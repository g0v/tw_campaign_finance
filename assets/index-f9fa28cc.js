(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function st(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((i=i.apply(e,t||[])).next())})}function Jb(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function bt(e){return this instanceof bt?(this.v=e,this):new bt(e)}function bi(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),r,s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(f){i[f]&&(r[f]=function(d){return new Promise(function(p,y){s.push([f,d,p,y])>1||a(f,d)})})}function a(f,d){try{c(i[f](d))}catch(p){h(s[0][3],p)}}function c(f){f.value instanceof bt?Promise.resolve(f.value.v).then(l,u):h(s[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function h(f,d){f(d),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Xu(e){var t,n;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,s){t[r]=e[r]?function(o){return(n=!n)?{value:bt(e[r](o)),done:!1}:s?s(o):o}:s}}function Us(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Jb=="function"?Jb(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}const T$=new TextDecoder("utf-8"),s0=e=>T$.decode(e),I$=new TextEncoder,qm=e=>I$.encode(e),[wet,M$]=(()=>{const e=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw e()}return t.asIntN=()=>{throw e()},t.asUintN=()=>{throw e()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[El,_et]=(()=>{const e=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[Al,vet]=(()=>{const e=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})(),N$=e=>typeof e=="number",kv=e=>typeof e=="boolean",de=e=>typeof e=="function",Ze=e=>e!=null&&Object(e)===e,zr=e=>Ze(e)&&de(e.then),Tl=e=>Ze(e)&&de(e[Symbol.iterator]),Ca=e=>Ze(e)&&de(e[Symbol.asyncIterator]),o0=e=>Ze(e)&&Ze(e.schema),Ov=e=>Ze(e)&&"done"in e&&"value"in e,Lv=e=>Ze(e)&&de(e.stat)&&N$(e.fd),Rv=e=>Ze(e)&&Ym(e.body),cd=e=>"_getDOMStream"in e&&"_getNodeStream"in e,$$=e=>Ze(e)&&de(e.abort)&&de(e.getWriter)&&!cd(e),Ym=e=>Ze(e)&&de(e.cancel)&&de(e.getReader)&&!cd(e),k$=e=>Ze(e)&&de(e.end)&&de(e.write)&&kv(e.writable)&&!cd(e),Fv=e=>Ze(e)&&de(e.read)&&de(e.pipe)&&kv(e.readable)&&!cd(e),O$=e=>Ze(e)&&de(e.clear)&&de(e.bytes)&&de(e.position)&&de(e.setPosition)&&de(e.capacity)&&de(e.getBufferIdentifier)&&de(e.createLong),Vm=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function L$(e){const t=e[0]?[e[0]]:[];let n,i,r,s;for(let o,a,c=0,l=0,u=e.length;++c<u;){if(o=t[l],a=e[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++l]=a);continue}if({byteOffset:n,byteLength:r}=o,{byteOffset:i,byteLength:s}=a,n+r<i||i+s<n){a&&(t[++l]=a);continue}t[l]=new Uint8Array(o.buffer,n,i-n+s)}return t}function Zb(e,t,n=0,i=t.byteLength){const r=e.byteLength,s=new Uint8Array(e.buffer,e.byteOffset,r),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(i,r));return s.set(o,n),e}function Ti(e,t){const n=L$(e),i=n.reduce((u,h)=>u+h.byteLength,0);let r,s,o,a=0,c=-1;const l=Math.min(t||Number.POSITIVE_INFINITY,i);for(const u=n.length;++c<u;){if(r=n[c],s=r.subarray(0,Math.min(r.length,l-a)),l<=a+s.length){s.length<r.length?n[c]=r.subarray(s.length):s.length===r.length&&c++,o?Zb(o,s,a):o=s;break}Zb(o||(o=new Uint8Array(l)),s,a),a+=s.length}return[o||new Uint8Array(0),n.slice(c),i-(o?o.byteLength:0)]}function Ut(e,t){let n=Ov(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=qm(n)),n instanceof ArrayBuffer?new e(n):n instanceof Vm?new e(n):O$(n)?Ut(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0)}const cc=e=>Ut(Int32Array,e),Ot=e=>Ut(Uint8Array,e),a0=e=>(e.next(),e);function*R$(e,t){const n=function*(r){yield r},i=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Vm?n(t):Tl(t)?t:n(t);return yield*a0(function*(r){let s=null;do s=r.next(yield Ut(e,s));while(!s.done)}(i[Symbol.iterator]())),new e}const F$=e=>R$(Uint8Array,e);function Dv(e,t){return bi(this,arguments,function*(){if(zr(t))return yield bt(yield bt(yield*Xu(Us(Dv(e,yield bt(t))))));const i=function(o){return bi(this,arguments,function*(){yield yield bt(yield bt(o))})},r=function(o){return bi(this,arguments,function*(){yield bt(yield*Xu(Us(a0(function*(a){let c=null;do c=a.next(yield c==null?void 0:c.value);while(!c.done)}(o[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Vm?i(t):Tl(t)?r(t):Ca(t)?t:i(t);return yield bt(yield*Xu(Us(a0(function(o){return bi(this,arguments,function*(){let a=null;do a=yield bt(o.next(yield yield bt(Ut(e,a))));while(!a.done)})}(s[Symbol.asyncIterator]()))))),yield bt(new e)})}const D$=e=>Dv(Uint8Array,e);function Wm(e,t,n){if(e!==0){n=n.slice(0,t+1);for(let i=-1;++i<=t;)n[i]+=e}return n}function C$(e,t){let n=0;const i=e.length;if(i!==t.length)return!1;if(i>0)do if(e[n]!==t[n])return!1;while(++n<i);return!0}const Tn={fromIterable(e){return hu(B$(e))},fromAsyncIterable(e){return hu(P$(e))},fromDOMStream(e){return hu(U$(e))},fromNodeStream(e){return hu(j$(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},hu=e=>(e.next(),e);function*B$(e){let t,n=!1,i=[],r,s,o,a=0;function c(){return s==="peek"?Ti(i,o)[0]:([r,i,a]=Ti(i,o),r)}({cmd:s,size:o}=yield null);const l=F$(e)[Symbol.iterator]();try{do if({done:t,value:r}=Number.isNaN(o-a)?l.next():l.next(o-a),!t&&r.byteLength>0&&(i.push(r),a+=r.byteLength),t||o<=a)do({cmd:s,size:o}=yield c());while(o<a);while(!t)}catch(u){(n=!0)&&typeof l.throw=="function"&&l.throw(u)}finally{n===!1&&typeof l.return=="function"&&l.return(null)}return null}function P$(e){return bi(this,arguments,function*(){let n,i=!1,r=[],s,o,a,c=0;function l(){return o==="peek"?Ti(r,a)[0]:([s,r,c]=Ti(r,a),s)}({cmd:o,size:a}=yield yield bt(null));const u=D$(e)[Symbol.asyncIterator]();try{do if({done:n,value:s}=Number.isNaN(a-c)?yield bt(u.next()):yield bt(u.next(a-c)),!n&&s.byteLength>0&&(r.push(s),c+=s.byteLength),n||a<=c)do({cmd:o,size:a}=yield yield bt(l()));while(a<c);while(!n)}catch(h){(i=!0)&&typeof u.throw=="function"&&(yield bt(u.throw(h)))}finally{i===!1&&typeof u.return=="function"&&(yield bt(u.return(new Uint8Array(0))))}return yield bt(null)})}function U$(e){return bi(this,arguments,function*(){let n=!1,i=!1,r=[],s,o,a,c=0;function l(){return o==="peek"?Ti(r,a)[0]:([s,r,c]=Ti(r,a),s)}({cmd:o,size:a}=yield yield bt(null));const u=new z$(e);try{do if({done:n,value:s}=Number.isNaN(a-c)?yield bt(u.read()):yield bt(u.read(a-c)),!n&&s.byteLength>0&&(r.push(Ot(s)),c+=s.byteLength),n||a<=c)do({cmd:o,size:a}=yield yield bt(l()));while(a<c);while(!n)}catch(h){(i=!0)&&(yield bt(u.cancel(h)))}finally{i===!1?yield bt(u.cancel()):e.locked&&u.releaseLock()}return yield bt(null)})}class z${constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return st(this,void 0,void 0,function*(){const{reader:n,source:i}=this;n&&(yield n.cancel(t).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(t){return st(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const n=yield this.reader.read();return!n.done&&(n.value=Ot(n)),n})}}const Up=(e,t)=>{const n=r=>i([t,r]);let i;return[t,n,new Promise(r=>(i=r)&&e.once(t,n))]};function j$(e){return bi(this,arguments,function*(){const n=[];let i="error",r=!1,s=null,o,a,c=0,l=[],u;function h(){return o==="peek"?Ti(l,a)[0]:([u,l,c]=Ti(l,a),u)}if({cmd:o,size:a}=yield yield bt(null),e.isTTY)return yield yield bt(new Uint8Array(0)),yield bt(null);try{n[0]=Up(e,"end"),n[1]=Up(e,"error");do{if(n[2]=Up(e,"readable"),[i,s]=yield bt(Promise.race(n.map(d=>d[2]))),i==="error")break;if((r=i==="end")||(Number.isFinite(a-c)?(u=Ot(e.read(a-c)),u.byteLength<a-c&&(u=Ot(e.read()))):u=Ot(e.read()),u.byteLength>0&&(l.push(u),c+=u.byteLength)),r||a<=c)do({cmd:o,size:a}=yield yield bt(h()));while(a<c)}while(!r)}finally{yield bt(f(n,i==="error"?s:null))}return yield bt(null);function f(d,p){return u=l=null,new Promise((y,m)=>{for(const[g,b]of d)e.off(g,b);try{const g=e.destroy;g&&g.call(e,p),p=void 0}catch(g){p=g||p}finally{p!=null?m(p):y()}})}})}var fn;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(fn||(fn={}));var gn;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(gn||(gn={}));var Je;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(Je||(Je={}));var ur;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(ur||(ur={}));var Lt;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(Lt||(Lt={}));var jr;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(jr||(jr={}));var Ct;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(Ct||(Ct={}));var L;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"})(L||(L={}));var Gi;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(Gi||(Gi={}));const q$=void 0;function Gc(e){if(e===null)return"null";if(e===q$)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof El||e instanceof Al?`[${[...e].map(t=>Gc(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,n)=>typeof n=="bigint"?`${n}`:n)}const Y$=Symbol.for("isArrowBigNum");function Zn(e,...t){return t.length===0?Object.setPrototypeOf(Ut(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}Zn.prototype[Y$]=!0;Zn.prototype.toJSON=function(){return`"${zs(this)}"`};Zn.prototype.valueOf=function(){return Cv(this)};Zn.prototype.toString=function(){return zs(this)};Zn.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return Cv(this);case"string":return zs(this);case"default":return c0(this)}return zs(this)};function qo(...e){return Zn.apply(this,e)}function Yo(...e){return Zn.apply(this,e)}function Hc(...e){return Zn.apply(this,e)}Object.setPrototypeOf(qo.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Yo.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Hc.prototype,Object.create(Uint32Array.prototype));Object.assign(qo.prototype,Zn.prototype,{constructor:qo,signed:!0,TypedArray:Int32Array,BigIntArray:El});Object.assign(Yo.prototype,Zn.prototype,{constructor:Yo,signed:!1,TypedArray:Uint32Array,BigIntArray:Al});Object.assign(Hc.prototype,Zn.prototype,{constructor:Hc,signed:!0,TypedArray:Uint32Array,BigIntArray:Al});function Cv(e){const{buffer:t,byteOffset:n,length:i,signed:r}=e,s=new Al(t,n,i),o=r&&s[s.length-1]&BigInt(1)<<BigInt(63);let a=BigInt(o?1:0),c=BigInt(0);if(o){for(const l of s)a+=~l*(BigInt(1)<<BigInt(32)*c++);a*=BigInt(-1)}else for(const l of s)a+=l*(BigInt(1)<<BigInt(32)*c++);return a}let zs,c0;M$?(c0=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:zp(e),zs=e=>e.byteLength===8?`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`:zp(e)):(zs=zp,c0=zs);function zp(e){let t="";const n=new Uint32Array(2);let i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const r=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let s=-1;const o=i.length-1;do{for(n[0]=i[s=0];s<o;)i[s++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+i[s];i[s]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,t=`${n[0]}${t}`}while(r[0]||r[1]||r[2]||r[3]);return t??"0"}class Gm{static new(t,n){switch(n){case!0:return new qo(t);case!1:return new Yo(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case El:return new qo(t)}return t.byteLength===16?new Hc(t):new Yo(t)}static signed(t){return new qo(t)}static unsigned(t){return new Yo(t)}static decimal(t){return new Hc(t)}constructor(t,n){return Gm.new(t,n)}}var Bv,Pv,Uv,zv,jv,qv,Yv,Vv,Wv,Gv,Hv,Xv,Kv,Qv,Jv,Zv,tx,ex,nx;class ct{static isNull(t){return(t==null?void 0:t.typeId)===L.Null}static isInt(t){return(t==null?void 0:t.typeId)===L.Int}static isFloat(t){return(t==null?void 0:t.typeId)===L.Float}static isBinary(t){return(t==null?void 0:t.typeId)===L.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===L.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===L.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===L.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===L.Date}static isTime(t){return(t==null?void 0:t.typeId)===L.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===L.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===L.Interval}static isList(t){return(t==null?void 0:t.typeId)===L.List}static isStruct(t){return(t==null?void 0:t.typeId)===L.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===L.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===L.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===L.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===L.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===L.Dictionary}static isDenseUnion(t){return ct.isUnion(t)&&t.mode===gn.Dense}static isSparseUnion(t){return ct.isUnion(t)&&t.mode===gn.Sparse}get typeId(){return L.NONE}}Bv=Symbol.toStringTag;ct[Bv]=(e=>(e.children=null,e.ArrayType=Array,e[Symbol.toStringTag]="DataType"))(ct.prototype);let qr=class extends ct{toString(){return"Null"}get typeId(){return L.Null}};Pv=Symbol.toStringTag;qr[Pv]=(e=>e[Symbol.toStringTag]="Null")(qr.prototype);class Yr extends ct{constructor(t,n){super(),this.isSigned=t,this.bitWidth=n}get typeId(){return L.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?El:Al}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Uv=Symbol.toStringTag;Yr[Uv]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(Yr.prototype);class Xc extends Yr{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(Xc.prototype,"ArrayType",{value:Int32Array});class Kc extends ct{constructor(t){super(),this.precision=t}get typeId(){return L.Float}get ArrayType(){switch(this.precision){case Je.HALF:return Uint16Array;case Je.SINGLE:return Float32Array;case Je.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}zv=Symbol.toStringTag;Kc[zv]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(Kc.prototype);let bf=class extends ct{constructor(){super()}get typeId(){return L.Binary}toString(){return"Binary"}};jv=Symbol.toStringTag;bf[jv]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(bf.prototype);let wf=class extends ct{constructor(){super()}get typeId(){return L.Utf8}toString(){return"Utf8"}};qv=Symbol.toStringTag;wf[qv]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(wf.prototype);let _f=class extends ct{constructor(){super()}get typeId(){return L.Bool}toString(){return"Bool"}};Yv=Symbol.toStringTag;_f[Yv]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(_f.prototype);let vf=class extends ct{constructor(t,n,i=128){super(),this.scale=t,this.precision=n,this.bitWidth=i}get typeId(){return L.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};Vv=Symbol.toStringTag;vf[Vv]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(vf.prototype);class xf extends ct{constructor(t){super(),this.unit=t}get typeId(){return L.Date}toString(){return`Date${(this.unit+1)*32}<${ur[this.unit]}>`}}Wv=Symbol.toStringTag;xf[Wv]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(xf.prototype);class Qc extends ct{constructor(t,n){super(),this.unit=t,this.bitWidth=n}get typeId(){return L.Time}toString(){return`Time${this.bitWidth}<${Lt[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return El}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Gv=Symbol.toStringTag;Qc[Gv]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(Qc.prototype);class Sf extends ct{constructor(t,n){super(),this.unit=t,this.timezone=n}get typeId(){return L.Timestamp}toString(){return`Timestamp<${Lt[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Hv=Symbol.toStringTag;Sf[Hv]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(Sf.prototype);class Ef extends ct{constructor(t){super(),this.unit=t}get typeId(){return L.Interval}toString(){return`Interval<${jr[this.unit]}>`}}Xv=Symbol.toStringTag;Ef[Xv]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(Ef.prototype);let Af=class extends ct{constructor(t){super(),this.children=[t]}get typeId(){return L.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};Kv=Symbol.toStringTag;Af[Kv]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(Af.prototype);class ze extends ct{constructor(t){super(),this.children=t}get typeId(){return L.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}Qv=Symbol.toStringTag;ze[Qv]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(ze.prototype);class Tf extends ct{constructor(t,n,i){super(),this.mode=t,this.children=i,this.typeIds=n=Int32Array.from(n),this.typeIdToChildIndex=n.reduce((r,s,o)=>(r[s]=o)&&r||r,Object.create(null))}get typeId(){return L.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}Jv=Symbol.toStringTag;Tf[Jv]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(Tf.prototype);let If=class extends ct{constructor(t){super(),this.byteWidth=t}get typeId(){return L.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};Zv=Symbol.toStringTag;If[Zv]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(If.prototype);let Mf=class extends ct{constructor(t,n){super(),this.listSize=t,this.children=[n]}get typeId(){return L.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};tx=Symbol.toStringTag;Mf[tx]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(Mf.prototype);class Nf extends ct{constructor(t,n=!1){super(),this.children=[t],this.keysSorted=n}get typeId(){return L.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}ex=Symbol.toStringTag;Nf[ex]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Nf.prototype);const V$=(e=>()=>++e)(-1);class aa extends ct{constructor(t,n,i,r){super(),this.indices=n,this.dictionary=t,this.isOrdered=r||!1,this.id=i==null?V$():typeof i=="number"?i:i.low}get typeId(){return L.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}nx=Symbol.toStringTag;aa[nx]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(aa.prototype);function Hi(e){const t=e;switch(e.typeId){case L.Decimal:return e.bitWidth/32;case L.Timestamp:return 2;case L.Date:return 1+t.unit;case L.Interval:return 1+t.unit;case L.FixedSizeList:return t.listSize;case L.FixedSizeBinary:return t.byteWidth;default:return 1}}class It{visitMany(t,...n){return t.map((i,r)=>this.visit(i,...n.map(s=>s[r])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,n=!0){return W$(this,t,n)}getVisitFnByTypeId(t,n=!0){return $o(this,t,n)}visitNull(t,...n){return null}visitBool(t,...n){return null}visitInt(t,...n){return null}visitFloat(t,...n){return null}visitUtf8(t,...n){return null}visitBinary(t,...n){return null}visitFixedSizeBinary(t,...n){return null}visitDate(t,...n){return null}visitTimestamp(t,...n){return null}visitTime(t,...n){return null}visitDecimal(t,...n){return null}visitList(t,...n){return null}visitStruct(t,...n){return null}visitUnion(t,...n){return null}visitDictionary(t,...n){return null}visitInterval(t,...n){return null}visitFixedSizeList(t,...n){return null}visitMap(t,...n){return null}}function W$(e,t,n=!0){return typeof t=="number"?$o(e,t,n):typeof t=="string"&&t in L?$o(e,L[t],n):t&&t instanceof ct?$o(e,tw(t),n):t!=null&&t.type&&t.type instanceof ct?$o(e,tw(t.type),n):$o(e,L.NONE,n)}function $o(e,t,n=!0){let i=null;switch(t){case L.Null:i=e.visitNull;break;case L.Bool:i=e.visitBool;break;case L.Int:i=e.visitInt;break;case L.Int8:i=e.visitInt8||e.visitInt;break;case L.Int16:i=e.visitInt16||e.visitInt;break;case L.Int32:i=e.visitInt32||e.visitInt;break;case L.Int64:i=e.visitInt64||e.visitInt;break;case L.Uint8:i=e.visitUint8||e.visitInt;break;case L.Uint16:i=e.visitUint16||e.visitInt;break;case L.Uint32:i=e.visitUint32||e.visitInt;break;case L.Uint64:i=e.visitUint64||e.visitInt;break;case L.Float:i=e.visitFloat;break;case L.Float16:i=e.visitFloat16||e.visitFloat;break;case L.Float32:i=e.visitFloat32||e.visitFloat;break;case L.Float64:i=e.visitFloat64||e.visitFloat;break;case L.Utf8:i=e.visitUtf8;break;case L.Binary:i=e.visitBinary;break;case L.FixedSizeBinary:i=e.visitFixedSizeBinary;break;case L.Date:i=e.visitDate;break;case L.DateDay:i=e.visitDateDay||e.visitDate;break;case L.DateMillisecond:i=e.visitDateMillisecond||e.visitDate;break;case L.Timestamp:i=e.visitTimestamp;break;case L.TimestampSecond:i=e.visitTimestampSecond||e.visitTimestamp;break;case L.TimestampMillisecond:i=e.visitTimestampMillisecond||e.visitTimestamp;break;case L.TimestampMicrosecond:i=e.visitTimestampMicrosecond||e.visitTimestamp;break;case L.TimestampNanosecond:i=e.visitTimestampNanosecond||e.visitTimestamp;break;case L.Time:i=e.visitTime;break;case L.TimeSecond:i=e.visitTimeSecond||e.visitTime;break;case L.TimeMillisecond:i=e.visitTimeMillisecond||e.visitTime;break;case L.TimeMicrosecond:i=e.visitTimeMicrosecond||e.visitTime;break;case L.TimeNanosecond:i=e.visitTimeNanosecond||e.visitTime;break;case L.Decimal:i=e.visitDecimal;break;case L.List:i=e.visitList;break;case L.Struct:i=e.visitStruct;break;case L.Union:i=e.visitUnion;break;case L.DenseUnion:i=e.visitDenseUnion||e.visitUnion;break;case L.SparseUnion:i=e.visitSparseUnion||e.visitUnion;break;case L.Dictionary:i=e.visitDictionary;break;case L.Interval:i=e.visitInterval;break;case L.IntervalDayTime:i=e.visitIntervalDayTime||e.visitInterval;break;case L.IntervalYearMonth:i=e.visitIntervalYearMonth||e.visitInterval;break;case L.FixedSizeList:i=e.visitFixedSizeList;break;case L.Map:i=e.visitMap;break}if(typeof i=="function")return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${L[t]}'`)}function tw(e){switch(e.typeId){case L.Null:return L.Null;case L.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?L.Int8:L.Uint8;case 16:return n?L.Int16:L.Uint16;case 32:return n?L.Int32:L.Uint32;case 64:return n?L.Int64:L.Uint64}return L.Int}case L.Float:switch(e.precision){case Je.HALF:return L.Float16;case Je.SINGLE:return L.Float32;case Je.DOUBLE:return L.Float64}return L.Float;case L.Binary:return L.Binary;case L.Utf8:return L.Utf8;case L.Bool:return L.Bool;case L.Decimal:return L.Decimal;case L.Time:switch(e.unit){case Lt.SECOND:return L.TimeSecond;case Lt.MILLISECOND:return L.TimeMillisecond;case Lt.MICROSECOND:return L.TimeMicrosecond;case Lt.NANOSECOND:return L.TimeNanosecond}return L.Time;case L.Timestamp:switch(e.unit){case Lt.SECOND:return L.TimestampSecond;case Lt.MILLISECOND:return L.TimestampMillisecond;case Lt.MICROSECOND:return L.TimestampMicrosecond;case Lt.NANOSECOND:return L.TimestampNanosecond}return L.Timestamp;case L.Date:switch(e.unit){case ur.DAY:return L.DateDay;case ur.MILLISECOND:return L.DateMillisecond}return L.Date;case L.Interval:switch(e.unit){case jr.DAY_TIME:return L.IntervalDayTime;case jr.YEAR_MONTH:return L.IntervalYearMonth}return L.Interval;case L.Map:return L.Map;case L.List:return L.List;case L.Struct:return L.Struct;case L.Union:switch(e.mode){case gn.Dense:return L.DenseUnion;case gn.Sparse:return L.SparseUnion}return L.Union;case L.FixedSizeBinary:return L.FixedSizeBinary;case L.FixedSizeList:return L.FixedSizeList;case L.Dictionary:return L.Dictionary}throw new Error(`Unrecognized type '${L[e.typeId]}'`)}It.prototype.visitInt8=null;It.prototype.visitInt16=null;It.prototype.visitInt32=null;It.prototype.visitInt64=null;It.prototype.visitUint8=null;It.prototype.visitUint16=null;It.prototype.visitUint32=null;It.prototype.visitUint64=null;It.prototype.visitFloat16=null;It.prototype.visitFloat32=null;It.prototype.visitFloat64=null;It.prototype.visitDateDay=null;It.prototype.visitDateMillisecond=null;It.prototype.visitTimestampSecond=null;It.prototype.visitTimestampMillisecond=null;It.prototype.visitTimestampMicrosecond=null;It.prototype.visitTimestampNanosecond=null;It.prototype.visitTimeSecond=null;It.prototype.visitTimeMillisecond=null;It.prototype.visitTimeMicrosecond=null;It.prototype.visitTimeNanosecond=null;It.prototype.visitDenseUnion=null;It.prototype.visitSparseUnion=null;It.prototype.visitIntervalDayTime=null;It.prototype.visitIntervalYearMonth=null;const ix=new Float64Array(1),mo=new Uint32Array(ix.buffer);function rx(e){const t=(e&31744)>>10,n=(e&1023)/1024,i=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,t-15)*(1+n)}function G$(e){if(e!==e)return 32256;ix[0]=e;const t=(mo[1]&2147483648)>>16&65535;let n=mo[1]&2146435072,i=0;return n>=1089470464?mo[0]>0?n=31744:(n=(n&2080374784)>>16,i=(mo[1]&1048575)>>10):n<=1056964608?(i=1048576+(mo[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(mo[1]&1048575)+512>>10),t|n|i&65535}class dt extends It{}function gt(e){return(t,n,i)=>{if(t.setValid(n,i!=null))return e(t,n,i)}}const H$=(e,t,n)=>{e[t]=Math.trunc(n/864e5)},Hm=(e,t,n)=>{e[t]=Math.trunc(n%4294967296),e[t+1]=Math.trunc(n/4294967296)},X$=(e,t,n)=>{e[t]=Math.trunc(n*1e3%4294967296),e[t+1]=Math.trunc(n*1e3/4294967296)},K$=(e,t,n)=>{e[t]=Math.trunc(n*1e6%4294967296),e[t+1]=Math.trunc(n*1e6/4294967296)},sx=(e,t,n,i)=>{if(n+1<t.length){const{[n]:r,[n+1]:s}=t;e.set(i.subarray(0,s-r),r)}},Q$=({offset:e,values:t},n,i)=>{const r=e+n;i?t[r>>3]|=1<<r%8:t[r>>3]&=~(1<<r%8)},mr=({values:e},t,n)=>{e[t]=n},Xm=({values:e},t,n)=>{e[t]=n},ox=({values:e},t,n)=>{e[t]=G$(n)},J$=(e,t,n)=>{switch(e.type.precision){case Je.HALF:return ox(e,t,n);case Je.SINGLE:case Je.DOUBLE:return Xm(e,t,n)}},ax=({values:e},t,n)=>{H$(e,t,n.valueOf())},cx=({values:e},t,n)=>{Hm(e,t*2,n.valueOf())},Z$=({stride:e,values:t},n,i)=>{t.set(i.subarray(0,e),e*n)},tk=({values:e,valueOffsets:t},n,i)=>sx(e,t,n,i),ek=({values:e,valueOffsets:t},n,i)=>{sx(e,t,n,qm(i))},nk=(e,t,n)=>{e.type.unit===ur.DAY?ax(e,t,n):cx(e,t,n)},lx=({values:e},t,n)=>Hm(e,t*2,n/1e3),ux=({values:e},t,n)=>Hm(e,t*2,n),fx=({values:e},t,n)=>X$(e,t*2,n),hx=({values:e},t,n)=>K$(e,t*2,n),ik=(e,t,n)=>{switch(e.type.unit){case Lt.SECOND:return lx(e,t,n);case Lt.MILLISECOND:return ux(e,t,n);case Lt.MICROSECOND:return fx(e,t,n);case Lt.NANOSECOND:return hx(e,t,n)}},dx=({values:e},t,n)=>{e[t]=n},px=({values:e},t,n)=>{e[t]=n},yx=({values:e},t,n)=>{e[t]=n},mx=({values:e},t,n)=>{e[t]=n},rk=(e,t,n)=>{switch(e.type.unit){case Lt.SECOND:return dx(e,t,n);case Lt.MILLISECOND:return px(e,t,n);case Lt.MICROSECOND:return yx(e,t,n);case Lt.NANOSECOND:return mx(e,t,n)}},sk=({values:e,stride:t},n,i)=>{e.set(i.subarray(0,t),t*n)},ok=(e,t,n)=>{const i=e.children[0],r=e.valueOffsets,s=Fn.getVisitFn(i);if(Array.isArray(n))for(let o=-1,a=r[t],c=r[t+1];a<c;)s(i,a++,n[++o]);else for(let o=-1,a=r[t],c=r[t+1];a<c;)s(i,a++,n.get(++o))},ak=(e,t,n)=>{const i=e.children[0],{valueOffsets:r}=e,s=Fn.getVisitFn(i);let{[t]:o,[t+1]:a}=r;const c=n instanceof Map?n.entries():Object.entries(n);for(const l of c)if(s(i,o,l),++o>=a)break},ck=(e,t)=>(n,i,r,s)=>i&&n(i,e,t[s]),lk=(e,t)=>(n,i,r,s)=>i&&n(i,e,t.get(s)),uk=(e,t)=>(n,i,r,s)=>i&&n(i,e,t.get(r.name)),fk=(e,t)=>(n,i,r,s)=>i&&n(i,e,t[r.name]),hk=(e,t,n)=>{const i=e.type.children.map(s=>Fn.getVisitFn(s.type)),r=n instanceof Map?uk(t,n):n instanceof ie?lk(t,n):Array.isArray(n)?ck(t,n):fk(t,n);e.type.children.forEach((s,o)=>r(i[o],e.children[o],s,o))},dk=(e,t,n)=>{e.type.mode===gn.Dense?gx(e,t,n):bx(e,t,n)},gx=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];Fn.visit(r,e.valueOffsets[t],n)},bx=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];Fn.visit(r,t,n)},pk=(e,t,n)=>{var i;(i=e.dictionary)===null||i===void 0||i.set(e.values[t],n)},yk=(e,t,n)=>{e.type.unit===jr.DAY_TIME?wx(e,t,n):_x(e,t,n)},wx=({values:e},t,n)=>{e.set(n.subarray(0,2),2*t)},_x=({values:e},t,n)=>{e[t]=n[0]*12+n[1]%12},mk=(e,t,n)=>{const{stride:i}=e,r=e.children[0],s=Fn.getVisitFn(r);if(Array.isArray(n))for(let o=-1,a=t*i;++o<i;)s(r,a+o,n[o]);else for(let o=-1,a=t*i;++o<i;)s(r,a+o,n.get(o))};dt.prototype.visitBool=gt(Q$);dt.prototype.visitInt=gt(mr);dt.prototype.visitInt8=gt(mr);dt.prototype.visitInt16=gt(mr);dt.prototype.visitInt32=gt(mr);dt.prototype.visitInt64=gt(mr);dt.prototype.visitUint8=gt(mr);dt.prototype.visitUint16=gt(mr);dt.prototype.visitUint32=gt(mr);dt.prototype.visitUint64=gt(mr);dt.prototype.visitFloat=gt(J$);dt.prototype.visitFloat16=gt(ox);dt.prototype.visitFloat32=gt(Xm);dt.prototype.visitFloat64=gt(Xm);dt.prototype.visitUtf8=gt(ek);dt.prototype.visitBinary=gt(tk);dt.prototype.visitFixedSizeBinary=gt(Z$);dt.prototype.visitDate=gt(nk);dt.prototype.visitDateDay=gt(ax);dt.prototype.visitDateMillisecond=gt(cx);dt.prototype.visitTimestamp=gt(ik);dt.prototype.visitTimestampSecond=gt(lx);dt.prototype.visitTimestampMillisecond=gt(ux);dt.prototype.visitTimestampMicrosecond=gt(fx);dt.prototype.visitTimestampNanosecond=gt(hx);dt.prototype.visitTime=gt(rk);dt.prototype.visitTimeSecond=gt(dx);dt.prototype.visitTimeMillisecond=gt(px);dt.prototype.visitTimeMicrosecond=gt(yx);dt.prototype.visitTimeNanosecond=gt(mx);dt.prototype.visitDecimal=gt(sk);dt.prototype.visitList=gt(ok);dt.prototype.visitStruct=gt(hk);dt.prototype.visitUnion=gt(dk);dt.prototype.visitDenseUnion=gt(gx);dt.prototype.visitSparseUnion=gt(bx);dt.prototype.visitDictionary=gt(pk);dt.prototype.visitInterval=gt(yk);dt.prototype.visitIntervalDayTime=gt(wx);dt.prototype.visitIntervalYearMonth=gt(_x);dt.prototype.visitFixedSizeList=gt(mk);dt.prototype.visitMap=gt(ak);const Fn=new dt,qn=Symbol.for("parent"),Vo=Symbol.for("rowIndex");class Km{constructor(t,n){return this[qn]=t,this[Vo]=n,new Proxy(this,new bk)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Vo],n=this[qn],i=n.type.children,r={};for(let s=-1,o=i.length;++s<o;)r[i[s].name]=tn.visit(n.children[s],t);return r}toString(){return`{${[...this].map(([t,n])=>`${Gc(t)}: ${Gc(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new gk(this[qn],this[Vo])}}class gk{constructor(t,n){this.childIndex=0,this.children=t.children,this.rowIndex=n,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,tn.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Km.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[qn]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Vo]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class bk{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[qn].type.children.map(n=>n.name)}has(t,n){return t[qn].type.children.findIndex(i=>i.name===n)!==-1}getOwnPropertyDescriptor(t,n){if(t[qn].type.children.findIndex(i=>i.name===n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const i=t[qn].type.children.findIndex(r=>r.name===n);if(i!==-1){const r=tn.visit(t[qn].children[i],t[Vo]);return Reflect.set(t,n,r),r}}set(t,n,i){const r=t[qn].type.children.findIndex(s=>s.name===n);return r!==-1?(Fn.visit(t[qn].children[r],t[Vo],i),Reflect.set(t,n,i)):Reflect.has(t,n)||typeof n=="symbol"?Reflect.set(t,n,i):!1}}class lt extends It{}function pt(e){return(t,n)=>t.getValid(n)?e(t,n):null}const wk=(e,t)=>864e5*e[t],Qm=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),_k=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,vk=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,vx=e=>new Date(e),xk=(e,t)=>vx(wk(e,t)),Sk=(e,t)=>vx(Qm(e,t)),Ek=(e,t)=>null,xx=(e,t,n)=>{if(n+1>=t.length)return null;const i=t[n],r=t[n+1];return e.subarray(i,r)},Ak=({offset:e,values:t},n)=>{const i=e+n;return(t[i>>3]&1<<i%8)!==0},Sx=({values:e},t)=>xk(e,t),Ex=({values:e},t)=>Sk(e,t*2),rs=({stride:e,values:t},n)=>t[e*n],Tk=({stride:e,values:t},n)=>rx(t[e*n]),Ax=({values:e},t)=>e[t],Ik=({stride:e,values:t},n)=>t.subarray(e*n,e*(n+1)),Mk=({values:e,valueOffsets:t},n)=>xx(e,t,n),Nk=({values:e,valueOffsets:t},n)=>{const i=xx(e,t,n);return i!==null?s0(i):null},$k=({values:e},t)=>e[t],kk=({type:e,values:t},n)=>e.precision!==Je.HALF?t[n]:rx(t[n]),Ok=(e,t)=>e.type.unit===ur.DAY?Sx(e,t):Ex(e,t),Tx=({values:e},t)=>1e3*Qm(e,t*2),Ix=({values:e},t)=>Qm(e,t*2),Mx=({values:e},t)=>_k(e,t*2),Nx=({values:e},t)=>vk(e,t*2),Lk=(e,t)=>{switch(e.type.unit){case Lt.SECOND:return Tx(e,t);case Lt.MILLISECOND:return Ix(e,t);case Lt.MICROSECOND:return Mx(e,t);case Lt.NANOSECOND:return Nx(e,t)}},$x=({values:e},t)=>e[t],kx=({values:e},t)=>e[t],Ox=({values:e},t)=>e[t],Lx=({values:e},t)=>e[t],Rk=(e,t)=>{switch(e.type.unit){case Lt.SECOND:return $x(e,t);case Lt.MILLISECOND:return kx(e,t);case Lt.MICROSECOND:return Ox(e,t);case Lt.NANOSECOND:return Lx(e,t)}},Fk=({values:e,stride:t},n)=>Gm.decimal(e.subarray(t*n,t*(n+1))),Dk=(e,t)=>{const{valueOffsets:n,stride:i,children:r}=e,{[t*i]:s,[t*i+1]:o}=n,c=r[0].slice(s,o-s);return new ie([c])},Ck=(e,t)=>{const{valueOffsets:n,children:i}=e,{[t]:r,[t+1]:s}=n,o=i[0];return new Jm(o.slice(r,s-r))},Bk=(e,t)=>new Km(e,t),Pk=(e,t)=>e.type.mode===gn.Dense?Rx(e,t):Fx(e,t),Rx=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return tn.visit(i,e.valueOffsets[t])},Fx=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return tn.visit(i,t)},Uk=(e,t)=>{var n;return(n=e.dictionary)===null||n===void 0?void 0:n.get(e.values[t])},zk=(e,t)=>e.type.unit===jr.DAY_TIME?Dx(e,t):Cx(e,t),Dx=({values:e},t)=>e.subarray(2*t,2*(t+1)),Cx=({values:e},t)=>{const n=e[t],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i},jk=(e,t)=>{const{stride:n,children:i}=e,s=i[0].slice(t*n,n);return new ie([s])};lt.prototype.visitNull=pt(Ek);lt.prototype.visitBool=pt(Ak);lt.prototype.visitInt=pt($k);lt.prototype.visitInt8=pt(rs);lt.prototype.visitInt16=pt(rs);lt.prototype.visitInt32=pt(rs);lt.prototype.visitInt64=pt(Ax);lt.prototype.visitUint8=pt(rs);lt.prototype.visitUint16=pt(rs);lt.prototype.visitUint32=pt(rs);lt.prototype.visitUint64=pt(Ax);lt.prototype.visitFloat=pt(kk);lt.prototype.visitFloat16=pt(Tk);lt.prototype.visitFloat32=pt(rs);lt.prototype.visitFloat64=pt(rs);lt.prototype.visitUtf8=pt(Nk);lt.prototype.visitBinary=pt(Mk);lt.prototype.visitFixedSizeBinary=pt(Ik);lt.prototype.visitDate=pt(Ok);lt.prototype.visitDateDay=pt(Sx);lt.prototype.visitDateMillisecond=pt(Ex);lt.prototype.visitTimestamp=pt(Lk);lt.prototype.visitTimestampSecond=pt(Tx);lt.prototype.visitTimestampMillisecond=pt(Ix);lt.prototype.visitTimestampMicrosecond=pt(Mx);lt.prototype.visitTimestampNanosecond=pt(Nx);lt.prototype.visitTime=pt(Rk);lt.prototype.visitTimeSecond=pt($x);lt.prototype.visitTimeMillisecond=pt(kx);lt.prototype.visitTimeMicrosecond=pt(Ox);lt.prototype.visitTimeNanosecond=pt(Lx);lt.prototype.visitDecimal=pt(Fk);lt.prototype.visitList=pt(Dk);lt.prototype.visitStruct=pt(Bk);lt.prototype.visitUnion=pt(Pk);lt.prototype.visitDenseUnion=pt(Rx);lt.prototype.visitSparseUnion=pt(Fx);lt.prototype.visitDictionary=pt(Uk);lt.prototype.visitInterval=pt(zk);lt.prototype.visitIntervalDayTime=pt(Dx);lt.prototype.visitIntervalYearMonth=pt(Cx);lt.prototype.visitFixedSizeList=pt(jk);lt.prototype.visitMap=pt(Ck);const tn=new lt,ui=Symbol.for("keys"),Wo=Symbol.for("vals");class Jm{constructor(t){return this[ui]=new ie([t.children[0]]).memoize(),this[Wo]=t.children[1],new Proxy(this,new Yk)}[Symbol.iterator](){return new qk(this[ui],this[Wo])}get size(){return this[ui].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ui],n=this[Wo],i={};for(let r=-1,s=t.length;++r<s;)i[t.get(r)]=tn.visit(n,r);return i}toString(){return`{${[...this].map(([t,n])=>`${Gc(t)}: ${Gc(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class qk{constructor(t,n){this.keys=t,this.vals=n,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),tn.visit(this.vals,t)]})}}class Yk{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[ui].toArray().map(String)}has(t,n){return t[ui].includes(n)}getOwnPropertyDescriptor(t,n){if(t[ui].indexOf(n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const i=t[ui].indexOf(n);if(i!==-1){const r=tn.visit(Reflect.get(t,Wo),i);return Reflect.set(t,n,r),r}}set(t,n,i){const r=t[ui].indexOf(n);return r!==-1?(Fn.visit(Reflect.get(t,Wo),r,i),Reflect.set(t,n,i)):Reflect.has(t,n)?Reflect.set(t,n,i):!1}}Object.defineProperties(Jm.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ui]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Wo]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let ew;function Bx(e,t,n,i){const{length:r=0}=e;let s=typeof t!="number"?0:t,o=typeof n!="number"?r:n;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(ew=s,s=o,o=ew),o>r&&(o=r),i?i(e,s,o):[s,o]}const nw=e=>e!==e;function Ba(e){if(typeof e!=="object"||e===null)return nw(e)?nw:n=>n===e;if(e instanceof Date){const n=e.valueOf();return i=>i instanceof Date?i.valueOf()===n:!1}return ArrayBuffer.isView(e)?n=>n?C$(e,n):!1:e instanceof Map?Wk(e):Array.isArray(e)?Vk(e):e instanceof ie?Gk(e):Hk(e,!0)}function Vk(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=Ba(e[n]);return ld(t)}function Wk(e){let t=-1;const n=[];for(const i of e.values())n[++t]=Ba(i);return ld(n)}function Gk(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=Ba(e.get(n));return ld(t)}function Hk(e,t=!1){const n=Object.keys(e);if(!t&&n.length===0)return()=>!1;const i=[];for(let r=-1,s=n.length;++r<s;)i[r]=Ba(e[n[r]]);return ld(i,n)}function ld(e,t){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return Xk(e,n);case Map:return iw(e,n,n.keys());case Jm:case Km:case Object:case void 0:return iw(e,n,t||Object.keys(n))}return n instanceof ie?Kk(e,n):!1}}function Xk(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t[i]))return!1;return!0}function Kk(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t.get(i)))return!1;return!0}function iw(e,t,n){const i=n[Symbol.iterator](),r=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=e.length;let c=s.next(),l=i.next(),u=r.next();for(;o<a&&!l.done&&!u.done&&!c.done&&!(l.value!==u.value||!e[o](c.value));++o,l=i.next(),u=r.next(),c=s.next());return o===a&&l.done&&u.done&&c.done?!0:(i.return&&i.return(),r.return&&r.return(),s.return&&s.return(),!1)}function Px(e,t,n,i){return(n&1<<i)!==0}function Qk(e,t,n,i){return(n&1<<i)>>i}function Zm(e,t,n){const i=n.byteLength+7&-8;if(e>0||n.byteLength<i){const r=new Uint8Array(i);return r.set(e%8===0?n.subarray(e>>3):$f(new tg(n,e,t,null,Px)).subarray(0,i)),r}return n}function $f(e){const t=[];let n=0,i=0,r=0;for(const o of e)o&&(r|=1<<i),++i===8&&(t[n++]=r,r=i=0);(n===0||i>0)&&(t[n++]=r);const s=new Uint8Array(t.length+7&-8);return s.set(t),s}class tg{constructor(t,n,i,r,s){this.bytes=t,this.length=i,this.context=r,this.get=s,this.bit=n%8,this.byteIndex=n>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function l0(e,t,n){if(n-t<=0)return 0;if(n-t<8){let s=0;for(const o of new tg(e,t,n-t,e,Qk))s+=o;return s}const i=n>>3<<3,r=t+(t%8===0?0:8-t%8);return l0(e,t,r)+l0(e,i,n)+Jk(e,r>>3,i-r>>3)}function Jk(e,t,n){let i=0,r=Math.trunc(t);const s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=n===void 0?e.byteLength:r+n;for(;o-r>=4;)i+=jp(s.getUint32(r)),r+=4;for(;o-r>=2;)i+=jp(s.getUint16(r)),r+=2;for(;o-r>=1;)i+=jp(s.getUint8(r)),r+=1;return i}function jp(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const Zk=-1;class Wt{constructor(t,n,i,r,s,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1));let c;s instanceof Wt?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=Hi(t),s&&((c=s[0])&&(this.valueOffsets=c),(c=s[1])&&(this.values=c),(c=s[2])&&(this.nullBitmap=c),(c=s[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:n,values:i,nullBitmap:r,typeIds:s}=this;return n&&(t+=n.byteLength),i&&(t+=i.byteLength),r&&(t+=r.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){let t=this._nullCount,n;return t<=Zk&&(n=this.nullBitmap)&&(this._nullCount=t=this.length-l0(n,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){const n=this.offset+t;return(this.nullBitmap[n>>3]&1<<n%8)!==0}return!0}setValid(t,n){if(!this.nullable)return n;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}const{nullBitmap:i,offset:r}=this,s=r+t>>3,o=(r+t)%8,a=i[s]>>o&1;return n?a===0&&(i[s]|=1<<o,this._nullCount=this.nullCount+1):a===1&&(i[s]&=~(1<<o),this._nullCount=this.nullCount-1),n}clone(t=this.type,n=this.offset,i=this.length,r=this._nullCount,s=this,o=this.children){return new Wt(t,n,i,r,s,o,this.dictionary)}slice(t,n){const{stride:i,typeId:r,children:s}=this,o=+(this._nullCount===0)-1,a=r===16?i:1,c=this._sliceBuffers(t,n,i,r);return this.clone(this.type,this.offset+t,n,o,c,s.length===0||this.valueOffsets?s:this._sliceChildren(s,a*t,a*n))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===L.Null)return this.clone(this.type,0,t,0);const{length:n,nullCount:i}=this,r=new Uint8Array((t+63&-64)>>3).fill(255,0,n>>3);r[n>>3]=(1<<n-(n&-8))-1,i>0&&r.set(Zm(this.offset,n,this.nullBitmap),0);const s=this.buffers;return s[Gi.VALIDITY]=r,this.clone(this.type,0,t,i+(t-n),s)}_sliceBuffers(t,n,i,r){let s;const{buffers:o}=this;return(s=o[Gi.TYPE])&&(o[Gi.TYPE]=s.subarray(t,t+n)),(s=o[Gi.OFFSET])&&(o[Gi.OFFSET]=s.subarray(t,t+n+1))||(s=o[Gi.DATA])&&(o[Gi.DATA]=r===6?s:s.subarray(i*t,i*(t+n))),o}_sliceChildren(t,n,i){return t.map(r=>r.slice(n,i))}}Wt.prototype.children=Object.freeze([]);class Fc extends It{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:n,["offset"]:i=0,["length"]:r=0}=t;return new Wt(n,i,r,0)}visitBool(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitInt(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitFloat(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitUtf8(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.data),s=Ot(t.nullBitmap),o=cc(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Wt(n,i,a,c,[o,r,s])}visitBinary(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.data),s=Ot(t.nullBitmap),o=cc(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Wt(n,i,a,c,[o,r,s])}visitFixedSizeBinary(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitDate(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitTimestamp(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitTime(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitDecimal(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitList(t){const{["type"]:n,["offset"]:i=0,["child"]:r}=t,s=Ot(t.nullBitmap),o=cc(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Wt(n,i,a,c,[o,void 0,s],[r])}visitStruct(t){const{["type"]:n,["offset"]:i=0,["children"]:r=[]}=t,s=Ot(t.nullBitmap),{length:o=r.reduce((c,{length:l})=>Math.max(c,l),0),nullCount:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,void 0,s],r)}visitUnion(t){const{["type"]:n,["offset"]:i=0,["children"]:r=[]}=t,s=Ot(t.nullBitmap),o=Ut(n.ArrayType,t.typeIds),{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(ct.isSparseUnion(n))return new Wt(n,i,a,c,[void 0,void 0,s,o],r);const l=cc(t.valueOffsets);return new Wt(n,i,a,c,[l,void 0,s,o],r)}visitDictionary(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.indices.ArrayType,t.data),{["dictionary"]:o=new ie([new Fc().visit({type:n.dictionary})])}=t,{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Wt(n,i,a,c,[void 0,s,r],[],o)}visitInterval(t){const{["type"]:n,["offset"]:i=0}=t,r=Ot(t.nullBitmap),s=Ut(n.ArrayType,t.data),{["length"]:o=s.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,s,r])}visitFixedSizeList(t){const{["type"]:n,["offset"]:i=0,["child"]:r=new Fc().visit({type:n.valueType})}=t,s=Ot(t.nullBitmap),{["length"]:o=r.length/Hi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Wt(n,i,o,a,[void 0,void 0,s],[r])}visitMap(t){const{["type"]:n,["offset"]:i=0,["child"]:r=new Fc().visit({type:n.childType})}=t,s=Ot(t.nullBitmap),o=cc(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Wt(n,i,a,c,[o,void 0,s],[r])}}function At(e){return new Fc().visit(e)}class rw{constructor(t=0,n){this.numChunks=t,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Ux(e){return e.reduce((t,n)=>t+n.nullCount,0)}function zx(e){return e.reduce((t,n,i)=>(t[i+1]=t[i]+n.length,t),new Uint32Array(e.length+1))}function jx(e,t,n,i){const r=[];for(let s=-1,o=e.length;++s<o;){const a=e[s],c=t[s],{length:l}=a;if(c>=i)break;if(n>=c+l)continue;if(c>=n&&c+l<=i){r.push(a);continue}const u=Math.max(0,n-c),h=Math.min(i-c,l);r.push(a.slice(u,h-u))}return r.length===0&&r.push(e[0].slice(0,0)),r}function eg(e,t,n,i){let r=0,s=0,o=t.length-1;do{if(r>=o-1)return n<t[o]?i(e,r,n-t[r]):null;s=r+Math.trunc((o-r)*.5),n<t[s]?o=s:r=s}while(r<o)}function ng(e,t){return e.getValid(t)}function Go(e){function t(n,i,r){return e(n[i],r)}return function(n){const i=this.data;return eg(i,this._offsets,n,t)}}function qx(e){let t;function n(i,r,s){return e(i[r],s,t)}return function(i,r){const s=this.data;t=r;const o=eg(s,this._offsets,i,n);return t=void 0,o}}function Yx(e){let t;function n(i,r,s){let o=s,a=0,c=0;for(let l=r-1,u=i.length;++l<u;){const h=i[l];if(~(a=e(h,t,o)))return c+a;o=0,c+=h.length}return-1}return function(i,r){t=i;const s=this.data,o=typeof r!="number"?n(s,0,0):eg(s,this._offsets,r,n);return t=void 0,o}}class ut extends It{}function t4(e,t){return t===null&&e.length>0?0:-1}function e4(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let i=0;for(const r of new tg(n,e.offset+(t||0),e.length,n,Px)){if(!r)return i;++i}return-1}function _t(e,t,n){if(t===void 0)return-1;if(t===null)return e4(e,n);const i=tn.getVisitFn(e),r=Ba(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(r(i(e,s)))return s;return-1}function Vx(e,t,n){const i=tn.getVisitFn(e),r=Ba(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(r(i(e,s)))return s;return-1}ut.prototype.visitNull=t4;ut.prototype.visitBool=_t;ut.prototype.visitInt=_t;ut.prototype.visitInt8=_t;ut.prototype.visitInt16=_t;ut.prototype.visitInt32=_t;ut.prototype.visitInt64=_t;ut.prototype.visitUint8=_t;ut.prototype.visitUint16=_t;ut.prototype.visitUint32=_t;ut.prototype.visitUint64=_t;ut.prototype.visitFloat=_t;ut.prototype.visitFloat16=_t;ut.prototype.visitFloat32=_t;ut.prototype.visitFloat64=_t;ut.prototype.visitUtf8=_t;ut.prototype.visitBinary=_t;ut.prototype.visitFixedSizeBinary=_t;ut.prototype.visitDate=_t;ut.prototype.visitDateDay=_t;ut.prototype.visitDateMillisecond=_t;ut.prototype.visitTimestamp=_t;ut.prototype.visitTimestampSecond=_t;ut.prototype.visitTimestampMillisecond=_t;ut.prototype.visitTimestampMicrosecond=_t;ut.prototype.visitTimestampNanosecond=_t;ut.prototype.visitTime=_t;ut.prototype.visitTimeSecond=_t;ut.prototype.visitTimeMillisecond=_t;ut.prototype.visitTimeMicrosecond=_t;ut.prototype.visitTimeNanosecond=_t;ut.prototype.visitDecimal=_t;ut.prototype.visitList=_t;ut.prototype.visitStruct=_t;ut.prototype.visitUnion=_t;ut.prototype.visitDenseUnion=Vx;ut.prototype.visitSparseUnion=Vx;ut.prototype.visitDictionary=_t;ut.prototype.visitInterval=_t;ut.prototype.visitIntervalDayTime=_t;ut.prototype.visitIntervalYearMonth=_t;ut.prototype.visitFixedSizeList=_t;ut.prototype.visitMap=_t;const kf=new ut;class ft extends It{}function yt(e){const{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===L.Timestamp||t instanceof Yr&&t.bitWidth!==64||t instanceof Qc&&t.bitWidth!==64||t instanceof Kc&&t.precision!==Je.HALF))return new rw(e.data.length,i=>{const r=e.data[i];return r.values.subarray(0,r.length)[Symbol.iterator]()});let n=0;return new rw(e.data.length,i=>{const s=e.data[i].length,o=e.slice(n,n+s);return n+=s,new n4(o)})}class n4{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}ft.prototype.visitNull=yt;ft.prototype.visitBool=yt;ft.prototype.visitInt=yt;ft.prototype.visitInt8=yt;ft.prototype.visitInt16=yt;ft.prototype.visitInt32=yt;ft.prototype.visitInt64=yt;ft.prototype.visitUint8=yt;ft.prototype.visitUint16=yt;ft.prototype.visitUint32=yt;ft.prototype.visitUint64=yt;ft.prototype.visitFloat=yt;ft.prototype.visitFloat16=yt;ft.prototype.visitFloat32=yt;ft.prototype.visitFloat64=yt;ft.prototype.visitUtf8=yt;ft.prototype.visitBinary=yt;ft.prototype.visitFixedSizeBinary=yt;ft.prototype.visitDate=yt;ft.prototype.visitDateDay=yt;ft.prototype.visitDateMillisecond=yt;ft.prototype.visitTimestamp=yt;ft.prototype.visitTimestampSecond=yt;ft.prototype.visitTimestampMillisecond=yt;ft.prototype.visitTimestampMicrosecond=yt;ft.prototype.visitTimestampNanosecond=yt;ft.prototype.visitTime=yt;ft.prototype.visitTimeSecond=yt;ft.prototype.visitTimeMillisecond=yt;ft.prototype.visitTimeMicrosecond=yt;ft.prototype.visitTimeNanosecond=yt;ft.prototype.visitDecimal=yt;ft.prototype.visitList=yt;ft.prototype.visitStruct=yt;ft.prototype.visitUnion=yt;ft.prototype.visitDenseUnion=yt;ft.prototype.visitSparseUnion=yt;ft.prototype.visitDictionary=yt;ft.prototype.visitInterval=yt;ft.prototype.visitIntervalDayTime=yt;ft.prototype.visitIntervalYearMonth=yt;ft.prototype.visitFixedSizeList=yt;ft.prototype.visitMap=yt;const ig=new ft,i4=(e,t)=>e+t;class ss extends It{visitNull(t,n){return 0}visitInt(t,n){return t.type.bitWidth/8}visitFloat(t,n){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,n){return 1/8}visitDecimal(t,n){return t.type.bitWidth/8}visitDate(t,n){return(t.type.unit+1)*4}visitTime(t,n){return t.type.bitWidth/8}visitTimestamp(t,n){return t.type.unit===Lt.SECOND?4:8}visitInterval(t,n){return(t.type.unit+1)*4}visitStruct(t,n){return t.children.reduce((i,r)=>i+Ii.visit(r,n),0)}visitFixedSizeBinary(t,n){return t.type.byteWidth}visitMap(t,n){return 8+t.children.reduce((i,r)=>i+Ii.visit(r,n),0)}visitDictionary(t,n){var i;return t.type.indices.bitWidth/8+(((i=t.dictionary)===null||i===void 0?void 0:i.getByteLength(t.values[n]))||0)}}const r4=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),s4=({valueOffsets:e},t)=>8+(e[t+1]-e[t]),o4=({valueOffsets:e,stride:t,children:n},i)=>{const r=n[0],{[i*t]:s}=e,{[i*t+1]:o}=e,a=Ii.getVisitFn(r.type),c=r.slice(s,o-s);let l=8;for(let u=-1,h=o-s;++u<h;)l+=a(c,u);return l},a4=({stride:e,children:t},n)=>{const i=t[0],r=i.slice(n*e,e),s=Ii.getVisitFn(i.type);let o=0;for(let a=-1,c=r.length;++a<c;)o+=s(r,a);return o},c4=(e,t)=>e.type.mode===gn.Dense?Wx(e,t):Gx(e,t),Wx=({type:e,children:t,typeIds:n,valueOffsets:i},r)=>{const s=e.typeIdToChildIndex[n[r]];return 8+Ii.visit(t[s],i[r])},Gx=({children:e},t)=>4+Ii.visitMany(e,e.map(()=>t)).reduce(i4,0);ss.prototype.visitUtf8=r4;ss.prototype.visitBinary=s4;ss.prototype.visitList=o4;ss.prototype.visitFixedSizeList=a4;ss.prototype.visitUnion=c4;ss.prototype.visitDenseUnion=Wx;ss.prototype.visitSparseUnion=Gx;const Ii=new ss;var Hx;const Xx={},Kx={};let ie=class xs{constructor(t){var n,i,r;const s=t[0]instanceof xs?t.flatMap(a=>a.data):t;if(s.length===0||s.some(a=>!(a instanceof Wt)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(n=s[0])===null||n===void 0?void 0:n.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:a,set:c,indexOf:l,byteLength:u}=Xx[o.typeId],h=s[0];this.isValid=f=>ng(h,f),this.get=f=>a(h,f),this.set=(f,d)=>c(h,f,d),this.indexOf=f=>l(h,f),this.getByteLength=f=>u(h,f),this._offsets=[0,h.length];break}default:Object.setPrototypeOf(this,Kx[o.typeId]),this._offsets=zx(s);break}this.data=s,this.type=o,this.stride=Hi(o),this.numChildren=(r=(i=o.children)===null||i===void 0?void 0:i.length)!==null&&r!==void 0?r:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,n)=>t+n.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Ux(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${L[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,n){}indexOf(t,n){return-1}includes(t,n){return this.indexOf(t,n)>0}getByteLength(t){return 0}[Symbol.iterator](){return ig.visit(this)}concat(...t){return new xs(this.data.concat(t.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(t,n){return new xs(Bx(this,t,n,({data:i,_offsets:r},s,o)=>jx(i,r,s,o)))}toJSON(){return[...this]}toArray(){const{type:t,data:n,length:i,stride:r,ArrayType:s}=this;switch(t.typeId){case L.Int:case L.Float:case L.Decimal:case L.Time:case L.Timestamp:switch(n.length){case 0:return new s;case 1:return n[0].values.subarray(0,i*r);default:return n.reduce((o,{values:a,length:c})=>(o.array.set(a.subarray(0,c*r),o.offset),o.offset+=c*r,o),{array:new s(i*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new xs(this.data.map(({children:n})=>n[t])):null}get isMemoized(){return ct.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(ct.isDictionary(this.type)){const t=new Of(this.data[0].dictionary),n=this.data.map(i=>{const r=i.clone();return r.dictionary=t,r});return new xs(n)}return new Of(this)}unmemoize(){if(ct.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),n=this.data.map(i=>{const r=i.clone();return r.dictionary=t,r});return new xs(n)}return this}};Hx=Symbol.toStringTag;ie[Hx]=(e=>{e.type=ct.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._nullCount=-1,e._byteLength=-1,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(L).map(n=>L[n]).filter(n=>typeof n=="number"&&n!==L.NONE);for(const n of t){const i=tn.getVisitFnByTypeId(n),r=Fn.getVisitFnByTypeId(n),s=kf.getVisitFnByTypeId(n),o=Ii.getVisitFnByTypeId(n);Xx[n]={get:i,set:r,indexOf:s,byteLength:o},Kx[n]=Object.create(e,{isValid:{value:Go(ng)},get:{value:Go(tn.getVisitFnByTypeId(n))},set:{value:qx(Fn.getVisitFnByTypeId(n))},indexOf:{value:Yx(kf.getVisitFnByTypeId(n))},getByteLength:{value:Go(Ii.getVisitFnByTypeId(n))}})}return"Vector"})(ie.prototype);class Of extends ie{constructor(t){super(t.data);const n=this.get,i=this.set,r=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){const a=s[o];if(a!==void 0)return a;const c=n.call(this,o);return s[o]=c,c}}),Object.defineProperty(this,"set",{value(o,a){i.call(this,o,a),s[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new Of(r.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new ie(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class u0{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,n,i,r){return t.prep(8,24),t.writeInt64(r),t.pad(4),t.writeInt32(i),t.writeInt64(n),t.offset()}}const qp=2,fi=4,Qi=4,jt=4,Er=new Int32Array(2),sw=new Float32Array(Er.buffer),ow=new Float64Array(Er.buffer),du=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;let sr=class f0{constructor(t,n){this.low=t|0,this.high=n|0}static create(t,n){return t==0&&n==0?f0.ZERO:new f0(t,n)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};sr.ZERO=new sr(0,0);var h0;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(h0||(h0={}));let ca=class Qx{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Qx(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new sr(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new sr(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return Er[0]=this.readInt32(t),sw[0]}readFloat64(t){return Er[du?0:1]=this.readInt32(t),Er[du?1:0]=this.readInt32(t+4),ow[0]}writeInt8(t,n){this.bytes_[t]=n}writeUint8(t,n){this.bytes_[t]=n}writeInt16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeUint16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeInt32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeUint32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeInt64(t,n){this.writeInt32(t,n.low),this.writeInt32(t+4,n.high)}writeUint64(t,n){this.writeUint32(t,n.low),this.writeUint32(t+4,n.high)}writeFloat32(t,n){sw[0]=n,this.writeInt32(t,Er[0])}writeFloat64(t,n){ow[0]=n,this.writeInt32(t,Er[du?0:1]),this.writeInt32(t+4,Er[du?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+fi+Qi)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let n=0;n<Qi;n++)t+=String.fromCharCode(this.readInt8(this.position_+fi+n));return t}__offset(t,n){const i=t-this.readInt32(t);return n<this.readInt16(i)?this.readInt16(i+n):0}__union(t,n){return t.bb_pos=n+this.readInt32(n),t.bb=this,t}__string(t,n){t+=this.readInt32(t);const i=this.readInt32(t);let r="",s=0;if(t+=fi,n===h0.UTF8_BYTES)return this.bytes_.subarray(t,t+i);for(;s<i;){let o;const a=this.readUint8(t+s++);if(a<192)o=a;else{const c=this.readUint8(t+s++);if(a<224)o=(a&31)<<6|c&63;else{const l=this.readUint8(t+s++);if(a<240)o=(a&15)<<12|(c&63)<<6|l&63;else{const u=this.readUint8(t+s++);o=(a&7)<<18|(c&63)<<12|(l&63)<<6|u&63}}}o<65536?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode((o>>10)+55296,(o&1024-1)+56320))}return r}__union_with_string(t,n){return typeof t=="string"?this.__string(n):this.__union(t,n)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+fi}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=Qi)throw new Error("FlatBuffers: file identifier must be length "+Qi);for(let n=0;n<Qi;n++)if(t.charCodeAt(n)!=this.readInt8(this.position()+fi+n))return!1;return!0}createLong(t,n){return sr.create(t,n)}createScalarList(t,n){const i=[];for(let r=0;r<n;++r)t(r)!==null&&i.push(t(r));return i}createObjList(t,n){const i=[];for(let r=0;r<n;++r){const s=t(r);s!==null&&i.push(s.unpack())}return i}},Jx=class Zx{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let n;t?n=t:n=1024,this.bb=ca.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,n){t>this.minalign&&(this.minalign=t);const i=~(this.bb.capacity()-this.space+n)+1&t-1;for(;this.space<i+t+n;){const r=this.bb.capacity();this.bb=Zx.growByteBuffer(this.bb),this.space+=this.bb.capacity()-r}this.pad(i)}pad(t){for(let n=0;n<t;n++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,n,i){(this.force_defaults||n!=i)&&(this.addInt8(n),this.slot(t))}addFieldInt16(t,n,i){(this.force_defaults||n!=i)&&(this.addInt16(n),this.slot(t))}addFieldInt32(t,n,i){(this.force_defaults||n!=i)&&(this.addInt32(n),this.slot(t))}addFieldInt64(t,n,i){(this.force_defaults||!n.equals(i))&&(this.addInt64(n),this.slot(t))}addFieldFloat32(t,n,i){(this.force_defaults||n!=i)&&(this.addFloat32(n),this.slot(t))}addFieldFloat64(t,n,i){(this.force_defaults||n!=i)&&(this.addFloat64(n),this.slot(t))}addFieldOffset(t,n,i){(this.force_defaults||n!=i)&&(this.addOffset(n),this.slot(t))}addFieldStruct(t,n,i){n!=i&&(this.nested(n),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const n=t.capacity();if(n&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=n<<1,r=ca.allocate(i);return r.setPosition(i-n),r.bytes().set(t.bytes(),i-n),r}addOffset(t){this.prep(fi,0),this.writeInt32(this.offset()-t+fi)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let n=0;n<t;n++)this.vtable[n]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let n=this.vtable_in_use-1;for(;n>=0&&this.vtable[n]==0;n--);const i=n+1;for(;n>=0;n--)this.addInt16(this.vtable[n]!=0?t-this.vtable[n]:0);const r=2;this.addInt16(t-this.object_start);const s=(i+r)*qp;this.addInt16(s);let o=0;const a=this.space;t:for(n=0;n<this.vtables.length;n++){const c=this.bb.capacity()-this.vtables[n];if(s==this.bb.readInt16(c)){for(let l=qp;l<s;l+=qp)if(this.bb.readInt16(a+l)!=this.bb.readInt16(c+l))continue t;o=this.vtables[n];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,n,i){const r=i?jt:0;if(n){const s=n;if(this.prep(this.minalign,fi+Qi+r),s.length!=Qi)throw new Error("FlatBuffers: file identifier must be length "+Qi);for(let o=Qi-1;o>=0;o--)this.writeInt8(s.charCodeAt(o))}this.prep(this.minalign,fi+r),this.addOffset(t),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,n){this.finish(t,n,!0)}requiredField(t,n){const i=this.bb.capacity()-t,r=i-this.bb.readInt32(i);if(!(this.bb.readInt16(r+n)!=0))throw new Error("FlatBuffers: field "+n+" must be set")}startVector(t,n,i){this.notNested(),this.vector_num_elems=n,this.prep(fi,t*n),this.prep(i,t*n)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const n=this.createString(t);return this.string_maps.set(t,n),n}createString(t){if(!t)return 0;let n;if(t instanceof Uint8Array)n=t;else{n=[];let i=0;for(;i<t.length;){let r;const s=t.charCodeAt(i++);if(s<55296||s>=56320)r=s;else{const o=t.charCodeAt(i++);r=(s<<10)+o+(65536-56623104-56320)}r<128?n.push(r):(r<2048?n.push(r>>6&31|192):(r<65536?n.push(r>>12&15|224):n.push(r>>18&7|240,r>>12&63|128),n.push(r>>6&63|128)),n.push(r&63|128))}}this.addInt8(0),this.startVector(1,n.length,1),this.bb.setPosition(this.space-=n.length);for(let i=0,r=this.space,s=this.bb.bytes();i<n.length;i++)s[r++]=n[i];return this.endVector()}createLong(t,n){return sr.create(t,n)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const n=[];for(let i=0;i<t.length;++i){const r=t[i];if(r!==null)n.push(this.createObjectOffset(r));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return n}createStructOffsetList(t,n){return n(this,t.length),this.createObjectOffsetList(t),this.endVector()}};class pe{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsKeyValue(t,n){return(n||new pe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,n){return t.setPosition(t.position()+jt),(n||new pe).__init(t.readInt32(t.position())+t.position(),t)}key(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}value(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,n){t.addFieldOffset(0,n,0)}static addValue(t,n){t.addFieldOffset(1,n,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,n,i){return pe.startKeyValue(t),pe.addKey(t,n),pe.addValue(t,i),pe.endKeyValue(t)}}var la;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(la||(la={}));var ua;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(ua||(ua={}));var Lf;(function(e){e[e.DenseArray=0]="DenseArray"})(Lf||(Lf={}));class un{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInt(t,n){return(n||new un).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,n){return t.setPosition(t.position()+jt),(n||new un).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,n){t.addFieldInt32(0,n,0)}static addIsSigned(t,n){t.addFieldInt8(1,+n,0)}static endInt(t){return t.endObject()}static createInt(t,n,i){return un.startInt(t),un.addBitWidth(t,n),un.addIsSigned(t,i),un.endInt(t)}}class Ji{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryEncoding(t,n){return(n||new Ji).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,n){return t.setPosition(t.position()+jt),(n||new Ji).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new un).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Lf.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,n){t.addFieldInt64(0,n,t.createLong(0,0))}static addIndexType(t,n){t.addFieldOffset(1,n,0)}static addIsOrdered(t,n){t.addFieldInt8(2,+n,0)}static addDictionaryKind(t,n){t.addFieldInt16(3,n,Lf.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class Ms{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBinary(t,n){return(n||new Ms).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,n){return t.setPosition(t.position()+jt),(n||new Ms).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Ms.startBinary(t),Ms.endBinary(t)}}class Ns{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBool(t,n){return(n||new Ns).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,n){return t.setPosition(t.position()+jt),(n||new Ns).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Ns.startBool(t),Ns.endBool(t)}}var Rf;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(Rf||(Rf={}));let Ku=class ko{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDate(t,n){return(n||new ko).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,n){return t.setPosition(t.position()+jt),(n||new ko).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Rf.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,Rf.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,n){return ko.startDate(t),ko.addUnit(t,n),ko.endDate(t)}};class Ge{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDecimal(t,n){return(n||new Ge).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,n){return t.setPosition(t.position()+jt),(n||new Ge).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,n){t.addFieldInt32(0,n,0)}static addScale(t,n){t.addFieldInt32(1,n,0)}static addBitWidth(t,n){t.addFieldInt32(2,n,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,n,i,r){return Ge.startDecimal(t),Ge.addPrecision(t,n),Ge.addScale(t,i),Ge.addBitWidth(t,r),Ge.endDecimal(t)}}var fa;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(fa||(fa={}));class hi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeBinary(t,n){return(n||new hi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,n){return t.setPosition(t.position()+jt),(n||new hi).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,n){return hi.startFixedSizeBinary(t),hi.addByteWidth(t,n),hi.endFixedSizeBinary(t)}}class di{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeList(t,n){return(n||new di).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,n){return t.setPosition(t.position()+jt),(n||new di).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,n){return di.startFixedSizeList(t),di.addListSize(t,n),di.endFixedSizeList(t)}}var Ff;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(Ff||(Ff={}));class pi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFloatingPoint(t,n){return(n||new pi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,n){return t.setPosition(t.position()+jt),(n||new pi).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ff.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,n){t.addFieldInt16(0,n,Ff.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,n){return pi.startFloatingPoint(t),pi.addPrecision(t,n),pi.endFloatingPoint(t)}}var Df;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Df||(Df={}));class yi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInterval(t,n){return(n||new yi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,n){return t.setPosition(t.position()+jt),(n||new yi).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Df.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,Df.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,n){return yi.startInterval(t),yi.addUnit(t,n),yi.endInterval(t)}}class $s{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsList(t,n){return(n||new $s).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,n){return t.setPosition(t.position()+jt),(n||new $s).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return $s.startList(t),$s.endList(t)}}let Qu=class Oo{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMap(t,n){return(n||new Oo).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,n){return t.setPosition(t.position()+jt),(n||new Oo).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,n){t.addFieldInt8(0,+n,0)}static endMap(t){return t.endObject()}static createMap(t,n){return Oo.startMap(t),Oo.addKeysSorted(t,n),Oo.endMap(t)}};class ks{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsNull(t,n){return(n||new ks).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,n){return t.setPosition(t.position()+jt),(n||new ks).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return ks.startNull(t),ks.endNull(t)}}class Os{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsStruct_(t,n){return(n||new Os).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,n){return t.setPosition(t.position()+jt),(n||new Os).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Os.startStruct_(t),Os.endStruct_(t)}}class In{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTime(t,n){return(n||new In).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,n){return t.setPosition(t.position()+jt),(n||new In).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fa.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,fa.MILLISECOND)}static addBitWidth(t,n){t.addFieldInt32(1,n,32)}static endTime(t){return t.endObject()}static createTime(t,n,i){return In.startTime(t),In.addUnit(t,n),In.addBitWidth(t,i),In.endTime(t)}}class Mn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTimestamp(t,n){return(n||new Mn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,n){return t.setPosition(t.position()+jt),(n||new Mn).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fa.SECOND}timezone(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,fa.SECOND)}static addTimezone(t,n){t.addFieldOffset(1,n,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,n,i){return Mn.startTimestamp(t),Mn.addUnit(t,n),Mn.addTimezone(t,i),Mn.endTimestamp(t)}}var Cf;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(Cf||(Cf={}));class He{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUnion(t,n){return(n||new He).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,n){return t.setPosition(t.position()+jt),(n||new He).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Cf.Sparse}typeIds(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt32(this.bb.__vector(this.bb_pos+n)+t*4):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,n){t.addFieldInt16(0,n,Cf.Sparse)}static addTypeIds(t,n){t.addFieldOffset(1,n,0)}static createTypeIdsVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addInt32(n[i]);return t.endVector()}static startTypeIdsVector(t,n){t.startVector(4,n,4)}static endUnion(t){return t.endObject()}static createUnion(t,n,i){return He.startUnion(t),He.addMode(t,n),He.addTypeIds(t,i),He.endUnion(t)}}class Ls{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUtf8(t,n){return(n||new Ls).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,n){return t.setPosition(t.position()+jt),(n||new Ls).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Ls.startUtf8(t),Ls.endUtf8(t)}}var te;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList"})(te||(te={}));let An=class Ju{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsField(t,n){return(n||new Ju).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,n){return t.setPosition(t.position()+jt),(n||new Ju).__init(t.readInt32(t.position())+t.position(),t)}name(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):te.NONE}type(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__union(t,this.bb_pos+n):null}dictionary(t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new Ji).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}children(t,n){const i=this.bb.__offset(this.bb_pos,14);return i?(n||new Ju).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const i=this.bb.__offset(this.bb_pos,16);return i?(n||new pe).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,n){t.addFieldOffset(0,n,0)}static addNullable(t,n){t.addFieldInt8(1,+n,0)}static addTypeType(t,n){t.addFieldInt8(2,n,te.NONE)}static addType(t,n){t.addFieldOffset(3,n,0)}static addDictionary(t,n){t.addFieldOffset(4,n,0)}static addChildren(t,n){t.addFieldOffset(5,n,0)}static createChildrenVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startChildrenVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(6,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endField(t){return t.endObject()}},ai=class Vi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsSchema(t,n){return(n||new Vi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,n){return t.setPosition(t.position()+jt),(n||new Vi).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ua.Little}fields(t,n){const i=this.bb.__offset(this.bb_pos,6);return i?(n||new An).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new pe).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt64(this.bb.__vector(this.bb_pos+n)+t*8):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,n){t.addFieldInt16(0,n,ua.Little)}static addFields(t,n){t.addFieldOffset(1,n,0)}static createFieldsVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startFieldsVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(2,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static addFeatures(t,n){t.addFieldOffset(3,n,0)}static createFeaturesVector(t,n){t.startVector(8,n.length,8);for(let i=n.length-1;i>=0;i--)t.addInt64(n[i]);return t.endVector()}static startFeaturesVector(t,n){t.startVector(8,n,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,n){t.finish(n)}static finishSizePrefixedSchemaBuffer(t,n){t.finish(n,void 0,!0)}static createSchema(t,n,i,r,s){return Vi.startSchema(t),Vi.addEndianness(t,n),Vi.addFields(t,i),Vi.addCustomMetadata(t,r),Vi.addFeatures(t,s),Vi.endSchema(t)}};class ln{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFooter(t,n){return(n||new ln).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,n){return t.setPosition(t.position()+jt),(n||new ln).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):la.V1}schema(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new ai).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}dictionaries(t,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new u0).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,n){const i=this.bb.__offset(this.bb_pos,10);return i?(n||new u0).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const i=this.bb.__offset(this.bb_pos,12);return i?(n||new pe).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,la.V1)}static addSchema(t,n){t.addFieldOffset(1,n,0)}static addDictionaries(t,n){t.addFieldOffset(2,n,0)}static startDictionariesVector(t,n){t.startVector(24,n,8)}static addRecordBatches(t,n){t.addFieldOffset(3,n,0)}static startRecordBatchesVector(t,n){t.startVector(24,n,8)}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,n){t.finish(n)}static finishSizePrefixedFooterBuffer(t,n){t.finish(n,void 0,!0)}}let ee=class Ss{constructor(t=[],n,i){this.fields=t||[],this.metadata=n||new Map,i||(i=d0(t)),this.dictionaries=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,n)=>`${n}: ${t}`).join(", ")} }>`}select(t){const n=new Set(t),i=this.fields.filter(r=>n.has(r.name));return new Ss(i,this.metadata)}selectAt(t){const n=t.map(i=>this.fields[i]).filter(Boolean);return new Ss(n,this.metadata)}assign(...t){const n=t[0]instanceof Ss?t[0]:Array.isArray(t[0])?new Ss(t[0]):new Ss(t),i=[...this.fields],r=pu(pu(new Map,this.metadata),n.metadata),s=n.fields.filter(a=>{const c=i.findIndex(l=>l.name===a.name);return~c?(i[c]=a.clone({metadata:pu(pu(new Map,i[c].metadata),a.metadata)}))&&!1:!0}),o=d0(s,new Map);return new Ss([...i,...s],r,new Map([...this.dictionaries,...o]))}};ee.prototype.fields=null;ee.prototype.metadata=null;ee.prototype.dictionaries=null;class Kt{constructor(t,n,i=!1,r){this.name=t,this.type=n,this.nullable=i,this.metadata=r||new Map}static new(...t){let[n,i,r,s]=t;return t[0]&&typeof t[0]=="object"&&({name:n}=t[0],i===void 0&&(i=t[0].type),r===void 0&&(r=t[0].nullable),s===void 0&&(s=t[0].metadata)),new Kt(`${n}`,i,r,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[n,i,r,s]=t;return!t[0]||typeof t[0]!="object"?[n=this.name,i=this.type,r=this.nullable,s=this.metadata]=t:{name:n=this.name,type:i=this.type,nullable:r=this.nullable,metadata:s=this.metadata}=t[0],Kt.new(n,i,r,s)}}Kt.prototype.type=null;Kt.prototype.name=null;Kt.prototype.nullable=null;Kt.prototype.metadata=null;function pu(e,t){return new Map([...e||new Map,...t||new Map])}function d0(e,t=new Map){for(let n=-1,i=e.length;++n<i;){const s=e[n].type;if(ct.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&d0(s.children,t)}return t}var aw=sr,l4=Jx,u4=ca;class Jc{constructor(t,n=fn.V4,i,r){this.schema=t,this.version=n,i&&(this._recordBatches=i),r&&(this._dictionaryBatches=r)}static decode(t){t=new u4(Ot(t));const n=ln.getRootAsFooter(t),i=ee.decode(n.schema());return new f4(i,n)}static encode(t){const n=new l4,i=ee.encode(n,t.schema);ln.startRecordBatchesVector(n,t.numRecordBatches);for(const o of[...t.recordBatches()].slice().reverse())Vr.encode(n,o);const r=n.endVector();ln.startDictionariesVector(n,t.numDictionaries);for(const o of[...t.dictionaryBatches()].slice().reverse())Vr.encode(n,o);const s=n.endVector();return ln.startFooter(n),ln.addSchema(n,i),ln.addVersion(n,fn.V4),ln.addRecordBatches(n,r),ln.addDictionaries(n,s),ln.finishFooterBuffer(n,ln.endFooter(n)),n.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,n=-1,i=this.numRecordBatches;++n<i;)(t=this.getRecordBatch(n))&&(yield t)}*dictionaryBatches(){for(let t,n=-1,i=this.numDictionaries;++n<i;)(t=this.getDictionaryBatch(n))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class f4 extends Jc{constructor(t,n){super(t,n.version()),this._footer=n}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const n=this._footer.recordBatches(t);if(n)return Vr.decode(n)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const n=this._footer.dictionaries(t);if(n)return Vr.decode(n)}return null}}class Vr{constructor(t,n,i){this.metaDataLength=t,this.offset=typeof i=="number"?i:i.low,this.bodyLength=typeof n=="number"?n:n.low}static decode(t){return new Vr(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,n){const{metaDataLength:i}=n,r=new aw(n.offset,0),s=new aw(n.bodyLength,0);return u0.createBlock(t,r,i,s)}}const re=Object.freeze({done:!0,value:void 0});class cw{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class rg{tee(){return this._getDOMStream().tee()}pipe(t,n){return this._getNodeStream().pipe(t,n)}pipeTo(t,n){return this._getDOMStream().pipeTo(t,n)}pipeThrough(t,n){return this._getDOMStream().pipeThrough(t,n)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class h4 extends rg{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return st(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(re);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Tn.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Tn.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return st(this,void 0,void 0,function*(){return yield this.abort(t),re})}return(t){return st(this,void 0,void 0,function*(){return yield this.close(),re})}read(t){return st(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return st(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((n,i)=>{this.resolvers.push({resolve:n,reject:i})}):Promise.resolve(re)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Zu extends h4{write(t){if((t=Ot(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?s0(this.toUint8Array(!0)):this.toUint8Array(!1).then(s0)}toUint8Array(t=!1){return t?Ti(this._values)[0]:(()=>st(this,void 0,void 0,function*(){var n,i;const r=[];let s=0;try{for(var o=Us(this),a;a=yield o.next(),!a.done;){const c=a.value;r.push(c),s+=c.byteLength}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=o.return)&&(yield i.call(o))}finally{if(n)throw n.error}}return Ti(r,s)[0]}))()}}class Bf{constructor(t){t&&(this.source=new d4(Tn.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class ha{constructor(t){t instanceof ha?this.source=t.source:t instanceof Zu?this.source=new ws(Tn.fromAsyncIterable(t)):Fv(t)?this.source=new ws(Tn.fromNodeStream(t)):Ym(t)?this.source=new ws(Tn.fromDOMStream(t)):Rv(t)?this.source=new ws(Tn.fromDOMStream(t.body)):Tl(t)?this.source=new ws(Tn.fromIterable(t)):zr(t)?this.source=new ws(Tn.fromAsyncIterable(t)):Ca(t)&&(this.source=new ws(Tn.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class d4{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,n="read"){return this.source.next({cmd:n,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||re)}return(t){return Object.create(this.source.return&&this.source.return(t)||re)}}class ws{constructor(t){this.source=t,this._closedPromise=new Promise(n=>this._closedPromiseResolve=n)}cancel(t){return st(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return st(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return st(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,n="read"){return st(this,void 0,void 0,function*(){return yield this.source.next({cmd:n,size:t})})}throw(t){return st(this,void 0,void 0,function*(){const n=this.source.throw&&(yield this.source.throw(t))||re;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}return(t){return st(this,void 0,void 0,function*(){const n=this.source.return&&(yield this.source.return(t))||re;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}}class lw extends Bf{constructor(t,n){super(),this.position=0,this.buffer=Ot(t),this.size=typeof n>"u"?this.buffer.byteLength:n}readInt32(t){const{buffer:n,byteOffset:i}=this.readAt(t,4);return new DataView(n,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:n,size:i,position:r}=this;return n&&r<i?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,r+Math.min(i-r,t)),n.subarray(r,this.position)):null}readAt(t,n){const i=this.buffer,r=Math.min(this.size,t+n);return i?i.subarray(t,r):new Uint8Array(n)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class Pf extends ha{constructor(t,n){super(),this.position=0,this._handle=t,typeof n=="number"?this.size=n:this._pending=(()=>st(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return st(this,void 0,void 0,function*(){const{buffer:n,byteOffset:i}=yield this.readAt(t,4);return new DataView(n,i).getInt32(0,!0)})}seek(t){return st(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return st(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:i,position:r}=this;if(n&&r<i){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=r,o=0,a=0;const c=Math.min(i,s+Math.min(i-s,t)),l=new Uint8Array(Math.max(0,(this.position=c)-s));for(;(s+=a)<c&&(o+=a)<l.byteLength;)({bytesRead:a}=yield n.read(l,o,l.byteLength-o,s));return l}return null})}readAt(t,n){return st(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:i,size:r}=this;if(i&&t+n<r){const s=Math.min(r,t+n),o=new Uint8Array(s-t);return(yield i.read(o,0,n,t)).buffer}return new Uint8Array(n)})}close(){return st(this,void 0,void 0,function*(){const t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return st(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return st(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}}const p4=65536;function Fo(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const da=8,sg=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class tS{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const n=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let r=n[3]*i[3];this.buffer[0]=r&65535;let s=r>>>16;return r=n[2]*i[3],s+=r,r=n[3]*i[2]>>>0,s+=r,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<r?p4:0,this.buffer[1]+=s>>>16,this.buffer[1]+=n[1]*i[3]+n[2]*i[2]+n[3]*i[1],this.buffer[1]+=n[0]*i[3]+n[1]*i[2]+n[2]*i[1]+n[3]*i[0]<<16,this}_plus(t){const n=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],n<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=n}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Fo(this.buffer[1])} ${Fo(this.buffer[0])}`}}class Bt extends tS{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,n=new Uint32Array(2)){return Bt.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return Bt.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const i=t.length,r=new Bt(n);for(let s=0;s<i;){const o=da<i-s?da:i-s,a=new Bt(new Uint32Array([Number.parseInt(t.slice(s,s+o),10),0])),c=new Bt(new Uint32Array([sg[o],0]));r.times(c),r.plus(a),s+=o}return r}static convertArray(t){const n=new Uint32Array(t.length*2);for(let i=-1,r=t.length;++i<r;)Bt.from(t[i],new Uint32Array(n.buffer,n.byteOffset+2*i*4,2));return n}static multiply(t,n){return new Bt(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Bt(new Uint32Array(t.buffer)).plus(n)}}class Ve extends tS{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const n=this.buffer[1]<<0,i=t.buffer[1]<<0;return n<i||n===i&&this.buffer[0]<t.buffer[0]}static from(t,n=new Uint32Array(2)){return Ve.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return Ve.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const i=t.startsWith("-"),r=t.length,s=new Ve(n);for(let o=i?1:0;o<r;){const a=da<r-o?da:r-o,c=new Ve(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),l=new Ve(new Uint32Array([sg[a],0]));s.times(l),s.plus(c),o+=a}return i?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*2);for(let i=-1,r=t.length;++i<r;)Ve.from(t[i],new Uint32Array(n.buffer,n.byteOffset+2*i*4,2));return n}static multiply(t,n){return new Ve(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Ve(new Uint32Array(t.buffer)).plus(n)}}class ci{constructor(t){this.buffer=t}high(){return new Ve(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Ve(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const n=new Bt(new Uint32Array([this.buffer[3],0])),i=new Bt(new Uint32Array([this.buffer[2],0])),r=new Bt(new Uint32Array([this.buffer[1],0])),s=new Bt(new Uint32Array([this.buffer[0],0])),o=new Bt(new Uint32Array([t.buffer[3],0])),a=new Bt(new Uint32Array([t.buffer[2],0])),c=new Bt(new Uint32Array([t.buffer[1],0])),l=new Bt(new Uint32Array([t.buffer[0],0]));let u=Bt.multiply(s,l);this.buffer[0]=u.low();const h=new Bt(new Uint32Array([u.high(),0]));return u=Bt.multiply(r,l),h.plus(u),u=Bt.multiply(s,c),h.plus(u),this.buffer[1]=h.low(),this.buffer[3]=h.lessThan(u)?1:0,this.buffer[2]=h.high(),new Bt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Bt.multiply(i,l)).plus(Bt.multiply(r,c)).plus(Bt.multiply(s,a)),this.buffer[3]+=Bt.multiply(n,l).plus(Bt.multiply(i,c)).plus(Bt.multiply(r,a)).plus(Bt.multiply(s,o)).low(),this}plus(t){const n=new Uint32Array(4);return n[3]=this.buffer[3]+t.buffer[3]>>>0,n[2]=this.buffer[2]+t.buffer[2]>>>0,n[1]=this.buffer[1]+t.buffer[1]>>>0,n[0]=this.buffer[0]+t.buffer[0]>>>0,n[0]<this.buffer[0]>>>0&&++n[1],n[1]<this.buffer[1]>>>0&&++n[2],n[2]<this.buffer[2]>>>0&&++n[3],this.buffer[3]=n[3],this.buffer[2]=n[2],this.buffer[1]=n[1],this.buffer[0]=n[0],this}hex(){return`${Fo(this.buffer[3])} ${Fo(this.buffer[2])} ${Fo(this.buffer[1])} ${Fo(this.buffer[0])}`}static multiply(t,n){return new ci(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new ci(new Uint32Array(t.buffer)).plus(n)}static from(t,n=new Uint32Array(4)){return ci.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(4)){return ci.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(4)){const i=t.startsWith("-"),r=t.length,s=new ci(n);for(let o=i?1:0;o<r;){const a=da<r-o?da:r-o,c=new ci(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),l=new ci(new Uint32Array([sg[a],0,0,0]));s.times(l),s.plus(c),o+=a}return i?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*4);for(let i=-1,r=t.length;++i<r;)ci.from(t[i],new Uint32Array(n.buffer,n.byteOffset+4*4*i,4));return n}}class eS extends It{constructor(t,n,i,r){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=n,this.buffers=i,this.dictionaries=r}visit(t){return super.visit(t instanceof Kt?t.type:t)}visitNull(t,{length:n}=this.nextFieldNode()){return At({type:t,length:n})}visitBool(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===gn.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:n,nullCount:i}=this.nextFieldNode()){return At({type:t,length:n,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,n,i=this.nextBufferRange()){return n>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,n){return this.readData(t,n)}readTypeIds(t,n){return this.readData(t,n)}readData(t,{length:n,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+n)}readDictionary(t){return this.dictionaries.get(t.id)}}class y4 extends eS{constructor(t,n,i,r){super(new Uint8Array(0),n,i,r),this.sources=t}readNullBitmap(t,n,{offset:i}=this.nextBufferRange()){return n<=0?new Uint8Array(0):$f(this.sources[i])}readOffsets(t,{offset:n}=this.nextBufferRange()){return Ut(Uint8Array,Ut(Int32Array,this.sources[n]))}readTypeIds(t,{offset:n}=this.nextBufferRange()){return Ut(Uint8Array,Ut(t.ArrayType,this.sources[n]))}readData(t,{offset:n}=this.nextBufferRange()){const{sources:i}=this;return ct.isTimestamp(t)||(ct.isInt(t)||ct.isTime(t))&&t.bitWidth===64||ct.isDate(t)&&t.unit===ur.MILLISECOND?Ut(Uint8Array,Ve.convertArray(i[n])):ct.isDecimal(t)?Ut(Uint8Array,ci.convertArray(i[n])):ct.isBinary(t)||ct.isFixedSizeBinary(t)?m4(i[n]):ct.isBool(t)?$f(i[n]):ct.isUtf8(t)?qm(i[n].join("")):Ut(Uint8Array,Ut(t.ArrayType,i[n].map(r=>+r)))}}function m4(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)n[i>>1]=Number.parseInt(t.slice(i,i+2),16);return n}class ht extends It{compareSchemas(t,n){return t===n||n instanceof t.constructor&&this.compareManyFields(t.fields,n.fields)}compareManyFields(t,n){return t===n||Array.isArray(t)&&Array.isArray(n)&&t.length===n.length&&t.every((i,r)=>this.compareFields(i,n[r]))}compareFields(t,n){return t===n||n instanceof t.constructor&&t.name===n.name&&t.nullable===n.nullable&&this.visit(t.type,n.type)}}function on(e,t){return t instanceof e.constructor}function Il(e,t){return e===t||on(e,t)}function gr(e,t){return e===t||on(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function ud(e,t){return e===t||on(e,t)&&e.precision===t.precision}function g4(e,t){return e===t||on(e,t)&&e.byteWidth===t.byteWidth}function og(e,t){return e===t||on(e,t)&&e.unit===t.unit}function Ml(e,t){return e===t||on(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function Nl(e,t){return e===t||on(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function b4(e,t){return e===t||on(e,t)&&e.children.length===t.children.length&&Wr.compareManyFields(e.children,t.children)}function w4(e,t){return e===t||on(e,t)&&e.children.length===t.children.length&&Wr.compareManyFields(e.children,t.children)}function ag(e,t){return e===t||on(e,t)&&e.mode===t.mode&&e.typeIds.every((n,i)=>n===t.typeIds[i])&&Wr.compareManyFields(e.children,t.children)}function _4(e,t){return e===t||on(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&Wr.visit(e.indices,t.indices)&&Wr.visit(e.dictionary,t.dictionary)}function cg(e,t){return e===t||on(e,t)&&e.unit===t.unit}function v4(e,t){return e===t||on(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&Wr.compareManyFields(e.children,t.children)}function x4(e,t){return e===t||on(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&Wr.compareManyFields(e.children,t.children)}ht.prototype.visitNull=Il;ht.prototype.visitBool=Il;ht.prototype.visitInt=gr;ht.prototype.visitInt8=gr;ht.prototype.visitInt16=gr;ht.prototype.visitInt32=gr;ht.prototype.visitInt64=gr;ht.prototype.visitUint8=gr;ht.prototype.visitUint16=gr;ht.prototype.visitUint32=gr;ht.prototype.visitUint64=gr;ht.prototype.visitFloat=ud;ht.prototype.visitFloat16=ud;ht.prototype.visitFloat32=ud;ht.prototype.visitFloat64=ud;ht.prototype.visitUtf8=Il;ht.prototype.visitBinary=Il;ht.prototype.visitFixedSizeBinary=g4;ht.prototype.visitDate=og;ht.prototype.visitDateDay=og;ht.prototype.visitDateMillisecond=og;ht.prototype.visitTimestamp=Ml;ht.prototype.visitTimestampSecond=Ml;ht.prototype.visitTimestampMillisecond=Ml;ht.prototype.visitTimestampMicrosecond=Ml;ht.prototype.visitTimestampNanosecond=Ml;ht.prototype.visitTime=Nl;ht.prototype.visitTimeSecond=Nl;ht.prototype.visitTimeMillisecond=Nl;ht.prototype.visitTimeMicrosecond=Nl;ht.prototype.visitTimeNanosecond=Nl;ht.prototype.visitDecimal=Il;ht.prototype.visitList=b4;ht.prototype.visitStruct=w4;ht.prototype.visitUnion=ag;ht.prototype.visitDenseUnion=ag;ht.prototype.visitSparseUnion=ag;ht.prototype.visitDictionary=_4;ht.prototype.visitInterval=cg;ht.prototype.visitIntervalDayTime=cg;ht.prototype.visitIntervalYearMonth=cg;ht.prototype.visitFixedSizeList=v4;ht.prototype.visitMap=x4;const Wr=new ht;function p0(e,t){return Wr.compareSchemas(e,t)}function Yp(e,t){return S4(e,t.map(n=>n.data.concat()))}function S4(e,t){const n=[...e.fields],i=[],r={numBatches:t.reduce((h,f)=>Math.max(h,f.length),0)};let s=0,o=0,a=-1;const c=t.length;let l,u=[];for(;r.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=t[a].shift(),o=Math.min(o,l?l.length:o);Number.isFinite(o)&&(u=E4(n,o,u,t,r),o>0&&(i[s++]=At({type:new ze(n),length:o,nullCount:0,children:u.slice()})))}return[e=e.assign(n),i.map(h=>new Xe(e,h))]}function E4(e,t,n,i,r){var s;const o=(t+63&-64)>>3;for(let a=-1,c=i.length;++a<c;){const l=n[a],u=l==null?void 0:l.length;if(u>=t)u===t?n[a]=l:(n[a]=l.slice(0,t),r.numBatches=Math.max(r.numBatches,i[a].unshift(l.slice(t,u-t))));else{const h=e[a];e[a]=h.clone({nullable:!0}),n[a]=(s=l==null?void 0:l._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:At({type:h.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return n}var nS;let Mi=class Es{constructor(...t){var n,i;if(t.length===0)return this.batches=[],this.schema=new ee([]),this._offsets=[0],this;let r,s;t[0]instanceof ee&&(r=t.shift()),t[t.length-1]instanceof Uint32Array&&(s=t.pop());const o=c=>{if(c){if(c instanceof Xe)return[c];if(c instanceof Es)return c.batches;if(c instanceof Wt){if(c.type instanceof ze)return[new Xe(new ee(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(l=>o(l));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(l=>o(l));if(typeof c=="object"){const l=Object.keys(c),u=l.map(d=>new ie([c[d]])),h=new ee(l.map((d,p)=>new Kt(String(d),u[p].type))),[,f]=Yp(h,u);return f.length===0?[new Xe(c)]:f}}}return[]},a=t.flatMap(c=>o(c));if(r=(i=r??((n=a[0])===null||n===void 0?void 0:n.schema))!==null&&i!==void 0?i:new ee([]),!(r instanceof ee))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const c of a){if(!(c instanceof Xe))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!p0(r,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=r,this.batches=a,this._offsets=s??zx(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,n)=>t+n.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Ux(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,n){}indexOf(t,n){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?ig.visit(new ie(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){const n=this.schema,i=this.data.concat(t.flatMap(({data:r})=>r));return new Es(n,i.map(r=>new Xe(n,r)))}slice(t,n){const i=this.schema;[t,n]=Bx({length:this.numRows},t,n);const r=jx(this.data,this._offsets,t,n);return new Es(i,r.map(s=>new Xe(i,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(n=>n.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const n=this.data.map(i=>i.children[t]);if(n.length===0){const{type:i}=this.schema.fields[t],r=At({type:i,length:0,nullCount:0});n.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new ie(n)}return null}setChild(t,n){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(r=>r.name===t),n)}setChildAt(t,n){let i=this.schema,r=[...this.batches];if(t>-1&&t<this.numCols){n||(n=new ie([At({type:new qr,length:this.numRows})]));const s=i.fields.slice(),o=s[t].clone({type:n.type}),a=this.schema.fields.map((c,l)=>this.getChildAt(l));[s[t],a[t]]=[o,n],[i,r]=Yp(i,a)}return new Es(i,r)}select(t){const n=this.schema.fields.reduce((i,r,s)=>i.set(r.name,s),new Map);return this.selectAt(t.map(i=>n.get(i)).filter(i=>i>-1))}selectAt(t){const n=this.schema.selectAt(t),i=this.batches.map(r=>r.selectAt(t));return new Es(n,i)}assign(t){const n=this.schema.fields,[i,r]=t.schema.fields.reduce((a,c,l)=>{const[u,h]=a,f=n.findIndex(d=>d.name===c.name);return~f?h[f]=l:u.push(l),a},[[],[]]),s=this.schema.assign(t.schema),o=[...n.map((a,c)=>[c,r[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...i.map(a=>t.getChildAt(a))].filter(Boolean);return new Es(...Yp(s,o))}};nS=Symbol.toStringTag;Mi[nS]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=Go(ng),e.get=Go(tn.getVisitFn(L.Struct)),e.set=qx(Fn.getVisitFn(L.Struct)),e.indexOf=Yx(kf.getVisitFn(L.Struct)),e.getByteLength=Go(Ii.getVisitFn(L.Struct)),"Table"))(Mi.prototype);var iS;let Xe=class Ec{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof ee))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=At({nullCount:0,type:new ze(this.schema.fields),children:this.schema.fields.map(n=>At({type:n.type,nullCount:0}))})]=t,!(this.data instanceof Wt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=uw(this.schema,this.data.children);break}case 1:{const[n]=t,{fields:i,children:r,length:s}=Object.keys(n).reduce((c,l,u)=>(c.children[u]=n[l],c.length=Math.max(c.length,n[l].length),c.fields[u]=Kt.new({name:l,type:n[l].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),o=new ee(i),a=At({type:new ze(i),length:s,children:r,nullCount:0});[this.schema,this.data]=uw(o,a.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=rS(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return tn.visit(this.data,t)}set(t,n){return Fn.visit(this.data,t,n)}indexOf(t,n){return kf.visit(this.data,t,n)}getByteLength(t){return Ii.visit(this.data,t)}[Symbol.iterator](){return ig.visit(new ie([this.data]))}toArray(){return[...this]}concat(...t){return new Mi(this.schema,[this,...t])}slice(t,n){const[i]=new ie([this.data]).slice(t,n).data;return new Ec(this.schema,i)}getChild(t){var n;return this.getChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new ie([this.data.children[t]]):null}setChild(t,n){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(r=>r.name===t),n)}setChildAt(t,n){let i=this.schema,r=this.data;if(t>-1&&t<this.numCols){n||(n=new ie([At({type:new qr,length:this.numRows})]));const s=i.fields.slice(),o=r.children.slice(),a=s[t].clone({type:n.type});[s[t],o[t]]=[a,n.data[0]],i=new ee(s,new Map(this.schema.metadata)),r=At({type:new ze(s),children:o})}return new Ec(i,r)}select(t){const n=this.schema.select(t),i=new ze(n.fields),r=[];for(const s of t){const o=this.schema.fields.findIndex(a=>a.name===s);~o&&(r[o]=this.data.children[o])}return new Ec(n,At({type:i,length:this.numRows,children:r}))}selectAt(t){const n=this.schema.selectAt(t),i=t.map(s=>this.data.children[s]).filter(Boolean),r=At({type:new ze(n.fields),length:this.numRows,children:i});return new Ec(n,r)}};iS=Symbol.toStringTag;Xe[iS]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Xe.prototype);function uw(e,t,n=t.reduce((i,r)=>Math.max(i,r.length),0)){var i;const r=[...e.fields],s=[...t],o=(n+63&-64)>>3;for(const[a,c]of e.fields.entries()){const l=t[a];(!l||l.length!==n)&&(r[a]=c.clone({nullable:!0}),s[a]=(i=l==null?void 0:l._changeLengthAndBackfillNullBitmap(n))!==null&&i!==void 0?i:At({type:c.type,length:n,nullCount:n,nullBitmap:new Uint8Array(o)}))}return[e.assign(r),At({type:new ze(r),length:n,children:s})]}function rS(e,t,n=new Map){for(let i=-1,r=e.length;++i<r;){const o=e[i].type,a=t[i];if(ct.isDictionary(o)){if(!n.has(o.id))a.dictionary&&n.set(o.id,a.dictionary);else if(n.get(o.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&rS(o.children,a.children,n)}return n}class lg extends Xe{constructor(t){const n=t.fields.map(r=>At({type:r.type})),i=At({type:new ze(t.fields),nullCount:0,children:n});super(t,i)}}var Uf;(function(e){e[e.BUFFER=0]="BUFFER"})(Uf||(Uf={}));var zf;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(zf||(zf={}));class Ar{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBodyCompression(t,n){return(n||new Ar).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,n){return t.setPosition(t.position()+jt),(n||new Ar).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):zf.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Uf.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,n){t.addFieldInt8(0,n,zf.LZ4_FRAME)}static addMethod(t,n){t.addFieldInt8(1,n,Uf.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,n,i){return Ar.startBodyCompression(t),Ar.addCodec(t,n),Ar.addMethod(t,i),Ar.endBodyCompression(t)}}let sS=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,n,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(n),t.offset()}},oS=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,n,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(n),t.offset()}},Xi=class y0{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsRecordBatch(t,n){return(n||new y0).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,n){return t.setPosition(t.position()+jt),(n||new y0).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,n){const i=this.bb.__offset(this.bb_pos,6);return i?(n||new oS).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new sS).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new Ar).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,n){t.addFieldInt64(0,n,t.createLong(0,0))}static addNodes(t,n){t.addFieldOffset(1,n,0)}static startNodesVector(t,n){t.startVector(16,n,8)}static addBuffers(t,n){t.addFieldOffset(2,n,0)}static startBuffersVector(t,n){t.startVector(16,n,8)}static addCompression(t,n){t.addFieldOffset(3,n,0)}static endRecordBatch(t){return t.endObject()}},Lo=class m0{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryBatch(t,n){return(n||new m0).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,n){return t.setPosition(t.position()+jt),(n||new m0).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Xi).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,n){t.addFieldInt64(0,n,t.createLong(0,0))}static addData(t,n){t.addFieldOffset(1,n,0)}static addIsDelta(t,n){t.addFieldInt8(2,+n,0)}static endDictionaryBatch(t){return t.endObject()}};var jf;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(jf||(jf={}));let xr=class oi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMessage(t,n){return(n||new oi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,n){return t.setPosition(t.position()+jt),(n||new oi).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):la.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):jf.NONE}header(t){const n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__union(t,this.bb_pos+n):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,n){const i=this.bb.__offset(this.bb_pos,12);return i?(n||new pe).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,la.V1)}static addHeaderType(t,n){t.addFieldInt8(1,n,jf.NONE)}static addHeader(t,n){t.addFieldOffset(2,n,0)}static addBodyLength(t,n){t.addFieldInt64(3,n,t.createLong(0,0))}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)t.addOffset(n[i]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,n){t.finish(n)}static finishSizePrefixedMessageBuffer(t,n){t.finish(n,void 0,!0)}static createMessage(t,n,i,r,s,o){return oi.startMessage(t),oi.addVersion(t,n),oi.addHeaderType(t,i),oi.addHeader(t,r),oi.addBodyLength(t,s),oi.addCustomMetadata(t,o),oi.endMessage(t)}};var A4=sr;class T4 extends It{visit(t,n){return t==null||n==null?void 0:super.visit(t,n)}visitNull(t,n){return ks.startNull(n),ks.endNull(n)}visitInt(t,n){return un.startInt(n),un.addBitWidth(n,t.bitWidth),un.addIsSigned(n,t.isSigned),un.endInt(n)}visitFloat(t,n){return pi.startFloatingPoint(n),pi.addPrecision(n,t.precision),pi.endFloatingPoint(n)}visitBinary(t,n){return Ms.startBinary(n),Ms.endBinary(n)}visitBool(t,n){return Ns.startBool(n),Ns.endBool(n)}visitUtf8(t,n){return Ls.startUtf8(n),Ls.endUtf8(n)}visitDecimal(t,n){return Ge.startDecimal(n),Ge.addScale(n,t.scale),Ge.addPrecision(n,t.precision),Ge.addBitWidth(n,t.bitWidth),Ge.endDecimal(n)}visitDate(t,n){return Ku.startDate(n),Ku.addUnit(n,t.unit),Ku.endDate(n)}visitTime(t,n){return In.startTime(n),In.addUnit(n,t.unit),In.addBitWidth(n,t.bitWidth),In.endTime(n)}visitTimestamp(t,n){const i=t.timezone&&n.createString(t.timezone)||void 0;return Mn.startTimestamp(n),Mn.addUnit(n,t.unit),i!==void 0&&Mn.addTimezone(n,i),Mn.endTimestamp(n)}visitInterval(t,n){return yi.startInterval(n),yi.addUnit(n,t.unit),yi.endInterval(n)}visitList(t,n){return $s.startList(n),$s.endList(n)}visitStruct(t,n){return Os.startStruct_(n),Os.endStruct_(n)}visitUnion(t,n){He.startTypeIdsVector(n,t.typeIds.length);const i=He.createTypeIdsVector(n,t.typeIds);return He.startUnion(n),He.addMode(n,t.mode),He.addTypeIds(n,i),He.endUnion(n)}visitDictionary(t,n){const i=this.visit(t.indices,n);return Ji.startDictionaryEncoding(n),Ji.addId(n,new A4(t.id,0)),Ji.addIsOrdered(n,t.isOrdered),i!==void 0&&Ji.addIndexType(n,i),Ji.endDictionaryEncoding(n)}visitFixedSizeBinary(t,n){return hi.startFixedSizeBinary(n),hi.addByteWidth(n,t.byteWidth),hi.endFixedSizeBinary(n)}visitFixedSizeList(t,n){return di.startFixedSizeList(n),di.addListSize(n,t.listSize),di.endFixedSizeList(n)}visitMap(t,n){return Qu.startMap(n),Qu.addKeysSorted(n,t.keysSorted),Qu.endMap(n)}}const Vp=new T4;function I4(e,t=new Map){return new ee(N4(e,t),tf(e.customMetadata),t)}function aS(e){return new bn(e.count,cS(e.columns),lS(e.columns))}function M4(e){return new Ni(aS(e.data),e.id,e.isDelta)}function N4(e,t){return(e.fields||[]).filter(Boolean).map(n=>Kt.fromJSON(n,t))}function fw(e,t){return(e.children||[]).filter(Boolean).map(n=>Kt.fromJSON(n,t))}function cS(e){return(e||[]).reduce((t,n)=>[...t,new ao(n.count,$4(n.VALIDITY)),...cS(n.children)],[])}function lS(e,t=[]){for(let n=-1,i=(e||[]).length;++n<i;){const r=e[n];r.VALIDITY&&t.push(new wi(t.length,r.VALIDITY.length)),r.TYPE&&t.push(new wi(t.length,r.TYPE.length)),r.OFFSET&&t.push(new wi(t.length,r.OFFSET.length)),r.DATA&&t.push(new wi(t.length,r.DATA.length)),t=lS(r.children,t)}return t}function $4(e){return(e||[]).reduce((t,n)=>t+ +(n===0),0)}function k4(e,t){let n,i,r,s,o,a;return!t||!(s=e.dictionary)?(o=dw(e,fw(e,t)),r=new Kt(e.name,o,e.nullable,tf(e.customMetadata))):t.has(n=s.id)?(i=(i=s.indexType)?hw(i):new Xc,a=new aa(t.get(n),i,n,s.isOrdered),r=new Kt(e.name,a,e.nullable,tf(e.customMetadata))):(i=(i=s.indexType)?hw(i):new Xc,t.set(n,o=dw(e,fw(e,t))),a=new aa(o,i,n,s.isOrdered),r=new Kt(e.name,a,e.nullable,tf(e.customMetadata))),r||null}function tf(e){return new Map(Object.entries(e||{}))}function hw(e){return new Yr(e.isSigned,e.bitWidth)}function dw(e,t){const n=e.type.name;switch(n){case"NONE":return new qr;case"null":return new qr;case"binary":return new bf;case"utf8":return new wf;case"bool":return new _f;case"list":return new Af((t||[])[0]);case"struct":return new ze(t||[]);case"struct_":return new ze(t||[])}switch(n){case"int":{const i=e.type;return new Yr(i.isSigned,i.bitWidth)}case"floatingpoint":{const i=e.type;return new Kc(Je[i.precision])}case"decimal":{const i=e.type;return new vf(i.scale,i.precision,i.bitWidth)}case"date":{const i=e.type;return new xf(ur[i.unit])}case"time":{const i=e.type;return new Qc(Lt[i.unit],i.bitWidth)}case"timestamp":{const i=e.type;return new Sf(Lt[i.unit],i.timezone)}case"interval":{const i=e.type;return new Ef(jr[i.unit])}case"union":{const i=e.type;return new Tf(gn[i.mode],i.typeIds||[],t||[])}case"fixedsizebinary":{const i=e.type;return new If(i.byteWidth)}case"fixedsizelist":{const i=e.type;return new Mf(i.listSize,(t||[])[0])}case"map":{const i=e.type;return new Nf((t||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var Gs=sr,O4=Jx,L4=ca;class je{constructor(t,n,i,r){this._version=n,this._headerType=i,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,n){const i=new je(0,fn.V4,n);return i._createHeader=R4(t,n),i}static decode(t){t=new L4(Ot(t));const n=xr.getRootAsMessage(t),i=n.bodyLength(),r=n.version(),s=n.headerType(),o=new je(i,r,s);return o._createHeader=F4(n,s),o}static encode(t){const n=new O4;let i=-1;return t.isSchema()?i=ee.encode(n,t.header()):t.isRecordBatch()?i=bn.encode(n,t.header()):t.isDictionaryBatch()&&(i=Ni.encode(n,t.header())),xr.startMessage(n),xr.addVersion(n,fn.V4),xr.addHeader(n,i),xr.addHeaderType(n,t.headerType),xr.addBodyLength(n,new Gs(t.bodyLength,0)),xr.finishMessageBuffer(n,xr.endMessage(n)),n.asUint8Array()}static from(t,n=0){if(t instanceof ee)return new je(0,fn.V4,Ct.Schema,t);if(t instanceof bn)return new je(n,fn.V4,Ct.RecordBatch,t);if(t instanceof Ni)return new je(n,fn.V4,Ct.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Ct.Schema}isRecordBatch(){return this.headerType===Ct.RecordBatch}isDictionaryBatch(){return this.headerType===Ct.DictionaryBatch}}class bn{constructor(t,n,i){this._nodes=n,this._buffers=i,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class Ni{constructor(t,n,i=!1){this._data=t,this._isDelta=i,this._id=typeof n=="number"?n:n.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class wi{constructor(t,n){this.offset=typeof t=="number"?t:t.low,this.length=typeof n=="number"?n:n.low}}class ao{constructor(t,n){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof n=="number"?n:n.low}}function R4(e,t){return()=>{switch(t){case Ct.Schema:return ee.fromJSON(e);case Ct.RecordBatch:return bn.fromJSON(e);case Ct.DictionaryBatch:return Ni.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${Ct[t]}, type: ${t} }`)}}function F4(e,t){return()=>{switch(t){case Ct.Schema:return ee.decode(e.header(new ai));case Ct.RecordBatch:return bn.decode(e.header(new Xi),e.version());case Ct.DictionaryBatch:return Ni.decode(e.header(new Lo),e.version())}throw new Error(`Unrecognized Message type: { name: ${Ct[t]}, type: ${t} }`)}}Kt.encode=W4;Kt.decode=Y4;Kt.fromJSON=k4;ee.encode=V4;ee.decode=D4;ee.fromJSON=I4;bn.encode=G4;bn.decode=C4;bn.fromJSON=aS;Ni.encode=H4;Ni.decode=B4;Ni.fromJSON=M4;ao.encode=X4;ao.decode=U4;wi.encode=K4;wi.decode=P4;function D4(e,t=new Map){const n=q4(e,t);return new ee(n,ef(e),t)}function C4(e,t=fn.V4){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new bn(e.length(),z4(e),j4(e,t))}function B4(e,t=fn.V4){return new Ni(bn.decode(e.data(),t),e.id(),e.isDelta())}function P4(e){return new wi(e.offset(),e.length())}function U4(e){return new ao(e.length(),e.nullCount())}function z4(e){const t=[];for(let n,i=-1,r=-1,s=e.nodesLength();++i<s;)(n=e.nodes(i))&&(t[++r]=ao.decode(n));return t}function j4(e,t){const n=[];for(let i,r=-1,s=-1,o=e.buffersLength();++r<o;)(i=e.buffers(r))&&(t<fn.V4&&(i.bb_pos+=8*(r+1)),n[++s]=wi.decode(i));return n}function q4(e,t){const n=[];for(let i,r=-1,s=-1,o=e.fieldsLength();++r<o;)(i=e.fields(r))&&(n[++s]=Kt.decode(i,t));return n}function pw(e,t){const n=[];for(let i,r=-1,s=-1,o=e.childrenLength();++r<o;)(i=e.children(r))&&(n[++s]=Kt.decode(i,t));return n}function Y4(e,t){let n,i,r,s,o,a;return!t||!(a=e.dictionary())?(r=mw(e,pw(e,t)),i=new Kt(e.name(),r,e.nullable(),ef(e))):t.has(n=a.id().low)?(s=(s=a.indexType())?yw(s):new Xc,o=new aa(t.get(n),s,n,a.isOrdered()),i=new Kt(e.name(),o,e.nullable(),ef(e))):(s=(s=a.indexType())?yw(s):new Xc,t.set(n,r=mw(e,pw(e,t))),o=new aa(r,s,n,a.isOrdered()),i=new Kt(e.name(),o,e.nullable(),ef(e))),i||null}function ef(e){const t=new Map;if(e)for(let n,i,r=-1,s=Math.trunc(e.customMetadataLength());++r<s;)(n=e.customMetadata(r))&&(i=n.key())!=null&&t.set(i,n.value());return t}function yw(e){return new Yr(e.isSigned(),e.bitWidth())}function mw(e,t){const n=e.typeType();switch(n){case te.NONE:return new qr;case te.Null:return new qr;case te.Binary:return new bf;case te.Utf8:return new wf;case te.Bool:return new _f;case te.List:return new Af((t||[])[0]);case te.Struct_:return new ze(t||[])}switch(n){case te.Int:{const i=e.type(new un);return new Yr(i.isSigned(),i.bitWidth())}case te.FloatingPoint:{const i=e.type(new pi);return new Kc(i.precision())}case te.Decimal:{const i=e.type(new Ge);return new vf(i.scale(),i.precision(),i.bitWidth())}case te.Date:{const i=e.type(new Ku);return new xf(i.unit())}case te.Time:{const i=e.type(new In);return new Qc(i.unit(),i.bitWidth())}case te.Timestamp:{const i=e.type(new Mn);return new Sf(i.unit(),i.timezone())}case te.Interval:{const i=e.type(new yi);return new Ef(i.unit())}case te.Union:{const i=e.type(new He);return new Tf(i.mode(),i.typeIdsArray()||[],t||[])}case te.FixedSizeBinary:{const i=e.type(new hi);return new If(i.byteWidth())}case te.FixedSizeList:{const i=e.type(new di);return new Mf(i.listSize(),(t||[])[0])}case te.Map:{const i=e.type(new Qu);return new Nf((t||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${te[n]}" (${n})`)}function V4(e,t){const n=t.fields.map(s=>Kt.encode(e,s));ai.startFieldsVector(e,n.length);const i=ai.createFieldsVector(e,n),r=t.metadata&&t.metadata.size>0?ai.createCustomMetadataVector(e,[...t.metadata].map(([s,o])=>{const a=e.createString(`${s}`),c=e.createString(`${o}`);return pe.startKeyValue(e),pe.addKey(e,a),pe.addValue(e,c),pe.endKeyValue(e)})):-1;return ai.startSchema(e),ai.addFields(e,i),ai.addEndianness(e,Q4?ua.Little:ua.Big),r!==-1&&ai.addCustomMetadata(e,r),ai.endSchema(e)}function W4(e,t){let n=-1,i=-1,r=-1;const s=t.type;let o=t.typeId;ct.isDictionary(s)?(o=s.dictionary.typeId,r=Vp.visit(s,e),i=Vp.visit(s.dictionary,e)):i=Vp.visit(s,e);const a=(s.children||[]).map(u=>Kt.encode(e,u)),c=An.createChildrenVector(e,a),l=t.metadata&&t.metadata.size>0?An.createCustomMetadataVector(e,[...t.metadata].map(([u,h])=>{const f=e.createString(`${u}`),d=e.createString(`${h}`);return pe.startKeyValue(e),pe.addKey(e,f),pe.addValue(e,d),pe.endKeyValue(e)})):-1;return t.name&&(n=e.createString(t.name)),An.startField(e),An.addType(e,i),An.addTypeType(e,o),An.addChildren(e,c),An.addNullable(e,!!t.nullable),n!==-1&&An.addName(e,n),r!==-1&&An.addDictionary(e,r),l!==-1&&An.addCustomMetadata(e,l),An.endField(e)}function G4(e,t){const n=t.nodes||[],i=t.buffers||[];Xi.startNodesVector(e,n.length);for(const o of n.slice().reverse())ao.encode(e,o);const r=e.endVector();Xi.startBuffersVector(e,i.length);for(const o of i.slice().reverse())wi.encode(e,o);const s=e.endVector();return Xi.startRecordBatch(e),Xi.addLength(e,new Gs(t.length,0)),Xi.addNodes(e,r),Xi.addBuffers(e,s),Xi.endRecordBatch(e)}function H4(e,t){const n=bn.encode(e,t.data);return Lo.startDictionaryBatch(e),Lo.addId(e,new Gs(t.id,0)),Lo.addIsDelta(e,t.isDelta),Lo.addData(e,n),Lo.endDictionaryBatch(e)}function X4(e,t){return oS.createFieldNode(e,new Gs(t.length,0),new Gs(t.nullCount,0))}function K4(e,t){return sS.createBuffer(e,new Gs(t.offset,0),new Gs(t.length,0))}const Q4=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})(),ug=e=>`Expected ${Ct[e]} Message in stream, but was null or length 0.`,fg=e=>`Header pointer of flatbuffer-encoded ${Ct[e]} Message is null or length 0.`,uS=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,fS=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class hS{constructor(t){this.source=t instanceof Bf?t:new Bf(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?re:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(ug(t));return n.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const n=Ot(this.source.read(t));if(n.byteLength<t)throw new Error(fS(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()}readSchema(t=!1){const n=Ct.Schema,i=this.readMessage(n),r=i==null?void 0:i.header();if(t&&!r)throw new Error(fg(n));return r}readMetadataLength(){const t=this.source.read(fd),n=t&&new ca(t),i=(n==null?void 0:n.readInt32(0))||0;return{done:i===0,value:i}}readMetadata(t){const n=this.source.read(t);if(!n)return re;if(n.byteLength<t)throw new Error(uS(t,n.byteLength));return{done:!1,value:je.decode(n)}}}class J4{constructor(t,n){this.source=t instanceof ha?t:Lv(t)?new Pf(t,n):new ha(t)}[Symbol.asyncIterator](){return this}next(){return st(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?re:t})}throw(t){return st(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return st(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return st(this,void 0,void 0,function*(){let n;if((n=yield this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(ug(t));return n.value})}readMessageBody(t){return st(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);const n=Ot(yield this.source.read(t));if(n.byteLength<t)throw new Error(fS(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()})}readSchema(t=!1){return st(this,void 0,void 0,function*(){const n=Ct.Schema,i=yield this.readMessage(n),r=i==null?void 0:i.header();if(t&&!r)throw new Error(fg(n));return r})}readMetadataLength(){return st(this,void 0,void 0,function*(){const t=yield this.source.read(fd),n=t&&new ca(t),i=(n==null?void 0:n.readInt32(0))||0;return{done:i===0,value:i}})}readMetadata(t){return st(this,void 0,void 0,function*(){const n=yield this.source.read(t);if(!n)return re;if(n.byteLength<t)throw new Error(uS(t,n.byteLength));return{done:!1,value:je.decode(n)}})}}class Z4 extends hS{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof cw?t:new cw(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:je.fromJSON(t.schema,Ct.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const n=t.dictionaries[this._dictionaryIndex++];return this._body=n.data.columns,{done:!1,value:je.fromJSON(n,Ct.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const n=t.batches[this._batchIndex++];return this._body=n.columns,{done:!1,value:je.fromJSON(n,Ct.RecordBatch)}}return this._body=[],re}readMessageBody(t){return n(this._body);function n(i){return(i||[]).reduce((r,s)=>[...r,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE&&[s.TYPE]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...n(s.children)],[])}}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(ug(t));return n.value}readSchema(){const t=Ct.Schema,n=this.readMessage(t),i=n==null?void 0:n.header();if(!n||!i)throw new Error(fg(t));return i}}const fd=4,g0="ARROW1",Zc=new Uint8Array(g0.length);for(let e=0;e<g0.length;e+=1)Zc[e]=g0.codePointAt(e);function hg(e,t=0){for(let n=-1,i=Zc.length;++n<i;)if(Zc[n]!==e[t+n])return!1;return!0}const $l=Zc.length,dS=$l+fd,t8=$l*2+fd;class mn extends rg{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const n=this._impl.open(t);return zr(n)?n.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Tn.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Tn.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof mn?t:o0(t)?r8(t):Lv(t)?a8(t):zr(t)?(()=>st(this,void 0,void 0,function*(){return yield mn.from(yield t)}))():Rv(t)||Ym(t)||Fv(t)||Ca(t)?o8(new ha(t)):s8(new Bf(t))}static readAll(t){return t instanceof mn?t.isSync()?gw(t):bw(t):o0(t)||ArrayBuffer.isView(t)||Tl(t)||Ov(t)?gw(t):bw(t)}}class qf extends mn{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return bi(this,arguments,function*(){yield bt(yield*Xu(Us(this[Symbol.iterator]())))})}}class Yf extends mn{constructor(t){super(t),this._impl=t}readAll(){var t,n;return st(this,void 0,void 0,function*(){const i=new Array;try{for(var r=Us(this),s;s=yield r.next(),!s.done;){const o=s.value;i.push(o)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=r.return)&&(yield n.call(r))}finally{if(t)throw t.error}}return i})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class pS extends qf{constructor(t){super(t),this._impl=t}}class e8 extends Yf{constructor(t){super(t),this._impl=t}}class yS{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,n){const i=this._loadVectors(t,n,this.schema.fields),r=At({type:new ze(this.schema.fields),length:t.length,children:i});return new Xe(this.schema,r)}_loadDictionaryBatch(t,n){const{id:i,isDelta:r}=t,{dictionaries:s,schema:o}=this,a=s.get(i);if(r||!a){const c=o.dictionaries.get(i),l=this._loadVectors(t.data,n,[c]);return(a&&r?a.concat(new ie(l)):new ie(l)).memoize()}return a.memoize()}_loadVectors(t,n,i){return new eS(n,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}class Vf extends yS{constructor(t,n){super(n),this._reader=o0(t)?new Z4(this._handle=t):new hS(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=gS(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):re}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):re}next(){if(this.closed)return re;let t;const{_reader:n}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),r=n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,r)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),r=n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(i,r);this.dictionaries.set(i.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new lg(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Wf extends yS{constructor(t,n){super(n),this._reader=new J4(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return st(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return st(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=gS(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return st(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):re})}return(t){return st(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):re})}next(){return st(this,void 0,void 0,function*(){if(this.closed)return re;let t;const{_reader:n}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),r=yield n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,r)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),r=yield n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(i,r);this.dictionaries.set(i.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new lg(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return st(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}}class mS extends Vf{constructor(t,n){super(t instanceof lw?t:new lw(t),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var n;if(this.closed)return null;this._footer||this.open();const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){const r=this._reader.readMessage(Ct.RecordBatch);if(r!=null&&r.isRecordBatch()){const s=r.header(),o=this._reader.readMessageBody(r.bodyLength);return this._loadRecordBatch(s,o)}}return null}_readDictionaryBatch(t){var n;const i=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){const r=this._reader.readMessage(Ct.DictionaryBatch);if(r!=null&&r.isDictionaryBatch()){const s=r.header(),o=this._reader.readMessageBody(r.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}}_readFooter(){const{_handle:t}=this,n=t.size-dS,i=t.readInt32(n),r=t.readAt(n-i,i);return Jc.decode(r)}_readNextMessageAndValidate(t){var n;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}}class n8 extends Wf{constructor(t,...n){const i=typeof n[0]!="number"?n.shift():void 0,r=n[0]instanceof Map?n.shift():void 0;super(t instanceof Pf?t:new Pf(t,i),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const n=Object.create(null,{open:{get:()=>super.open}});return st(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield n.open.call(this,t)})}readRecordBatch(t){var n;return st(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){const r=yield this._reader.readMessage(Ct.RecordBatch);if(r!=null&&r.isRecordBatch()){const s=r.header(),o=yield this._reader.readMessageBody(r.bodyLength);return this._loadRecordBatch(s,o)}}return null})}_readDictionaryBatch(t){var n;return st(this,void 0,void 0,function*(){const i=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){const r=yield this._reader.readMessage(Ct.DictionaryBatch);if(r!=null&&r.isDictionaryBatch()){const s=r.header(),o=yield this._reader.readMessageBody(r.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}})}_readFooter(){return st(this,void 0,void 0,function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const n=t.size-dS,i=yield t.readInt32(n),r=yield t.readAt(n-i,i);return Jc.decode(r)})}_readNextMessageAndValidate(t){return st(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=this._footer.getRecordBatch(this._recordBatchIndex);if(n&&(yield this._handle.seek(n.offset)))return yield this._reader.readMessage(t)}return null})}}class i8 extends Vf{constructor(t,n){super(t,n)}_loadVectors(t,n,i){return new y4(n,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}function gS(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*gw(e){const t=mn.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function bw(e){return bi(this,arguments,function*(){const n=yield bt(mn.from(e));try{if(!(yield bt(n.open({autoDestroy:!1}))).closed)do yield yield bt(n);while(!(yield bt(n.reset().open())).closed)}finally{yield bt(n.cancel())}})}function r8(e){return new qf(new i8(e))}function s8(e){const t=e.peek($l+7&-8);return t&&t.byteLength>=4?hg(t)?new pS(new mS(e.read())):new qf(new Vf(e)):new qf(new Vf(function*(){}()))}function o8(e){return st(this,void 0,void 0,function*(){const t=yield e.peek($l+7&-8);return t&&t.byteLength>=4?hg(t)?new pS(new mS(yield e.read())):new Yf(new Wf(e)):new Yf(new Wf(function(){return bi(this,arguments,function*(){})}()))})}function a8(e){return st(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),n=new Pf(e,t);return t>=t8&&hg(yield n.readAt(0,$l+7&-8))?new e8(new n8(n)):new Yf(new Wf(n))})}class he extends It{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){const n=r=>r.flatMap(s=>Array.isArray(s)?n(s):s instanceof Xe?s.data.children:s.data),i=new he;return i.visitMany(n(t)),i}visit(t){if(t instanceof ie)return this.visitMany(t.data),this;const{type:n}=t;if(!ct.isDictionary(n)){const{length:i,nullCount:r}=t;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");ct.isNull(n)||Hn.call(this,r<=0?new Uint8Array(0):Zm(t.offset,i,t.nullBitmap)),this.nodes.push(new ao(i,r))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function Hn(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new wi(this._byteLength,t)),this._byteLength+=t,this}function c8(e){const{type:t,length:n,typeIds:i,valueOffsets:r}=e;if(Hn.call(this,i),t.mode===gn.Sparse)return b0.call(this,e);if(t.mode===gn.Dense){if(e.offset<=0)return Hn.call(this,r),b0.call(this,e);{const s=i.reduce((u,h)=>Math.max(u,h),i[0]),o=new Int32Array(s+1),a=new Int32Array(s+1).fill(-1),c=new Int32Array(n),l=Wm(-r[0],n,r);for(let u,h,f=-1;++f<n;)(h=a[u=i[f]])===-1&&(h=a[u]=l[u]),c[f]=l[f]-h,++o[u];Hn.call(this,c);for(let u,h=-1,f=t.children.length;++h<f;)if(u=e.children[h]){const d=t.typeIds[h],p=Math.min(n,o[d]);this.visit(u.slice(a[d],p))}}}return this}function l8(e){let t;return e.nullCount>=e.length?Hn.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?Hn.call(this,Zm(e.offset,e.length,t)):Hn.call(this,$f(e.values))}function os(e){return Hn.call(this,e.values.subarray(0,e.length*e.stride))}function bS(e){const{length:t,values:n,valueOffsets:i}=e,r=i[0],s=i[t],o=Math.min(s-r,n.byteLength-r);return Hn.call(this,Wm(-i[0],t,i)),Hn.call(this,n.subarray(r,r+o)),this}function dg(e){const{length:t,valueOffsets:n}=e;return n&&Hn.call(this,Wm(n[0],t,n)),this.visit(e.children[0])}function b0(e){return this.visitMany(e.type.children.map((t,n)=>e.children[n]).filter(Boolean))[0]}he.prototype.visitBool=l8;he.prototype.visitInt=os;he.prototype.visitFloat=os;he.prototype.visitUtf8=bS;he.prototype.visitBinary=bS;he.prototype.visitFixedSizeBinary=os;he.prototype.visitDate=os;he.prototype.visitTimestamp=os;he.prototype.visitTime=os;he.prototype.visitDecimal=os;he.prototype.visitList=dg;he.prototype.visitStruct=b0;he.prototype.visitUnion=c8;he.prototype.visitInterval=os;he.prototype.visitFixedSizeList=dg;he.prototype.visitMap=dg;class wS extends rg{constructor(t){super(),this._position=0,this._started=!1,this._sink=new Zu,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Ze(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return zr(t)?t.then(n=>this.writeAll(n)):Ca(t)?gg(this,t):mg(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,n=null){return t===this._sink||t instanceof Zu?this._sink=t:(this._sink=new Zu,t&&$$(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&k$(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!n||!p0(n,this._schema))&&(n==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=n,this._writeSchema(n))),this}write(t){let n=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof Mi&&!(n=t.schema))return this.finish()&&void 0;if(t instanceof Xe&&!(n=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(n&&!p0(n,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,n)}t instanceof Xe?t instanceof lg||this._writeRecordBatch(t):t instanceof Mi?this.writeAll(t.batches):Tl(t)&&this.writeAll(t)}_writeMessage(t,n=8){const i=n-1,r=je.encode(t),s=r.byteLength,o=this._writeLegacyIpcFormat?4:8,a=s+o+i&~i,c=a-s-o;return t.headerType===Ct.RecordBatch?this._recordBatchBlocks.push(new Vr(a,t.bodyLength,this._position)):t.headerType===Ct.DictionaryBatch&&this._dictionaryBlocks.push(new Vr(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),s>0&&this._write(r),this._writePadding(c)}_write(t){if(this._started){const n=Ot(t);n&&n.byteLength>0&&(this._sink.write(n),this._position+=n.byteLength)}return this}_writeSchema(t){return this._writeMessage(je.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Zc)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:n,nodes:i,bufferRegions:r,buffers:s}=he.assemble(t),o=new bn(t.numRows,i,r),a=je.from(o,n);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(s)}_writeDictionaryBatch(t,n,i=!1){this._dictionaryDeltaOffsets.set(n,t.length+(this._dictionaryDeltaOffsets.get(n)||0));const{byteLength:r,nodes:s,bufferRegions:o,buffers:a}=he.assemble(new ie([t])),c=new bn(t.length,s,o),l=new Ni(c,n,i),u=je.from(l,r);return this._writeMessage(u)._writeBodyBuffers(a)}_writeBodyBuffers(t){let n,i,r;for(let s=-1,o=t.length;++s<o;)(n=t[s])&&(i=n.byteLength)>0&&(this._write(n),(r=(i+7&-8)-i)>0&&this._writePadding(r));return this}_writeDictionaries(t){for(let[n,i]of t.dictionaries){let r=this._dictionaryDeltaOffsets.get(n)||0;if(r===0||(i=i==null?void 0:i.slice(r)).length>0)for(const s of i.data)this._writeDictionaryBatch(s,n,r>0),r+=s.length}return this}}class pg extends wS{static writeAll(t,n){const i=new pg(n);return zr(t)?t.then(r=>i.writeAll(r)):Ca(t)?gg(i,t):mg(i,t)}}class yg extends wS{static writeAll(t){const n=new yg;return zr(t)?t.then(i=>n.writeAll(i)):Ca(t)?gg(n,t):mg(n,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const n=Jc.encode(new Jc(t,fn.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(n)._write(Int32Array.of(n.byteLength))._writeMagic()}}function mg(e,t){let n=t;t instanceof Mi&&(n=t.batches,e.reset(void 0,t.schema));for(const i of n)e.write(i);return e.finish()}function gg(e,t){var n,i,r,s;return st(this,void 0,void 0,function*(){try{for(n=Us(t);i=yield n.next(),!i.done;){const o=i.value;e.write(o)}}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}return e.finish()})}function _S(e){const t=mn.from(e);return zr(t)?t.then(n=>_S(n)):t.isAsync()?t.readAll().then(n=>new Mi(n)):new Mi(t.readAll())}function u8(e,t="stream"){return(t==="stream"?pg:yg).writeAll(e).toUint8Array(!0)}function f8(e="ws://localhost:3000/"){const t=[];let n=!1,i=null,r;const s={open(){n=!0,c()},close(){for(n=!1,i=null,r=null;t.length;)t.shift().reject("Socket closed")},error(l){if(i){const{reject:u}=i;i=null,c(),u(l)}else console.error("WebSocket error: ",l)},message({data:l}){if(i){const{query:u,resolve:h,reject:f}=i;if(i=null,c(),typeof l=="string"){const d=JSON.parse(l);d.error?f(d.error):h(d)}else if(u.type==="exec")h();else if(u.type==="arrow")h(_S(l.arrayBuffer()));else throw new Error(`Unexpected socket data: ${l}`)}else console.log("WebSocket message: ",l)}};function o(){r=new WebSocket(e);for(const l in s)r.addEventListener(l,s[l])}function a(l,u,h){r==null&&o(),t.push({query:l,resolve:u,reject:h}),n&&!i&&c()}function c(){t.length&&(i=t.shift(),r.send(JSON.stringify(i.query)))}return{get connected(){return n},query(l){return new Promise((u,h)=>a(l,u,h))}}}class Gr{constructor(t,n){t&&(this.table=String(t)),n&&(this.column=n)}get columns(){return this.column?[this.column]:[]}toString(){const{table:t,column:n}=this;if(n){const i=n.startsWith("*")?n:`"${n}"`;return`${t?`${ww(t)}.`:""}${i}`}else return t?ww(t):"NULL"}}function ww(e){return e.split(".").map(n=>`"${n}"`).join(".")}function h8(e,t){return e instanceof Gr&&e.column===t}function Gt(e){return typeof e=="string"?bg(e):e}function nf(e){return typeof e=="string"?d8(e):e}function d8(e){return new Gr(e)}function bg(e,t){return arguments.length===1&&(t=e,e=null),new Gr(e,t)}function kl(e){switch(typeof e){case"boolean":return e?"TRUE":"FALSE";case"string":return`'${e}'`;case"number":return Number.isFinite(e)?String(e):"NULL";default:if(e==null)return"NULL";if(e instanceof Date){const t=+e;if(Number.isNaN(t))return"NULL";const n=e.getUTCFullYear(),i=e.getUTCMonth(),r=e.getUTCDate();return t===Date.UTC(n,i,r)?`MAKE_DATE(${n}, ${i+1}, ${r})`:`EPOCH_MS(${t})`}else return e instanceof RegExp?`'${e.source}'`:String(e)}}const pa=e=>typeof(e==null?void 0:e.addEventListener)=="function";function vS(e){return e instanceof hd}class hd{constructor(t,n,i){this._expr=Array.isArray(t)?t:[t],this._deps=n||[],this.annotate(i);const r=this._expr.filter(s=>pa(s));r.length>0?(this._params=Array.from(new Set(r)),this._params.forEach(s=>{s.addEventListener("value",()=>{var o;return p8(this,(o=this.map)==null?void 0:o.get("value"))})})):this.addEventListener=void 0}get value(){return this}get columns(){const{_params:t,_deps:n}=this;if(t){const i=new Set(t.flatMap(r=>{var o;const s=(o=r.value)==null?void 0:o.columns;return Array.isArray(s)?s:[]}));if(i.size){const r=new Set(n);return i.forEach(s=>r.add(s)),Array.from(r)}}return n}get column(){return this._deps.length?this._deps[0]:this.columns[0]}annotate(...t){return Object.assign(this,...t)}toString(){return this._expr.map(t=>pa(t)&&!vS(t)?kl(t.value):t).join("")}addEventListener(t,n){const i=this.map||(this.map=new Map);(i.get(t)||(i.set(t,new Set),i.get(t))).add(n)}}function p8(e,t){if(t!=null&&t.size)return Promise.allSettled(Array.from(t,n=>n(e)))}function xS(e,t){const n=[e[0]],i=new Set,r=t.length;for(let s=0,o=0;s<r;){const a=t[s];pa(a)?n[++o]=a:(Array.isArray(a==null?void 0:a.columns)&&a.columns.forEach(l=>i.add(l)),n[o]+=typeof a=="string"?a:kl(a));const c=e[++s];pa(n[o])?n[++o]=c:n[o]+=c}return{spans:n,cols:Array.from(i)}}function q(e,...t){const{spans:n,cols:i}=xS(e,t);return new hd(n,i)}function y8(e){const t=Gt(e);return q`${t} DESC NULLS LAST`.annotate({label:t==null?void 0:t.label,desc:!0})}const Ol=e=>({value:e,toString:()=>kl(e)});function dd(e){var t;e(this.op,this),(t=this.children)==null||t.forEach(n=>n.visit(e))}function SS(e,t){const n=t.filter(r=>r!=null).map(Gt),i=n.map((r,s)=>s?` ${e} `:"");return t.length&&i.push(""),q(i,...n).annotate({op:e,children:n,visit:dd})}const Hs=(...e)=>SS("AND",e.flat()),ES=(...e)=>SS("OR",e.flat()),AS=e=>t=>q`(${Gt(t)} ${e})`.annotate({op:e,a:t,visit:dd}),TS=AS("IS NULL"),Gf=AS("IS NOT NULL"),Ll=e=>(t,n)=>q`(${Gt(t)} ${e} ${Gt(n)})`.annotate({op:e,a:t,b:n,visit:dd}),pd=Ll("="),m8=Ll("<>"),Hf=Ll("<"),IS=Ll(">"),Xf=Ll("<=");function g8(e,t,n,i){t=Gt(t);const r=e.startsWith("NOT ")?"NOT ":"";return(n?i?q`${r}(${n[0]} <= ${t} AND ${t} < ${n[1]})`:q`(${t} ${e} ${n[0]} AND ${n[1]})`:q``).annotate({op:e,visit:dd,field:t,range:n})}const wn=(e,t,n)=>g8("BETWEEN",e,t,n);function Kf(e,t){return Array.from({length:e},()=>t)}function Rl(e,t){return(...n)=>{const i=n.map(Gt),r=t?`::${t}`:"";return(i.length?q([`${e}(`,...Kf(i.length-1,", "),`)${r}`],...i):q`${e}()${r}`).annotate({func:e,args:i})}}const b8=Rl("REGEXP_MATCHES"),w8=Rl("CONTAINS"),_8=Rl("PREFIX"),v8=Rl("SUFFIX");class Mr extends hd{constructor(t,n,i,r,s="",o="",a=""){let c;if(r&&!(s||o||a))c=r?q`${n} OVER "${r}"`:q`${n} OVER ()`;else{const f=s&&o?" ":"",d=(s||o)&&a?" ":"";c=q`${n} OVER (${r?`"${r}" `:""}${s}${f}${o}${d}${a})`}i&&(c=q`(${c})::${i}`);const{_expr:u,_deps:h}=c;super(u,h,{window:t,func:n,type:i,name:r,group:s,order:o,frame:a})}get basis(){return this.column}get label(){const{func:t}=this;return t.label??t.toString()}over(t){const{window:n,func:i,type:r,group:s,order:o,frame:a}=this;return new Mr(n,i,r,t,s,o,a)}partitionby(...t){const n=t.flat().filter(u=>u).map(Gt),i=q(["PARTITION BY ",Kf(n.length-1,", "),""],...n),{window:r,func:s,type:o,name:a,order:c,frame:l}=this;return new Mr(r,s,o,a,i,c,l)}orderby(...t){const n=t.flat().filter(u=>u).map(Gt),i=q(["ORDER BY ",Kf(n.length-1,", "),""],...n),{window:r,func:s,type:o,name:a,group:c,frame:l}=this;return new Mr(r,s,o,a,c,i,l)}rows(t){const n=_w("ROWS",t),{window:i,func:r,type:s,name:o,group:a,order:c}=this;return new Mr(i,r,s,o,a,c,n)}range(t){const n=_w("RANGE",t),{window:i,func:r,type:s,name:o,group:a,order:c}=this;return new Mr(i,r,s,o,a,c,n)}}function _w(e,t){if(pa(t)){const n=q`${t}`;return n.toString=()=>`${e} ${vw(t.value)}`,n}return`${e} ${vw(t)}`}function vw(e){const[t,n]=e,i=t===0?"CURRENT ROW":Number.isFinite(t)?`${Math.abs(t)} PRECEDING`:"UNBOUNDED PRECEDING",r=n===0?"CURRENT ROW":Number.isFinite(n)?`${Math.abs(n)} FOLLOWING`:"UNBOUNDED FOLLOWING";return`BETWEEN ${i} AND ${r}`}function ti(e,t){return(...n)=>{const i=Rl(e)(...n);return new Mr(e,i,t)}}const x8=ti("ROW_NUMBER","INTEGER"),S8=ti("RANK","INTEGER"),E8=ti("DENSE_RANK","INTEGER"),A8=ti("PERCENT_RANK"),T8=ti("CUME_DIST"),I8=ti("NTILE"),M8=ti("LAG"),N8=ti("LEAD"),$8=ti("FIRST_VALUE"),k8=ti("LAST_VALUE"),O8=ti("NTH_VALUE");class Dc extends hd{constructor(t,n,i,r,s){n=(n||[]).map(Gt);const{strings:o,exprs:a}=L8(t,n,i,r,s),{spans:c,cols:l}=xS(o,a);super(c,l,{aggregate:t,args:n,type:i,isDistinct:r,filter:s})}get basis(){return this.column}get label(){const{aggregate:t,args:n,isDistinct:i}=this,r=i?"DISTINCT"+(n.length?" ":""):"",s=n.length?`(${r}${n.map(R8).join(", ")})`:"";return`${t.toLowerCase()}${s}`}distinct(){const{aggregate:t,args:n,type:i,filter:r}=this;return new Dc(t,n,i,!0,r)}where(t){const{aggregate:n,args:i,type:r,isDistinct:s}=this;return new Dc(n,i,r,s,t)}window(){const{aggregate:t,args:n,type:i,isDistinct:r}=this,s=new Dc(t,n,null,r);return new Mr(t,s,i)}partitionby(...t){return this.window().partitionby(...t)}orderby(...t){return this.window().orderby(...t)}rows(t,n){return this.window().rows(t,n)}range(t,n){return this.window().range(t,n)}}function L8(e,t,n,i,r){const s=`)${n?`::${n}`:""}`;let o=[`${e}(${i?"DISTINCT ":""}`],a=[];return t.length?(o=o.concat([...Kf(t.length-1,", "),`${s}${r?" FILTER (WHERE ":""}`,...r?[")"]:[]]),a=[...t,...r?[r]:[]]):o[0]+="*"+s,{exprs:a,strings:o}}function R8(e){const t=kl(e);return t&&t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function Re(e,t){return(...n)=>new Dc(e,n,t)}const js=Re("COUNT","INTEGER"),F8=Re("AVG"),ya=Re("MAX"),ma=Re("MIN"),co=Re("SUM","DOUBLE"),D8=Re("MEDIAN"),C8=Re("QUANTILE"),B8=Re("MODE"),P8=Re("REGR_INTERCEPT"),U8=Re("REGR_SLOPE"),z8=Re("REGR_COUNT"),j8=Re("REGR_SYY"),q8=Re("REGR_SXX"),Y8=Re("REGR_AVGX"),xw=Re("ARG_MIN"),Sw=Re("ARG_MAX");function V8(e,t){const n=Gt(e),i=q`CAST(${n} AS ${t})`;return Object.defineProperty(i,"label",{enumerable:!0,get(){return e.label}}),Object.defineProperty(i,"aggregate",{enumerable:!0,get(){return e.aggregate||!1}}),i}const Ew=e=>V8(e,"DOUBLE"),MS=e=>{const t=Gt(e);return q`(1000 * (epoch(${t}) - second(${t})) + millisecond(${t}))::DOUBLE`},W8=e=>{const t=Gt(e);return q`MAKE_DATE(2012, MONTH(${t}), 1)`.annotate({label:"month"})},G8=e=>{const t=Gt(e);return q`MAKE_DATE(2012, MONTH(${t}), DAY(${t}))`.annotate({label:"date"})},H8=e=>{const t=Gt(e);return q`MAKE_DATE(2012, 1, DAY(${t}))`.annotate({label:"date"})};class St{static select(...t){return new St().select(...t)}static from(...t){return new St().from(...t)}static with(...t){return new St().with(...t)}static union(...t){return new Rs("UNION",t.flat())}static unionAll(...t){return new Rs("UNION ALL",t.flat())}static intersect(...t){return new Rs("INTERSECT",t.flat())}static except(...t){return new Rs("EXCEPT",t.flat())}constructor(){this.query={with:[],select:[],from:[],where:[],groupby:[],having:[],window:[],qualify:[],orderby:[]}}clone(){const t=new St;return t.query={...this.query},t}with(...t){const{query:n}=this;if(t.length===0)return n.with;{const i=[],r=(s,o)=>{const a=o.clone();a.cteFor=this,i.push({as:s,query:a})};return t.flat().forEach(s=>{if(s!=null)if(s.as&&s.query)r(s.as,s.query);else for(const o in s)r(o,s[o])}),n.with=n.with.concat(i),this}}select(...t){const{query:n}=this;if(t.length===0)return n.select;{const i=[];for(const r of t.flat())if(r!=null)if(typeof r=="string")i.push({as:r,expr:Gt(r)});else if(r instanceof Gr)i.push({as:r.column,expr:r});else if(Array.isArray(r))i.push({as:r[0],expr:r[1]});else for(const s in r)i.push({as:yu(s),expr:Gt(r[s])});return n.select=n.select.concat(i),this}}$select(...t){return this.query.select=[],this.select(...t)}distinct(t=!0){return this.query.distinct=!!t,this}from(...t){const{query:n}=this;if(t.length===0)return n.from;{const i=[];return t.flat().forEach(r=>{if(r!=null)if(typeof r=="string")i.push({as:r,from:nf(r)});else if(r instanceof Gr)i.push({as:r.table,from:r});else if(Wp(r)||vS(r))i.push({from:r});else if(Array.isArray(r))i.push({as:yu(r[0]),from:nf(r[1])});else for(const s in r)i.push({as:yu(s),from:nf(r[s])})}),n.from=n.from.concat(i),this}}$from(...t){return this.query.from=[],this.from(...t)}sample(t,n){const{query:i}=this;if(arguments.length===0)return i.sample;{let r=t;return typeof t=="number"&&(r=t>0&&t<1?{perc:100*t,method:n}:{rows:Math.round(t),method:n}),i.sample=r,this}}where(...t){const{query:n}=this;return t.length===0?n.where:(n.where=n.where.concat(t.flat().filter(i=>i)),this)}$where(...t){return this.query.where=[],this.where(...t)}groupby(...t){const{query:n}=this;return t.length===0?n.groupby:(n.groupby=n.groupby.concat(t.flat().filter(i=>i).map(Gt)),this)}$groupby(...t){return this.query.groupby=[],this.groupby(...t)}having(...t){const{query:n}=this;return t.length===0?n.having:(n.having=n.having.concat(t.flat().filter(i=>i)),this)}window(...t){const{query:n}=this;if(t.length===0)return n.window;{const i=[];return t.flat().forEach(r=>{if(r!=null)for(const s in r)i.push({as:yu(s),expr:r[s]})}),n.window=n.window.concat(i),this}}qualify(...t){const{query:n}=this;return t.length===0?n.qualify:(n.qualify=n.qualify.concat(t.flat().filter(i=>i)),this)}orderby(...t){const{query:n}=this;return t.length===0?n.orderby:(n.orderby=n.orderby.concat(t.flat().filter(i=>i).map(Gt)),this)}limit(t){const{query:n}=this;return arguments.length===0?n.limit:(n.limit=Number.isFinite(t)?t:void 0,this)}offset(t){const{query:n}=this;return arguments.length===0?n.offset:(n.offset=Number.isFinite(t)?t:void 0,this)}get subqueries(){const{query:t,cteFor:n}=this,i=((n==null?void 0:n.query)||t).with,r=i==null?void 0:i.reduce((o,{as:a,query:c})=>(o[a]=c,o),{}),s=[];return t.from.forEach(({from:o})=>{if(Wp(o))s.push(o);else if(r[o.table]){const a=r[o.table];s.push(a)}}),s}toString(){const{select:t,distinct:n,from:i,sample:r,where:s,groupby:o,having:a,window:c,qualify:l,orderby:u,limit:h,offset:f,with:d}=this.query,p=[];if(d.length){const m=d.map(({as:g,query:b})=>`"${g}" AS (${b})`);p.push(`WITH ${m.join(", ")}`)}const y=t.map(({as:m,expr:g})=>h8(g,m)&&!g.table?`${g}`:`${g} AS "${m}"`);if(p.push(`SELECT${n?" DISTINCT":""} ${y.join(", ")}`),i.length){const m=i.map(({as:g,from:b})=>{const w=Wp(b)?`(${b})`:`${b}`;return!g||g===b.table?w:`${w} AS "${g}"`});p.push(`FROM ${m.join(", ")}`)}if(s.length){const m=s.map(String).filter(g=>g).join(" AND ");m&&p.push(`WHERE ${m}`)}if(r){const{rows:m,perc:g,method:b,seed:w}=r,_=m?`${m} ROWS`:`${g} PERCENT`,x=b?` (${b}${w!=null?`, ${w}`:""})`:"";p.push(`USING SAMPLE ${_}${x}`)}if(o.length&&p.push(`GROUP BY ${o.join(", ")}`),a.length){const m=a.map(String).filter(g=>g).join(" AND ");m&&p.push(`HAVING ${m}`)}if(c.length){const m=c.map(({as:g,expr:b})=>`"${g}" AS (${b})`);p.push(`WINDOW ${m.join(", ")}`)}if(l.length){const m=l.map(String).filter(g=>g).join(" AND ");m&&p.push(`QUALIFY ${m}`)}return u.length&&p.push(`ORDER BY ${u.join(", ")}`),Number.isFinite(h)&&p.push(`LIMIT ${h}`),Number.isFinite(f)&&p.push(`OFFSET ${f}`),p.join(" ")}}class Rs{constructor(t,n){this.op=t,this.queries=n.map(i=>i.clone()),this.query={orderby:[]}}clone(){const t=new Rs(this.op,this.queries);return t.query={...this.query},t}orderby(...t){const{query:n}=this;return t.length===0?n.orderby:(n.orderby=n.orderby.concat(t.flat().filter(i=>i).map(Gt)),this)}limit(t){const{query:n}=this;return arguments.length===0?n.limit:(n.limit=Number.isFinite(t)?t:void 0,this)}offset(t){const{query:n}=this;return arguments.length===0?n.offset:(n.offset=Number.isFinite(t)?t:void 0,this)}get subqueries(){const{queries:t,cteFor:n}=this;return n&&t.forEach(i=>i.cteFor=n),t}toString(){const{op:t,queries:n,query:{orderby:i,limit:r,offset:s}}=this,o=[n.join(` ${t} `)];return i.length&&o.push(`ORDER BY ${i.join(", ")}`),Number.isFinite(r)&&o.push(`LIMIT ${r}`),Number.isFinite(s)&&o.push(`OFFSET ${s}`),o.join(" ")}}function Wp(e){return e instanceof St||e instanceof Rs}function yu(e){return X8(e)?e.slice(1,-1):e}function X8(e){return e[0]==='"'&&e[e.length-1]==='"'}function yd(e,t,{replace:n=!1,temp:i=!0,view:r=!1}={}){return"CREATE"+(n?" OR REPLACE ":" ")+(i?"TEMP ":"")+(r?"VIEW":"TABLE")+(n?" ":" IF NOT EXISTS ")+e+" AS "+t}function K8(e,{columns:t=Object.keys((e==null?void 0:e[0])||{})}={}){let n=[];if(Array.isArray(t)?(n=t,t=n.reduce((r,s)=>(r[s]=s,r),{})):t&&(n=Object.keys(t)),!n.length)throw new Error("Can not create table from empty column set.");const i=[];for(const r of e){const s=n.map(o=>`${kl(r[o])} AS "${t[o]}"`);i.push(`(SELECT ${s.join(", ")})`)}return i.join(" UNION ALL ")}function wg(e,t,n,i={},r={}){const{select:s=["*"],where:o,view:a,temp:c,replace:l,...u}=i,h=eO({...r,...u}),f=`${e}('${n}'${h?", "+h:""})`,d=o?` WHERE ${o}`:"",p=`SELECT ${s.join(", ")} FROM ${f}${d}`;return yd(t,p,{view:a,temp:c,replace:l})}function Q8(e,t,n){return wg("read_csv",e,t,n,{auto_detect:!0,sample_size:-1})}function J8(e,t,n){return wg("read_json",e,t,n,{auto_detect:!0,json_format:"auto"})}function Z8(e,t,n){return wg("read_parquet",e,t,n)}function tO(e,t,n={}){const{select:i=["*"],...r}=n,s=K8(t),o=i.length===1&&i[0]==="*"?s:`SELECT ${i} FROM ${s}`;return yd(e,o,r)}function eO(e){return Object.entries(e).map(([t,n])=>{const i=typeof n,r=i==="boolean"?String(n):i==="string"?`'${n}'`:n;return`${t}=${r}`}).join(", ")}function nO(e){switch(e){case"BIGINT":case"HUGEINT":case"INTEGER":case"SMALLINT":case"TINYINT":case"UBIGINT":case"UINTEGER":case"USMALLINT":case"UTINYINT":case"DOUBLE":case"FLOAT":case"REAL":case"DECIMAL":return"number";case"DATE":case"TIMESTAMP":case"TIMESTAMPTZ":case"TIME":return"date";case"BOOLEAN":return"boolean";case"VARCHAR":case"UUID":return"string";case"LIST":return"array";case"BLOB":case"STRUCT":case"MAP":return"object";default:throw new Error(`Unsupported type: ${e}`)}}const iO="count",rO="nulls",sO="max",oO="min",aO="distinct",cO={[iO]:js,[aO]:e=>js(e).distinct(),[sO]:ya,[oO]:ma,[rO]:e=>js().where(TS(e))};function lO({table:e,column:t},n){return St.from(e).select(n.map(i=>[i,cO[i](t)]))}const NS=()=>Object.create(null);class uO{constructor(t){this.mc=t,this.clear()}clear(){this.tables=NS()}tableInfo(t){const n=this.tables;if(n[t])return n[t];const i=fO(this.mc,t).catch(r=>{throw n[t]=null,r});return n[t]=i}async fieldInfo({table:t,column:n,stats:i}){const s=(await this.tableInfo(t))[n];if(s==null)return;if(!(i!=null&&i.length))return s;const o=await this.mc.query(lO(s,i),{persist:!0}),a={...s,...Array.from(o)[0]};for(const c in a){const l=a[c];typeof l=="bigint"&&(a[c]=Number(l))}return a}async queryFields(t){const n=await hO(this,t);return(await Promise.all(n.map(r=>this.fieldInfo(r)))).filter(r=>r)}}async function fO(e,t){const n=await e.query(`DESCRIBE ${nf(t)}`,{type:"json",cache:!1}),i=NS();for(const r of n)i[r.column_name]={table:t,column:r.column_name,sqlType:r.column_type,type:nO(r.column_type),nullable:r.null==="YES"};return i}async function hO(e,t){return t.length===1&&t[0].column==="*"?Object.values(await e.tableInfo(t[0].table)):t}function dO(e){let t=2166136261;for(let n=0,i=e.length;n<i;++n){const r=e.charCodeAt(n),s=r&65280;s&&(t=Aw(t^s>>8)),t=Aw(t^r&255)}return pO(t)}function Aw(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}function pO(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,e+=e<<5,e&4294967295}const $S=e=>e;class yO{constructor(t,{selection:n,temp:i=!0}){this.mc=t,this.selection=n,this.temp=i,this.reset()}reset(){this.enabled=!1,this.clients=null,this.indices=null,this.activeView=null}clear(){this.indices&&(this.mc.cancel(Array.from(this.indices.values(),t=>t.result)),this.indices=null)}index(t,n){var l,u;if(this.clients!==t){const h=Array.from(t,Iw),f=(l=h[0])==null?void 0:l.from;this.enabled=h.every(d=>d&&d.from===f),this.clients=t,this.activeView=null,this.clear()}if(!this.enabled)return!1;n=n||this.selection.active;const{source:i}=n;if(i&&i===((u=this.activeView)==null?void 0:u.source))return!0;if(this.clear(),!i)return!1;const r=this.activeView=mO(n);if(!r)return!1;this.mc.logger().warn("DATA CUBE INDEX CONSTRUCTION");const s=this.selection.remove(i),o=this.indices=new Map,{mc:a,temp:c}=this;for(const h of t){if(s.skip(h,n))continue;const f=Iw(h),d=h.query(s.predicate(h)).select({...r.columns,...f.count}).groupby(Object.keys(r.columns)),[p]=d.subqueries;if(p){const w=Object.values(r.columns).map(_=>_.columns[0]);wO(p,w)}const y=d.toString(),g=`cube_index_${(dO(y)>>>0).toString(16)}`,b=a.exec(yd(g,y,{temp:c}));o.set(h,{table:g,result:b,...f})}}async update(){const{clients:t,selection:n,activeView:i}=this,r=i.predicate(n.active.predicate);return Promise.all(Array.from(t).map(s=>this.updateClient(s,r)))}async updateClient(t,n){const i=this.indices.get(t);if(!i)return;n||(n=this.activeView.predicate(this.selection.active.predicate));const{table:r,dims:s,aggr:o}=i,a=St.select(s,o).from(r).groupby(s).where(n);return this.mc.updateClient(t,a)}}function mO(e){var c;const{source:t,schema:n}=e;let i=(c=e.predicate)==null?void 0:c.columns;if(!n||!i)return null;const{type:r,scales:s,pixelSize:o=1}=n;let a;if(r==="interval"&&s){const l=s.map(u=>gO(u,o));if(l.some(u=>u==null))return null;l.length===1?(a=u=>u?wn("active0",u.range.map(l[0])):[],i={active0:l[0](e.predicate.field)}):(a=u=>u?Hs(u.children.map(({range:h},f)=>wn(`active${f}`,h.map(l[f])))):[],i=Object.fromEntries(e.predicate.children.map((u,h)=>[`active${h}`,l[h](u.field)])))}else if(r==="point")a=$S,i=Object.fromEntries(i.map(l=>[l.toString(),l]));else return null;return{source:t,columns:i,predicate:a}}function gO(e,t){const{type:n,domain:i,range:r}=e;let s,o;switch(n){case"linear":s=$S,o=Gt;break;case"log":s=Math.log,o=a=>q`LN(${Gt(a)})`;break;case"symlog":s=a=>Math.sign(a)*Math.log1p(Math.abs(a)),o=a=>(a=Gt(a),q`SIGN(${a}) * LN(1 + ABS(${a}))`);break;case"sqrt":s=Math.sqrt,o=a=>q`SQRT(${Gt(a)})`;break;case"utc":case"time":s=a=>+a,o=a=>a instanceof Date?+a:MS(Gt(a));break}return s?bO(i,r,t,s,o):null}function bO(e,t,n,i,r){const s=i(Math.min(e[0],e[1])),o=i(Math.max(e[0],e[1])),a=Math.abs(i(t[1])-i(t[0]))/(o-s)/n,c=n===1?"":`${n}::INTEGER * `;return l=>q`${c}FLOOR(${a}::DOUBLE * (${r(l)} - ${s}::DOUBLE))::INTEGER`}const Tw={from:NaN};function Iw(e){if(!e.filterIndexable)return Tw;const t=e.query(),n=w0(t);if(!n||!t.groupby)return Tw;const i=new Set(t.groupby().map(a=>a.column)),r=[],s=[];let o;for(const{as:a,expr:{aggregate:c}}of t.select())switch(c==null?void 0:c.toUpperCase()){case"COUNT":case"SUM":r.push({[a]:q`SUM("${a}")::DOUBLE`});break;case"AVG":o="_count_",r.push({[a]:q`(SUM("${a}" * ${o}) / SUM(${o}))::DOUBLE`});break;case"MAX":r.push({[a]:q`MAX("${a}")`});break;case"MIN":r.push({[a]:q`MIN("${a}")`});break;default:if(i.has(a))s.push(a);else return null}return{aggr:r,dims:s,count:o?{[o]:q`COUNT(*)`}:{},from:n}}function w0(e){const t=e.subqueries;if(e.select){const i=e.from();if(!i.length)return;if(t.length===0)return i[0].from.table}const n=w0(t[0]);for(let i=1;i<t.length;++i){const r=w0(t[i]);if(r!==void 0&&r!==n)return NaN}return n}function wO(e,t){const n=new Set,i=r=>{n.has(r)||(n.add(r),r.select&&r.from().length&&r.select(t),r.subqueries.forEach(i))};i(e)}class _O{constructor(t,n,i=!0){this.mc=t,this.selection=n,this.clients=new Set,this.indexer=i?new yO(this.mc,{...i,selection:n}):null;const{value:r,activate:s}=this.handlers={value:()=>this.update(),activate:o=>{var a;return(a=this.indexer)==null?void 0:a.index(this.clients,o)}};n.addEventListener("value",r),n.addEventListener("activate",s)}finalize(){const{value:t,activate:n}=this.handlers;this.selection.removeEventListener("value",t),this.selection.removeEventListener("activate",n)}reset(){var t;(t=this.indexer)==null||t.reset()}add(t){return(this.clients=new Set(this.clients)).add(t),this}remove(t){return this.clients.has(t)&&(this.clients=new Set(this.clients)).delete(t),this}update(){const{mc:t,indexer:n,clients:i,selection:r}=this;return n!=null&&n.index(i)?n.update():vO(t,i,r)}}function vO(e,t,n){return Promise.all(Array.from(t).map(i=>{const r=n.predicate(i);if(r!=null)return e.updateClient(i,i.query(r))}))}function kS(){let e,t;const n=new Promise((i,r)=>{e=i,t=r});return n.fulfill=i=>(e(i),n),n.reject=i=>(t(i),n),n}function xO(e,t,n){let i=[],r=0;function s(){const o=SO(i,t);i=[],r=0;for(const a of o)AO(a,e,n),MO(a,t)}return{add(o,a){o.request.type==="arrow"?(r=r||requestAnimationFrame(()=>s()),i.push({entry:o,priority:a,index:i.length})):e(o,a)}}}function SO(e,t){const n=[],i=new Map;for(const r of e){const{entry:{request:s}}=r,o=EO(s.query,t);if(!i.has(o)){const a=[];n.push(a),i.set(o,a)}i.get(o).push(r)}return n}function EO(e,t){const n=`${e}`;if(e instanceof St&&!t.get(n)){if(e.orderby().length||e.where().length||e.qualify().length||e.having().length)return n;const i=e.clone().$select("*"),r=e.groupby();if(r.length){const s={};e.select().forEach(({as:o,expr:a})=>s[o]=a),i.$groupby(r.map(o=>o instanceof Gr&&s[o.column]||o))}return`${i}`}else return n}function AO(e,t,n){if(TO(e))t({request:{type:"arrow",cache:!1,record:!1,query:IO(e,n)},result:e.result=kS()});else for(const{entry:i,priority:r}of e)t(i,r)}function TO(e){if(e.length>1){const t=`${e[0].entry.request.query}`;for(let n=1;n<e.length;++n)if(t!==`${e[n].entry.request.query}`)return!0}return!1}function IO(e,t){const n=e.maps=[],i=new Map;for(const o of e){const{query:a}=o.entry.request,c=[];n.push(c);for(const{as:l,expr:u}of a.select()){const h=`${u}`;i.has(h)||i.set(h,[`col${i.size}`,u]);const[f]=i.get(h);c.push([f,l])}t(`${a}`)}const r=e[0].entry.request.query.clone(),s=r.groupby();if(s.length){const o={};e.maps[0].forEach(([a,c])=>o[c]=a),r.$groupby(s.map(a=>a instanceof Gr&&o[a.column]||a))}return r.$select(Array.from(i.values()))}async function MO(e,t){const{maps:n,result:i}=e;if(!n)return;let r;try{r=await i}catch(s){for(const{entry:o}of e)o.result.reject(s);return}e.forEach(({entry:s},o)=>{const{request:a,result:c}=s,l=NO(r,n[o]);a.cache&&t.set(String(a.query),l),c.fulfill(l)})}function NO(e,t){if(t){const n={};for(const[i,r]of t)n[r]=e.getChild(i);return new e.constructor(n)}else return e}const $O=typeof requestIdleCallback<"u"?requestIdleCallback:setTimeout,kO=()=>({get:()=>{},set:(e,t)=>t,clear:()=>{}});function OO({max:e=1e3,ttl:t=3*60*60*1e3}={}){let n=new Map;function i(){const r=performance.now()-t;let s=null,o=1/0;for(const[a,c]of n){const{last:l}=c;l<o&&(s=a,o=l),r>l&&n.delete(a)}s&&n.delete(s)}return{get(r){const s=n.get(r);if(s)return s.last=performance.now(),s.value},set(r,s){return n.set(r,{last:performance.now(),value:s}),n.size>e&&$O(i),s},clear(){n=new Map}}}function LO(e){const t=Array.from({length:e},()=>({head:null,tail:null}));return{isEmpty(){return t.every(n=>!n.head)},insert(n,i){const r=t[i];if(!r)throw new Error(`Invalid queue priority rank: ${i}`);const s={item:n,next:null};r.head===null?r.head=r.tail=s:r.tail=r.tail.next=s},remove(n){for(const i of t){let{head:r,tail:s}=i;for(let o=null,a=r;a;o=a,a=a.next)n(a.item)&&(a===r?r=a.next:o.next=a.next,a===s&&(s=o||r));i.head=r,i.tail=s}},next(){for(const n of t){const{head:i}=n;if(i!==null)return n.head=i.next,n.tail===i&&(n.tail=null),i.item}}}}const Tr={High:0,Normal:1,Low:2};function RO(){const e=LO(3);let t,n,i,r=[],s=null,o;function a(){if(s||e.isEmpty())return;const{request:h,result:f}=e.next();s=u(h,f),s.finally(()=>{s=null,a()})}function c(h,f=Tr.Normal){e.insert(h,f),a()}function l(h){r.length&&h&&r.forEach(f=>f.add(h))}async function u(h,f){try{const{query:d,type:p,cache:y=!1,record:m=!0,options:g}=h,b=d?`${d}`:null;if(m&&l(b),y){const x=n.get(b);if(x){i.debug("Cache"),f.fulfill(x);return}}const w=performance.now(),_=await t.query({type:p,sql:b,...g});y&&n.set(b,_),i.debug(`Request: ${(performance.now()-w).toFixed(1)}`),f.fulfill(_)}catch(d){f.reject(d)}}return{cache(h){return h!==void 0?n=h===!0?OO():h||kO():n},logger(h){return h?i=h:i},connector(h){return h?t=h:t},consolidate(h){h&&!o?o=xO(c,n,l):!h&&o&&(o=null)},request(h,f=Tr.Normal){const d=kS(),p={request:h,result:d};return o?o.add(p,f):c(p,f),d},cancel(h){const f=new Set(h);e.remove(({result:d})=>f.has(d))},clear(){e.remove(({result:h})=>(h.reject("Cleared"),!0))},record(){let h=[];const f={add(d){h.push(d)},reset(){h=[]},snapshot(){return h.slice()},stop(){return r=r.filter(d=>d!==f),h}};return r.push(f),f}}}function FO(){return{debug(){},info(){},log(){},warn(){},error(){}}}let mu;function as(e){return e?mu=e:mu==null&&(mu=new DO),mu}class DO{constructor(t=f8(),n={}){this.catalog=new uO(this),this.manager=n.manager||RO(),this.logger(n.logger||console),this.configure(n),this.databaseConnector(t),this.clear()}logger(t){return arguments.length&&(this._logger=t||FO(),this.manager.logger(this._logger)),this._logger}configure({cache:t=!0,consolidate:n=!0,indexes:i=!0}){this.manager.cache(t),this.manager.consolidate(n),this.indexes=i}clear({clients:t=!0,cache:n=!0,catalog:i=!1}={}){var r,s;this.manager.clear(),t&&((r=this.clients)==null||r.forEach(o=>this.disconnect(o)),(s=this.filterGroups)==null||s.forEach(o=>o.finalize()),this.clients=new Set,this.filterGroups=new Map),n&&this.manager.cache().clear(),i&&this.catalog.clear()}databaseConnector(t){return this.manager.connector(t)}cancel(t){this.manager.cancel(t)}exec(t,{priority:n=Tr.Normal}={}){return this.manager.request({type:"exec",query:t},n)}query(t,{type:n="arrow",cache:i=!0,priority:r=Tr.Normal,...s}={}){return this.manager.request({type:n,query:t,cache:i,options:s},r)}prefetch(t,n={}){return this.query(t,{...n,cache:!0,priority:Tr.Low})}createBundle(t,n,i=Tr.Low){const r={name:t,queries:n};return this.manager.request({type:"create-bundle",options:r},i)}loadBundle(t,n=Tr.High){const i={name:t};return this.manager.request({type:"load-bundle",options:i},n)}updateClient(t,n,i=Tr.Normal){return t.queryPending(),this.query(n,{priority:i}).then(r=>t.queryResult(r).update(),r=>{t.queryError(r),this._logger.error(r)})}requestQuery(t,n){var i;return(i=this.filterGroups.get(t.filterBy))==null||i.reset(),n?this.updateClient(t,n):t.update()}async connect(t){const{catalog:n,clients:i,filterGroups:r,indexes:s}=this;if(i.has(t))throw new Error("Client already connected.");i.add(t);const o=t.fields();o!=null&&o.length&&t.fieldInfo(await n.queryFields(o));const a=t.filterBy;if(a)if(r.has(a))r.get(a).add(t);else{const c=new _O(this,a,s);r.set(a,c.add(t))}t.requestQuery()}disconnect(t){var r;const{clients:n,filterGroups:i}=this;n.has(t)&&(n.delete(t),(r=i.get(t.filterBy))==null||r.remove(t))}}const Mw={};function OS(e,t=!1){let n,i,r=Mw;function s(l){n=e(l).then(()=>{if(i){const{value:u}=i;i=null,s(u)}else n=null})}function o(l){i={event:l}}function a(l){n?o(l):s(l)}function c(l){r!==l&&requestAnimationFrame(()=>{const u=r;r=Mw,a(u)}),r=l}return t?c:a}class Fl{constructor(t){this._filterBy=t,this._requestUpdate=OS(()=>this.requestQuery(),!0)}get filterBy(){return this._filterBy}get filterIndexable(){return!0}fields(){return null}fieldInfo(){return this}query(){return null}queryPending(){return this}queryResult(){return this}queryError(t){return console.error(t),this}requestQuery(t){var i;const n=t||this.query((i=this.filterBy)==null?void 0:i.predicate(this));return as().requestQuery(this,n)}requestUpdate(){this._requestUpdate()}update(){return this}}class CO{constructor(){this._callbacks=new Map}addEventListener(t,n){this._callbacks.has(t)||this._callbacks.set(t,{callbacks:new Set,pending:null,queue:new BO}),this._callbacks.get(t).callbacks.add(n)}removeEventListener(t,n){const i=this._callbacks.get(t);i&&i.callbacks.delete(n)}willEmit(t,n){return n}emitQueueFilter(){return null}cancel(t){const n=this._callbacks.get(t);n==null||n.queue.clear()}emit(t,n){const i=this._callbacks.get(t)||{};if(i.pending)i.queue.enqueue(n,this.emitQueueFilter(t,n));else{const r=this.willEmit(t,n),{callbacks:s,queue:o}=i;if(s!=null&&s.size){const a=Promise.allSettled(Array.from(s,c=>c(r))).then(()=>{i.pending=null,o.isEmpty()||this.emit(t,o.dequeue())});i.pending=a}}}}class BO{constructor(){this.clear()}clear(){this.next=null}isEmpty(){return!this.next}enqueue(t,n){const i={value:t};if(n&&this.next){let r=this;for(;r.next;)n(r.next.value)?r=r.next:r.next=r.next.next;r.next=i}else this.next=i}dequeue(){const{next:t}=this;return this.next=t==null?void 0:t.next,t==null?void 0:t.value}}function LS(e,t){return e===t?!1:e instanceof Date&&t instanceof Date?+e!=+t:Array.isArray(e)&&Array.isArray(t)?PO(e,t):!0}function PO(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!0;return!1}function Cr(e){return e instanceof or}class or extends CO{constructor(t){super(),this._value=t}static value(t){return new or(t)}static array(t){if(t.some(n=>Cr(n))){const n=new or,i=()=>n.update(t.map(r=>Cr(r)?r.value:r));return i(),t.forEach(r=>Cr(r)?r.addEventListener("value",i):0),n}return new or(t)}get value(){return this._value}update(t,{force:n}={}){return LS(this._value,t)||n?this.emit("value",t):this.cancel("value"),this}willEmit(t,n){return t==="value"&&(this._value=n),n}}function Xs(e){return e instanceof Lr}let Lr=class Ro extends or{static intersect({cross:t=!1}={}){return new Ro(new lc({cross:t}))}static union({cross:t=!1}={}){return new Ro(new lc({cross:t,union:!0}))}static single({cross:t=!1}={}){return new Ro(new lc({cross:t,single:!0}))}static crossfilter(){return new Ro(new lc({cross:!0}))}constructor(t=new lc){super([]),this._resolved=this._value,this._resolver=t}clone(){const t=new Ro(this._resolver);return t._value=t._resolved=this._value,t}remove(t){const n=this.clone();return n._value=n._resolved=n._resolver.resolve(this._resolved,{source:t}),n._value.active={source:t},n}get active(){return this.clauses.active}get value(){var t;return(t=this.active)==null?void 0:t.value}get clauses(){return super.value}get single(){return this._resolver.single}activate(t){this.emit("activate",t)}update(t){return this._resolved=this._resolver.resolve(this._resolved,t,!0),this._resolved.active=t,super.update(this._resolved)}willEmit(t,n){return t==="value"?(this._value=n,this.value):n}emitQueueFilter(t,n){return t==="value"?this._resolver.queueFilter(n):null}skip(t,n){return this._resolver.skip(t,n)}predicate(t){const{clauses:n}=this;return this._resolver.predicate(n,n.active,t)}};class lc{constructor({union:t,cross:n,single:i}={}){this.union=!!t,this.cross=!!n,this.single=!!i}resolve(t,n,i=!1){const{source:r,predicate:s}=n,o=t.filter(c=>r!==c.source),a=this.single?[]:o;return this.single&&i&&o.forEach(c=>{var l,u;return(u=(l=c.source)==null?void 0:l.reset)==null?void 0:u.call(l)}),s&&a.push(n),a}skip(t,n){var i;return this.cross&&((i=n==null?void 0:n.clients)==null?void 0:i.has(t))}predicate(t,n,i){const{union:r}=this;if(this.skip(i,n))return;const s=t.filter(o=>!this.skip(i,o)).map(o=>o.predicate);return r&&s.length>1?ES(s):s}queueFilter(t){var n;if(this.cross){const i=(n=t.active)==null?void 0:n.source;return r=>{var s;return((s=r.active)==null?void 0:s.source)!==i}}}}var UO=Object.create,RS=Object.defineProperty,zO=Object.getOwnPropertyDescriptor,jO=Object.getOwnPropertyNames,qO=Object.getPrototypeOf,YO=Object.prototype.hasOwnProperty,VO=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),WO=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of jO(t))!YO.call(e,r)&&r!==n&&RS(e,r,{get:()=>t[r],enumerable:!(i=zO(t,r))||i.enumerable});return e},GO=(e,t,n)=>(n=e!=null?UO(qO(e)):{},WO(t||!e||!e.__esModule?RS(n,"default",{value:e,enumerable:!0}):n,e)),HO=VO((e,t)=>{t.exports=Worker}),XO=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(XO||{}),KO=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(KO||{}),QO=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(QO||{}),JO=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(JO||{}),ZO=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(ZO||{}),tL=class{log(t){}},eL=class{constructor(e=2){this.level=e}log(e){e.level>=this.level&&console.log(e)}},nL=(e=>(e[e.SUCCESS=0]="SUCCESS",e))(nL||{}),iL=class{constructor(t,n){this._bindings=t,this._conn=n}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}async query(t){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let n=await this._bindings.runQuery(this._conn,t),i=mn.from(n);return console.assert(i.isSync(),"Reader is not sync"),console.assert(i.isFile(),"Reader is not file"),new Mi(i)}async send(t){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let n=await this._bindings.startPendingQuery(this._conn,t);for(;n==null;)n=await this._bindings.pollPendingQuery(this._conn);let i=new FS(this._bindings,this._conn,n),r=await mn.from(i);return console.assert(r.isAsync()),console.assert(r.isStream()),r}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(t){return await this._bindings.getTableNames(this._conn,t)}async prepare(t){let n=await this._bindings.createPrepared(this._conn,t);return new rL(this._bindings,this._conn,n)}async insertArrowTable(t,n){let i=u8(t,"stream");await this.insertArrowFromIPCStream(i,n)}async insertArrowFromIPCStream(t,n){await this._bindings.insertArrowFromIPCStream(this._conn,t,n)}async insertCSVFromPath(t,n){await this._bindings.insertCSVFromPath(this._conn,t,n)}async insertJSONFromPath(t,n){await this._bindings.insertJSONFromPath(this._conn,t,n)}},FS=class{constructor(e,t,n){this.db=e,this.conn=t,this.header=n,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},rL=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e),n=mn.from(t);return console.assert(n.isSync()),console.assert(n.isFile()),new Mi(n)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new FS(this.bindings,this.connectionId,t),i=await mn.from(n);return console.assert(i.isAsync()),console.assert(i.isStream()),i}},sL=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(sL||{}),oL=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(oL||{}),Mt=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((n,i)=>{this.promiseResolver=n,this.promiseRejecter=i})}};function rf(e){switch(e.typeId){case L.Binary:return{sqlType:"binary"};case L.Bool:return{sqlType:"bool"};case L.Date:return{sqlType:"date"};case L.DateDay:return{sqlType:"date32[d]"};case L.DateMillisecond:return{sqlType:"date64[ms]"};case L.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case L.Float:return{sqlType:"float"};case L.Float16:return{sqlType:"float16"};case L.Float32:return{sqlType:"float32"};case L.Float64:return{sqlType:"float64"};case L.Int:return{sqlType:"int32"};case L.Int16:return{sqlType:"int16"};case L.Int32:return{sqlType:"int32"};case L.Int64:return{sqlType:"int64"};case L.Uint16:return{sqlType:"uint16"};case L.Uint32:return{sqlType:"uint32"};case L.Uint64:return{sqlType:"uint64"};case L.Uint8:return{sqlType:"uint8"};case L.IntervalDayTime:return{sqlType:"interval[dt]"};case L.IntervalYearMonth:return{sqlType:"interval[m]"};case L.List:return{sqlType:"list",valueType:rf(e.valueType)};case L.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case L.Null:return{sqlType:"null"};case L.Utf8:return{sqlType:"utf8"};case L.Struct:return{sqlType:"struct",fields:e.children.map(t=>_0(t.name,t.type))};case L.Map:{let t=e;return{sqlType:"map",keyType:rf(t.keyType),valueType:rf(t.valueType)}}case L.Time:return{sqlType:"time[s]"};case L.TimeMicrosecond:return{sqlType:"time[us]"};case L.TimeMillisecond:return{sqlType:"time[ms]"};case L.TimeNanosecond:return{sqlType:"time[ns]"};case L.TimeSecond:return{sqlType:"time[s]"};case L.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case L.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case L.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case L.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case L.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error(`unsupported arrow type: ${e.toString()}`)}function _0(e,t){let n=rf(t);return n.name=e,n}var aL=new TextEncoder,cL=class{constructor(e,t=null){this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),t!=null&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((t,n)=>{this._workerShutdownResolver=t})}detach(){!this._worker||(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){!this._worker||(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data},t),await e.promise}onMessage(e){let t=e.data;switch(t.type){case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let i of this._onInstantiationProgress)i(t.data);return}}let n=this._pendingRequests.get(t.requestId);if(!n){console.warn(`unassociated response: [${t.requestId}, ${t.type.toString()}]`);return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let i=new Error(t.data.message);i.name=t.data.name,i.stack=t.data.stack,n.promiseRejecter(i);return}switch(n.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){n.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){n.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){n.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){n.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){n.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){n.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){n.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){n.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){n.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){n.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){n.promiseResolver(t.data);return}break;case"SEND_PREPARED":if(t.type=="QUERY_RESULT_HEADER"){n.promiseResolver(t.data);return}break;case"START_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){n.promiseResolver(t.data);return}break;case"POLL_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){n.promiseResolver(t.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],t.type=="SUCCESS"){n.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){n.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){n.promiseResolver(t.data);return}break}n.promiseRejecter(new Error(`unexpected response type: ${t.type.toString()}`))}onError(e){console.error(e),console.error(`error in duckdb worker: ${e.message}`),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);return}this._pendingRequests.clear()}async reset(){let e=new Mt("RESET",null);return await this.postTask(e)}async ping(){let e=new Mt("PING",null);await this.postTask(e)}async dropFile(e){let t=new Mt("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new Mt("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new Mt("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,n=i=>{}){this._onInstantiationProgress.push(n);let i=new Mt("INSTANTIATE",[e,t]);return await this.postTask(i)}async getVersion(){let e=new Mt("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new Mt("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new Mt("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new Mt("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new Mt("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new iL(this,e)}async disconnect(e){let t=new Mt("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let n=new Mt("RUN_QUERY",[e,t]);return await this.postTask(n)}async startPendingQuery(e,t){let n=new Mt("START_PENDING_QUERY",[e,t]);return await this.postTask(n)}async pollPendingQuery(e){let t=new Mt("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new Mt("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new Mt("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let n=new Mt("GET_TABLE_NAMES",[e,t]);return await this.postTask(n)}async createPrepared(e,t){let n=new Mt("CREATE_PREPARED",[e,t]);return await this.postTask(n)}async closePrepared(e,t){let n=new Mt("CLOSE_PREPARED",[e,t]);await this.postTask(n)}async runPrepared(e,t,n){let i=new Mt("RUN_PREPARED",[e,t,n]);return await this.postTask(i)}async sendPrepared(e,t,n){let i=new Mt("SEND_PREPARED",[e,t,n]);return await this.postTask(i)}async globFiles(e){let t=new Mt("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let n=aL.encode(t);await this.registerFileBuffer(e,n)}async registerFileURL(e,t,n,i){t===void 0&&(t=e);let r=new Mt("REGISTER_FILE_URL",[e,t,n,i]);await this.postTask(r)}async registerEmptyFileBuffer(e){let t=new Mt("REGISTER_FILE_BUFFER",[e,new Uint8Array]);await this.postTask(t)}async registerFileBuffer(e,t){let n=new Mt("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(n,[t.buffer])}async registerFileHandle(e,t,n,i){let r=new Mt("REGISTER_FILE_HANDLE",[e,t,n,i]);await this.postTask(r,[])}async collectFileStatistics(e,t){let n=new Mt("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(n,[])}async exportFileStatistics(e){let t=new Mt("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new Mt("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let n=new Mt("COPY_FILE_TO_PATH",[e,t]);await this.postTask(n)}async insertArrowFromIPCStream(e,t,n){if(t.length==0)return;let i=new Mt("INSERT_ARROW_FROM_IPC_STREAM",[e,t,n]);await this.postTask(i,[t.buffer])}async insertCSVFromPath(e,t,n){if(n.columns!==void 0){let r=[];for(let s in n.columns){let o=n.columns[s];r.push(_0(s,o))}n.columnsFlat=r,delete n.columns}let i=new Mt("IMPORT_CSV_FROM_PATH",[e,t,n]);await this.postTask(i)}async insertJSONFromPath(e,t,n){if(n.columns!==void 0){let r=[];for(let s in n.columns){let o=n.columns[s];r.push(_0(s,o))}n.columnsFlat=r,delete n.columns}let i=new Mt("IMPORT_JSON_FROM_PATH",[e,t,n]);await this.postTask(i)}},lL=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),uL=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),fL=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),hL=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),_g={name:"@duckdb/duckdb-wasm",version:"1.27.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^11.0.0"},devDependencies:{"@types/emscripten":"^1.39.6","@types/jasmine":"^4.3.1","@typescript-eslint/eslint-plugin":"^5.53.0","@typescript-eslint/parser":"^5.49.0",esbuild:"^0.15.12",eslint:"^8.35.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.32.2","fast-glob":"^3.2.12",jasmine:"^4.5.0","jasmine-core":"^5.0.0","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.9.0",karma:"^6.4.2","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-firefox-launcher":"^2.1.2","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.0.0","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"^0.0.36","make-dir":"^3.1.0",nyc:"^15.1.0",prettier:"^2.8.4",puppeteer:"^19.10.0",rimraf:"^4.3.0",s3rver:"^3.7.1",typedoc:"^0.24.8",typescript:"^4.8.4","wasm-feature-detect":"^1.5.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-blocking":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.mjs":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.cjs":"./dist/duckdb-browser-blocking.cjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{browser:{types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},dL=_g.name,pL=_g.version,vg=_g.version.split(".");vg[0];vg[1];vg[2];var yL=()=>typeof navigator>"u";function mL(){let e=`https://cdn.jsdelivr.net/npm/${dL}@${pL}/dist/`;return{mvp:{mainModule:`${e}duckdb-mvp.wasm`,mainWorker:`${e}duckdb-browser-mvp.worker.js`},eh:{mainModule:`${e}duckdb-eh.wasm`,mainWorker:`${e}duckdb-browser-eh.worker.js`}}}var Gp=null,Hp=null,Xp=null,Kp=null,Qp=null;async function gL(){return Gp==null&&(Gp=typeof BigInt64Array<"u"),Hp==null&&(Hp=await uL()),Xp==null&&(Xp=await hL()),Kp==null&&(Kp=await fL()),Qp==null&&(Qp=await lL()),{bigInt64Array:Gp,crossOriginIsolated:yL()||globalThis.crossOriginIsolated||!1,wasmExceptions:Hp,wasmSIMD:Kp,wasmThreads:Xp,wasmBulkMemory:Qp}}async function bL(e){let t=await gL();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}GO(HO());function wL(){let e=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),e.decode(t))}wL();var _L=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(_L||{});async function vL(e){const t=await xL(e),n=await t.connect();return{db:t,con:n,query:async i=>{const{type:r,sql:s}=i,o=await n.query(s);return r==="exec"?void 0:r==="arrow"?o:Array.from(o)}}}async function xL({log:e=!1}={}){const t=mL(),n=await bL(t),i=URL.createObjectURL(new Blob([`importScripts("${n.mainWorker}");`],{type:"text/javascript"})),r=new Worker(i),s=e?new eL:new tL,o=new cL(s,r);return await o.instantiate(n.mainModule,n.pthreadWorker),URL.revokeObjectURL(i),o}function SL(){const e=new Set;let t,n=new Promise(i=>t=i);return{pending(i){e.add(i)},ready(i){return e.delete(i),e.size===0},resolve(){n=new Promise(i=>{t(),t=i})},get promise(){return n}}}function md(e,t){const n=new e(t);return as().connect(n),n.element}const EL=e=>e&&typeof e=="object"&&!Array.isArray(e),AL=e=>md(TL,e);class TL extends Fl{constructor({element:t,filterBy:n,from:i,column:r,label:s=r,format:o=u=>u,options:a,value:c,as:l}={}){var h,f,d,p;super(n),this.from=i,this.column=r,this.selection=l,this.format=o,this.element=t??document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this;const u=document.createElement("label");u.innerText=s||r,this.element.appendChild(u),this.select=document.createElement("select"),a&&(this.data=a.map(y=>EL(y)?y:{value:y}),this.update()),c=c??((h=this.selection)==null?void 0:h.value)??((d=(f=this.data)==null?void 0:f[0])==null?void 0:d.value),((p=this.selection)==null?void 0:p.value)===void 0&&this.publish(c),this.element.appendChild(this.select),this.selection&&(this.select.addEventListener("input",()=>{this.publish(this.selectedValue()??null)}),Xs(this.selection)||this.selection.addEventListener("value",y=>{y!==this.select.value&&this.selectedValue(y)}))}selectedValue(t){var n;if(arguments.length===0){const i=this.select.selectedIndex;return this.data[i].value}else{const i=(n=this.data)==null?void 0:n.findIndex(r=>r.value===t);i>=0?this.select.selectedIndex=i:this.select.value=String(t)}}reset(){this.select.selectedIndex=this.from?0:-1}publish(t){const{selection:n,column:i}=this;Xs(n)?n.update({source:this,schema:{type:"point"},value:t,predicate:t?pd(i,Ol(t)):null}):Cr(n)&&n.update(t)}query(t=[]){const{from:n,column:i}=this;return n?St.from(n).select({value:i}).distinct().where(t).orderby(i):null}queryResult(t){return this.data=[{value:"",label:"All"},...t],this}update(){var r;const{data:t,format:n,select:i}=this;i.replaceChildren();for(const{value:s,label:o}of t){const a=document.createElement("option");a.setAttribute("value",s),a.innerText=o??n(s),this.select.appendChild(a)}return this.selection&&this.selectedValue(((r=this.selection)==null?void 0:r.value)??""),this}}const IL={contains:w8,prefix:_8,suffix:v8,regexp:b8};let ML=0;const NL=e=>md($L,e);class $L extends Fl{constructor({element:t,filterBy:n,from:i,column:r,label:s,type:o="contains",as:a}={}){if(super(n),this.id="search_"+ ++ML,this.type=o,this.from=i,this.column=r,this.selection=a,this.element=t??document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this,s){const c=document.createElement("label");c.setAttribute("for",this.id),c.innerText=s,this.element.appendChild(c)}this.searchbox=document.createElement("input"),this.searchbox.setAttribute("id",this.id),this.searchbox.setAttribute("type","text"),this.searchbox.setAttribute("placeholder","Query"),this.element.appendChild(this.searchbox),this.selection&&(this.searchbox.addEventListener("input",()=>{this.publish(this.searchbox.value||null)}),Xs(this.selection)||this.selection.addEventListener("value",c=>{c!==this.searchbox.value&&(this.searchbox.value=c)}))}reset(){this.searchbox.value=""}publish(t){const{selection:n,column:i,type:r}=this;Xs(n)?n.update({source:this,schema:{type:r},value:t,predicate:t?IL[r](i,Ol(t)):null}):Cr(n)&&n.update(t)}query(t=[]){const{from:n,column:i}=this;return n?St.from(n).select({list:i}).distinct().where(t):null}queryResult(t){return this.data=t,this}update(){const t=document.createElement("datalist"),n=`${this.id}_list`;t.setAttribute("id",n);for(const i of this.data){const r=document.createElement("option");r.setAttribute("value",i.list),t.append(r)}return this.datalist&&this.datalist.remove(),this.element.appendChild(this.datalist=t),this.searchbox.setAttribute("list",n),this}}let kL=0;const OL=e=>md(LL,e);class LL extends Fl{constructor({element:t,filterBy:n,as:i,min:r,max:s,step:o,from:a,column:c,label:l=c,value:u=i==null?void 0:i.value,width:h}={}){var f;if(super(n),this.id="slider_"+ ++kL,this.from=a,this.column=c||"value",this.selection=i,this.min=r,this.max=s,this.step=o,this.element=t||document.createElement("div"),this.element.setAttribute("class","input"),this.element.value=this,l){const d=document.createElement("label");d.setAttribute("for",this.id),d.innerText=l,this.element.appendChild(d)}this.slider=document.createElement("input"),this.slider.setAttribute("id",this.id),this.slider.setAttribute("type","range"),h!=null&&(this.slider.style.width=`${+h}px`),r!=null&&this.slider.setAttribute("min",r),s!=null&&this.slider.setAttribute("max",s),o!=null&&this.slider.setAttribute("step",o),u!=null&&(this.slider.setAttribute("value",u),((f=this.selection)==null?void 0:f.value)===void 0&&this.publish(u)),this.element.appendChild(this.slider),this.selection&&(this.slider.addEventListener("input",()=>{this.publish(+this.slider.value)}),Xs(this.selection)||this.selection.addEventListener("value",d=>{d!==+this.slider.value&&(this.slider.value=d)}))}query(t=[]){const{from:n,column:i}=this;return!n||this.min!=null&&this.max!=null?null:St.select({min:ma(i),max:ya(i)}).from(n).where(t)}queryResult(t){const{min:n,max:i}=Array.from(t)[0];return this.min==null&&this.slider.setAttribute("min",n),this.max==null&&this.slider.setAttribute("max",i),this.step==null&&this.slider.setAttribute("step",(i-n)/500),this}publish(t){const{selection:n,column:i}=this;Xs(n)?n.update({source:this,schema:{type:"point"},value:t,predicate:pd(i,Ol(t))}):Cr(this.selection)&&n.update(t)}}function DS(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),i=e.getUTCMinutes(),r=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${RL(e.getUTCFullYear())}-${Ki(e.getUTCMonth()+1,2)}-${Ki(e.getUTCDate(),2)}${n||i||r||s?`T${Ki(n,2)}:${Ki(i,2)}${r||s?`:${Ki(r,2)}${s?`.${Ki(s,3)}`:""}`:""}Z`:""}`}function RL(e){return e<0?`-${Ki(-e,6)}`:e>9999?`+${Ki(e,6)}`:Ki(e,4)}function Ki(e,t){return`${e}`.padStart(t,"0")}const FL=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function xg(e,t){return FL.test(e+="")?new Date(e):typeof t=="function"?t(e):t}const CS=Eg(e=>{const t=Sg(e);return n=>n==null?"":typeof n=="number"?t(n):n instanceof Date?BS(n):`${n}`}),Sg=Eg(e=>t=>t===0?"0":t.toLocaleString(e));CS();Sg();function BS(e){return DS(e,"Invalid Date")}function Eg(e){let t=Eg,n;return(i="en")=>i===t?n:n=e(t=i)}let DL=-1;const CL=e=>md(BL,e);class BL extends Fl{constructor({element:t,filterBy:n,from:i,columns:r=["*"],align:s={},format:o,width:a,maxWidth:c,height:l=500,rowBatch:u=100}={}){super(n),this.id=`table-${++DL}`,this.from=i,this.columns=r,this.format=o,this.align=s,this.widths=typeof a=="object"?a:{},this.offset=0,this.limit=+u,this.pending=!1,this.sortHeader=null,this.sortColumn=null,this.sortDesc=!1,this.element=t||document.createElement("div"),this.element.setAttribute("id",this.id),this.element.value=this,typeof a=="number"&&(this.element.style.width=`${a}px`),c&&(this.element.style.maxWidth=`${c}px`),this.element.style.maxHeight=`${l}px`,this.element.style.overflow="auto";let h=-1;this.element.addEventListener("scroll",f=>{const{pending:d,loaded:p}=this,{scrollHeight:y,scrollTop:m,clientHeight:g}=f.target,b=m<h;h=m,!(b||d||p)&&y-m<2*g&&(this.pending=!0,this.requestData(this.offset+this.limit))}),this.tbl=document.createElement("table"),this.element.appendChild(this.tbl),this.head=document.createElement("thead"),this.tbl.appendChild(this.head),this.body=document.createElement("tbody"),this.tbl.appendChild(this.body),this.style=document.createElement("style"),this.element.appendChild(this.style)}requestData(t=0){var i;this.offset=t;const n=this.query((i=this.filterBy)==null?void 0:i.predicate(this));this.requestQuery(n),as().prefetch(n.clone().offset(t+this.limit))}fields(){return this.columns.map(t=>bg(this.from,t))}fieldInfo(t){this.schema=t;const n=this.head;n.innerHTML="";const i=document.createElement("tr");for(const{column:r}of t){const s=document.createElement("th");s.addEventListener("click",o=>this.sort(o,r)),s.appendChild(document.createElement("span")),s.appendChild(document.createTextNode(r)),i.appendChild(s)}return n.appendChild(i),this.formats=PL(this.format,t),this.style.innerText=jL(this.id,UL(this.align,t),zL(this.widths,t)),this}query(t=[]){const{from:n,limit:i,offset:r,schema:s,sortColumn:o,sortDesc:a}=this;return St.from(n).select(s.map(c=>c.column)).where(t).orderby(o?a?y8(o):o:[]).limit(i).offset(r)}queryResult(t){return this.pending||(this.loaded=!1,this.body.replaceChildren()),this.data=t,this}update(){const{body:t,formats:n,data:i,schema:r,limit:s}=this,o=r.length;let a=0;for(const c of i){++a;const l=document.createElement("tr");for(let u=0;u<o;++u){const h=c[r[u].column],f=document.createElement("td");f.innerText=h==null?"":n[u](h),l.appendChild(f)}t.appendChild(l)}return a<s&&(this.loaded=!0),this.pending=!1,this}sort(t,n){n===this.sortColumn?this.sortDesc=!this.sortDesc:(this.sortColumn=n,this.sortDesc=!1);const i=t.currentTarget,r=this.sortHeader;r===i&&t.metaKey?(r.firstChild.textContent="",this.sortHeader=null,this.sortColumn=null):(r&&(r.firstChild.textContent=""),this.sortHeader=i,i.firstChild.textContent=this.sortDesc?"▾":"▴"),this.requestData()}}function PL(e={},t,n){return t.map(({column:i,type:r})=>{if(i in e)return e[i];switch(r){case"number":return Sg(n);case"date":return BS;default:return CS(n)}})}function UL(e={},t){return t.map(({column:n,type:i})=>n in e?e[n]:i==="number"?"right":"left")}function zL(e={},t){return t.map(({column:n})=>e[n])}function jL(e,t,n){const i=[];return t.forEach((r,s)=>{const o=+n[s];if(r!=="left"||o){const a=r!=="left"?`text-align:${r};`:"",c=o?`width:${o}px;max-width:${o}px;`:"";i.push(`#${e} tr>:nth-child(${s+1}) {${a}${c}}`)}}),i.join(" ")}const Ag=Symbol("Fixed"),Ks=Symbol("Transient"),PS=Symbol("Transform"),qL=["rectY-x","rectX-y","rect-x","rect-y"];function YL(e,t){return qL.includes(`${t}-${e}`)}function Nw(e,t={steps:25}){const n=(i,r)=>YL(r,i.type)?{[`${r}1`]:Jp(i,e,t),[`${r}2`]:Jp(i,e,{...t,offset:1})}:{[r]:Jp(i,e,t)};return n[PS]=!0,n}function Jp(e,t,n){return{column:t,label:t,get stats(){return["min","max"]},get columns(){return[t]},get basis(){return t},toString(){const{min:i,max:r}=e.stats[t],s=VL(i,r,n),o=Gt(t),a=s.min===0?o:`(${o} - ${s.min})`,c=`${(s.max-s.min)/s.steps}::DOUBLE`,l=n.offset?`${n.offset} + `:"";return`${i} + ${c} * (${l}FLOOR(${a} / ${c})::INTEGER)`}}}function VL(e,t,n){let{steps:i=25,minstep:r=0,nice:s=!0}=n;if(s!==!1){const o=t-e,a=i,c=Math.LN10,l=Math.ceil(Math.log(a)/c);let u=Math.max(r,Math.pow(10,Math.round(Math.log(o)/c)-l));for(;Math.ceil(o/u)>a;)u*=10;const h=[5,2];let f;for(let y=0,m=h.length;y<m;++y)f=u/h[y],f>=r&&o/f<=a&&(u=f);f=Math.log(u);const d=f>=0?0:~~(-f/c)+1,p=Math.pow(10,-d-1);f=Math.floor(e/u+p)*u,e=e<f?f-u:f,t=Math.ceil(t/u)*u,i=Math.round((t-e)/u)}return{min:e,max:t,steps:i}}function ue(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Dl(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tl(e){let t,n,i;e.length!==2?(t=ue,n=(a,c)=>ue(e(a),c),i=(a,c)=>e(a)-c):(t=e===ue||e===Dl?e:WL,n=e,i=e);function r(a,c,l=0,u=a.length){if(l<u){if(t(c,c)!==0)return u;do{const h=l+u>>>1;n(a[h],c)<0?l=h+1:u=h}while(l<u)}return l}function s(a,c,l=0,u=a.length){if(l<u){if(t(c,c)!==0)return u;do{const h=l+u>>>1;n(a[h],c)<=0?l=h+1:u=h}while(l<u)}return l}function o(a,c,l=0,u=a.length){const h=r(a,c,l,u-1);return h>l&&i(a[h-1],c)>-i(a[h],c)?h-1:h}return{left:r,center:o,right:s}}function WL(){return 0}function US(e){return e===null?NaN:+e}function*GL(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const HL=tl(ue),XL=HL.right;tl(US).center;const gd=XL,zS=jS(qS),KL=jS(QL);function jS(e){return function(t,n,i=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:r,width:s,height:o}=t;if(!((s=Math.floor(s))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:r.length/s))>=0))throw new RangeError("invalid height");if(!s||!o||!n&&!i)return t;const a=n&&e(n),c=i&&e(i),l=r.slice();return a&&c?(go(a,l,r,s,o),go(a,r,l,s,o),go(a,l,r,s,o),bo(c,r,l,s,o),bo(c,l,r,s,o),bo(c,r,l,s,o)):a?(go(a,r,l,s,o),go(a,l,r,s,o),go(a,r,l,s,o)):c&&(bo(c,r,l,s,o),bo(c,l,r,s,o),bo(c,r,l,s,o)),t}}function go(e,t,n,i,r){for(let s=0,o=i*r;s<o;)e(t,n,s,s+=i,1)}function bo(e,t,n,i,r){for(let s=0,o=i*r;s<i;++s)e(t,n,s,s+o,i)}function QL(e){const t=qS(e);return(n,i,r,s,o)=>{r<<=2,s<<=2,o<<=2,t(n,i,r+0,s+0,o),t(n,i,r+1,s+1,o),t(n,i,r+2,s+2,o),t(n,i,r+3,s+3,o)}}function qS(e){const t=Math.floor(e);if(t===e)return JL(e);const n=e-t,i=2*e+1;return(r,s,o,a,c)=>{if(!((a-=c)>=o))return;let l=t*s[o];const u=c*t,h=u+c;for(let f=o,d=o+u;f<d;f+=c)l+=s[Math.min(a,f)];for(let f=o,d=a;f<=d;f+=c)l+=s[Math.min(a,f+u)],r[f]=(l+n*(s[Math.max(o,f-h)]+s[Math.min(a,f+h)]))/i,l-=s[Math.max(o,f-u)]}}function JL(e){const t=2*e+1;return(n,i,r,s,o)=>{if(!((s-=o)>=r))return;let a=e*i[r];const c=o*e;for(let l=r,u=r+c;l<u;l+=o)a+=i[Math.min(s,l)];for(let l=r,u=s;l<=u;l+=o)a+=i[Math.min(s,l+c)],n[l]=a/t,a-=i[Math.max(r,l-c)]}}function bd(e,t){let n=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&++n;else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(r=+r)>=r&&++n}return n}function ZL(e){return e.length|0}function t5(e){return!(e>0)}function e5(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function n5(e){return t=>e(...t)}function i5(...e){const t=typeof e[e.length-1]=="function"&&n5(e.pop());e=e.map(e5);const n=e.map(ZL),i=e.length-1,r=new Array(i+1).fill(0),s=[];if(i<0||n.some(t5))return s;for(;;){s.push(r.map((a,c)=>e[c][a]));let o=i;for(;++r[o]===n[o];){if(o===0)return t?s.map(t):s;r[o--]=0}}}function r5(e,t){var n=0,i=0;return Float64Array.from(e,t===void 0?r=>n+=+r||0:r=>n+=+t(r,i++,e)||0)}function Tg(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function wd(e,t){const n=Tg(e,t);return n&&Math.sqrt(n)}function Ae(e,t){let n,i;if(t===void 0)for(const r of e)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(n===void 0?s>=s&&(n=i=s):(n>s&&(n=s),i<s&&(i=s)))}return[n,i]}class xi{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class Qs extends Map{constructor(t,n=WS){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(v0(this,t))}has(t){return super.has(v0(this,t))}set(t,n){return super.set(YS(this,t),n)}delete(t){return super.delete(VS(this,t))}}class _d extends Set{constructor(t,n=WS){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(v0(this,t))}add(t){return super.add(YS(this,t))}delete(t){return super.delete(VS(this,t))}}function v0({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function YS({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function VS({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function WS(e){return e!==null&&typeof e=="object"?e.valueOf():e}function x0(e){return e}function br(e,...t){return Ig(e,x0,x0,t)}function Ho(e,t,...n){return Ig(e,x0,t,n)}function s5(e,t,...n){return Ig(e,Array.from,t,n)}function Ig(e,t,n,i){return function r(s,o){if(o>=i.length)return n(s);const a=new Qs,c=i[o++];let l=-1;for(const u of s){const h=c(u,++l,s),f=a.get(h);f?f.push(u):a.set(h,[u])}for(const[u,h]of a)a.set(u,r(h,o));return t(a)}(e,0)}function o5(e,t){return Array.from(t,n=>e[n])}function el(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const i=Uint32Array.from(e,(r,s)=>s);return t.length>1?(t=t.map(r=>e.map(r)),i.sort((r,s)=>{for(const o of t){const a=nl(o[r],o[s]);if(a)return a}})):(n=e.map(n),i.sort((r,s)=>nl(n[r],n[s]))),o5(e,i)}return e.sort(Mg(n))}function Mg(e=ue){if(e===ue)return nl;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function nl(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Ng(e,t,n){return(t.length!==2?el(Ho(e,t,n),([i,r],[s,o])=>ue(r,o)||ue(i,s)):el(br(e,n),([i,r],[s,o])=>t(r,o)||ue(i,s))).map(([i])=>i)}const a5=Math.sqrt(50),c5=Math.sqrt(10),l5=Math.sqrt(2);function Qf(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=a5?10:s>=c5?5:s>=l5?2:1;let a,c,l;return r<0?(l=Math.pow(10,-r)/o,a=Math.round(e*l),c=Math.round(t*l),a/l<e&&++a,c/l>t&&--c,l=-l):(l=Math.pow(10,r)*o,a=Math.round(e/l),c=Math.round(t/l),a*l<e&&++a,c*l>t&&--c),c<a&&.5<=n&&n<2?Qf(e,t,n*2):[a,c,l]}function Hr(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?Qf(t,e,n):Qf(e,t,n);if(!(s>=r))return[];const a=s-r+1,c=new Array(a);if(i)if(o<0)for(let l=0;l<a;++l)c[l]=(s-l)/-o;else for(let l=0;l<a;++l)c[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)c[l]=(r+l)/-o;else for(let l=0;l<a;++l)c[l]=(r+l)*o;return c}function il(e,t,n){return t=+t,e=+e,n=+n,Qf(e,t,n)[2]}function S0(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?il(t,e,n):il(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function GS(e,t,n){let i;for(;;){const r=il(e,t,n);if(r===i||r===0||!isFinite(r))return[e,t];r>0?(e=Math.floor(e/r)*r,t=Math.ceil(t/r)*r):r<0&&(e=Math.ceil(e*r)/r,t=Math.floor(t*r)/r),i=r}}function $g(e){return Math.max(1,Math.ceil(Math.log(bd(e))/Math.LN2)+1)}function oe(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function u5(e,t){let n,i=-1,r=-1;if(t===void 0)for(const s of e)++r,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,i=r);else for(let s of e)(s=t(s,++r,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,i=r);return i}function xe(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function f5(e,t){let n,i=-1,r=-1;if(t===void 0)for(const s of e)++r,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,i=r);else for(let s of e)(s=t(s,++r,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,i=r);return i}function HS(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?nl:Mg(r);i>n;){if(i-n>600){const c=i-n+1,l=t-n+1,u=Math.log(c),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(c-h)/c)*(l-c/2<0?-1:1),d=Math.max(n,Math.floor(t-l*h/c+f)),p=Math.min(i,Math.floor(t+(c-l)*h/c+f));HS(e,t,d,p,r)}const s=e[t];let o=n,a=i;for(uc(e,n,t),r(e[i],s)>0&&uc(e,n,i);o<a;){for(uc(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?uc(e,n,a):(++a,uc(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function uc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function kg(e,t=ue){let n,i=!1;if(t.length===1){let r;for(const s of e){const o=t(s);(i?ue(o,r)>0:ue(o,o)===0)&&(n=s,r=o,i=!0)}}else for(const r of e)(i?t(r,n)>0:t(r,r)===0)&&(n=r,i=!0);return n}function Xr(e,t,n){if(e=Float64Array.from(GL(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return xe(e);if(t>=1)return oe(e);var i,r=(i-1)*t,s=Math.floor(r),o=oe(HS(e,s).subarray(0,s+1)),a=xe(e.subarray(s+1));return o+(a-o)*(r-s)}}function h5(e,t,n=US){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function d5(e,t,n){const i=bd(e),r=Xr(e,.75)-Xr(e,.25);return i&&r?Math.ceil((n-t)/(2*r*Math.pow(i,-1/3))):1}function XS(e,t,n){const i=bd(e),r=wd(e);return i&&r?Math.ceil((n-t)*Math.cbrt(i)/(3.49*r)):1}function Og(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function ga(e,t){return Xr(e,.5,t)}function*p5(e){for(const t of e)yield*t}function KS(e){return Array.from(p5(e))}function QS(e,t){const n=new Qs;if(t===void 0)for(let s of e)s!=null&&s>=s&&n.set(s,(n.get(s)||0)+1);else{let s=-1;for(let o of e)(o=t(o,++s,e))!=null&&o>=o&&n.set(o,(n.get(o)||0)+1)}let i,r=0;for(const[s,o]of n)o>r&&(r=o,i=s);return i}function y5(e,t=m5){const n=[];let i,r=!1;for(const s of e)r&&n.push(t(i,s)),i=s,r=!0;return n}function m5(e,t){return[e,t]}function dn(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function JS(e,t=ue){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let n=Array.from(e);const i=new Float64Array(n.length);t.length!==2&&(n=n.map(t),t=ue);const r=(a,c)=>t(n[a],n[c]);let s,o;return e=Uint32Array.from(n,(a,c)=>c),e.sort(t===ue?(a,c)=>nl(n[a],n[c]):Mg(r)),e.forEach((a,c)=>{const l=r(a,s===void 0?a:s);l>=0?((s===void 0||l>0)&&(s=a,o=c),i[a]=o):i[a]=NaN}),i}function g5(e,t=ue){let n,i=!1;if(t.length===1){let r;for(const s of e){const o=t(s);(i?ue(o,r)<0:ue(o,o)===0)&&(n=s,r=o,i=!0)}}else for(const r of e)(i?t(r,n)<0:t(r,r)===0)&&(n=r,i=!0);return n}function $i(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function Jf(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function b5(e){return e}var Zp=1,ty=2,E0=3,gu=4,$w=1e-6;function w5(e){return"translate("+e+",0)"}function _5(e){return"translate(0,"+e+")"}function v5(e){return t=>+e(t)}function x5(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function S5(){return!this.__axis}function E5(e,t){var n=[],i=null,r=null,s=6,o=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=e===Zp||e===gu?-1:1,u=e===gu||e===ty?"x":"y",h=e===Zp||e===E0?w5:_5;function f(d){var p=i??(t.ticks?t.ticks.apply(t,n):t.domain()),y=r??(t.tickFormat?t.tickFormat.apply(t,n):b5),m=Math.max(s,0)+a,g=t.range(),b=+g[0]+c,w=+g[g.length-1]+c,_=(t.bandwidth?x5:v5)(t.copy(),c),x=d.selection?d.selection():d,v=x.selectAll(".domain").data([null]),E=x.selectAll(".tick").data(p,t).order(),T=E.exit(),k=E.enter().append("g").attr("class","tick"),A=E.select("line"),I=E.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(k),A=A.merge(k.append("line").attr("stroke","currentColor").attr(u+"2",l*s)),I=I.merge(k.append("text").attr("fill","currentColor").attr(u,l*m).attr("dy",e===Zp?"0em":e===E0?"0.71em":"0.32em")),d!==x&&(v=v.transition(d),E=E.transition(d),A=A.transition(d),I=I.transition(d),T=T.transition(d).attr("opacity",$w).attr("transform",function(O){return isFinite(O=_(O))?h(O+c):this.getAttribute("transform")}),k.attr("opacity",$w).attr("transform",function(O){var F=this.parentNode.__axis;return h((F&&isFinite(F=F(O))?F:_(O))+c)})),T.remove(),v.attr("d",e===gu||e===ty?o?"M"+l*o+","+b+"H"+c+"V"+w+"H"+l*o:"M"+c+","+b+"V"+w:o?"M"+b+","+l*o+"V"+c+"H"+w+"V"+l*o:"M"+b+","+c+"H"+w),E.attr("opacity",1).attr("transform",function(O){return h(_(O)+c)}),A.attr(u+"2",l*s),I.attr(u,l*m).text(y),x.filter(S5).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===ty?"start":e===gu?"end":"middle"),x.each(function(){this.__axis=_})}return f.scale=function(d){return arguments.length?(t=d,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(i=d==null?null:Array.from(d),f):i&&i.slice()},f.tickFormat=function(d){return arguments.length?(r=d,f):r},f.tickSize=function(d){return arguments.length?(s=o=+d,f):s},f.tickSizeInner=function(d){return arguments.length?(s=+d,f):s},f.tickSizeOuter=function(d){return arguments.length?(o=+d,f):o},f.tickPadding=function(d){return arguments.length?(a=+d,f):a},f.offset=function(d){return arguments.length?(c=+d,f):c},f}function A5(e){return E5(E0,e)}var T5={value:()=>{}};function vd(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new sf(n)}function sf(e){this._=e}function I5(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}sf.prototype=vd.prototype={constructor:sf,on:function(e,t){var n=this._,i=I5(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=M5(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=kw(n[r],e.name,t);else if(t==null)for(r in n)n[r]=kw(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new sf(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function M5(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function kw(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=T5,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var A0="http://www.w3.org/1999/xhtml";const Js={svg:"http://www.w3.org/2000/svg",xhtml:A0,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xd(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Js.hasOwnProperty(t)?{space:Js[t],local:e}:e}function N5(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===A0&&t.documentElement.namespaceURI===A0?t.createElement(e):t.createElementNS(n,e)}}function $5(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Sd(e){var t=xd(e);return(t.local?$5:N5)(t)}function k5(){}function Lg(e){return e==null?k5:function(){return this.querySelector(e)}}function O5(e){typeof e!="function"&&(e=Lg(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=new Array(o),c,l,u=0;u<o;++u)(c=s[u])&&(l=e.call(c,c.__data__,u,s))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new _n(i,this._parents)}function L5(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function R5(){return[]}function ZS(e){return e==null?R5:function(){return this.querySelectorAll(e)}}function F5(e){return function(){return L5(e.apply(this,arguments))}}function D5(e){typeof e=="function"?e=F5(e):e=ZS(e);for(var t=this._groups,n=t.length,i=[],r=[],s=0;s<n;++s)for(var o=t[s],a=o.length,c,l=0;l<a;++l)(c=o[l])&&(i.push(e.call(c,c.__data__,l,o)),r.push(c));return new _n(i,r)}function tE(e){return function(){return this.matches(e)}}function eE(e){return function(t){return t.matches(e)}}var C5=Array.prototype.find;function B5(e){return function(){return C5.call(this.children,e)}}function P5(){return this.firstElementChild}function U5(e){return this.select(e==null?P5:B5(typeof e=="function"?e:eE(e)))}var z5=Array.prototype.filter;function j5(){return Array.from(this.children)}function q5(e){return function(){return z5.call(this.children,e)}}function Y5(e){return this.selectAll(e==null?j5:q5(typeof e=="function"?e:eE(e)))}function V5(e){typeof e!="function"&&(e=tE(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new _n(i,this._parents)}function nE(e){return new Array(e.length)}function W5(){return new _n(this._enter||this._groups.map(nE),this._parents)}function Zf(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Zf.prototype={constructor:Zf,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function G5(e){return function(){return e}}function H5(e,t,n,i,r,s){for(var o=0,a,c=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],i[o]=a):n[o]=new Zf(e,s[o]);for(;o<c;++o)(a=t[o])&&(r[o]=a)}function X5(e,t,n,i,r,s,o){var a,c,l=new Map,u=t.length,h=s.length,f=new Array(u),d;for(a=0;a<u;++a)(c=t[a])&&(f[a]=d=o.call(c,c.__data__,a,t)+"",l.has(d)?r[a]=c:l.set(d,c));for(a=0;a<h;++a)d=o.call(e,s[a],a,s)+"",(c=l.get(d))?(i[a]=c,c.__data__=s[a],l.delete(d)):n[a]=new Zf(e,s[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(r[a]=c)}function K5(e){return e.__data__}function Q5(e,t){if(!arguments.length)return Array.from(this,K5);var n=t?X5:H5,i=this._parents,r=this._groups;typeof e!="function"&&(e=G5(e));for(var s=r.length,o=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var u=i[l],h=r[l],f=h.length,d=J5(e.call(u,u&&u.__data__,l,i)),p=d.length,y=a[l]=new Array(p),m=o[l]=new Array(p),g=c[l]=new Array(f);n(u,h,y,m,g,d,t);for(var b=0,w=0,_,x;b<p;++b)if(_=y[b]){for(b>=w&&(w=b+1);!(x=m[w])&&++w<p;);_._next=x||null}}return o=new _n(o,i),o._enter=a,o._exit=c,o}function J5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Z5(){return new _n(this._exit||this._groups.map(nE),this._parents)}function tR(e,t,n){var i=this.enter(),r=this,s=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function eR(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),c=0;c<o;++c)for(var l=n[c],u=i[c],h=l.length,f=a[c]=new Array(h),d,p=0;p<h;++p)(d=l[p]||u[p])&&(f[p]=d);for(;c<r;++c)a[c]=n[c];return new _n(a,this._parents)}function nR(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i=e[t],r=i.length-1,s=i[r],o;--r>=0;)(o=i[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function iR(e){e||(e=rR);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o=n[s],a=o.length,c=r[s]=new Array(a),l,u=0;u<a;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new _n(r,this._parents).order()}function rR(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function sR(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function oR(){return Array.from(this)}function aR(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null}function cR(){let e=0;for(const t of this)++e;return e}function lR(){return!this.node()}function uR(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r=t[n],s=0,o=r.length,a;s<o;++s)(a=r[s])&&e.call(a,a.__data__,s,r);return this}function fR(e){return function(){this.removeAttribute(e)}}function hR(e){return function(){this.removeAttributeNS(e.space,e.local)}}function dR(e,t){return function(){this.setAttribute(e,t)}}function pR(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function yR(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function mR(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function gR(e,t){var n=xd(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((t==null?n.local?hR:fR:typeof t=="function"?n.local?mR:yR:n.local?pR:dR)(n,t))}function iE(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bR(e){return function(){this.style.removeProperty(e)}}function wR(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _R(e,t,n){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function vR(e,t,n){return arguments.length>1?this.each((t==null?bR:typeof t=="function"?_R:wR)(e,t,n??"")):ba(this.node(),e)}function ba(e,t){return e.style.getPropertyValue(t)||iE(e).getComputedStyle(e,null).getPropertyValue(t)}function xR(e){return function(){delete this[e]}}function SR(e,t){return function(){this[e]=t}}function ER(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function AR(e,t){return arguments.length>1?this.each((t==null?xR:typeof t=="function"?ER:SR)(e,t)):this.node()[e]}function rE(e){return e.trim().split(/^|\s+/)}function Rg(e){return e.classList||new sE(e)}function sE(e){this._node=e,this._names=rE(e.getAttribute("class")||"")}sE.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function oE(e,t){for(var n=Rg(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function aE(e,t){for(var n=Rg(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function TR(e){return function(){oE(this,e)}}function IR(e){return function(){aE(this,e)}}function MR(e,t){return function(){(t.apply(this,arguments)?oE:aE)(this,e)}}function NR(e,t){var n=rE(e+"");if(arguments.length<2){for(var i=Rg(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?MR:t?TR:IR)(n,t))}function $R(){this.textContent=""}function kR(e){return function(){this.textContent=e}}function OR(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function LR(e){return arguments.length?this.each(e==null?$R:(typeof e=="function"?OR:kR)(e)):this.node().textContent}function RR(){this.innerHTML=""}function FR(e){return function(){this.innerHTML=e}}function DR(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function CR(e){return arguments.length?this.each(e==null?RR:(typeof e=="function"?DR:FR)(e)):this.node().innerHTML}function BR(){this.nextSibling&&this.parentNode.appendChild(this)}function PR(){return this.each(BR)}function UR(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zR(){return this.each(UR)}function jR(e){var t=typeof e=="function"?e:Sd(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function qR(){return null}function YR(e,t){var n=typeof e=="function"?e:Sd(e),i=t==null?qR:typeof t=="function"?t:Lg(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function VR(){var e=this.parentNode;e&&e.removeChild(this)}function WR(){return this.each(VR)}function GR(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function HR(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function XR(e){return this.select(e?HR:GR)}function KR(e){return arguments.length?this.property("__data__",e):this.node().__data__}function QR(e){return function(t){e.call(this,t,this.__data__)}}function JR(e){return e.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{type:t,name:n}})}function ZR(e){return function(){var t=this.__on;if(t){for(var n=0,i=-1,r=t.length,s;n<r;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++i]=s;++i?t.length=i:delete this.__on}}}function tF(e,t,n){return function(){var i=this.__on,r,s=QR(t);if(i){for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=t;return}}this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},i?i.push(r):this.__on=[r]}}function eF(e,t,n){var i=JR(e+""),r,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(r=0,u=a[c];r<s;++r)if((o=i[r]).type===u.type&&o.name===u.name)return u.value}return}for(a=t?tF:ZR,r=0;r<s;++r)this.each(a(i[r],t,n));return this}function cE(e,t,n){var i=iE(e),r=i.CustomEvent;typeof r=="function"?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function nF(e,t){return function(){return cE(this,e,t)}}function iF(e,t){return function(){return cE(this,e,t.apply(this,arguments))}}function rF(e,t){return this.each((typeof t=="function"?iF:nF)(e,t))}function*sF(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,s=i.length,o;r<s;++r)(o=i[r])&&(yield o)}var lE=[null];function _n(e,t){this._groups=e,this._parents=t}function Cl(){return new _n([[document.documentElement]],lE)}function oF(){return this}_n.prototype=Cl.prototype={constructor:_n,select:O5,selectAll:D5,selectChild:U5,selectChildren:Y5,filter:V5,data:Q5,enter:W5,exit:Z5,join:tR,merge:eR,selection:oF,order:nR,sort:iR,call:sR,nodes:oR,node:aR,size:cR,empty:lR,each:uR,attr:gR,style:vR,property:AR,classed:NR,text:LR,html:CR,raise:PR,lower:zR,append:jR,insert:YR,remove:WR,clone:XR,datum:KR,on:eF,dispatch:rF,[Symbol.iterator]:sF};function zt(e){return typeof e=="string"?new _n([[document.querySelector(e)]],[document.documentElement]):new _n([[e]],lE)}function aF(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Yn(e,t){if(e=aF(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const T0={capture:!0,passive:!1};function I0(e){e.preventDefault(),e.stopImmediatePropagation()}function uE(e){var t=e.document.documentElement,n=zt(e).on("dragstart.drag",I0,T0);"onselectstart"in t?n.on("selectstart.drag",I0,T0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function fE(e,t){var n=e.document.documentElement,i=zt(e).on("dragstart.drag",null);t&&(i.on("click.drag",I0,T0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Pa(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Bl(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function cs(){}var Zs=.7,wa=1/Zs,Xo="\\s*([+-]?\\d+)\\s*",rl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Si="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cF=/^#([0-9a-f]{3,8})$/,lF=new RegExp(`^rgb\\(${Xo},${Xo},${Xo}\\)$`),uF=new RegExp(`^rgb\\(${Si},${Si},${Si}\\)$`),fF=new RegExp(`^rgba\\(${Xo},${Xo},${Xo},${rl}\\)$`),hF=new RegExp(`^rgba\\(${Si},${Si},${Si},${rl}\\)$`),dF=new RegExp(`^hsl\\(${rl},${Si},${Si}\\)$`),pF=new RegExp(`^hsla\\(${rl},${Si},${Si},${rl}\\)$`),Ow={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Pa(cs,fr,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Lw,formatHex:Lw,formatHex8:yF,formatHsl:mF,formatRgb:Rw,toString:Rw});function Lw(){return this.rgb().formatHex()}function yF(){return this.rgb().formatHex8()}function mF(){return hE(this).formatHsl()}function Rw(){return this.rgb().formatRgb()}function fr(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cF.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fw(t):n===3?new ve(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bu(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bu(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=lF.exec(e))?new ve(t[1],t[2],t[3],1):(t=uF.exec(e))?new ve(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fF.exec(e))?bu(t[1],t[2],t[3],t[4]):(t=hF.exec(e))?bu(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=dF.exec(e))?Bw(t[1],t[2]/100,t[3]/100,1):(t=pF.exec(e))?Bw(t[1],t[2]/100,t[3]/100,t[4]):Ow.hasOwnProperty(e)?Fw(Ow[e]):e==="transparent"?new ve(NaN,NaN,NaN,0):null}function Fw(e){return new ve(e>>16&255,e>>8&255,e&255,1)}function bu(e,t,n,i){return i<=0&&(e=t=n=NaN),new ve(e,t,n,i)}function Fg(e){return e instanceof cs||(e=fr(e)),e?(e=e.rgb(),new ve(e.r,e.g,e.b,e.opacity)):new ve}function Dn(e,t,n,i){return arguments.length===1?Fg(e):new ve(e,t,n,i??1)}function ve(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Pa(ve,Dn,Bl(cs,{brighter(e){return e=e==null?wa:Math.pow(wa,e),new ve(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zs:Math.pow(Zs,e),new ve(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ve(qs(this.r),qs(this.g),qs(this.b),th(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dw,formatHex:Dw,formatHex8:gF,formatRgb:Cw,toString:Cw}));function Dw(){return`#${Fs(this.r)}${Fs(this.g)}${Fs(this.b)}`}function gF(){return`#${Fs(this.r)}${Fs(this.g)}${Fs(this.b)}${Fs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cw(){const e=th(this.opacity);return`${e===1?"rgb(":"rgba("}${qs(this.r)}, ${qs(this.g)}, ${qs(this.b)}${e===1?")":`, ${e})`}`}function th(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Fs(e){return e=qs(e),(e<16?"0":"")+e.toString(16)}function Bw(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Vn(e,t,n,i)}function hE(e){if(e instanceof Vn)return new Vn(e.h,e.s,e.l,e.opacity);if(e instanceof cs||(e=fr(e)),!e)return new Vn;if(e instanceof Vn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,c=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=c<.5?s+r:2-s-r,o*=60):a=c>0&&c<1?0:o,new Vn(o,a,c,e.opacity)}function M0(e,t,n,i){return arguments.length===1?hE(e):new Vn(e,t,n,i??1)}function Vn(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Pa(Vn,M0,Bl(cs,{brighter(e){return e=e==null?wa:Math.pow(wa,e),new Vn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zs:Math.pow(Zs,e),new Vn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ve(ey(e>=240?e-240:e+120,r,i),ey(e,r,i),ey(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new Vn(Pw(this.h),wu(this.s),wu(this.l),th(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=th(this.opacity);return`${e===1?"hsl(":"hsla("}${Pw(this.h)}, ${wu(this.s)*100}%, ${wu(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Pw(e){return e=(e||0)%360,e<0?e+360:e}function wu(e){return Math.max(0,Math.min(1,e||0))}function ey(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const dE=Math.PI/180,pE=180/Math.PI,eh=18,yE=.96422,mE=1,gE=.82521,bE=4/29,Ko=6/29,wE=3*Ko*Ko,bF=Ko*Ko*Ko;function _E(e){if(e instanceof Ei)return new Ei(e.l,e.a,e.b,e.opacity);if(e instanceof Zi)return vE(e);e instanceof ve||(e=Fg(e));var t=sy(e.r),n=sy(e.g),i=sy(e.b),r=ny((.2225045*t+.7168786*n+.0606169*i)/mE),s,o;return t===n&&n===i?s=o=r:(s=ny((.4360747*t+.3850649*n+.1430804*i)/yE),o=ny((.0139322*t+.0971045*n+.7141733*i)/gE)),new Ei(116*r-16,500*(s-r),200*(r-o),e.opacity)}function N0(e,t,n,i){return arguments.length===1?_E(e):new Ei(e,t,n,i??1)}function Ei(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Pa(Ei,N0,Bl(cs,{brighter(e){return new Ei(this.l+eh*(e??1),this.a,this.b,this.opacity)},darker(e){return new Ei(this.l-eh*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=yE*iy(t),e=mE*iy(e),n=gE*iy(n),new ve(ry(3.1338561*t-1.6168667*e-.4906146*n),ry(-.9787684*t+1.9161415*e+.033454*n),ry(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function ny(e){return e>bF?Math.pow(e,1/3):e/wE+bE}function iy(e){return e>Ko?e*e*e:wE*(e-bE)}function ry(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function sy(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wF(e){if(e instanceof Zi)return new Zi(e.h,e.c,e.l,e.opacity);if(e instanceof Ei||(e=_E(e)),e.a===0&&e.b===0)return new Zi(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*pE;return new Zi(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function $0(e,t,n,i){return arguments.length===1?wF(e):new Zi(e,t,n,i??1)}function Zi(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function vE(e){if(isNaN(e.h))return new Ei(e.l,0,0,e.opacity);var t=e.h*dE;return new Ei(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Pa(Zi,$0,Bl(cs,{brighter(e){return new Zi(this.h,this.c,this.l+eh*(e??1),this.opacity)},darker(e){return new Zi(this.h,this.c,this.l-eh*(e??1),this.opacity)},rgb(){return vE(this).rgb()}}));var xE=-.14861,Dg=1.78277,Cg=-.29227,Ed=-.90649,sl=1.97294,Uw=sl*Ed,zw=sl*Dg,jw=Dg*Cg-Ed*xE;function _F(e){if(e instanceof Ys)return new Ys(e.h,e.s,e.l,e.opacity);e instanceof ve||(e=Fg(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(jw*i+Uw*t-zw*n)/(jw+Uw-zw),s=i-r,o=(sl*(n-r)-Cg*s)/Ed,a=Math.sqrt(o*o+s*s)/(sl*r*(1-r)),c=a?Math.atan2(o,s)*pE-120:NaN;return new Ys(c<0?c+360:c,a,r,e.opacity)}function ki(e,t,n,i){return arguments.length===1?_F(e):new Ys(e,t,n,i??1)}function Ys(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Pa(Ys,ki,Bl(cs,{brighter(e){return e=e==null?wa:Math.pow(wa,e),new Ys(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zs:Math.pow(Zs,e),new Ys(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*dE,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new ve(255*(t+n*(xE*i+Dg*r)),255*(t+n*(Cg*i+Ed*r)),255*(t+n*(sl*i)),this.opacity)}}));function vF(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function xF(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return vF((n-i/t)*t,o,r,s,a)}}const Ad=e=>()=>e;function SE(e,t){return function(n){return e+n*t}}function SF(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Bg(e,t){var n=t-e;return n?SE(e,n>180||n<-180?n-360*Math.round(n/360):n):Ad(isNaN(e)?t:e)}function EF(e){return(e=+e)==1?Oe:function(t,n){return n-t?SF(t,n,e):Ad(isNaN(t)?n:t)}}function Oe(e,t){var n=t-e;return n?SE(e,n):Ad(isNaN(e)?t:e)}const to=function e(t){var n=EF(t);function i(r,s){var o=n((r=Dn(r)).r,(s=Dn(s)).r),a=n(r.g,s.g),c=n(r.b,s.b),l=Oe(r.opacity,s.opacity);return function(u){return r.r=o(u),r.g=a(u),r.b=c(u),r.opacity=l(u),r+""}}return i.gamma=e,i}(1);function AF(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Dn(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(c){return a.r=i(c),a.g=r(c),a.b=s(c),a+""}}}var TF=AF(xF);function IF(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function MF(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function NF(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=Ua(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function $F(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function $e(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function kF(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Ua(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var k0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oy=new RegExp(k0.source,"g");function OF(e){return function(){return e}}function LF(e){return function(t){return e(t)+""}}function EE(e,t){var n=k0.lastIndex=oy.lastIndex=0,i,r,s,o=-1,a=[],c=[];for(e=e+"",t=t+"";(i=k0.exec(e))&&(r=oy.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:$e(i,r)})),n=oy.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?LF(c[0].x):OF(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}function Ua(e,t){var n=typeof t,i;return t==null||n==="boolean"?Ad(t):(n==="number"?$e:n==="string"?(i=fr(t))?(t=i,to):EE:t instanceof fr?to:t instanceof Date?$F:MF(t)?IF:Array.isArray(t)?NF:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?kF:$e)(e,t)}function Pg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var qw=180/Math.PI,O0={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function AE(e,t,n,i,r,s){var o,a,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*i)&&(n-=e*c,i-=t*c),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,c/=a),e*i<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*qw,skewX:Math.atan(c)*qw,scaleX:o,scaleY:a}}var _u;function RF(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?O0:AE(t.a,t.b,t.c,t.d,t.e,t.f)}function FF(e){return e==null||(_u||(_u=document.createElementNS("http://www.w3.org/2000/svg","g")),_u.setAttribute("transform",e),!(e=_u.transform.baseVal.consolidate()))?O0:(e=e.matrix,AE(e.a,e.b,e.c,e.d,e.e,e.f))}function TE(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,u,h,f,d,p){if(l!==h||u!==f){var y=d.push("translate(",null,t,null,n);p.push({i:y-4,x:$e(l,h)},{i:y-2,x:$e(u,f)})}else(h||f)&&d.push("translate("+h+t+f+n)}function o(l,u,h,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:h.push(r(h)+"rotate(",null,i)-2,x:$e(l,u)})):u&&h.push(r(h)+"rotate("+u+i)}function a(l,u,h,f){l!==u?f.push({i:h.push(r(h)+"skewX(",null,i)-2,x:$e(l,u)}):u&&h.push(r(h)+"skewX("+u+i)}function c(l,u,h,f,d,p){if(l!==h||u!==f){var y=d.push(r(d)+"scale(",null,",",null,")");p.push({i:y-4,x:$e(l,h)},{i:y-2,x:$e(u,f)})}else(h!==1||f!==1)&&d.push(r(d)+"scale("+h+","+f+")")}return function(l,u){var h=[],f=[];return l=e(l),u=e(u),s(l.translateX,l.translateY,u.translateX,u.translateY,h,f),o(l.rotate,u.rotate,h,f),a(l.skewX,u.skewX,h,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,f),l=u=null,function(d){for(var p=-1,y=f.length,m;++p<y;)h[(m=f[p]).i]=m.x(d);return h.join("")}}}var DF=TE(RF,"px, ","px)","deg)"),CF=TE(FF,", ",")",")"),BF=1e-12;function Yw(e){return((e=Math.exp(e))+1/e)/2}function PF(e){return((e=Math.exp(e))-1/e)/2}function UF(e){return((e=Math.exp(2*e))-1)/(e+1)}const zF=function e(t,n,i){function r(s,o){var a=s[0],c=s[1],l=s[2],u=o[0],h=o[1],f=o[2],d=u-a,p=h-c,y=d*d+p*p,m,g;if(y<BF)g=Math.log(f/l)/t,m=function(E){return[a+E*d,c+E*p,l*Math.exp(t*E*g)]};else{var b=Math.sqrt(y),w=(f*f-l*l+i*y)/(2*l*n*b),_=(f*f-l*l-i*y)/(2*f*n*b),x=Math.log(Math.sqrt(w*w+1)-w),v=Math.log(Math.sqrt(_*_+1)-_);g=(v-x)/t,m=function(E){var T=E*g,k=Yw(x),A=l/(n*b)*(k*UF(t*T+x)-PF(x));return[a+A*d,c+A*p,l*k/Yw(t*T+x)]}}return m.duration=g*1e3*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return e(o,a,c)},r}(Math.SQRT2,2,4);function jF(e){return function(t,n){var i=e((t=M0(t)).h,(n=M0(n)).h),r=Oe(t.s,n.s),s=Oe(t.l,n.l),o=Oe(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const qF=jF(Bg);function YF(e,t){var n=Oe((e=N0(e)).l,(t=N0(t)).l),i=Oe(e.a,t.a),r=Oe(e.b,t.b),s=Oe(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function VF(e){return function(t,n){var i=e((t=$0(t)).h,(n=$0(n)).h),r=Oe(t.c,n.c),s=Oe(t.l,n.l),o=Oe(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const WF=VF(Bg);function IE(e){return function t(n){n=+n;function i(r,s){var o=e((r=ki(r)).h,(s=ki(s)).h),a=Oe(r.s,s.s),c=Oe(r.l,s.l),l=Oe(r.opacity,s.opacity);return function(u){return r.h=o(u),r.s=a(u),r.l=c(Math.pow(u,n)),r.opacity=l(u),r+""}}return i.gamma=t,i}(1)}IE(Bg);var Ug=IE(Oe);function Td(e,t){t===void 0&&(t=e,e=Ua);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function Xn(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var _a=0,Ac=0,fc=0,ME=1e3,nh,Tc,ih=0,eo=0,Id=0,ol=typeof performance=="object"&&performance.now?performance:Date,NE=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function zg(){return eo||(NE(GF),eo=ol.now()+Id)}function GF(){eo=0}function rh(){this._call=this._time=this._next=null}rh.prototype=$E.prototype={constructor:rh,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?zg():+n)+(t==null?0:+t),!this._next&&Tc!==this&&(Tc?Tc._next=this:nh=this,Tc=this),this._call=e,this._time=n,L0()},stop:function(){this._call&&(this._call=null,this._time=1/0,L0())}};function $E(e,t,n){var i=new rh;return i.restart(e,t,n),i}function HF(){zg(),++_a;for(var e=nh,t;e;)(t=eo-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_a}function Vw(){eo=(ih=ol.now())+Id,_a=Ac=0;try{HF()}finally{_a=0,KF(),eo=0}}function XF(){var e=ol.now(),t=e-ih;t>ME&&(Id-=t,ih=e)}function KF(){for(var e,t=nh,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:nh=n);Tc=e,L0(i)}function L0(e){if(!_a){Ac&&(Ac=clearTimeout(Ac));var t=e-eo;t>24?(e<1/0&&(Ac=setTimeout(Vw,e-ol.now()-Id)),fc&&(fc=clearInterval(fc))):(fc||(ih=ol.now(),fc=setInterval(XF,ME)),_a=1,NE(Vw))}}function Ww(e,t,n){var i=new rh;return t=t==null?0:+t,i.restart(r=>{i.stop(),e(r+t)},t,n),i}var QF=vd("start","end","cancel","interrupt"),JF=[],kE=0,Gw=1,R0=2,of=3,Hw=4,F0=5,af=6;function Md(e,t,n,i,r,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;ZF(e,n,{name:t,index:i,group:r,on:QF,tween:JF,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:kE})}function jg(e,t){var n=ei(e,t);if(n.state>kE)throw new Error("too late; already scheduled");return n}function Li(e,t){var n=ei(e,t);if(n.state>of)throw new Error("too late; already running");return n}function ei(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ZF(e,t,n){var i=e.__transition,r;i[t]=n,n.timer=$E(s,0,n.time);function s(l){n.state=Gw,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var u,h,f,d;if(n.state!==Gw)return c();for(u in i)if(d=i[u],d.name===n.name){if(d.state===of)return Ww(o);d.state===Hw?(d.state=af,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[u]):+u<t&&(d.state=af,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[u])}if(Ww(function(){n.state===of&&(n.state=Hw,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=R0,n.on.call("start",e,e.__data__,n.index,n.group),n.state===R0){for(n.state=of,r=new Array(f=n.tween.length),u=0,h=-1;u<f;++u)(d=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=d);r.length=h+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=F0,1),h=-1,f=r.length;++h<f;)r[h].call(e,u);n.state===F0&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=af,n.timer.stop(),delete i[t];for(var l in i)return;delete e.__transition}}function Qo(e,t){var n=e.__transition,i,r,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((i=n[o]).name!==t){s=!1;continue}r=i.state>R0&&i.state<F0,i.state=af,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete n[o]}s&&delete e.__transition}}function tD(e){return this.each(function(){Qo(this,e)})}function eD(e,t){var n,i;return function(){var r=Li(this,e),s=r.tween;if(s!==n){i=n=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}r.tween=i}}function nD(e,t,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=Li(this,e),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:t,value:n},c=0,l=r.length;c<l;++c)if(r[c].name===t){r[c]=a;break}c===l&&r.push(a)}s.tween=r}}function iD(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i=ei(this.node(),n).tween,r=0,s=i.length,o;r<s;++r)if((o=i[r]).name===e)return o.value;return null}return this.each((t==null?eD:nD)(n,e,t))}function qg(e,t,n){var i=e._id;return e.each(function(){var r=Li(this,i);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ei(r,i).value[t]}}function OE(e,t){var n;return(typeof t=="number"?$e:t instanceof fr?to:(n=fr(t))?(t=n,to):EE)(e,t)}function rD(e){return function(){this.removeAttribute(e)}}function sD(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oD(e,t,n){var i,r=n+"",s;return function(){var o=this.getAttribute(e);return o===r?null:o===i?s:s=t(i=o,n)}}function aD(e,t,n){var i,r=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===i?s:s=t(i=o,n)}}function cD(e,t,n){var i,r,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=a+"",o===c?null:o===i&&c===r?s:(r=c,s=t(i=o,a)))}}function lD(e,t,n){var i,r,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=a+"",o===c?null:o===i&&c===r?s:(r=c,s=t(i=o,a)))}}function uD(e,t){var n=xd(e),i=n==="transform"?CF:OE;return this.attrTween(e,typeof t=="function"?(n.local?lD:cD)(n,i,qg(this,"attr."+e,t)):t==null?(n.local?sD:rD)(n):(n.local?aD:oD)(n,i,t))}function fD(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function hD(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function dD(e,t){var n,i;function r(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&hD(e,s)),n}return r._value=t,r}function pD(e,t){var n,i;function r(){var s=t.apply(this,arguments);return s!==i&&(n=(i=s)&&fD(e,s)),n}return r._value=t,r}function yD(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var i=xd(e);return this.tween(n,(i.local?dD:pD)(i,t))}function mD(e,t){return function(){jg(this,e).delay=+t.apply(this,arguments)}}function gD(e,t){return t=+t,function(){jg(this,e).delay=t}}function bD(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?mD:gD)(t,e)):ei(this.node(),t).delay}function wD(e,t){return function(){Li(this,e).duration=+t.apply(this,arguments)}}function _D(e,t){return t=+t,function(){Li(this,e).duration=t}}function vD(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?wD:_D)(t,e)):ei(this.node(),t).duration}function xD(e,t){if(typeof t!="function")throw new Error;return function(){Li(this,e).ease=t}}function SD(e){var t=this._id;return arguments.length?this.each(xD(t,e)):ei(this.node(),t).ease}function ED(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Li(this,e).ease=n}}function AD(e){if(typeof e!="function")throw new Error;return this.each(ED(this._id,e))}function TD(e){typeof e!="function"&&(e=tE(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var s=t[r],o=s.length,a=i[r]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new hr(i,this._parents,this._name,this._id)}function ID(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var c=t[a],l=n[a],u=c.length,h=o[a]=new Array(u),f,d=0;d<u;++d)(f=c[d]||l[d])&&(h[d]=f);for(;a<i;++a)o[a]=t[a];return new hr(o,this._parents,this._name,this._id)}function MD(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ND(e,t,n){var i,r,s=MD(t)?jg:Li;return function(){var o=s(this,e),a=o.on;a!==i&&(r=(i=a).copy()).on(t,n),o.on=r}}function $D(e,t){var n=this._id;return arguments.length<2?ei(this.node(),n).on.on(e):this.each(ND(n,e,t))}function kD(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function OD(){return this.on("end.remove",kD(this._id))}function LD(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Lg(e));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a=i[o],c=a.length,l=s[o]=new Array(c),u,h,f=0;f<c;++f)(u=a[f])&&(h=e.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),l[f]=h,Md(l[f],t,n,f,l,ei(u,n)));return new hr(s,this._parents,t,n)}function RD(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ZS(e));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var c=i[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var f=e.call(u,u.__data__,h,c),d,p=ei(u,n),y=0,m=f.length;y<m;++y)(d=f[y])&&Md(d,t,n,y,f,p);s.push(f),o.push(u)}return new hr(s,o,t,n)}var FD=Cl.prototype.constructor;function DD(){return new FD(this._groups,this._parents)}function CD(e,t){var n,i,r;return function(){var s=ba(this,e),o=(this.style.removeProperty(e),ba(this,e));return s===o?null:s===n&&o===i?r:r=t(n=s,i=o)}}function LE(e){return function(){this.style.removeProperty(e)}}function BD(e,t,n){var i,r=n+"",s;return function(){var o=ba(this,e);return o===r?null:o===i?s:s=t(i=o,n)}}function PD(e,t,n){var i,r,s;return function(){var o=ba(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ba(this,e))),o===c?null:o===i&&c===r?s:(r=c,s=t(i=o,a))}}function UD(e,t){var n,i,r,s="style."+t,o="end."+s,a;return function(){var c=Li(this,e),l=c.on,u=c.value[s]==null?a||(a=LE(t)):void 0;(l!==n||r!==u)&&(i=(n=l).copy()).on(o,r=u),c.on=i}}function zD(e,t,n){var i=(e+="")=="transform"?DF:OE;return t==null?this.styleTween(e,CD(e,i)).on("end.style."+e,LE(e)):typeof t=="function"?this.styleTween(e,PD(e,i,qg(this,"style."+e,t))).each(UD(this._id,e)):this.styleTween(e,BD(e,i,t),n).on("end.style."+e,null)}function jD(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}function qD(e,t,n){var i,r;function s(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&jD(e,o,n)),i}return s._value=t,s}function YD(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,qD(e,t,n??""))}function VD(e){return function(){this.textContent=e}}function WD(e){return function(){var t=e(this);this.textContent=t??""}}function GD(e){return this.tween("text",typeof e=="function"?WD(qg(this,"text",e)):VD(e==null?"":e+""))}function HD(e){return function(t){this.textContent=e.call(this,t)}}function XD(e){var t,n;function i(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&HD(r)),t}return i._value=e,i}function KD(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,XD(e))}function QD(){for(var e=this._name,t=this._id,n=RE(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,c,l=0;l<a;++l)if(c=o[l]){var u=ei(c,t);Md(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new hr(i,this._parents,e,n)}function JD(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--r===0&&s()}};n.each(function(){var l=Li(this,i),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),r===0&&s()})}var ZD=0;function hr(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function RE(){return++ZD}var Pi=Cl.prototype;hr.prototype={constructor:hr,select:LD,selectAll:RD,selectChild:Pi.selectChild,selectChildren:Pi.selectChildren,filter:TD,merge:ID,selection:DD,transition:QD,call:Pi.call,nodes:Pi.nodes,node:Pi.node,size:Pi.size,empty:Pi.empty,each:Pi.each,on:$D,attr:uD,attrTween:yD,style:zD,styleTween:YD,text:GD,textTween:KD,remove:OD,tween:iD,delay:bD,duration:vD,ease:SD,easeVarying:AD,end:JD,[Symbol.iterator]:Pi[Symbol.iterator]};function tC(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var eC={time:null,delay:0,duration:250,ease:tC};function nC(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function iC(e){var t,n;e instanceof hr?(t=e._id,e=e._name):(t=RE(),(n=eC).time=zg(),e=e==null?null:e+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,c,l=0;l<a;++l)(c=o[l])&&Md(c,e,t,l,o,n||nC(c,t));return new hr(i,this._parents,e,t)}Cl.prototype.interrupt=tD;Cl.prototype.transition=iC;const ay=e=>()=>e;function rC(e,{sourceEvent:t,target:n,selection:i,mode:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function sC(e){e.stopImmediatePropagation()}function cy(e){e.preventDefault(),e.stopImmediatePropagation()}var Xw={name:"drag"},ly={name:"space"},wo={name:"handle"},_o={name:"center"};const{abs:Kw,max:Ie,min:Me}=Math;function Qw(e){return[+e[0],+e[1]]}function D0(e){return[Qw(e[0]),Qw(e[1])]}var cf={name:"x",handles:["w","e"].map(al),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},lf={name:"y",handles:["n","s"].map(al),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},oC={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(al),input:function(e){return e==null?null:D0(e)},output:function(e){return e}},Ui={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Jw={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Zw={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},aC={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},cC={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function al(e){return{type:e}}function lC(e){return!e.ctrlKey&&!e.button}function uC(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function fC(){return navigator.maxTouchPoints||"ontouchstart"in this}function uy(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function hC(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function dC(){return Yg(cf)}function pC(){return Yg(lf)}function yC(){return Yg(oC)}function Yg(e){var t=uC,n=lC,i=fC,r=!0,s=vd("start","brush","end"),o=6,a;function c(m){var g=m.property("__brush",y).selectAll(".overlay").data([al("overlay")]);g.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Ui.overlay).merge(g).each(function(){var w=uy(this).extent;zt(this).attr("x",w[0][0]).attr("y",w[0][1]).attr("width",w[1][0]-w[0][0]).attr("height",w[1][1]-w[0][1])}),m.selectAll(".selection").data([al("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Ui.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var b=m.selectAll(".handle").data(e.handles,function(w){return w.type});b.exit().remove(),b.enter().append("rect").attr("class",function(w){return"handle handle--"+w.type}).attr("cursor",function(w){return Ui[w.type]}),m.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(i).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(m,g,b){m.tween?m.on("start.brush",function(w){u(this,arguments).beforestart().start(w)}).on("interrupt.brush end.brush",function(w){u(this,arguments).end(w)}).tween("brush",function(){var w=this,_=w.__brush,x=u(w,arguments),v=_.selection,E=e.input(typeof g=="function"?g.apply(this,arguments):g,_.extent),T=Ua(v,E);function k(A){_.selection=A===1&&E===null?null:T(A),l.call(w),x.brush()}return v!==null&&E!==null?k:k(1)}):m.each(function(){var w=this,_=arguments,x=w.__brush,v=e.input(typeof g=="function"?g.apply(w,_):g,x.extent),E=u(w,_).beforestart();Qo(w),x.selection=v===null?null:v,l.call(w),E.start(b).brush(b).end(b)})},c.clear=function(m,g){c.move(m,null,g)};function l(){var m=zt(this),g=uy(this).selection;g?(m.selectAll(".selection").style("display",null).attr("x",g[0][0]).attr("y",g[0][1]).attr("width",g[1][0]-g[0][0]).attr("height",g[1][1]-g[0][1]),m.selectAll(".handle").style("display",null).attr("x",function(b){return b.type[b.type.length-1]==="e"?g[1][0]-o/2:g[0][0]-o/2}).attr("y",function(b){return b.type[0]==="s"?g[1][1]-o/2:g[0][1]-o/2}).attr("width",function(b){return b.type==="n"||b.type==="s"?g[1][0]-g[0][0]+o:o}).attr("height",function(b){return b.type==="e"||b.type==="w"?g[1][1]-g[0][1]+o:o})):m.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(m,g,b){var w=m.__brush.emitter;return w&&(!b||!w.clean)?w:new h(m,g,b)}function h(m,g,b){this.that=m,this.args=g,this.state=m.__brush,this.active=0,this.clean=b}h.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(m,g){return this.starting?(this.starting=!1,this.emit("start",m,g)):this.emit("brush",m),this},brush:function(m,g){return this.emit("brush",m,g),this},end:function(m,g){return--this.active===0&&(delete this.state.emitter,this.emit("end",m,g)),this},emit:function(m,g,b){var w=zt(this.that).datum();s.call(m,this.that,new rC(m,{sourceEvent:g,target:c,selection:e.output(this.state.selection),mode:b,dispatch:s}),w)}};function f(m){if(a&&!m.touches||!n.apply(this,arguments))return;var g=this,b=m.target.__data__.type,w=(r&&m.metaKey?b="overlay":b)==="selection"?Xw:r&&m.altKey?_o:wo,_=e===lf?null:aC[b],x=e===cf?null:cC[b],v=uy(g),E=v.extent,T=v.selection,k=E[0][0],A,I,O=E[0][1],F,S,M=E[1][0],N,$,D=E[1][1],C,B,z=0,j=0,V,X=_&&x&&r&&m.shiftKey,tt,Dt,Y=Array.from(m.touches||[m],K=>{const Pt=K.identifier;return K=Yn(K,g),K.point0=K.slice(),K.identifier=Pt,K});Qo(g);var W=u(g,arguments,!0).beforestart();if(b==="overlay"){T&&(V=!0);const K=[Y[0],Y[1]||Y[0]];v.selection=T=[[A=e===lf?k:Me(K[0][0],K[1][0]),F=e===cf?O:Me(K[0][1],K[1][1])],[N=e===lf?M:Ie(K[0][0],K[1][0]),C=e===cf?D:Ie(K[0][1],K[1][1])]],Y.length>1&&Q(m)}else A=T[0][0],F=T[0][1],N=T[1][0],C=T[1][1];I=A,S=F,$=N,B=C;var U=zt(g).attr("pointer-events","none"),G=U.selectAll(".overlay").attr("cursor",Ui[b]);if(m.touches)W.moved=P,W.ended=at;else{var H=zt(m.view).on("mousemove.brush",P,!0).on("mouseup.brush",at,!0);r&&H.on("keydown.brush",Nt,!0).on("keyup.brush",xt,!0),uE(m.view)}l.call(g),W.start(m,w.name);function P(K){for(const Pt of K.changedTouches||[K])for(const si of Y)si.identifier===Pt.identifier&&(si.cur=Yn(Pt,g));if(X&&!tt&&!Dt&&Y.length===1){const Pt=Y[0];Kw(Pt.cur[0]-Pt[0])>Kw(Pt.cur[1]-Pt[1])?Dt=!0:tt=!0}for(const Pt of Y)Pt.cur&&(Pt[0]=Pt.cur[0],Pt[1]=Pt.cur[1]);V=!0,cy(K),Q(K)}function Q(K){const Pt=Y[0],si=Pt.point0;var cn;switch(z=Pt[0]-si[0],j=Pt[1]-si[1],w){case ly:case Xw:{_&&(z=Ie(k-A,Me(M-N,z)),I=A+z,$=N+z),x&&(j=Ie(O-F,Me(D-C,j)),S=F+j,B=C+j);break}case wo:{Y[1]?(_&&(I=Ie(k,Me(M,Y[0][0])),$=Ie(k,Me(M,Y[1][0])),_=1),x&&(S=Ie(O,Me(D,Y[0][1])),B=Ie(O,Me(D,Y[1][1])),x=1)):(_<0?(z=Ie(k-A,Me(M-A,z)),I=A+z,$=N):_>0&&(z=Ie(k-N,Me(M-N,z)),I=A,$=N+z),x<0?(j=Ie(O-F,Me(D-F,j)),S=F+j,B=C):x>0&&(j=Ie(O-C,Me(D-C,j)),S=F,B=C+j));break}case _o:{_&&(I=Ie(k,Me(M,A-z*_)),$=Ie(k,Me(M,N+z*_))),x&&(S=Ie(O,Me(D,F-j*x)),B=Ie(O,Me(D,C+j*x)));break}}$<I&&(_*=-1,cn=A,A=N,N=cn,cn=I,I=$,$=cn,b in Jw&&G.attr("cursor",Ui[b=Jw[b]])),B<S&&(x*=-1,cn=F,F=C,C=cn,cn=S,S=B,B=cn,b in Zw&&G.attr("cursor",Ui[b=Zw[b]])),v.selection&&(T=v.selection),tt&&(I=T[0][0],$=T[1][0]),Dt&&(S=T[0][1],B=T[1][1]),(T[0][0]!==I||T[0][1]!==S||T[1][0]!==$||T[1][1]!==B)&&(v.selection=[[I,S],[$,B]],l.call(g),W.brush(K,w.name))}function at(K){if(sC(K),K.touches){if(K.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else fE(K.view,V),H.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);U.attr("pointer-events","all"),G.attr("cursor",Ui.overlay),v.selection&&(T=v.selection),hC(T)&&(v.selection=null,l.call(g)),W.end(K,w.name)}function Nt(K){switch(K.keyCode){case 16:{X=_&&x;break}case 18:{w===wo&&(_&&(N=$-z*_,A=I+z*_),x&&(C=B-j*x,F=S+j*x),w=_o,Q(K));break}case 32:{(w===wo||w===_o)&&(_<0?N=$-z:_>0&&(A=I-z),x<0?C=B-j:x>0&&(F=S-j),w=ly,G.attr("cursor",Ui.selection),Q(K));break}default:return}cy(K)}function xt(K){switch(K.keyCode){case 16:{X&&(tt=Dt=X=!1,Q(K));break}case 18:{w===_o&&(_<0?N=$:_>0&&(A=I),x<0?C=B:x>0&&(F=S),w=wo,Q(K));break}case 32:{w===ly&&(K.altKey?(_&&(N=$-z*_,A=I+z*_),x&&(C=B-j*x,F=S+j*x),w=_o):(_<0?N=$:_>0&&(A=I),x<0?C=B:x>0&&(F=S),w=wo),G.attr("cursor",Ui[b]),Q(K));break}default:return}cy(K)}}function d(m){u(this,arguments).moved(m)}function p(m){u(this,arguments).ended(m)}function y(){var m=this.__brush||{selection:null};return m.extent=D0(t.apply(this,arguments)),m.dim=e,m}return c.extent=function(m){return arguments.length?(t=typeof m=="function"?m:ay(D0(m)),c):t},c.filter=function(m){return arguments.length?(n=typeof m=="function"?m:ay(!!m),c):n},c.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:ay(!!m),c):i},c.handleSize=function(m){return arguments.length?(o=+m,c):o},c.keyModifiers=function(m){return arguments.length?(r=!!m,c):r},c.on=function(){var m=s.on.apply(s,arguments);return m===s?c:m},c}const C0=Math.PI,B0=2*C0,As=1e-6,mC=B0-As;function FE(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function gC(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return FE;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let DE=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?FE:gC(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,c=i-t,l=r-n,u=o-t,h=a-n,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>As)if(!(Math.abs(h*c-l*u)>As)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=i-o,p=r-a,y=c*c+l*l,m=d*d+p*p,g=Math.sqrt(y),b=Math.sqrt(f),w=s*Math.tan((C0-Math.acos((y+f-m)/(2*g*b)))/2),_=w/b,x=w/g;Math.abs(_-1)>As&&this._append`L${t+_*u},${n+_*h}`,this._append`A${s},${s},0,0,${+(h*d>u*p)},${this._x1=t+x*c},${this._y1=n+x*l}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),c=i*Math.sin(r),l=t+a,u=n+c,h=1^o,f=o?r-s:s-r;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>As||Math.abs(this._y1-u)>As)&&this._append`L${l},${u}`,i&&(f<0&&(f=f%B0+B0),f>mC?this._append`A${i},${i},0,1,${h},${t-a},${n-c}A${i},${i},0,1,${h},${this._x1=l},${this._y1=u}`:f>As&&this._append`A${i},${i},0,${+(f>=C0)},${h},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function tr(e=3){return new DE(+e)}var bC=Array.prototype,CE=bC.slice;function wC(e,t){return e-t}function _C(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}const Ir=e=>()=>e;function vC(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=xC(e,t[n]))return r;return 0}function xC(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var c=e[s],l=c[0],u=c[1],h=e[a],f=h[0],d=h[1];if(SC(c,h,t))return 0;u>i!=d>i&&n<(f-l)*(i-u)/(d-u)+l&&(r=-r)}return r}function SC(e,t,n){var i;return EC(e,t,n)&&AC(e[i=+(e[0]===t[0])],n[i],t[i])}function EC(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function AC(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function TC(){}var zi=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function sh(){var e=1,t=1,n=$g,i=c;function r(l){var u=n(l);if(Array.isArray(u))u=u.slice().sort(wC);else{const h=Ae(l,IC);for(u=Hr(...GS(h[0],h[1],u),u);u[u.length-1]>=h[1];)u.pop();for(;u[1]<h[0];)u.shift()}return u.map(h=>s(l,h))}function s(l,u){const h=u==null?NaN:+u;if(isNaN(h))throw new Error(`invalid value: ${u}`);var f=[],d=[];return o(l,h,function(p){i(p,l,h),_C(p)>0?f.push([p]):d.push(p)}),d.forEach(function(p){for(var y=0,m=f.length,g;y<m;++y)if(vC((g=f[y])[0],p)!==-1){g.push(p);return}}),{type:"MultiPolygon",value:u,coordinates:f}}function o(l,u,h){var f=new Array,d=new Array,p,y,m,g,b,w;for(p=y=-1,g=_s(l[0],u),zi[g<<1].forEach(_);++p<e-1;)m=g,g=_s(l[p+1],u),zi[m|g<<1].forEach(_);for(zi[g<<0].forEach(_);++y<t-1;){for(p=-1,g=_s(l[y*e+e],u),b=_s(l[y*e],u),zi[g<<1|b<<2].forEach(_);++p<e-1;)m=g,g=_s(l[y*e+e+p+1],u),w=b,b=_s(l[y*e+p+1],u),zi[m|g<<1|b<<2|w<<3].forEach(_);zi[g|b<<3].forEach(_)}for(p=-1,b=l[y*e]>=u,zi[b<<2].forEach(_);++p<e-1;)w=b,b=_s(l[y*e+p+1],u),zi[b<<2|w<<3].forEach(_);zi[b<<3].forEach(_);function _(x){var v=[x[0][0]+p,x[0][1]+y],E=[x[1][0]+p,x[1][1]+y],T=a(v),k=a(E),A,I;(A=d[T])?(I=f[k])?(delete d[A.end],delete f[I.start],A===I?(A.ring.push(E),h(A.ring)):f[A.start]=d[I.end]={start:A.start,end:I.end,ring:A.ring.concat(I.ring)}):(delete d[A.end],A.ring.push(E),d[A.end=k]=A):(A=f[k])?(I=d[T])?(delete f[A.start],delete d[I.end],A===I?(A.ring.push(E),h(A.ring)):f[I.start]=d[A.end]={start:I.start,end:A.end,ring:I.ring.concat(A.ring)}):(delete f[A.start],A.ring.unshift(v),f[A.start=T]=A):f[T]=d[k]={start:T,end:k,ring:[v,E]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function c(l,u,h){l.forEach(function(f){var d=f[0],p=f[1],y=d|0,m=p|0,g=fy(u[m*e+y]);d>0&&d<e&&y===d&&(f[0]=t_(d,fy(u[m*e+y-1]),g,h)),p>0&&p<t&&m===p&&(f[1]=t_(p,fy(u[(m-1)*e+y]),g,h))})}return r.contour=s,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),h=Math.floor(l[1]);if(!(u>=0&&h>=0))throw new Error("invalid size");return e=u,t=h,r},r.thresholds=function(l){return arguments.length?(n=typeof l=="function"?l:Array.isArray(l)?Ir(CE.call(l)):Ir(l),r):n},r.smooth=function(l){return arguments.length?(i=l?c:TC,r):i===c},r}function IC(e){return isFinite(e)?e:NaN}function _s(e,t){return e==null?!1:+e>=t}function fy(e){return e==null||isNaN(e=+e)?-1/0:e}function t_(e,t,n,i){const r=i-t,s=n-t,o=isFinite(r)||isFinite(s)?r/s:Math.sign(r)/Math.sign(s);return isNaN(o)?e:e+o-.5}function MC(e){return e[0]}function NC(e){return e[1]}function $C(){return 1}function kC(){var e=MC,t=NC,n=$C,i=960,r=500,s=20,o=2,a=s*3,c=i+a*2>>o,l=r+a*2>>o,u=Ir(20);function h(b){var w=new Float32Array(c*l),_=Math.pow(2,-o),x=-1;for(const F of b){var v=(e(F,++x,b)+a)*_,E=(t(F,x,b)+a)*_,T=+n(F,x,b);if(T&&v>=0&&v<c&&E>=0&&E<l){var k=Math.floor(v),A=Math.floor(E),I=v-k-.5,O=E-A-.5;w[k+A*c]+=(1-I)*(1-O)*T,w[k+1+A*c]+=I*(1-O)*T,w[k+1+(A+1)*c]+=I*O*T,w[k+(A+1)*c]+=(1-I)*O*T}}return zS({data:w,width:c,height:l},s*_),w}function f(b){var w=h(b),_=u(w),x=Math.pow(2,2*o);return Array.isArray(_)||(_=Hr(Number.MIN_VALUE,oe(w)/x,_)),sh().size([c,l]).thresholds(_.map(v=>v*x))(w).map((v,E)=>(v.value=+_[E],d(v)))}f.contours=function(b){var w=h(b),_=sh().size([c,l]),x=Math.pow(2,2*o),v=E=>{E=+E;var T=d(_.contour(w,E*x));return T.value=E,T};return Object.defineProperty(v,"max",{get:()=>oe(w)/x}),v};function d(b){return b.coordinates.forEach(p),b}function p(b){b.forEach(y)}function y(b){b.forEach(m)}function m(b){b[0]=b[0]*Math.pow(2,o)-a,b[1]=b[1]*Math.pow(2,o)-a}function g(){return a=s*3,c=i+a*2>>o,l=r+a*2>>o,f}return f.x=function(b){return arguments.length?(e=typeof b=="function"?b:Ir(+b),f):e},f.y=function(b){return arguments.length?(t=typeof b=="function"?b:Ir(+b),f):t},f.weight=function(b){return arguments.length?(n=typeof b=="function"?b:Ir(+b),f):n},f.size=function(b){if(!arguments.length)return[i,r];var w=+b[0],_=+b[1];if(!(w>=0&&_>=0))throw new Error("invalid size");return i=w,r=_,g()},f.cellSize=function(b){if(!arguments.length)return 1<<o;if(!((b=+b)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(b)/Math.LN2),g()},f.thresholds=function(b){return arguments.length?(u=typeof b=="function"?b:Array.isArray(b)?Ir(CE.call(b)):Ir(b),f):u},f.bandwidth=function(b){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((b=+b)>=0))throw new Error("invalid bandwidth");return s=(Math.sqrt(4*b*b+1)-1)/2,g()},f}const ar=11102230246251565e-32,Ne=134217729,OC=(3+8*ar)*ar;function hy(e,t,n,i,r){let s,o,a,c,l=t[0],u=i[0],h=0,f=0;u>l==u>-l?(s=l,l=t[++h]):(s=u,u=i[++f]);let d=0;if(h<e&&f<n)for(u>l==u>-l?(o=l+s,a=s-(o-l),l=t[++h]):(o=u+s,a=s-(o-u),u=i[++f]),s=o,a!==0&&(r[d++]=a);h<e&&f<n;)u>l==u>-l?(o=s+l,c=o-s,a=s-(o-c)+(l-c),l=t[++h]):(o=s+u,c=o-s,a=s-(o-c)+(u-c),u=i[++f]),s=o,a!==0&&(r[d++]=a);for(;h<e;)o=s+l,c=o-s,a=s-(o-c)+(l-c),l=t[++h],s=o,a!==0&&(r[d++]=a);for(;f<n;)o=s+u,c=o-s,a=s-(o-c)+(u-c),u=i[++f],s=o,a!==0&&(r[d++]=a);return(s!==0||d===0)&&(r[d++]=s),d}function LC(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function Pl(e){return new Float64Array(e)}const RC=(3+16*ar)*ar,FC=(2+12*ar)*ar,DC=(9+64*ar)*ar*ar,vo=Pl(4),e_=Pl(8),n_=Pl(12),i_=Pl(16),Fe=Pl(4);function CC(e,t,n,i,r,s,o){let a,c,l,u,h,f,d,p,y,m,g,b,w,_,x,v,E,T;const k=e-r,A=n-r,I=t-s,O=i-s;_=k*O,f=Ne*k,d=f-(f-k),p=k-d,f=Ne*O,y=f-(f-O),m=O-y,x=p*m-(_-d*y-p*y-d*m),v=I*A,f=Ne*I,d=f-(f-I),p=I-d,f=Ne*A,y=f-(f-A),m=A-y,E=p*m-(v-d*y-p*y-d*m),g=x-E,h=x-g,vo[0]=x-(g+h)+(h-E),b=_+g,h=b-_,w=_-(b-h)+(g-h),g=w-v,h=w-g,vo[1]=w-(g+h)+(h-v),T=b+g,h=T-b,vo[2]=b-(T-h)+(g-h),vo[3]=T;let F=LC(4,vo),S=FC*o;if(F>=S||-F>=S||(h=e-k,a=e-(k+h)+(h-r),h=n-A,l=n-(A+h)+(h-r),h=t-I,c=t-(I+h)+(h-s),h=i-O,u=i-(O+h)+(h-s),a===0&&c===0&&l===0&&u===0)||(S=DC*o+OC*Math.abs(F),F+=k*u+O*a-(I*l+A*c),F>=S||-F>=S))return F;_=a*O,f=Ne*a,d=f-(f-a),p=a-d,f=Ne*O,y=f-(f-O),m=O-y,x=p*m-(_-d*y-p*y-d*m),v=c*A,f=Ne*c,d=f-(f-c),p=c-d,f=Ne*A,y=f-(f-A),m=A-y,E=p*m-(v-d*y-p*y-d*m),g=x-E,h=x-g,Fe[0]=x-(g+h)+(h-E),b=_+g,h=b-_,w=_-(b-h)+(g-h),g=w-v,h=w-g,Fe[1]=w-(g+h)+(h-v),T=b+g,h=T-b,Fe[2]=b-(T-h)+(g-h),Fe[3]=T;const M=hy(4,vo,4,Fe,e_);_=k*u,f=Ne*k,d=f-(f-k),p=k-d,f=Ne*u,y=f-(f-u),m=u-y,x=p*m-(_-d*y-p*y-d*m),v=I*l,f=Ne*I,d=f-(f-I),p=I-d,f=Ne*l,y=f-(f-l),m=l-y,E=p*m-(v-d*y-p*y-d*m),g=x-E,h=x-g,Fe[0]=x-(g+h)+(h-E),b=_+g,h=b-_,w=_-(b-h)+(g-h),g=w-v,h=w-g,Fe[1]=w-(g+h)+(h-v),T=b+g,h=T-b,Fe[2]=b-(T-h)+(g-h),Fe[3]=T;const N=hy(M,e_,4,Fe,n_);_=a*u,f=Ne*a,d=f-(f-a),p=a-d,f=Ne*u,y=f-(f-u),m=u-y,x=p*m-(_-d*y-p*y-d*m),v=c*l,f=Ne*c,d=f-(f-c),p=c-d,f=Ne*l,y=f-(f-l),m=l-y,E=p*m-(v-d*y-p*y-d*m),g=x-E,h=x-g,Fe[0]=x-(g+h)+(h-E),b=_+g,h=b-_,w=_-(b-h)+(g-h),g=w-v,h=w-g,Fe[1]=w-(g+h)+(h-v),T=b+g,h=T-b,Fe[2]=b-(T-h)+(g-h),Fe[3]=T;const $=hy(N,n_,4,Fe,i_);return i_[$-1]}function vu(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),c=o-a,l=Math.abs(o+a);return Math.abs(c)>=RC*l?c:-CC(e,t,n,i,r,s,l)}const r_=Math.pow(2,-52),xu=new Uint32Array(512);class oh{static from(t,n=jC,i=qC){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new oh(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,c=1/0,l=-1/0,u=-1/0;for(let A=0;A<o;A++){const I=t[2*A],O=t[2*A+1];I<a&&(a=I),O<c&&(c=O),I>l&&(l=I),O>u&&(u=O),this._ids[A]=A}const h=(a+l)/2,f=(c+u)/2;let d=1/0,p,y,m;for(let A=0;A<o;A++){const I=dy(h,f,t[2*A],t[2*A+1]);I<d&&(p=A,d=I)}const g=t[2*p],b=t[2*p+1];d=1/0;for(let A=0;A<o;A++){if(A===p)continue;const I=dy(g,b,t[2*A],t[2*A+1]);I<d&&I>0&&(y=A,d=I)}let w=t[2*y],_=t[2*y+1],x=1/0;for(let A=0;A<o;A++){if(A===p||A===y)continue;const I=UC(g,b,w,_,t[2*A],t[2*A+1]);I<x&&(m=A,x=I)}let v=t[2*m],E=t[2*m+1];if(x===1/0){for(let O=0;O<o;O++)this._dists[O]=t[2*O]-t[0]||t[2*O+1]-t[1];Do(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let I=0;for(let O=0,F=-1/0;O<o;O++){const S=this._ids[O];this._dists[S]>F&&(A[I++]=S,F=this._dists[S])}this.hull=A.subarray(0,I),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(vu(g,b,w,_,v,E)<0){const A=y,I=w,O=_;y=m,w=v,_=E,m=A,v=I,E=O}const T=zC(g,b,w,_,v,E);this._cx=T.x,this._cy=T.y;for(let A=0;A<o;A++)this._dists[A]=dy(t[2*A],t[2*A+1],T.x,T.y);Do(this._ids,this._dists,0,o-1),this._hullStart=p;let k=3;i[p]=n[m]=y,i[y]=n[p]=m,i[m]=n[y]=p,r[p]=0,r[y]=1,r[m]=2,s.fill(-1),s[this._hashKey(g,b)]=p,s[this._hashKey(w,_)]=y,s[this._hashKey(v,E)]=m,this.trianglesLen=0,this._addTriangle(p,y,m,-1,-1,-1);for(let A=0,I,O;A<this._ids.length;A++){const F=this._ids[A],S=t[2*F],M=t[2*F+1];if(A>0&&Math.abs(S-I)<=r_&&Math.abs(M-O)<=r_||(I=S,O=M,F===p||F===y||F===m))continue;let N=0;for(let z=0,j=this._hashKey(S,M);z<this._hashSize&&(N=s[(j+z)%this._hashSize],!(N!==-1&&N!==i[N]));z++);N=n[N];let $=N,D;for(;D=i[$],vu(S,M,t[2*$],t[2*$+1],t[2*D],t[2*D+1])>=0;)if($=D,$===N){$=-1;break}if($===-1)continue;let C=this._addTriangle($,F,i[$],-1,-1,r[$]);r[F]=this._legalize(C+2),r[$]=C,k++;let B=i[$];for(;D=i[B],vu(S,M,t[2*B],t[2*B+1],t[2*D],t[2*D+1])<0;)C=this._addTriangle(B,F,D,r[F],-1,r[B]),r[F]=this._legalize(C+2),i[B]=B,k--,B=D;if($===N)for(;D=n[$],vu(S,M,t[2*D],t[2*D+1],t[2*$],t[2*$+1])<0;)C=this._addTriangle(D,F,$,-1,r[$],r[D]),this._legalize(C+2),r[D]=C,i[$]=$,k--,$=D;this._hullStart=n[F]=$,i[$]=n[B]=F,i[F]=B,s[this._hashKey(S,M)]=F,s[this._hashKey(t[2*$],t[2*$+1])]=$}this.hull=new Uint32Array(k);for(let A=0,I=this._hullStart;A<k;A++)this.hull[A]=I,I=i[I];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(BC(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],c=t-t%3;if(o=c+(t+2)%3,a===-1){if(s===0)break;t=xu[--s];continue}const l=a-a%3,u=c+(t+1)%3,h=l+(a+2)%3,f=n[o],d=n[t],p=n[u],y=n[h];if(PC(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1],r[2*y],r[2*y+1])){n[t]=y,n[a]=f;const g=i[h];if(g===-1){let w=this._hullStart;do{if(this._hullTri[w]===h){this._hullTri[w]=t;break}w=this._hullPrev[w]}while(w!==this._hullStart)}this._link(t,g),this._link(a,i[o]),this._link(o,h);const b=l+(a+1)%3;s<xu.length&&(xu[s++]=b)}else{if(s===0)break;t=xu[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function BC(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function dy(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function PC(e,t,n,i,r,s,o,a){const c=e-o,l=t-a,u=n-o,h=i-a,f=r-o,d=s-a,p=c*c+l*l,y=u*u+h*h,m=f*f+d*d;return c*(h*m-y*d)-l*(u*m-y*f)+p*(u*d-h*f)<0}function UC(e,t,n,i,r,s){const o=n-e,a=i-t,c=r-e,l=s-t,u=o*o+a*a,h=c*c+l*l,f=.5/(o*l-a*c),d=(l*u-a*h)*f,p=(o*h-c*u)*f;return d*d+p*p}function zC(e,t,n,i,r,s){const o=n-e,a=i-t,c=r-e,l=s-t,u=o*o+a*a,h=c*c+l*l,f=.5/(o*l-a*c),d=e+(l*u-a*h)*f,p=t+(o*h-c*u)*f;return{x:d,y:p}}function Do(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;hc(e,r,s),t[e[n]]>t[e[i]]&&hc(e,n,i),t[e[s]]>t[e[i]]&&hc(e,s,i),t[e[n]]>t[e[s]]&&hc(e,n,s);const a=e[s],c=t[a];for(;;){do s++;while(t[e[s]]<c);do o--;while(t[e[o]]>c);if(o<s)break;hc(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(Do(e,t,s,i),Do(e,t,n,o-1)):(Do(e,t,n,o-1),Do(e,t,s,i))}}function hc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function jC(e){return e[0]}function qC(e){return e[1]}const s_=1e-6;class Ds{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>s_||Math.abs(this._y1-s)>s_)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class P0{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let YC=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let y=0,m=0,g=i.length,b,w;y<g;y+=3,m+=2){const _=i[y]*2,x=i[y+1]*2,v=i[y+2]*2,E=t[_],T=t[_+1],k=t[x],A=t[x+1],I=t[v],O=t[v+1],F=k-E,S=A-T,M=I-E,N=O-T,$=(F*N-S*M)*2;if(Math.abs($)<1e-9){if(s===void 0){s=o=0;for(const C of n)s+=t[C*2],o+=t[C*2+1];s/=n.length,o/=n.length}const D=1e9*Math.sign((s-E)*N-(o-T)*M);b=(E+I)/2-D*N,w=(T+O)/2+D*M}else{const D=1/$,C=F*F+S*S,B=M*M+N*N;b=E+(N*C-S*B)*D,w=T+(F*B-M*C)*D}a[m]=b,a[m+1]=w}let c=n[n.length-1],l,u=c*4,h,f=t[2*c],d,p=t[2*c+1];r.fill(0);for(let y=0;y<n.length;++y)c=n[y],l=u,h=f,d=p,u=c*4,f=t[2*c],p=t[2*c+1],r[l+2]=r[u]=d-p,r[l+3]=r[u+1]=f-h}render(t){const n=t==null?t=new Ds:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let u=0,h=i.length;u<h;++u){const f=i[u];if(f<u)continue;const d=Math.floor(u/3)*2,p=Math.floor(f/3)*2,y=o[d],m=o[d+1],g=o[p],b=o[p+1];this._renderSegment(y,m,g,b,t)}let c,l=s[s.length-1];for(let u=0;u<s.length;++u){c=l,l=s[u];const h=Math.floor(r[l]/3)*2,f=o[h],d=o[h+1],p=c*4,y=this._project(f,d,a[p+2],a[p+3]);y&&this._renderSegment(f,d,y[0],y[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Ds:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Ds:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new P0;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),c=this._regioncode(i,r);a===0&&c===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){t:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,c=r.length;a<c;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+c-2)%c]&&n[(s+3)%o]===r[(a+c-1)%c]){yield i;break t}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let c=o;do{const l=Math.floor(c/3);if(a.push(n[l*2],n[l*2+1]),c=c%3===2?c-2:c+1,s[c]!==t)break;c=r[c]}while(c!==o&&c!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],c=n[i-1],l,u=this._regioncode(a,c),h,f=0;for(let d=0;d<i;d+=2)if(s=a,o=c,a=n[d],c=n[d+1],l=u,u=this._regioncode(a,c),l===0&&u===0)h=f,f=0,r?r.push(a,c):r=[a,c];else{let p,y,m,g,b;if(l===0){if((p=this._clipSegment(s,o,a,c,l,u))===null)continue;[y,m,g,b]=p}else{if((p=this._clipSegment(a,c,s,o,u,l))===null)continue;[g,b,y,m]=p,h=f,f=this._edgecode(y,m),h&&f&&this._edge(t,h,f,r,r.length),r?r.push(y,m):r=[y,m]}h=f,f=this._edgecode(g,b),h&&f&&this._edge(t,h,f,r,r.length),r?r.push(g,b):r=[g,b]}if(r)h=f,f=this._edgecode(r[0],r[1]),h&&f&&this._edge(t,h,f,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let c,l,u=s||o;u&8?(c=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):u&4?(c=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):u&2?(l=n+(r-n)*(this.xmax-t)/(i-t),c=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),c=this.xmin),s?(t=c,n=l,s=this._regioncode(t,n)):(i=c,r=l,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),c;if((c=this._project(a[0],a[1],i,r))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(c[0],c[1]),a=this._clipFinite(t,a))for(let l=0,u=a.length,h,f=this._edgecode(a[u-2],a[u-1]);l<u;l+=2)h=f,f=this._edgecode(a[l],a[l+1]),h&&f&&(l=this._edge(t,h,f,a,l),u=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,c;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(c=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(c=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,c=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,c=n+(s=o)*r)}return[a,c]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const VC=2*Math.PI,xo=Math.pow;function WC(e){return e[0]}function GC(e){return e[1]}function HC(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function XC(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class ls{static from(t,n=WC,i=GC,r){return new ls("length"in t?KC(t,n,i,r):Float64Array.from(QC(t,n,i,r)))}constructor(t){this._delaunator=new oh(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&HC(t)){this.collinear=Int32Array.from({length:n.length/2},(f,d)=>d).sort((f,d)=>n[2*f]-n[2*d]||n[2*f+1]-n[2*d+1]);const c=this.collinear[0],l=this.collinear[this.collinear.length-1],u=[n[2*c],n[2*c+1],n[2*l],n[2*l+1]],h=1e-8*Math.hypot(u[3]-u[1],u[2]-u[0]);for(let f=0,d=n.length/2;f<d;++f){const p=XC(n[2*f],n[2*f+1],h);n[2*f]=p[0],n[2*f+1]=p[1]}this._delaunator=new oh(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,l=i.length;c<l;++c){const u=s[c%3===2?c-2:c+1];(i[c]===-1||o[u]===-1)&&(o[u]=c)}for(let c=0,l=r.length;c<l;++c)a[r[c]]=c;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new YC(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const h=a.indexOf(t);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const c=n[t];if(c===-1)return;let l=c,u=-1;do{if(yield u=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const h=i[(r[t]+1)%i.length];h!==u&&(yield h);return}}while(l!==c)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:c,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let u=t,h=xo(n-l[t*2],2)+xo(i-l[t*2+1],2);const f=r[t];let d=f;do{let p=c[d];const y=xo(n-l[p*2],2)+xo(i-l[p*2+1],2);if(y<h&&(h=y,u=p),d=d%3===2?d-2:d+1,c[d]!==t)break;if(d=a[d],d===-1){if(d=s[(o[t]+1)%s.length],d!==p&&xo(n-l[d*2],2)+xo(i-l[d*2+1],2)<h)return d;break}}while(d!==f);return u}render(t){const n=t==null?t=new Ds:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const c=r[o];if(c<o)continue;const l=s[o]*2,u=s[c]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[u],i[u+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new Ds:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],c=r[s+1];t.moveTo(a+n,c),t.arc(a,c,n,0,VC)}return i&&i.value()}renderHull(t){const n=t==null?t=new Ds:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const c=2*i[a];t.lineTo(r[c],r[c+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new P0;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Ds:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,c=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[c],r[c+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new P0;return this.renderTriangle(t,n),n.value()}}function KC(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*QC(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function JC(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ah(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function va(e){return e=ah(Math.abs(e)),e?e[1]:NaN}function ZC(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],c=0;r>0&&a>0&&(c+a+1>i&&(a=Math.max(1,i-c)),s.push(n.substring(r-=a,r+a)),!((c+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function t7(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var e7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cl(e){if(!(t=e7.exec(e)))throw new Error("invalid format: "+e);var t;return new Vg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}cl.prototype=Vg.prototype;function Vg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Vg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function n7(e){t:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break t;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var BE;function i7(e,t){var n=ah(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(BE=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ah(e,Math.max(0,t+s-1))[0]}function o_(e,t){var n=ah(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const a_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:JC,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>o_(e*100,t),r:o_,s:i7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c_(e){return e}var l_=Array.prototype.map,u_=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function r7(e){var t=e.grouping===void 0||e.thousands===void 0?c_:ZC(l_.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?c_:t7(l_.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(h){h=cl(h);var f=h.fill,d=h.align,p=h.sign,y=h.symbol,m=h.zero,g=h.width,b=h.comma,w=h.precision,_=h.trim,x=h.type;x==="n"?(b=!0,x="g"):a_[x]||(w===void 0&&(w=12),_=!0,x="g"),(m||f==="0"&&d==="=")&&(m=!0,f="0",d="=");var v=y==="$"?n:y==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",E=y==="$"?i:/[%p]/.test(x)?o:"",T=a_[x],k=/[defgprs%]/.test(x);w=w===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function A(I){var O=v,F=E,S,M,N;if(x==="c")F=T(I)+F,I="";else{I=+I;var $=I<0||1/I<0;if(I=isNaN(I)?c:T(Math.abs(I),w),_&&(I=n7(I)),$&&+I==0&&p!=="+"&&($=!1),O=($?p==="("?p:a:p==="-"||p==="("?"":p)+O,F=(x==="s"?u_[8+BE/3]:"")+F+($&&p==="("?")":""),k){for(S=-1,M=I.length;++S<M;)if(N=I.charCodeAt(S),48>N||N>57){F=(N===46?r+I.slice(S+1):I.slice(S))+F,I=I.slice(0,S);break}}}b&&!m&&(I=t(I,1/0));var D=O.length+I.length+F.length,C=D<g?new Array(g-D+1).join(f):"";switch(b&&m&&(I=t(C+I,C.length?g-F.length:1/0),C=""),d){case"<":I=O+I+F+C;break;case"=":I=O+C+I+F;break;case"^":I=C.slice(0,D=C.length>>1)+O+I+F+C.slice(D);break;default:I=C+O+I+F;break}return s(I)}return A.toString=function(){return h+""},A}function u(h,f){var d=l((h=cl(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(va(f)/3)))*3,y=Math.pow(10,-p),m=u_[8+p/3];return function(g){return d(y*g)+m}}return{format:l,formatPrefix:u}}var Su,Ul,PE;s7({thousands:",",grouping:[3],currency:["$",""]});function s7(e){return Su=r7(e),Ul=Su.format,PE=Su.formatPrefix,Su}function o7(e){return Math.max(0,-va(Math.abs(e)))}function a7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(va(t)/3)))*3-va(Math.abs(e)))}function c7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,va(t)-va(e))+1}var nt=1e-6,ch=1e-12,vt=Math.PI,ce=vt/2,f_=vt/4,vn=vt*2,Ee=180/vt,$t=vt/180,Rt=Math.abs,za=Math.atan,Kn=Math.atan2,rt=Math.cos,Eu=Math.ceil,UE=Math.exp,U0=Math.hypot,lh=Math.log,py=Math.pow,J=Math.sin,Nn=Math.sign||function(e){return e>0?1:e<0?-1:0},Ye=Math.sqrt,Wg=Math.tan;function zE(e){return e>1?0:e<-1?vt:Math.acos(e)}function en(e){return e>1?ce:e<-1?-ce:Math.asin(e)}function pn(){}function uh(e,t){e&&d_.hasOwnProperty(e.type)&&d_[e.type](e,t)}var h_={Feature:function(e,t){uh(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)uh(n[i].geometry,t)}},d_={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){z0(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)z0(n[i],t,0)},Polygon:function(e,t){p_(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)p_(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)uh(n[i],t)}};function z0(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function p_(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)z0(e[n],t,1);t.polygonEnd()}function Nr(e,t){e&&h_.hasOwnProperty(e.type)?h_[e.type](e,t):uh(e,t)}function j0(e){return[Kn(e[1],e[0]),en(e[2])]}function xa(e){var t=e[0],n=e[1],i=rt(n);return[i*rt(t),i*J(t),J(n)]}function Au(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function fh(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function yy(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Tu(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function q0(e){var t=Ye(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ic,hh,dh,ph,yh,mh,gh,bh,Y0,V0,W0,jE,qE,Be,Pe,Ue,Gn={sphere:pn,point:Gg,lineStart:y_,lineEnd:m_,polygonStart:function(){Gn.lineStart=f7,Gn.lineEnd=h7},polygonEnd:function(){Gn.lineStart=y_,Gn.lineEnd=m_}};function Gg(e,t){e*=$t,t*=$t;var n=rt(t);zl(n*rt(e),n*J(e),J(t))}function zl(e,t,n){++Ic,dh+=(e-dh)/Ic,ph+=(t-ph)/Ic,yh+=(n-yh)/Ic}function y_(){Gn.point=l7}function l7(e,t){e*=$t,t*=$t;var n=rt(t);Be=n*rt(e),Pe=n*J(e),Ue=J(t),Gn.point=u7,zl(Be,Pe,Ue)}function u7(e,t){e*=$t,t*=$t;var n=rt(t),i=n*rt(e),r=n*J(e),s=J(t),o=Kn(Ye((o=Pe*s-Ue*r)*o+(o=Ue*i-Be*s)*o+(o=Be*r-Pe*i)*o),Be*i+Pe*r+Ue*s);hh+=o,mh+=o*(Be+(Be=i)),gh+=o*(Pe+(Pe=r)),bh+=o*(Ue+(Ue=s)),zl(Be,Pe,Ue)}function m_(){Gn.point=Gg}function f7(){Gn.point=d7}function h7(){YE(jE,qE),Gn.point=Gg}function d7(e,t){jE=e,qE=t,e*=$t,t*=$t,Gn.point=YE;var n=rt(t);Be=n*rt(e),Pe=n*J(e),Ue=J(t),zl(Be,Pe,Ue)}function YE(e,t){e*=$t,t*=$t;var n=rt(t),i=n*rt(e),r=n*J(e),s=J(t),o=Pe*s-Ue*r,a=Ue*i-Be*s,c=Be*r-Pe*i,l=U0(o,a,c),u=en(l),h=l&&-u/l;Y0.add(h*o),V0.add(h*a),W0.add(h*c),hh+=u,mh+=u*(Be+(Be=i)),gh+=u*(Pe+(Pe=r)),bh+=u*(Ue+(Ue=s)),zl(Be,Pe,Ue)}function p7(e){Ic=hh=dh=ph=yh=mh=gh=bh=0,Y0=new xi,V0=new xi,W0=new xi,Nr(e,Gn);var t=+Y0,n=+V0,i=+W0,r=U0(t,n,i);return r<ch&&(t=mh,n=gh,i=bh,hh<nt&&(t=dh,n=ph,i=yh),r=U0(t,n,i),r<ch)?[NaN,NaN]:[Kn(n,t)*Ee,en(i/r)*Ee]}function G0(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function H0(e,t){return Rt(e)>vt&&(e-=Math.round(e/vn)*vn),[e,t]}H0.invert=H0;function VE(e,t,n){return(e%=vn)?t||n?G0(b_(e),w_(t,n)):b_(e):t||n?w_(t,n):H0}function g_(e){return function(t,n){return t+=e,Rt(t)>vt&&(t-=Math.round(t/vn)*vn),[t,n]}}function b_(e){var t=g_(e);return t.invert=g_(-e),t}function w_(e,t){var n=rt(e),i=J(e),r=rt(t),s=J(t);function o(a,c){var l=rt(c),u=rt(a)*l,h=J(a)*l,f=J(c),d=f*n+u*i;return[Kn(h*r-d*s,u*n-f*i),en(d*r+h*s)]}return o.invert=function(a,c){var l=rt(c),u=rt(a)*l,h=J(a)*l,f=J(c),d=f*r-h*s;return[Kn(h*r+f*s,u*n+d*i),en(d*n-u*i)]},o}function y7(e){e=VE(e[0]*$t,e[1]*$t,e.length>2?e[2]*$t:0);function t(n){return n=e(n[0]*$t,n[1]*$t),n[0]*=Ee,n[1]*=Ee,n}return t.invert=function(n){return n=e.invert(n[0]*$t,n[1]*$t),n[0]*=Ee,n[1]*=Ee,n},t}function m7(e,t,n,i,r,s){if(n){var o=rt(t),a=J(t),c=i*n;r==null?(r=t+i*vn,s=t-c/2):(r=__(o,r),s=__(o,s),(i>0?r<s:r>s)&&(r+=i*vn));for(var l,u=r;i>0?u>s:u<s;u-=c)l=j0([o,-a*rt(u),-a*J(u)]),e.point(l[0],l[1])}}function __(e,t){t=xa(t),t[0]-=e,q0(t);var n=zE(-t[1]);return((-t[2]<0?-n:n)+vn-nt)%vn}function WE(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:pn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function uf(e,t){return Rt(e[0]-t[0])<nt&&Rt(e[1]-t[1])<nt}function Iu(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function GE(e,t,n,i,r){var s=[],o=[],a,c;if(e.forEach(function(p){if(!((y=p.length-1)<=0)){var y,m=p[0],g=p[y],b;if(uf(m,g)){if(!m[2]&&!g[2]){for(r.lineStart(),a=0;a<y;++a)r.point((m=p[a])[0],m[1]);r.lineEnd();return}g[0]+=2*nt}s.push(b=new Iu(m,p,null,!0)),o.push(b.o=new Iu(m,null,b,!1)),s.push(b=new Iu(g,p,null,!1)),o.push(b.o=new Iu(g,null,b,!0))}}),!!s.length){for(o.sort(t),v_(s),v_(o),a=0,c=o.length;a<c;++a)o[a].e=n=!n;for(var l=s[0],u,h;;){for(var f=l,d=!0;f.v;)if((f=f.n)===l)return;u=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,c=u.length;a<c;++a)r.point((h=u[a])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(u=f.p.z,a=u.length-1;a>=0;--a)r.point((h=u[a])[0],h[1]);else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,u=f.z,d=!d}while(!f.v);r.lineEnd()}}}function v_(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function my(e){return Rt(e[0])<=vt?e[0]:Nn(e[0])*((Rt(e[0])+vt)%vn-vt)}function g7(e,t){var n=my(t),i=t[1],r=J(i),s=[J(n),-rt(n),0],o=0,a=0,c=new xi;r===1?i=ce+nt:r===-1&&(i=-ce-nt);for(var l=0,u=e.length;l<u;++l)if(f=(h=e[l]).length)for(var h,f,d=h[f-1],p=my(d),y=d[1]/2+f_,m=J(y),g=rt(y),b=0;b<f;++b,p=_,m=v,g=E,d=w){var w=h[b],_=my(w),x=w[1]/2+f_,v=J(x),E=rt(x),T=_-p,k=T>=0?1:-1,A=k*T,I=A>vt,O=m*v;if(c.add(Kn(O*k*J(A),g*E+O*rt(A))),o+=I?T+k*vn:T,I^p>=n^_>=n){var F=fh(xa(d),xa(w));q0(F);var S=fh(s,F);q0(S);var M=(I^T>=0?-1:1)*en(S[2]);(i>M||i===M&&(F[0]||F[1]))&&(a+=I^T>=0?1:-1)}}return(o<-nt||o<nt&&c<-ch)^a&1}function HE(e,t,n,i){return function(r){var s=t(r),o=WE(),a=t(o),c=!1,l,u,h,f={point:d,lineStart:y,lineEnd:m,polygonStart:function(){f.point=g,f.lineStart=b,f.lineEnd=w,u=[],l=[]},polygonEnd:function(){f.point=d,f.lineStart=y,f.lineEnd=m,u=KS(u);var _=g7(l,i);u.length?(c||(r.polygonStart(),c=!0),GE(u,w7,_,n,r)):_&&(c||(r.polygonStart(),c=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),c&&(r.polygonEnd(),c=!1),u=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(_,x){e(_,x)&&r.point(_,x)}function p(_,x){s.point(_,x)}function y(){f.point=p,s.lineStart()}function m(){f.point=d,s.lineEnd()}function g(_,x){h.push([_,x]),a.point(_,x)}function b(){a.lineStart(),h=[]}function w(){g(h[0][0],h[0][1]),a.lineEnd();var _=a.clean(),x=o.result(),v,E=x.length,T,k,A;if(h.pop(),l.push(h),h=null,!!E){if(_&1){if(k=x[0],(T=k.length-1)>0){for(c||(r.polygonStart(),c=!0),r.lineStart(),v=0;v<T;++v)r.point((A=k[v])[0],A[1]);r.lineEnd()}return}E>1&&_&2&&x.push(x.pop().concat(x.shift())),u.push(x.filter(b7))}}return f}}function b7(e){return e.length>1}function w7(e,t){return((e=e.x)[0]<0?e[1]-ce-nt:ce-e[1])-((t=t.x)[0]<0?t[1]-ce-nt:ce-t[1])}const x_=HE(function(){return!0},_7,x7,[-vt,-ce]);function _7(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?vt:-vt,c=Rt(s-t);Rt(c-vt)<nt?(e.point(t,n=(n+o)/2>0?ce:-ce),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&c>=vt&&(Rt(t-i)<nt&&(t-=i*nt),Rt(s-a)<nt&&(s-=a*nt),n=v7(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function v7(e,t,n,i){var r,s,o=J(e-n);return Rt(o)>nt?za((J(t)*(s=rt(i))*J(n)-J(i)*(r=rt(t))*J(e))/(r*s*o)):(t+i)/2}function x7(e,t,n,i){var r;if(e==null)r=n*ce,i.point(-vt,r),i.point(0,r),i.point(vt,r),i.point(vt,0),i.point(vt,-r),i.point(0,-r),i.point(-vt,-r),i.point(-vt,0),i.point(-vt,r);else if(Rt(e[0]-t[0])>nt){var s=e[0]<t[0]?vt:-vt;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function S7(e){var t=rt(e),n=6*$t,i=t>0,r=Rt(t)>nt;function s(u,h,f,d){m7(d,e,n,f,u,h)}function o(u,h){return rt(u)*rt(h)>t}function a(u){var h,f,d,p,y;return{lineStart:function(){p=d=!1,y=1},point:function(m,g){var b=[m,g],w,_=o(m,g),x=i?_?0:l(m,g):_?l(m+(m<0?vt:-vt),g):0;if(!h&&(p=d=_)&&u.lineStart(),_!==d&&(w=c(h,b),(!w||uf(h,w)||uf(b,w))&&(b[2]=1)),_!==d)y=0,_?(u.lineStart(),w=c(b,h),u.point(w[0],w[1])):(w=c(h,b),u.point(w[0],w[1],2),u.lineEnd()),h=w;else if(r&&h&&i^_){var v;!(x&f)&&(v=c(b,h,!0))&&(y=0,i?(u.lineStart(),u.point(v[0][0],v[0][1]),u.point(v[1][0],v[1][1]),u.lineEnd()):(u.point(v[1][0],v[1][1]),u.lineEnd(),u.lineStart(),u.point(v[0][0],v[0][1],3)))}_&&(!h||!uf(h,b))&&u.point(b[0],b[1]),h=b,d=_,f=x},lineEnd:function(){d&&u.lineEnd(),h=null},clean:function(){return y|(p&&d)<<1}}}function c(u,h,f){var d=xa(u),p=xa(h),y=[1,0,0],m=fh(d,p),g=Au(m,m),b=m[0],w=g-b*b;if(!w)return!f&&u;var _=t*g/w,x=-t*b/w,v=fh(y,m),E=Tu(y,_),T=Tu(m,x);yy(E,T);var k=v,A=Au(E,k),I=Au(k,k),O=A*A-I*(Au(E,E)-1);if(!(O<0)){var F=Ye(O),S=Tu(k,(-A-F)/I);if(yy(S,E),S=j0(S),!f)return S;var M=u[0],N=h[0],$=u[1],D=h[1],C;N<M&&(C=M,M=N,N=C);var B=N-M,z=Rt(B-vt)<nt,j=z||B<nt;if(!z&&D<$&&(C=$,$=D,D=C),j?z?$+D>0^S[1]<(Rt(S[0]-M)<nt?$:D):$<=S[1]&&S[1]<=D:B>vt^(M<=S[0]&&S[0]<=N)){var V=Tu(k,(-A+F)/I);return yy(V,E),[S,j0(V)]}}}function l(u,h){var f=i?e:vt-e,d=0;return u<-f?d|=1:u>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return HE(o,a,s,i?[0,-e]:[-vt,e-vt])}function E7(e,t,n,i,r,s){var o=e[0],a=e[1],c=t[0],l=t[1],u=0,h=1,f=c-o,d=l-a,p;if(p=n-o,!(!f&&p>0)){if(p/=f,f<0){if(p<u)return;p<h&&(h=p)}else if(f>0){if(p>h)return;p>u&&(u=p)}if(p=r-o,!(!f&&p<0)){if(p/=f,f<0){if(p>h)return;p>u&&(u=p)}else if(f>0){if(p<u)return;p<h&&(h=p)}if(p=i-a,!(!d&&p>0)){if(p/=d,d<0){if(p<u)return;p<h&&(h=p)}else if(d>0){if(p>h)return;p>u&&(u=p)}if(p=s-a,!(!d&&p<0)){if(p/=d,d<0){if(p>h)return;p>u&&(u=p)}else if(d>0){if(p<u)return;p<h&&(h=p)}return u>0&&(e[0]=o+u*f,e[1]=a+u*d),h<1&&(t[0]=o+h*f,t[1]=a+h*d),!0}}}}}var Mc=1e9,Mu=-Mc;function XE(e,t,n,i){function r(l,u){return e<=l&&l<=n&&t<=u&&u<=i}function s(l,u,h,f){var d=0,p=0;if(l==null||(d=o(l,h))!==(p=o(u,h))||c(l,u)<0^h>0)do f.point(d===0||d===3?e:n,d>1?i:t);while((d=(d+h+4)%4)!==p);else f.point(u[0],u[1])}function o(l,u){return Rt(l[0]-e)<nt?u>0?0:3:Rt(l[0]-n)<nt?u>0?2:1:Rt(l[1]-t)<nt?u>0?1:0:u>0?3:2}function a(l,u){return c(l.x,u.x)}function c(l,u){var h=o(l,1),f=o(u,1);return h!==f?h-f:h===0?u[1]-l[1]:h===1?l[0]-u[0]:h===2?l[1]-u[1]:u[0]-l[0]}return function(l){var u=l,h=WE(),f,d,p,y,m,g,b,w,_,x,v,E={point:T,lineStart:O,lineEnd:F,polygonStart:A,polygonEnd:I};function T(M,N){r(M,N)&&u.point(M,N)}function k(){for(var M=0,N=0,$=d.length;N<$;++N)for(var D=d[N],C=1,B=D.length,z=D[0],j,V,X=z[0],tt=z[1];C<B;++C)j=X,V=tt,z=D[C],X=z[0],tt=z[1],V<=i?tt>i&&(X-j)*(i-V)>(tt-V)*(e-j)&&++M:tt<=i&&(X-j)*(i-V)<(tt-V)*(e-j)&&--M;return M}function A(){u=h,f=[],d=[],v=!0}function I(){var M=k(),N=v&&M,$=(f=KS(f)).length;(N||$)&&(l.polygonStart(),N&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),$&&GE(f,a,M,s,l),l.polygonEnd()),u=l,f=d=p=null}function O(){E.point=S,d&&d.push(p=[]),x=!0,_=!1,b=w=NaN}function F(){f&&(S(y,m),g&&_&&h.rejoin(),f.push(h.result())),E.point=T,_&&u.lineEnd()}function S(M,N){var $=r(M,N);if(d&&p.push([M,N]),x)y=M,m=N,g=$,x=!1,$&&(u.lineStart(),u.point(M,N));else if($&&_)u.point(M,N);else{var D=[b=Math.max(Mu,Math.min(Mc,b)),w=Math.max(Mu,Math.min(Mc,w))],C=[M=Math.max(Mu,Math.min(Mc,M)),N=Math.max(Mu,Math.min(Mc,N))];E7(D,C,e,t,n,i)?(_||(u.lineStart(),u.point(D[0],D[1])),u.point(C[0],C[1]),$||u.lineEnd(),v=!1):$&&(u.lineStart(),u.point(M,N),v=!1)}b=M,w=N,_=$}return E}}function S_(e,t,n){var i=dn(e,t-nt,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function E_(e,t,n){var i=dn(e,t-nt,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function A7(){var e,t,n,i,r,s,o,a,c=10,l=c,u=90,h=360,f,d,p,y,m=2.5;function g(){return{type:"MultiLineString",coordinates:b()}}function b(){return dn(Eu(i/u)*u,n,u).map(p).concat(dn(Eu(a/h)*h,o,h).map(y)).concat(dn(Eu(t/c)*c,e,c).filter(function(w){return Rt(w%u)>nt}).map(f)).concat(dn(Eu(s/l)*l,r,l).filter(function(w){return Rt(w%h)>nt}).map(d))}return g.lines=function(){return b().map(function(w){return{type:"LineString",coordinates:w}})},g.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(y(o).slice(1),p(n).reverse().slice(1),y(a).reverse().slice(1))]}},g.extent=function(w){return arguments.length?g.extentMajor(w).extentMinor(w):g.extentMinor()},g.extentMajor=function(w){return arguments.length?(i=+w[0][0],n=+w[1][0],a=+w[0][1],o=+w[1][1],i>n&&(w=i,i=n,n=w),a>o&&(w=a,a=o,o=w),g.precision(m)):[[i,a],[n,o]]},g.extentMinor=function(w){return arguments.length?(t=+w[0][0],e=+w[1][0],s=+w[0][1],r=+w[1][1],t>e&&(w=t,t=e,e=w),s>r&&(w=s,s=r,r=w),g.precision(m)):[[t,s],[e,r]]},g.step=function(w){return arguments.length?g.stepMajor(w).stepMinor(w):g.stepMinor()},g.stepMajor=function(w){return arguments.length?(u=+w[0],h=+w[1],g):[u,h]},g.stepMinor=function(w){return arguments.length?(c=+w[0],l=+w[1],g):[c,l]},g.precision=function(w){return arguments.length?(m=+w,f=S_(s,r,90),d=E_(t,e,m),p=S_(a,o,90),y=E_(i,n,m),g):m},g.extentMajor([[-180,-90+nt],[180,90-nt]]).extentMinor([[-180,-80-nt],[180,80+nt]])}function T7(){return A7()()}const X0=e=>e;var gy=new xi,K0=new xi,KE,QE,Q0,J0,$r={point:pn,lineStart:pn,lineEnd:pn,polygonStart:function(){$r.lineStart=I7,$r.lineEnd=N7},polygonEnd:function(){$r.lineStart=$r.lineEnd=$r.point=pn,gy.add(Rt(K0)),K0=new xi},result:function(){var e=gy/2;return gy=new xi,e}};function I7(){$r.point=M7}function M7(e,t){$r.point=JE,KE=Q0=e,QE=J0=t}function JE(e,t){K0.add(J0*e-Q0*t),Q0=e,J0=t}function N7(){JE(KE,QE)}const A_=$r;var Sa=1/0,wh=Sa,ll=-Sa,_h=ll,$7={point:k7,lineStart:pn,lineEnd:pn,polygonStart:pn,polygonEnd:pn,result:function(){var e=[[Sa,wh],[ll,_h]];return ll=_h=-(wh=Sa=1/0),e}};function k7(e,t){e<Sa&&(Sa=e),e>ll&&(ll=e),t<wh&&(wh=t),t>_h&&(_h=t)}const vh=$7;var Z0=0,tm=0,Nc=0,xh=0,Sh=0,Co=0,em=0,nm=0,$c=0,ZE,tA,mi,gi,Wn={point:no,lineStart:T_,lineEnd:I_,polygonStart:function(){Wn.lineStart=R7,Wn.lineEnd=F7},polygonEnd:function(){Wn.point=no,Wn.lineStart=T_,Wn.lineEnd=I_},result:function(){var e=$c?[em/$c,nm/$c]:Co?[xh/Co,Sh/Co]:Nc?[Z0/Nc,tm/Nc]:[NaN,NaN];return Z0=tm=Nc=xh=Sh=Co=em=nm=$c=0,e}};function no(e,t){Z0+=e,tm+=t,++Nc}function T_(){Wn.point=O7}function O7(e,t){Wn.point=L7,no(mi=e,gi=t)}function L7(e,t){var n=e-mi,i=t-gi,r=Ye(n*n+i*i);xh+=r*(mi+e)/2,Sh+=r*(gi+t)/2,Co+=r,no(mi=e,gi=t)}function I_(){Wn.point=no}function R7(){Wn.point=D7}function F7(){eA(ZE,tA)}function D7(e,t){Wn.point=eA,no(ZE=mi=e,tA=gi=t)}function eA(e,t){var n=e-mi,i=t-gi,r=Ye(n*n+i*i);xh+=r*(mi+e)/2,Sh+=r*(gi+t)/2,Co+=r,r=gi*e-mi*t,em+=r*(mi+e),nm+=r*(gi+t),$c+=r*3,no(mi=e,gi=t)}const M_=Wn;function nA(e){this._context=e}nA.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,vn);break}}},result:pn};var im=new xi,by,iA,rA,kc,Oc,Eh={point:pn,lineStart:function(){Eh.point=C7},lineEnd:function(){by&&sA(iA,rA),Eh.point=pn},polygonStart:function(){by=!0},polygonEnd:function(){by=null},result:function(){var e=+im;return im=new xi,e}};function C7(e,t){Eh.point=sA,iA=kc=e,rA=Oc=t}function sA(e,t){kc-=e,Oc-=t,im.add(Ye(kc*kc+Oc*Oc)),kc=e,Oc=t}const N_=Eh;let $_,Ah,k_,O_;class L_{constructor(t){this._append=t==null?oA:B7(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==k_||this._append!==Ah){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,k_=i,Ah=this._append,O_=this._,this._=r}this._+=O_;break}}}result(){const t=this._;return this._="",t.length?t:null}}function oA(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function B7(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return oA;if(t!==$_){const n=10**t;$_=t,Ah=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return Ah}function us(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),Nr(a,r(s))),s.result()}return o.area=function(a){return Nr(a,r(A_)),A_.result()},o.measure=function(a){return Nr(a,r(N_)),N_.result()},o.bounds=function(a){return Nr(a,r(vh)),vh.result()},o.centroid=function(a){return Nr(a,r(M_)),M_.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,X0):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new L_(n)):new nA(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const c=Math.floor(a);if(!(c>=0))throw new RangeError(`invalid digits: ${a}`);n=c}return t===null&&(s=new L_(n)),o},o.projection(e).digits(n).context(t)}function Th(e){return{stream:Nd(e)}}function Nd(e){return function(t){var n=new rm;for(var i in e)n[i]=e[i];return n.stream=t,n}}function rm(){}rm.prototype={constructor:rm,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Hg(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Nr(n,e.stream(vh)),t(vh.result()),i!=null&&e.clipExtent(i),e}function Xg(e,t,n){return Hg(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,c=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,c])},n)}function aA(e,t,n){return Xg(e,[[0,0],t],n)}function cA(e,t,n){return Hg(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function lA(e,t,n){return Hg(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var R_=16,P7=rt(30*$t);function F_(e,t){return+t?z7(e,t):U7(e)}function U7(e){return Nd({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function z7(e,t){function n(i,r,s,o,a,c,l,u,h,f,d,p,y,m){var g=l-i,b=u-r,w=g*g+b*b;if(w>4*t&&y--){var _=o+f,x=a+d,v=c+p,E=Ye(_*_+x*x+v*v),T=en(v/=E),k=Rt(Rt(v)-1)<nt||Rt(s-h)<nt?(s+h)/2:Kn(x,_),A=e(k,T),I=A[0],O=A[1],F=I-i,S=O-r,M=b*F-g*S;(M*M/w>t||Rt((g*F+b*S)/w-.5)>.3||o*f+a*d+c*p<P7)&&(n(i,r,s,o,a,c,I,O,k,_/=E,x/=E,v,y,m),m.point(I,O),n(I,O,k,_,x,v,l,u,h,f,d,p,y,m))}}return function(i){var r,s,o,a,c,l,u,h,f,d,p,y,m={point:g,lineStart:b,lineEnd:_,polygonStart:function(){i.polygonStart(),m.lineStart=x},polygonEnd:function(){i.polygonEnd(),m.lineStart=b}};function g(T,k){T=e(T,k),i.point(T[0],T[1])}function b(){h=NaN,m.point=w,i.lineStart()}function w(T,k){var A=xa([T,k]),I=e(T,k);n(h,f,u,d,p,y,h=I[0],f=I[1],u=T,d=A[0],p=A[1],y=A[2],R_,i),i.point(h,f)}function _(){m.point=g,i.lineEnd()}function x(){b(),m.point=v,m.lineEnd=E}function v(T,k){w(r=T,k),s=h,o=f,a=d,c=p,l=y,m.point=w}function E(){n(h,f,u,d,p,y,s,o,r,a,c,l,R_,i),m.lineEnd=_,_()}return m}}var j7=Nd({point:function(e,t){this.stream.point(e*$t,t*$t)}});function q7(e){return Nd({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function Y7(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function D_(e,t,n,i,r,s){if(!s)return Y7(e,t,n,i,r);var o=rt(s),a=J(s),c=o*e,l=a*e,u=o/e,h=a/e,f=(a*n-o*t)/e,d=(a*t+o*n)/e;function p(y,m){return y*=i,m*=r,[c*y-l*m+t,n-l*y-c*m]}return p.invert=function(y,m){return[i*(u*y-h*m+f),r*(d-h*y-u*m)]},p}function fs(e){return uA(function(){return e})()}function uA(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,c=0,l=0,u,h=0,f=1,d=1,p=null,y=x_,m=null,g,b,w,_=X0,x=.5,v,E,T,k,A;function I(M){return T(M[0]*$t,M[1]*$t)}function O(M){return M=T.invert(M[0],M[1]),M&&[M[0]*Ee,M[1]*Ee]}I.stream=function(M){return k&&A===M?k:k=j7(q7(u)(y(v(_(A=M)))))},I.preclip=function(M){return arguments.length?(y=M,p=void 0,S()):y},I.postclip=function(M){return arguments.length?(_=M,m=g=b=w=null,S()):_},I.clipAngle=function(M){return arguments.length?(y=+M?S7(p=M*$t):(p=null,x_),S()):p*Ee},I.clipExtent=function(M){return arguments.length?(_=M==null?(m=g=b=w=null,X0):XE(m=+M[0][0],g=+M[0][1],b=+M[1][0],w=+M[1][1]),S()):m==null?null:[[m,g],[b,w]]},I.scale=function(M){return arguments.length?(n=+M,F()):n},I.translate=function(M){return arguments.length?(i=+M[0],r=+M[1],F()):[i,r]},I.center=function(M){return arguments.length?(s=M[0]%360*$t,o=M[1]%360*$t,F()):[s*Ee,o*Ee]},I.rotate=function(M){return arguments.length?(a=M[0]%360*$t,c=M[1]%360*$t,l=M.length>2?M[2]%360*$t:0,F()):[a*Ee,c*Ee,l*Ee]},I.angle=function(M){return arguments.length?(h=M%360*$t,F()):h*Ee},I.reflectX=function(M){return arguments.length?(f=M?-1:1,F()):f<0},I.reflectY=function(M){return arguments.length?(d=M?-1:1,F()):d<0},I.precision=function(M){return arguments.length?(v=F_(E,x=M*M),S()):Ye(x)},I.fitExtent=function(M,N){return Xg(I,M,N)},I.fitSize=function(M,N){return aA(I,M,N)},I.fitWidth=function(M,N){return cA(I,M,N)},I.fitHeight=function(M,N){return lA(I,M,N)};function F(){var M=D_(n,0,0,f,d,h).apply(null,t(s,o)),N=D_(n,i-M[0],r-M[1],f,d,h);return u=VE(a,c,l),E=G0(t,N),T=G0(u,E),v=F_(E,x),S()}function S(){return k=A=null,I}return function(){return t=e.apply(this,arguments),I.invert=t.invert&&O,F()}}function Kg(e){var t=0,n=vt/3,i=uA(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*$t,n=s[1]*$t):[t*Ee,n*Ee]},r}function V7(e){var t=rt(e);function n(i,r){return[i*t,J(r)/t]}return n.invert=function(i,r){return[i/t,en(r*t)]},n}function W7(e,t){var n=J(e),i=(n+J(t))/2;if(Rt(i)<nt)return V7(e);var r=1+n*(2*i-n),s=Ye(r)/i;function o(a,c){var l=Ye(r-2*i*J(c))/i;return[l*J(a*=i),s-l*rt(a)]}return o.invert=function(a,c){var l=s-c,u=Kn(a,Rt(l))*Nn(l);return l*i<0&&(u-=vt*Nn(a)*Nn(l)),[u/i,en((r-(a*a+l*l)*i*i)/(2*i))]},o}function Ih(){return Kg(W7).scale(155.424).center([0,33.6442])}function fA(){return Ih().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function G7(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function H7(){var e,t,n=fA(),i,r=Ih().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=Ih().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,c,l={point:function(f,d){c=[f,d]}};function u(f){var d=f[0],p=f[1];return c=null,i.point(d,p),c||(s.point(d,p),c)||(a.point(d,p),c)}u.invert=function(f){var d=n.scale(),p=n.translate(),y=(f[0]-p[0])/d,m=(f[1]-p[1])/d;return(m>=.12&&m<.234&&y>=-.425&&y<-.214?r:m>=.166&&m<.234&&y>=-.214&&y<-.115?o:n).invert(f)},u.stream=function(f){return e&&t===f?e:e=G7([n.stream(t=f),r.stream(f),o.stream(f)])},u.precision=function(f){return arguments.length?(n.precision(f),r.precision(f),o.precision(f),h()):n.precision()},u.scale=function(f){return arguments.length?(n.scale(f),r.scale(f*.35),o.scale(f),u.translate(n.translate())):n.scale()},u.translate=function(f){if(!arguments.length)return n.translate();var d=n.scale(),p=+f[0],y=+f[1];return i=n.translate(f).clipExtent([[p-.455*d,y-.238*d],[p+.455*d,y+.238*d]]).stream(l),s=r.translate([p-.307*d,y+.201*d]).clipExtent([[p-.425*d+nt,y+.12*d+nt],[p-.214*d-nt,y+.234*d-nt]]).stream(l),a=o.translate([p-.205*d,y+.212*d]).clipExtent([[p-.214*d+nt,y+.166*d+nt],[p-.115*d-nt,y+.234*d-nt]]).stream(l),h()},u.fitExtent=function(f,d){return Xg(u,f,d)},u.fitSize=function(f,d){return aA(u,f,d)},u.fitWidth=function(f,d){return cA(u,f,d)},u.fitHeight=function(f,d){return lA(u,f,d)};function h(){return e=t=null,u}return u.scale(1070)}function hA(e){return function(t,n){var i=rt(t),r=rt(n),s=e(i*r);return s===1/0?[2,0]:[s*r*J(t),s*J(n)]}}function jl(e){return function(t,n){var i=Ye(t*t+n*n),r=e(i),s=J(r),o=rt(r);return[Kn(t*s,i*o),en(i&&n*s/i)]}}var dA=hA(function(e){return Ye(2/(1+e))});dA.invert=jl(function(e){return 2*en(e/2)});function X7(){return fs(dA).scale(124.75).clipAngle(180-.001)}var pA=hA(function(e){return(e=zE(e))&&e/J(e)});pA.invert=jl(function(e){return e});function K7(){return fs(pA).scale(79.4188).clipAngle(180-.001)}function $d(e,t){return[e,lh(Wg((ce+t)/2))]}$d.invert=function(e,t){return[e,2*za(UE(t))-ce]};function Q7(){return yA($d).scale(961/vn)}function yA(e){var t=fs(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,c,l;t.scale=function(h){return arguments.length?(i(h),u()):i()},t.translate=function(h){return arguments.length?(r(h),u()):r()},t.center=function(h){return arguments.length?(n(h),u()):n()},t.clipExtent=function(h){return arguments.length?(h==null?o=a=c=l=null:(o=+h[0][0],a=+h[0][1],c=+h[1][0],l=+h[1][1]),u()):o==null?null:[[o,a],[c,l]]};function u(){var h=vt*i(),f=t(y7(t.rotate()).invert([0,0]));return s(o==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:e===$d?[[Math.max(f[0]-h,o),a],[Math.min(f[0]+h,c),l]]:[[o,Math.max(f[1]-h,a)],[c,Math.min(f[1]+h,l)]])}return u()}function Nu(e){return Wg((ce+e)/2)}function J7(e,t){var n=rt(e),i=e===t?J(e):lh(n/rt(t))/lh(Nu(t)/Nu(e)),r=n*py(Nu(e),i)/i;if(!i)return $d;function s(o,a){r>0?a<-ce+nt&&(a=-ce+nt):a>ce-nt&&(a=ce-nt);var c=r/py(Nu(a),i);return[c*J(i*o),r-c*rt(i*o)]}return s.invert=function(o,a){var c=r-a,l=Nn(i)*Ye(o*o+c*c),u=Kn(o,Rt(c))*Nn(c);return c*i<0&&(u-=vt*Nn(o)*Nn(c)),[u/i,2*za(py(r/l,1/i))-ce]},s}function Z7(){return Kg(J7).scale(109.5).parallels([30,30])}function Mh(e,t){return[e,t]}Mh.invert=Mh;function tB(){return fs(Mh).scale(152.63)}function eB(e,t){var n=rt(e),i=e===t?J(e):(n-rt(t))/(t-e),r=n/i+e;if(Rt(i)<nt)return Mh;function s(o,a){var c=r-a,l=i*o;return[c*J(l),r-c*rt(l)]}return s.invert=function(o,a){var c=r-a,l=Kn(o,Rt(c))*Nn(c);return c*i<0&&(l-=vt*Nn(o)*Nn(c)),[l/i,r-Nn(i)*Ye(o*o+c*c)]},s}function nB(){return Kg(eB).scale(131.154).center([0,13.9389])}var Cc=1.340264,Bc=-.081106,Pc=893e-6,Uc=.003796,Nh=Ye(3)/2,iB=12;function mA(e,t){var n=en(Nh*J(t)),i=n*n,r=i*i*i;return[e*rt(n)/(Nh*(Cc+3*Bc*i+r*(7*Pc+9*Uc*i))),n*(Cc+Bc*i+r*(Pc+Uc*i))]}mA.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,c;s<iB&&(a=n*(Cc+Bc*i+r*(Pc+Uc*i))-t,c=Cc+3*Bc*i+r*(7*Pc+9*Uc*i),n-=o=a/c,i=n*n,r=i*i*i,!(Rt(o)<ch));++s);return[Nh*e*(Cc+3*Bc*i+r*(7*Pc+9*Uc*i))/rt(n),en(J(n)/Nh)]};function rB(){return fs(mA).scale(177.158)}function gA(e,t){var n=rt(t),i=rt(e)*n;return[n*J(e)/i,J(t)/i]}gA.invert=jl(za);function sB(){return fs(gA).scale(144.049).clipAngle(60)}function bA(e,t){return[rt(t)*J(e),J(t)]}bA.invert=jl(en);function oB(){return fs(bA).scale(249.5).clipAngle(90+nt)}function wA(e,t){var n=rt(t),i=1+rt(e)*n;return[n*J(e)/i,J(t)/i]}wA.invert=jl(function(e){return 2*za(e)});function aB(){return fs(wA).scale(250).clipAngle(142)}function _A(e,t){return[lh(Wg((ce+t)/2)),-e]}_A.invert=function(e,t){return[-t,2*za(UE(e))-ce]};function cB(){var e=yA(_A),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}function lB(e,t){return e.parent===t.parent?1:2}function uB(e){return e.reduce(fB,0)/e.length}function fB(e,t){return e+t.x}function hB(e){return 1+e.reduce(dB,0)}function dB(e,t){return Math.max(e,t.y)}function pB(e){for(var t;t=e.children;)e=t[0];return e}function yB(e){for(var t;t=e.children;)e=t[t.length-1];return e}function vA(){var e=lB,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(f){var d=f.children;d?(f.x=uB(d),f.y=hB(d)):(f.x=o?a+=e(f,o):0,f.y=0,o=f)});var c=pB(s),l=yB(s),u=c.x-e(c,l)/2,h=l.x+e(l,c)/2;return s.eachAfter(i?function(f){f.x=(f.x-s.x)*t,f.y=(s.y-f.y)*n}:function(f){f.x=(f.x-u)/(h-u)*t,f.y=(1-(s.y?f.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function mB(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function gB(){return this.eachAfter(mB)}function bB(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function wB(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function _B(e,t){for(var n=this,i=[n],r=[],s,o,a,c=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++c,this);return this}function vB(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function xB(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function SB(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function EB(e){for(var t=this,n=AB(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function AB(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function TB(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function IB(){return Array.from(this)}function MB(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function NB(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*$B(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function xA(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=LB)):t===void 0&&(t=OB);for(var n=new Ea(e),i,r=[n],s,o,a,c;i=r.pop();)if((o=t(i.data))&&(c=(o=Array.from(o)).length))for(i.children=o,a=c-1;a>=0;--a)r.push(s=o[a]=new Ea(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(SA)}function kB(){return xA(this).eachBefore(RB)}function OB(e){return e.children}function LB(e){return Array.isArray(e)?e[1]:null}function RB(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function SA(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Ea(e){this.data=e,this.depth=this.height=0,this.parent=null}Ea.prototype=xA.prototype={constructor:Ea,count:gB,each:bB,eachAfter:_B,eachBefore:wB,find:vB,sum:xB,sort:SB,path:EB,ancestors:TB,descendants:IB,leaves:MB,links:NB,copy:kB,[Symbol.iterator]:$B};function wy(e){return e==null?null:FB(e)}function FB(e){if(typeof e!="function")throw new Error;return e}var DB={depth:-1},C_={},_y={};function CB(e){return e.id}function BB(e){return e.parentId}function EA(){var e=CB,t=BB,n;function i(r){var s=Array.from(r),o=e,a=t,c,l,u,h,f,d,p,y,m=new Map;if(n!=null){const g=s.map((_,x)=>PB(n(_,x,r))),b=g.map(B_),w=new Set(g).add("");for(const _ of b)w.has(_)||(w.add(_),g.push(_),b.push(B_(_)),s.push(_y));o=(_,x)=>g[x],a=(_,x)=>b[x]}for(u=0,c=s.length;u<c;++u)l=s[u],d=s[u]=new Ea(l),(p=o(l,u,r))!=null&&(p+="")&&(y=d.id=p,m.set(y,m.has(y)?C_:d)),(p=a(l,u,r))!=null&&(p+="")&&(d.parent=p);for(u=0;u<c;++u)if(d=s[u],p=d.parent){if(f=m.get(p),!f)throw new Error("missing: "+p);if(f===C_)throw new Error("ambiguous: "+p);f.children?f.children.push(d):f.children=[d],d.parent=f}else{if(h)throw new Error("multiple roots");h=d}if(!h)throw new Error("no root");if(n!=null){for(;h.data===_y&&h.children.length===1;)h=h.children[0],--c;for(let g=s.length-1;g>=0&&(d=s[g],d.data===_y);--g)d.data=null}if(h.parent=DB,h.eachBefore(function(g){g.depth=g.parent.depth+1,--c}).eachBefore(SA),h.parent=null,c>0)throw new Error("cycle");return h}return i.id=function(r){return arguments.length?(e=wy(r),i):e},i.parentId=function(r){return arguments.length?(t=wy(r),i):t},i.path=function(r){return arguments.length?(n=wy(r),i):n},i}function PB(e){e=`${e}`;let t=e.length;return sm(e,t-1)&&!sm(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function B_(e){let t=e.length;if(t<2)return"";for(;--t>1&&!sm(e,t););return e.slice(0,t)}function sm(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function UB(e,t){return e.parent===t.parent?1:2}function vy(e){var t=e.children;return t?t[0]:e.t}function xy(e){var t=e.children;return t?t[t.length-1]:e.t}function zB(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function jB(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function qB(e,t,n){return e.a.parent===t.parent?e.a:n}function ff(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}ff.prototype=Object.create(Ea.prototype);function YB(e){for(var t=new ff(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new ff(s[o],o)),r.parent=n;return(t.parent=new ff(null,0)).children=[t],t}function $h(){var e=UB,t=1,n=1,i=null;function r(l){var u=YB(l);if(u.eachAfter(s),u.parent.m=-u.z,u.eachBefore(o),i)l.eachBefore(c);else{var h=l,f=l,d=l;l.eachBefore(function(b){b.x<h.x&&(h=b),b.x>f.x&&(f=b),b.depth>d.depth&&(d=b)});var p=h===f?1:e(h,f)/2,y=p-h.x,m=t/(f.x+p+y),g=n/(d.depth||1);l.eachBefore(function(b){b.x=(b.x+y)*m,b.y=b.depth*g})}return l}function s(l){var u=l.children,h=l.parent.children,f=l.i?h[l.i-1]:null;if(u){jB(l);var d=(u[0].z+u[u.length-1].z)/2;f?(l.z=f.z+e(l._,f._),l.m=l.z-d):l.z=d}else f&&(l.z=f.z+e(l._,f._));l.parent.A=a(l,f,l.parent.A||h[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,u,h){if(u){for(var f=l,d=l,p=u,y=f.parent.children[0],m=f.m,g=d.m,b=p.m,w=y.m,_;p=xy(p),f=vy(f),p&&f;)y=vy(y),d=xy(d),d.a=l,_=p.z+b-f.z-m+e(p._,f._),_>0&&(zB(qB(p,l,h),l,_),m+=_,g+=_),b+=p.m,m+=f.m,w+=y.m,g+=d.m;p&&!xy(d)&&(d.t=p,d.m+=b-g),f&&!vy(y)&&(y.t=f,y.m+=m-w,h=l)}return h}function c(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}const VB=1664525,WB=1013904223,P_=1/4294967296;function Qg(e=Math.random()){let t=(0<=e&&e<1?e/P_:Math.abs(e))|0;return()=>(t=VB*t+WB|0,P_*(t>>>0))}function Ri(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function kd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const om=Symbol("implicit");function Jg(){var e=new Qs,t=[],n=[],i=om;function r(s){let o=e.get(s);if(o===void 0){if(i!==om)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Qs;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return Jg(t,n).unknown(i)},Ri.apply(r,arguments),r}function Od(){var e=Jg().unknown(void 0),t=e.domain,n=e.range,i=0,r=1,s,o,a=!1,c=0,l=0,u=.5;delete e.unknown;function h(){var f=t().length,d=r<i,p=d?r:i,y=d?i:r;s=(y-p)/Math.max(1,f-c+l*2),a&&(s=Math.floor(s)),p+=(y-p-s*(f-c))*u,o=s*(1-c),a&&(p=Math.round(p),o=Math.round(o));var m=dn(f).map(function(g){return p+s*g});return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([i,r]=f,i=+i,r=+r,h()):[i,r]},e.rangeRound=function(f){return[i,r]=f,i=+i,r=+r,a=!0,h()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(f){return arguments.length?(a=!!f,h()):a},e.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(l=+f,h()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},e.copy=function(){return Od(t(),[i,r]).round(a).paddingInner(c).paddingOuter(l).align(u)},Ri.apply(h(),arguments)}function AA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return AA(t())},e}function GB(){return AA(Od.apply(null,arguments).paddingInner(1))}function HB(e){return function(){return e}}function am(e){return+e}var U_=[0,1];function $n(e){return e}function cm(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:HB(isNaN(t)?NaN:.5)}function XB(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function KB(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=cm(r,i),s=n(o,s)):(i=cm(i,r),s=n(s,o)),function(a){return s(i(a))}}function QB(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=cm(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var c=gd(e,a,1,i)-1;return s[c](r[c](a))}}function ql(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Ld(){var e=U_,t=U_,n=Ua,i,r,s,o=$n,a,c,l;function u(){var f=Math.min(e.length,t.length);return o!==$n&&(o=XB(e[0],e[f-1])),a=f>2?QB:KB,c=l=null,h}function h(f){return f==null||isNaN(f=+f)?s:(c||(c=a(e.map(i),t,n)))(i(o(f)))}return h.invert=function(f){return o(r((l||(l=a(t,e.map(i),$e)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,am),u()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),n=Pg,u()},h.clamp=function(f){return arguments.length?(o=f?!0:$n,u()):o!==$n},h.interpolate=function(f){return arguments.length?(n=f,u()):n},h.unknown=function(f){return arguments.length?(s=f,h):s},function(f,d){return i=f,r=d,u()}}function TA(){return Ld()($n,$n)}function JB(e,t,n,i){var r=S0(e,t,n),s;switch(i=cl(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=a7(r,o))&&(i.precision=s),PE(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=c7(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=o7(r))&&(i.precision=s-(i.type==="%")*2);break}}return Ul(i)}function Yl(e){var t=e.domain;return e.ticks=function(n){var i=t();return Hr(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return JB(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],c,l,u=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);u-- >0;){if(l=il(o,a,n),l===c)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;c=l}return e},e}function Rd(){var e=TA();return e.copy=function(){return ql(e,Rd())},Ri.apply(e,arguments),Yl(e)}function IA(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,am),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return IA(e).unknown(t)},e=arguments.length?Array.from(e,am):[0,1],Yl(n)}function MA(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function z_(e){return Math.log(e)}function j_(e){return Math.exp(e)}function ZB(e){return-Math.log(-e)}function t9(e){return-Math.exp(-e)}function e9(e){return isFinite(e)?+("1e"+e):e<0?0:e}function n9(e){return e===10?e9:e===Math.E?Math.exp:t=>Math.pow(e,t)}function i9(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function q_(e){return(t,n)=>-e(-t,n)}function NA(e){const t=e(z_,j_),n=t.domain;let i=10,r,s;function o(){return r=i9(i),s=n9(i),n()[0]<0?(r=q_(r),s=q_(s),e(ZB,t9)):e(z_,j_),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const c=n();let l=c[0],u=c[c.length-1];const h=u<l;h&&([l,u]=[u,l]);let f=r(l),d=r(u),p,y;const m=a==null?10:+a;let g=[];if(!(i%1)&&d-f<m){if(f=Math.floor(f),d=Math.ceil(d),l>0){for(;f<=d;++f)for(p=1;p<i;++p)if(y=f<0?p/s(-f):p*s(f),!(y<l)){if(y>u)break;g.push(y)}}else for(;f<=d;++f)for(p=i-1;p>=1;--p)if(y=f>0?p/s(-f):p*s(f),!(y<l)){if(y>u)break;g.push(y)}g.length*2<m&&(g=Hr(l,u,m))}else g=Hr(f,d,Math.min(d-f,m)).map(s);return h?g.reverse():g},t.tickFormat=(a,c)=>{if(a==null&&(a=10),c==null&&(c=i===10?"s":","),typeof c!="function"&&(!(i%1)&&(c=cl(c)).precision==null&&(c.trim=!0),c=Ul(c)),a===1/0)return c;const l=Math.max(1,i*a/t.ticks().length);return u=>{let h=u/s(Math.round(r(u)));return h*i<i-.5&&(h*=i),h<=l?c(u):""}},t.nice=()=>n(MA(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function $A(){const e=NA(Ld()).domain([1,10]);return e.copy=()=>ql(e,$A()).base(e.base()),Ri.apply(e,arguments),e}function Y_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function V_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function kA(e){var t=1,n=e(Y_(t),V_(t));return n.constant=function(i){return arguments.length?e(Y_(t=+i),V_(t)):t},Yl(n)}function OA(){var e=kA(Ld());return e.copy=function(){return ql(e,OA()).constant(e.constant())},Ri.apply(e,arguments)}function W_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function r9(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function s9(e){return e<0?-e*e:e*e}function LA(e){var t=e($n,$n),n=1;function i(){return n===1?e($n,$n):n===.5?e(r9,s9):e(W_(n),W_(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},Yl(t)}function RA(){var e=LA(Ld());return e.copy=function(){return ql(e,RA()).exponent(e.exponent())},Ri.apply(e,arguments),e}function FA(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=h5(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[gd(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ue),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return FA().domain(e).range(t).unknown(i)},Ri.apply(s,arguments)}function DA(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[gd(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return DA().domain(e).range(t).unknown(n)},Ri.apply(r,arguments)}const Sy=new Date,Ey=new Date;function ye(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const c=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return c;let l;do c.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return c},r.filter=s=>ye(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(Sy.setTime(+s),Ey.setTime(+o),e(Sy),e(Ey),Math.floor(n(Sy,Ey))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const kh=ye(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);kh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ye(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):kh);kh.range;const er=1e3,kn=er*60,nr=kn*60,dr=nr*24,Zg=dr*7,G_=dr*30,Ay=dr*365,ir=ye(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*er)},(e,t)=>(t-e)/er,e=>e.getUTCSeconds());ir.range;const Fd=ye(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*er)},(e,t)=>{e.setTime(+e+t*kn)},(e,t)=>(t-e)/kn,e=>e.getMinutes());Fd.range;const Dd=ye(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*kn)},(e,t)=>(t-e)/kn,e=>e.getUTCMinutes());Dd.range;const Cd=ye(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*er-e.getMinutes()*kn)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getHours());Cd.range;const Bd=ye(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getUTCHours());Bd.range;const ja=ye(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*kn)/dr,e=>e.getDate()-1);ja.range;const Pd=ye(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dr,e=>e.getUTCDate()-1);Pd.range;const t1=ye(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dr,e=>Math.floor(e/dr));t1.range;function lo(e){return ye(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*kn)/Zg)}const Aa=lo(0),ul=lo(1),CA=lo(2),BA=lo(3),io=lo(4),PA=lo(5),UA=lo(6);Aa.range;ul.range;CA.range;BA.range;io.range;PA.range;UA.range;function uo(e){return ye(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Zg)}const Ta=uo(0),fl=uo(1),zA=uo(2),jA=uo(3),ro=uo(4),qA=uo(5),YA=uo(6);Ta.range;fl.range;zA.range;jA.range;ro.range;qA.range;YA.range;const Ud=ye(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ud.range;const zd=ye(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());zd.range;const Qn=ye(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Qn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ye(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Qn.range;const Jn=ye(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ye(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Jn.range;function VA(e,t,n,i,r,s){const o=[[ir,1,er],[ir,5,5*er],[ir,15,15*er],[ir,30,30*er],[s,1,kn],[s,5,5*kn],[s,15,15*kn],[s,30,30*kn],[r,1,nr],[r,3,3*nr],[r,6,6*nr],[r,12,12*nr],[i,1,dr],[i,2,2*dr],[n,1,Zg],[t,1,G_],[t,3,3*G_],[e,1,Ay]];function a(l,u,h){const f=u<l;f&&([l,u]=[u,l]);const d=h&&typeof h.range=="function"?h:c(l,u,h),p=d?d.range(l,+u+1):[];return f?p.reverse():p}function c(l,u,h){const f=Math.abs(u-l)/h,d=tl(([,,m])=>m).right(o,f);if(d===o.length)return e.every(S0(l/Ay,u/Ay,h));if(d===0)return kh.every(Math.max(S0(l,u,h),1));const[p,y]=o[f/o[d-1][2]<o[d][2]/f?d-1:d];return p.every(y)}return[a,c]}const[o9,WA]=VA(Jn,zd,Ta,t1,Bd,Dd),[a9,c9]=VA(Qn,Ud,Aa,ja,Cd,Fd);function Ty(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Iy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function dc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function l9(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,c=e.shortMonths,l=pc(r),u=yc(r),h=pc(s),f=yc(s),d=pc(o),p=yc(o),y=pc(a),m=yc(a),g=pc(c),b=yc(c),w={a:$,A:D,b:C,B,c:null,d:Z_,e:Z_,f:O9,g:j9,G:Y9,H:N9,I:$9,j:k9,L:GA,m:L9,M:R9,p:z,q:j,Q:n2,s:i2,S:F9,u:D9,U:C9,V:B9,w:P9,W:U9,x:null,X:null,y:z9,Y:q9,Z:V9,"%":e2},_={a:V,A:X,b:tt,B:Dt,c:null,d:t2,e:t2,f:X9,g:sP,G:aP,H:W9,I:G9,j:H9,L:XA,m:K9,M:Q9,p:Y,q:W,Q:n2,s:i2,S:J9,u:Z9,U:tP,V:eP,w:nP,W:iP,x:null,X:null,y:rP,Y:oP,Z:cP,"%":e2},x={a:A,A:I,b:O,B:F,c:S,d:Q_,e:Q_,f:A9,g:K_,G:X_,H:J_,I:J_,j:v9,L:E9,m:_9,M:x9,p:k,q:w9,Q:I9,s:M9,S:S9,u:p9,U:y9,V:m9,w:d9,W:g9,x:M,X:N,y:K_,Y:X_,Z:b9,"%":T9};w.x=v(n,w),w.X=v(i,w),w.c=v(t,w),_.x=v(n,_),_.X=v(i,_),_.c=v(t,_);function v(U,G){return function(H){var P=[],Q=-1,at=0,Nt=U.length,xt,K,Pt;for(H instanceof Date||(H=new Date(+H));++Q<Nt;)U.charCodeAt(Q)===37&&(P.push(U.slice(at,Q)),(K=H_[xt=U.charAt(++Q)])!=null?xt=U.charAt(++Q):K=xt==="e"?" ":"0",(Pt=G[xt])&&(xt=Pt(H,K)),P.push(xt),at=Q+1);return P.push(U.slice(at,Q)),P.join("")}}function E(U,G){return function(H){var P=dc(1900,void 0,1),Q=T(P,U,H+="",0),at,Nt;if(Q!=H.length)return null;if("Q"in P)return new Date(P.Q);if("s"in P)return new Date(P.s*1e3+("L"in P?P.L:0));if(G&&!("Z"in P)&&(P.Z=0),"p"in P&&(P.H=P.H%12+P.p*12),P.m===void 0&&(P.m="q"in P?P.q:0),"V"in P){if(P.V<1||P.V>53)return null;"w"in P||(P.w=1),"Z"in P?(at=Iy(dc(P.y,0,1)),Nt=at.getUTCDay(),at=Nt>4||Nt===0?fl.ceil(at):fl(at),at=Pd.offset(at,(P.V-1)*7),P.y=at.getUTCFullYear(),P.m=at.getUTCMonth(),P.d=at.getUTCDate()+(P.w+6)%7):(at=Ty(dc(P.y,0,1)),Nt=at.getDay(),at=Nt>4||Nt===0?ul.ceil(at):ul(at),at=ja.offset(at,(P.V-1)*7),P.y=at.getFullYear(),P.m=at.getMonth(),P.d=at.getDate()+(P.w+6)%7)}else("W"in P||"U"in P)&&("w"in P||(P.w="u"in P?P.u%7:"W"in P?1:0),Nt="Z"in P?Iy(dc(P.y,0,1)).getUTCDay():Ty(dc(P.y,0,1)).getDay(),P.m=0,P.d="W"in P?(P.w+6)%7+P.W*7-(Nt+5)%7:P.w+P.U*7-(Nt+6)%7);return"Z"in P?(P.H+=P.Z/100|0,P.M+=P.Z%100,Iy(P)):Ty(P)}}function T(U,G,H,P){for(var Q=0,at=G.length,Nt=H.length,xt,K;Q<at;){if(P>=Nt)return-1;if(xt=G.charCodeAt(Q++),xt===37){if(xt=G.charAt(Q++),K=x[xt in H_?G.charAt(Q++):xt],!K||(P=K(U,H,P))<0)return-1}else if(xt!=H.charCodeAt(P++))return-1}return P}function k(U,G,H){var P=l.exec(G.slice(H));return P?(U.p=u.get(P[0].toLowerCase()),H+P[0].length):-1}function A(U,G,H){var P=d.exec(G.slice(H));return P?(U.w=p.get(P[0].toLowerCase()),H+P[0].length):-1}function I(U,G,H){var P=h.exec(G.slice(H));return P?(U.w=f.get(P[0].toLowerCase()),H+P[0].length):-1}function O(U,G,H){var P=g.exec(G.slice(H));return P?(U.m=b.get(P[0].toLowerCase()),H+P[0].length):-1}function F(U,G,H){var P=y.exec(G.slice(H));return P?(U.m=m.get(P[0].toLowerCase()),H+P[0].length):-1}function S(U,G,H){return T(U,t,G,H)}function M(U,G,H){return T(U,n,G,H)}function N(U,G,H){return T(U,i,G,H)}function $(U){return o[U.getDay()]}function D(U){return s[U.getDay()]}function C(U){return c[U.getMonth()]}function B(U){return a[U.getMonth()]}function z(U){return r[+(U.getHours()>=12)]}function j(U){return 1+~~(U.getMonth()/3)}function V(U){return o[U.getUTCDay()]}function X(U){return s[U.getUTCDay()]}function tt(U){return c[U.getUTCMonth()]}function Dt(U){return a[U.getUTCMonth()]}function Y(U){return r[+(U.getUTCHours()>=12)]}function W(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var G=v(U+="",w);return G.toString=function(){return U},G},parse:function(U){var G=E(U+="",!1);return G.toString=function(){return U},G},utcFormat:function(U){var G=v(U+="",_);return G.toString=function(){return U},G},utcParse:function(U){var G=E(U+="",!0);return G.toString=function(){return U},G}}}var H_={"-":"",_:" ",0:"0"},Se=/^\s*\d+/,u9=/^%/,f9=/[\\^$*+?|[\]().{}]/g;function kt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function h9(e){return e.replace(f9,"\\$&")}function pc(e){return new RegExp("^(?:"+e.map(h9).join("|")+")","i")}function yc(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function d9(e,t,n){var i=Se.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function p9(e,t,n){var i=Se.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function y9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function m9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function g9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function X_(e,t,n){var i=Se.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function K_(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function b9(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function w9(e,t,n){var i=Se.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function _9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function Q_(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function v9(e,t,n){var i=Se.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function J_(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function x9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function S9(e,t,n){var i=Se.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function E9(e,t,n){var i=Se.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function A9(e,t,n){var i=Se.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function T9(e,t,n){var i=u9.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function I9(e,t,n){var i=Se.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function M9(e,t,n){var i=Se.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function Z_(e,t){return kt(e.getDate(),t,2)}function N9(e,t){return kt(e.getHours(),t,2)}function $9(e,t){return kt(e.getHours()%12||12,t,2)}function k9(e,t){return kt(1+ja.count(Qn(e),e),t,3)}function GA(e,t){return kt(e.getMilliseconds(),t,3)}function O9(e,t){return GA(e,t)+"000"}function L9(e,t){return kt(e.getMonth()+1,t,2)}function R9(e,t){return kt(e.getMinutes(),t,2)}function F9(e,t){return kt(e.getSeconds(),t,2)}function D9(e){var t=e.getDay();return t===0?7:t}function C9(e,t){return kt(Aa.count(Qn(e)-1,e),t,2)}function HA(e){var t=e.getDay();return t>=4||t===0?io(e):io.ceil(e)}function B9(e,t){return e=HA(e),kt(io.count(Qn(e),e)+(Qn(e).getDay()===4),t,2)}function P9(e){return e.getDay()}function U9(e,t){return kt(ul.count(Qn(e)-1,e),t,2)}function z9(e,t){return kt(e.getFullYear()%100,t,2)}function j9(e,t){return e=HA(e),kt(e.getFullYear()%100,t,2)}function q9(e,t){return kt(e.getFullYear()%1e4,t,4)}function Y9(e,t){var n=e.getDay();return e=n>=4||n===0?io(e):io.ceil(e),kt(e.getFullYear()%1e4,t,4)}function V9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+kt(t/60|0,"0",2)+kt(t%60,"0",2)}function t2(e,t){return kt(e.getUTCDate(),t,2)}function W9(e,t){return kt(e.getUTCHours(),t,2)}function G9(e,t){return kt(e.getUTCHours()%12||12,t,2)}function H9(e,t){return kt(1+Pd.count(Jn(e),e),t,3)}function XA(e,t){return kt(e.getUTCMilliseconds(),t,3)}function X9(e,t){return XA(e,t)+"000"}function K9(e,t){return kt(e.getUTCMonth()+1,t,2)}function Q9(e,t){return kt(e.getUTCMinutes(),t,2)}function J9(e,t){return kt(e.getUTCSeconds(),t,2)}function Z9(e){var t=e.getUTCDay();return t===0?7:t}function tP(e,t){return kt(Ta.count(Jn(e)-1,e),t,2)}function KA(e){var t=e.getUTCDay();return t>=4||t===0?ro(e):ro.ceil(e)}function eP(e,t){return e=KA(e),kt(ro.count(Jn(e),e)+(Jn(e).getUTCDay()===4),t,2)}function nP(e){return e.getUTCDay()}function iP(e,t){return kt(fl.count(Jn(e)-1,e),t,2)}function rP(e,t){return kt(e.getUTCFullYear()%100,t,2)}function sP(e,t){return e=KA(e),kt(e.getUTCFullYear()%100,t,2)}function oP(e,t){return kt(e.getUTCFullYear()%1e4,t,4)}function aP(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ro(e):ro.ceil(e),kt(e.getUTCFullYear()%1e4,t,4)}function cP(){return"+0000"}function e2(){return"%"}function n2(e){return+e}function i2(e){return Math.floor(+e/1e3)}var So,jd,hl;lP({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lP(e){return So=l9(e),jd=So.format,So.parse,hl=So.utcFormat,So.utcParse,So}function uP(e){return new Date(e)}function fP(e){return e instanceof Date?+e:+new Date(+e)}function e1(e,t,n,i,r,s,o,a,c,l){var u=TA(),h=u.invert,f=u.domain,d=l(".%L"),p=l(":%S"),y=l("%I:%M"),m=l("%I %p"),g=l("%a %d"),b=l("%b %d"),w=l("%B"),_=l("%Y");function x(v){return(c(v)<v?d:a(v)<v?p:o(v)<v?y:s(v)<v?m:i(v)<v?r(v)<v?g:b:n(v)<v?w:_)(v)}return u.invert=function(v){return new Date(h(v))},u.domain=function(v){return arguments.length?f(Array.from(v,fP)):f().map(uP)},u.ticks=function(v){var E=f();return e(E[0],E[E.length-1],v??10)},u.tickFormat=function(v,E){return E==null?x:l(E)},u.nice=function(v){var E=f();return(!v||typeof v.range!="function")&&(v=t(E[0],E[E.length-1],v??10)),v?f(MA(E,v)):u},u.copy=function(){return ql(u,e1(e,t,n,i,r,s,o,a,c,l))},u}function hP(){return Ri.apply(e1(a9,c9,Qn,Ud,Aa,ja,Cd,Fd,ir,jd).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function dP(){return Ri.apply(e1(o9,WA,Jn,zd,Ta,Pd,Bd,Dd,ir,hl).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function qd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Yd(){var e=0,t=.5,n=1,i=1,r,s,o,a,c,l=$n,u,h=!1,f;function d(y){return isNaN(y=+y)?f:(y=.5+((y=+u(y))-s)*(i*y<i*s?a:c),l(h?Math.max(0,Math.min(1,y)):y))}d.domain=function(y){return arguments.length?([e,t,n]=y,r=u(e=+e),s=u(t=+t),o=u(n=+n),a=r===s?0:.5/(s-r),c=s===o?0:.5/(o-s),i=s<r?-1:1,d):[e,t,n]},d.clamp=function(y){return arguments.length?(h=!!y,d):h},d.interpolator=function(y){return arguments.length?(l=y,d):l};function p(y){return function(m){var g,b,w;return arguments.length?([g,b,w]=m,l=Td(y,[g,b,w]),d):[l(0),l(.5),l(1)]}}return d.range=p(Ua),d.rangeRound=p(Pg),d.unknown=function(y){return arguments.length?(f=y,d):f},function(y){return u=y,r=y(e),s=y(t),o=y(n),a=r===s?0:.5/(s-r),c=s===o?0:.5/(o-s),i=s<r?-1:1,d}}function QA(){var e=Yl(Yd()($n));return e.copy=function(){return qd(e,QA())},kd.apply(e,arguments)}function JA(){var e=NA(Yd()).domain([.1,1,10]);return e.copy=function(){return qd(e,JA()).base(e.base())},kd.apply(e,arguments)}function ZA(){var e=kA(Yd());return e.copy=function(){return qd(e,ZA()).constant(e.constant())},kd.apply(e,arguments)}function tT(){var e=LA(Yd());return e.copy=function(){return qd(e,tT()).exponent(e.exponent())},kd.apply(e,arguments)}function wt(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const pP=wt("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),yP=wt("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),mP=wt("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),gP=wt("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),bP=wt("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),wP=wt("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),_P=wt("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),vP=wt("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),xP=wt("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),SP=wt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),qt=e=>TF(e[e.length-1]);var eT=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(wt);const nT=qt(eT);var iT=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(wt);const rT=qt(iT);var sT=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(wt);const oT=qt(sT);var aT=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(wt);const cT=qt(aT);var lm=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(wt);const Oh=qt(lm);var lT=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(wt);const uT=qt(lT);var um=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(wt);const Lh=qt(um);var fT=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(wt);const hT=qt(fT);var dT=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(wt);const pT=qt(dT);var yT=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(wt);const mT=qt(yT);var gT=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(wt);const bT=qt(gT);var wT=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(wt);const _T=qt(wT);var vT=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(wt);const xT=qt(vT);var ST=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(wt);const ET=qt(ST);var AT=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(wt);const TT=qt(AT);var IT=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(wt);const MT=qt(IT);var NT=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(wt);const $T=qt(NT);var kT=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(wt);const OT=qt(kT);var LT=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(wt);const RT=qt(LT);var FT=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(wt);const DT=qt(FT);var CT=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(wt);const BT=qt(CT);var PT=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(wt);const UT=qt(PT);var zT=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(wt);const jT=qt(zT);var qT=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(wt);const YT=qt(qT);var VT=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(wt);const WT=qt(VT);var GT=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(wt);const HT=qt(GT);var XT=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(wt);const KT=qt(XT);function QT(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const JT=Ug(ki(300,.5,0),ki(-240,.5,1));var ZT=Ug(ki(-100,.75,.35),ki(80,1.5,.8)),tI=Ug(ki(260,.75,.35),ki(80,1.5,.8)),$u=ki();function eI(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return $u.h=360*e-100,$u.s=1.5-1.5*t,$u.l=.8-.9*t,$u+""}var ku=Dn(),EP=Math.PI/3,AP=Math.PI*2/3;function nI(e){var t;return e=(.5-e)*Math.PI,ku.r=255*(t=Math.sin(e))*t,ku.g=255*(t=Math.sin(e+EP))*t,ku.b=255*(t=Math.sin(e+AP))*t,ku+""}function iI(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function Vd(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const rI=Vd(wt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var sI=Vd(wt("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),oI=Vd(wt("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),aI=Vd(wt("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function we(e){return function(){return e}}const cI=Math.cos,n1=Math.min,Rh=Math.sin,me=Math.sqrt,r2=1e-12,Fh=Math.PI,Wd=2*Fh;function lI(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new DE(t)}function uI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fI(e){this._context=e}fI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Vl(e){return new fI(e)}function hI(e){return e[0]}function dI(e){return e[1]}function pI(e,t){var n=we(!0),i=null,r=Vl,s=null,o=lI(a);e=typeof e=="function"?e:e===void 0?hI:we(e),t=typeof t=="function"?t:t===void 0?dI:we(t);function a(c){var l,u=(c=uI(c)).length,h,f=!1,d;for(i==null&&(s=r(d=o())),l=0;l<=u;++l)!(l<u&&n(h=c[l],l,c))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(h,l,c),+t(h,l,c));if(d)return s=null,d+""||null}return a.x=function(c){return arguments.length?(e=typeof c=="function"?c:we(+c),a):e},a.y=function(c){return arguments.length?(t=typeof c=="function"?c:we(+c),a):t},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:we(!!c),a):n},a.curve=function(c){return arguments.length?(r=c,i!=null&&(s=r(i)),a):r},a.context=function(c){return arguments.length?(c==null?i=s=null:s=r(i=c),a):i},a}function i1(e,t,n){var i=null,r=we(!0),s=null,o=Vl,a=null,c=lI(l);e=typeof e=="function"?e:e===void 0?hI:we(+e),t=typeof t=="function"?t:we(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?dI:we(+n);function l(h){var f,d,p,y=(h=uI(h)).length,m,g=!1,b,w=new Array(y),_=new Array(y);for(s==null&&(a=o(b=c())),f=0;f<=y;++f){if(!(f<y&&r(m=h[f],f,h))===g)if(g=!g)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=f-1;p>=d;--p)a.point(w[p],_[p]);a.lineEnd(),a.areaEnd()}g&&(w[f]=+e(m,f,h),_[f]=+t(m,f,h),a.point(i?+i(m,f,h):w[f],n?+n(m,f,h):_[f]))}if(b)return a=null,b+""||null}function u(){return pI().defined(r).curve(o).context(s)}return l.x=function(h){return arguments.length?(e=typeof h=="function"?h:we(+h),i=null,l):e},l.x0=function(h){return arguments.length?(e=typeof h=="function"?h:we(+h),l):e},l.x1=function(h){return arguments.length?(i=h==null?null:typeof h=="function"?h:we(+h),l):i},l.y=function(h){return arguments.length?(t=typeof h=="function"?h:we(+h),n=null,l):t},l.y0=function(h){return arguments.length?(t=typeof h=="function"?h:we(+h),l):t},l.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:we(+h),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(i).y(t)},l.defined=function(h){return arguments.length?(r=typeof h=="function"?h:we(!!h),l):r},l.curve=function(h){return arguments.length?(o=h,s!=null&&(a=o(s)),l):o},l.context=function(h){return arguments.length?(h==null?s=a=null:a=o(s=h),l):s},l}class yI{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function TP(e){return new yI(e,!0)}function IP(e){return new yI(e,!1)}const MP=me(3),mI={draw(e,t){const n=me(t+n1(t/28,.75))*.59436,i=n/2,r=i*MP;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-r,-i),e.lineTo(r,i),e.moveTo(-r,i),e.lineTo(r,-i)}},dl={draw(e,t){const n=me(t/Fh);e.moveTo(n,0),e.arc(0,0,n,0,Wd)}},gI={draw(e,t){const n=me(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},bI=me(1/3),NP=bI*2,wI={draw(e,t){const n=me(t/NP),i=n*bI;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},_I={draw(e,t){const n=me(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},vI={draw(e,t){const n=me(t-n1(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},xI={draw(e,t){const n=me(t),i=-n/2;e.rect(i,i,n,n)}},SI={draw(e,t){const n=me(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},$P=.8908130915292852,EI=Rh(Fh/10)/Rh(7*Fh/10),kP=Rh(Wd/10)*EI,OP=-cI(Wd/10)*EI,AI={draw(e,t){const n=me(t*$P),i=kP*n,r=OP*n;e.moveTo(0,-n),e.lineTo(i,r);for(let s=1;s<5;++s){const o=Wd*s/5,a=cI(o),c=Rh(o);e.lineTo(c*n,-a*n),e.lineTo(a*i-c*r,c*i+a*r)}e.closePath()}},My=me(3),TI={draw(e,t){const n=-me(t/(My*3));e.moveTo(0,n*2),e.lineTo(-My*n,-n),e.lineTo(My*n,-n),e.closePath()}},LP=me(3),II={draw(e,t){const n=me(t)*.6824,i=n/2,r=n*LP/2;e.moveTo(0,-n),e.lineTo(r,i),e.lineTo(-r,i),e.closePath()}},xn=-.5,Sn=me(3)/2,fm=1/me(12),RP=(fm/2+1)*3,MI={draw(e,t){const n=me(t/RP),i=n/2,r=n*fm,s=i,o=n*fm+n,a=-s,c=o;e.moveTo(i,r),e.lineTo(s,o),e.lineTo(a,c),e.lineTo(xn*i-Sn*r,Sn*i+xn*r),e.lineTo(xn*s-Sn*o,Sn*s+xn*o),e.lineTo(xn*a-Sn*c,Sn*a+xn*c),e.lineTo(xn*i+Sn*r,xn*r-Sn*i),e.lineTo(xn*s+Sn*o,xn*o-Sn*s),e.lineTo(xn*a+Sn*c,xn*c-Sn*a),e.closePath()}},NI={draw(e,t){const n=me(t-n1(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},FP=[dl,gI,wI,xI,AI,TI,MI],DP=[dl,vI,NI,II,mI,SI,_I];function Kr(){}function Dh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Gd(e){this._context=e}Gd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Dh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CP(e){return new Gd(e)}function $I(e){this._context=e}$I.prototype={areaStart:Kr,areaEnd:Kr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BP(e){return new $I(e)}function kI(e){this._context=e}kI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PP(e){return new kI(e)}function OI(e,t){this._basis=new Gd(e),this._beta=t}OI.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,c;++a<=n;)c=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+c*s),this._beta*t[a]+(1-this._beta)*(r+c*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const UP=function e(t){function n(i){return t===1?new Gd(i):new OI(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Ch(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function r1(e,t){this._context=e,this._k=(1-t)/6}r1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ch(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ch(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const zP=function e(t){function n(i){return new r1(i,t)}return n.tension=function(i){return e(+i)},n}(0);function s1(e,t){this._context=e,this._k=(1-t)/6}s1.prototype={areaStart:Kr,areaEnd:Kr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ch(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const jP=function e(t){function n(i){return new s1(i,t)}return n.tension=function(i){return e(+i)},n}(0);function o1(e,t){this._context=e,this._k=(1-t)/6}o1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ch(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qP=function e(t){function n(i){return new o1(i,t)}return n.tension=function(i){return e(+i)},n}(0);function a1(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>r2){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>r2){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function LI(e,t){this._context=e,this._alpha=t}LI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:a1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const YP=function e(t){function n(i){return t?new LI(i,t):new r1(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function RI(e,t){this._context=e,this._alpha=t}RI.prototype={areaStart:Kr,areaEnd:Kr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:a1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const VP=function e(t){function n(i){return t?new RI(i,t):new s1(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function FI(e,t){this._context=e,this._alpha=t}FI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:a1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const WP=function e(t){function n(i){return t?new FI(i,t):new o1(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function DI(e){this._context=e}DI.prototype={areaStart:Kr,areaEnd:Kr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function GP(e){return new DI(e)}function s2(e){return e<0?-1:1}function o2(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(s2(s)+s2(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function a2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Ny(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function Bh(e){this._context=e}Bh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ny(this,this._t0,a2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ny(this,a2(this,n=o2(this,e,t)),n);break;default:Ny(this,this._t0,n=o2(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function CI(e){this._context=new BI(e)}(CI.prototype=Object.create(Bh.prototype)).point=function(e,t){Bh.prototype.point.call(this,t,e)};function BI(e){this._context=e}BI.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function HP(e){return new Bh(e)}function XP(e){return new CI(e)}function PI(e){this._context=e}PI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=c2(e),r=c2(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function c2(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function KP(e){return new PI(e)}function Hd(e,t){this._context=e,this._t=t}Hd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function QP(e){return new Hd(e,.5)}function JP(e){return new Hd(e,0)}function ZP(e){return new Hd(e,1)}const Ou=e=>()=>e;function tU(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function _i(e,t,n){this.k=e,this.x=t,this.y=n}_i.prototype={constructor:_i,scale:function(e){return e===1?this:new _i(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new _i(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var UI=new _i(1,0,0);_i.prototype;function $y(e){e.stopImmediatePropagation()}function mc(e){e.preventDefault(),e.stopImmediatePropagation()}function eU(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function nU(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function l2(){return this.__zoom||UI}function iU(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function rU(){return navigator.maxTouchPoints||"ontouchstart"in this}function sU(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function oU(){var e=eU,t=nU,n=sU,i=iU,r=rU,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=zF,l=vd("start","zoom","end"),u,h,f,d=500,p=150,y=0,m=10;function g(S){S.property("__zoom",l2).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",A).filter(r).on("touchstart.zoom",I).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(S,M,N,$){var D=S.selection?S.selection():S;D.property("__zoom",l2),S!==D?x(S,M,N,$):D.interrupt().each(function(){v(this,arguments).event($).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},g.scaleBy=function(S,M,N,$){g.scaleTo(S,function(){var D=this.__zoom.k,C=typeof M=="function"?M.apply(this,arguments):M;return D*C},N,$)},g.scaleTo=function(S,M,N,$){g.transform(S,function(){var D=t.apply(this,arguments),C=this.__zoom,B=N==null?_(D):typeof N=="function"?N.apply(this,arguments):N,z=C.invert(B),j=typeof M=="function"?M.apply(this,arguments):M;return n(w(b(C,j),B,z),D,o)},N,$)},g.translateBy=function(S,M,N,$){g.transform(S,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof N=="function"?N.apply(this,arguments):N),t.apply(this,arguments),o)},null,$)},g.translateTo=function(S,M,N,$,D){g.transform(S,function(){var C=t.apply(this,arguments),B=this.__zoom,z=$==null?_(C):typeof $=="function"?$.apply(this,arguments):$;return n(UI.translate(z[0],z[1]).scale(B.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof N=="function"?-N.apply(this,arguments):-N),C,o)},$,D)};function b(S,M){return M=Math.max(s[0],Math.min(s[1],M)),M===S.k?S:new _i(M,S.x,S.y)}function w(S,M,N){var $=M[0]-N[0]*S.k,D=M[1]-N[1]*S.k;return $===S.x&&D===S.y?S:new _i(S.k,$,D)}function _(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function x(S,M,N,$){S.on("start.zoom",function(){v(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event($).end()}).tween("zoom",function(){var D=this,C=arguments,B=v(D,C).event($),z=t.apply(D,C),j=N==null?_(z):typeof N=="function"?N.apply(D,C):N,V=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),X=D.__zoom,tt=typeof M=="function"?M.apply(D,C):M,Dt=c(X.invert(j).concat(V/X.k),tt.invert(j).concat(V/tt.k));return function(Y){if(Y===1)Y=tt;else{var W=Dt(Y),U=V/W[2];Y=new _i(U,j[0]-W[0]*U,j[1]-W[1]*U)}B.zoom(null,Y)}})}function v(S,M,N){return!N&&S.__zooming||new E(S,M)}function E(S,M){this.that=S,this.args=M,this.active=0,this.sourceEvent=null,this.extent=t.apply(S,M),this.taps=0}E.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,M){return this.mouse&&S!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var M=zt(this.that).datum();l.call(S,this.that,new tU(S,{sourceEvent:this.sourceEvent,target:g,type:S,transform:this.that.__zoom,dispatch:l}),M)}};function T(S,...M){if(!e.apply(this,arguments))return;var N=v(this,M).event(S),$=this.__zoom,D=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,i.apply(this,arguments)))),C=Yn(S);if(N.wheel)(N.mouse[0][0]!==C[0]||N.mouse[0][1]!==C[1])&&(N.mouse[1]=$.invert(N.mouse[0]=C)),clearTimeout(N.wheel);else{if($.k===D)return;N.mouse=[C,$.invert(C)],Qo(this),N.start()}mc(S),N.wheel=setTimeout(B,p),N.zoom("mouse",n(w(b($,D),N.mouse[0],N.mouse[1]),N.extent,o));function B(){N.wheel=null,N.end()}}function k(S,...M){if(f||!e.apply(this,arguments))return;var N=S.currentTarget,$=v(this,M,!0).event(S),D=zt(S.view).on("mousemove.zoom",j,!0).on("mouseup.zoom",V,!0),C=Yn(S,N),B=S.clientX,z=S.clientY;uE(S.view),$y(S),$.mouse=[C,this.__zoom.invert(C)],Qo(this),$.start();function j(X){if(mc(X),!$.moved){var tt=X.clientX-B,Dt=X.clientY-z;$.moved=tt*tt+Dt*Dt>y}$.event(X).zoom("mouse",n(w($.that.__zoom,$.mouse[0]=Yn(X,N),$.mouse[1]),$.extent,o))}function V(X){D.on("mousemove.zoom mouseup.zoom",null),fE(X.view,$.moved),mc(X),$.event(X).end()}}function A(S,...M){if(e.apply(this,arguments)){var N=this.__zoom,$=Yn(S.changedTouches?S.changedTouches[0]:S,this),D=N.invert($),C=N.k*(S.shiftKey?.5:2),B=n(w(b(N,C),$,D),t.apply(this,M),o);mc(S),a>0?zt(this).transition().duration(a).call(x,B,$,S):zt(this).call(g.transform,B,$,S)}}function I(S,...M){if(e.apply(this,arguments)){var N=S.touches,$=N.length,D=v(this,M,S.changedTouches.length===$).event(S),C,B,z,j;for($y(S),B=0;B<$;++B)z=N[B],j=Yn(z,this),j=[j,this.__zoom.invert(j),z.identifier],D.touch0?!D.touch1&&D.touch0[2]!==j[2]&&(D.touch1=j,D.taps=0):(D.touch0=j,C=!0,D.taps=1+!!u);u&&(u=clearTimeout(u)),C&&(D.taps<2&&(h=j[0],u=setTimeout(function(){u=null},d)),Qo(this),D.start())}}function O(S,...M){if(this.__zooming){var N=v(this,M).event(S),$=S.changedTouches,D=$.length,C,B,z,j;for(mc(S),C=0;C<D;++C)B=$[C],z=Yn(B,this),N.touch0&&N.touch0[2]===B.identifier?N.touch0[0]=z:N.touch1&&N.touch1[2]===B.identifier&&(N.touch1[0]=z);if(B=N.that.__zoom,N.touch1){var V=N.touch0[0],X=N.touch0[1],tt=N.touch1[0],Dt=N.touch1[1],Y=(Y=tt[0]-V[0])*Y+(Y=tt[1]-V[1])*Y,W=(W=Dt[0]-X[0])*W+(W=Dt[1]-X[1])*W;B=b(B,Math.sqrt(Y/W)),z=[(V[0]+tt[0])/2,(V[1]+tt[1])/2],j=[(X[0]+Dt[0])/2,(X[1]+Dt[1])/2]}else if(N.touch0)z=N.touch0[0],j=N.touch0[1];else return;N.zoom("touch",n(w(B,z,j),N.extent,o))}}function F(S,...M){if(this.__zooming){var N=v(this,M).event(S),$=S.changedTouches,D=$.length,C,B;for($y(S),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),C=0;C<D;++C)B=$[C],N.touch0&&N.touch0[2]===B.identifier?delete N.touch0:N.touch1&&N.touch1[2]===B.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(B=Yn(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<m)){var z=zt(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return g.wheelDelta=function(S){return arguments.length?(i=typeof S=="function"?S:Ou(+S),g):i},g.filter=function(S){return arguments.length?(e=typeof S=="function"?S:Ou(!!S),g):e},g.touchable=function(S){return arguments.length?(r=typeof S=="function"?S:Ou(!!S),g):r},g.extent=function(S){return arguments.length?(t=typeof S=="function"?S:Ou([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),g):t},g.scaleExtent=function(S){return arguments.length?(s[0]=+S[0],s[1]=+S[1],g):[s[0],s[1]]},g.translateExtent=function(S){return arguments.length?(o[0][0]=+S[0][0],o[1][0]=+S[1][0],o[0][1]=+S[0][1],o[1][1]=+S[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(S){return arguments.length?(n=S,g):n},g.duration=function(S){return arguments.length?(a=+S,g):a},g.interpolate=function(S){return arguments.length?(c=S,g):c},g.on=function(){var S=l.on.apply(l,arguments);return S===l?g:S},g.clickDistance=function(S){return arguments.length?(y=(S=+S)*S,g):Math.sqrt(y)},g.tapDistance=function(S){return arguments.length?(m=+S,g):m},g}function qe(e){return e!=null&&!Number.isNaN(e)}function Cn(e,t){return+qe(t)-+qe(e)||ue(e,t)}function Ph(e,t){return+qe(t)-+qe(e)||Dl(e,t)}function c1(e){return e!=null&&`${e}`!=""}function Uh(e){return isFinite(e)?e:NaN}function cr(e){return e>0&&isFinite(e)?e:NaN}function Xd(e){return e<0&&isFinite(e)?e:NaN}const hf=1e3,hm=hf*60,dm=hm*60,pl=dm*24,aU=pl*7,u2=pl*30,cU=pl*365,gc=[["millisecond",.5*hf],["second",hf],["second",30*hf],["minute",hm],["minute",30*hm],["hour",dm],["hour",12*dm],["day",pl],["day",2*pl],["week",aU],["month",u2],["month",3*u2],["year",cU]],lU=new Map([["second",ir],["minute",Fd],["hour",Cd],["day",ja],["week",Aa],["month",Ud],["year",Qn],["monday",ul],["tuesday",CA],["wednesday",BA],["thursday",io],["friday",PA],["saturday",UA],["sunday",Aa]]),uU=new Map([["second",ir],["minute",Dd],["hour",Bd],["day",t1],["week",Ta],["month",zd],["year",Jn],["monday",fl],["tuesday",zA],["wednesday",jA],["thursday",ro],["friday",qA],["saturday",YA],["sunday",Ta]]);function zI(e,t){let n=`${e}`.toLowerCase();n.endsWith("s")&&(n=n.slice(0,-1));let i=1;const r=/^(?:(\d+)\s+)/.exec(n);switch(r&&(n=n.slice(r[0].length),i=+r[1]),n){case"quarter":n="month",i*=3;break;case"half":n="month",i*=6;break}let s=t.get(n);if(!s)throw new Error(`unknown interval: ${e}`);if(!(i>1))return s;if(!s.every)throw new Error(`non-periodic interval: ${n}`);return s.every(i)}function fU(e){return zI(e,lU)}function jI(e){return zI(e,uU)}function hU(e){if(!e)return!1;const t=e.floor(new Date(Date.UTC(2e3,11,31)));return Jn(t)>=t}function dU(e){if(!e)return!1;const t=e.floor(new Date(2e3,11,31));return Qn(t)>=t}function pU(e,t,n,i){const r=e.type==="time"?jd:hl,s=i==="left"||i==="right"?(o,a)=>`
${o}
${a}`:i==="top"?(o,a)=>`${a}
${o}`:(o,a)=>`${o}
${a}`;switch(yU(e,t,n)){case"millisecond":return vs(r(".%L"),r(":%M:%S"),s);case"second":return vs(r(":%S"),r("%-I:%M"),s);case"minute":return vs(r("%-I:%M"),r("%p"),s);case"hour":return vs(r("%-I %p"),r("%b %-d"),s);case"day":return vs(r("%-d"),r("%b"),s);case"week":return vs(r("%-d"),r("%b"),s);case"month":return vs(r("%b"),r("%Y"),s);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function yU(e,t,n){const i=ga(y5(t,(c,l)=>Math.abs(l-c)||NaN));if(i>0)return gc[tl(([,c])=>c).right(gc,i,1,gc.length)-1][0];const[r,s]=Ae(e.domain()),o=typeof n=="number"?n:10,a=Math.abs(s-r)/o;return gc[tl(([,c])=>Math.log(c)).center(gc,Math.log(a))][0]}function vs(e,t,n){return(i,r,s)=>{const o=e(i,r),a=t(i,r),c=r-Na(s);return r!==c&&s[c]!==void 0&&a===t(s[c],c)?o:n(o,a)}}const Ia=Object.getPrototypeOf(Uint8Array),mU=Object.prototype.toString;function Et(e,t,n){const i=typeof t;return i==="string"?f2(e,qI(t),n):i==="function"?f2(e,t,n):i==="number"||t instanceof Date||i==="boolean"?Ht(e,Bn(t),n):typeof(t==null?void 0:t.transform)=="function"?h2(t.transform(e),n):h2(t,n)}function f2(e,t,n){return Ht(e,(n==null?void 0:n.prototype)instanceof Ia?gU(t):t,n)}function h2(e,t){return t===void 0?rn(e):e instanceof t?e:t.prototype instanceof Ia&&!(e instanceof Ia)?t.from(e,f1):t.from(e)}function gU(e){return(t,n)=>f1(e(t,n))}const zc=[null],qI=e=>t=>t[e],an={transform:wr},ot={transform:e=>e},l1=()=>1,bU=()=>!0,ke=e=>e==null?e:`${e}`,Tt=e=>e==null?e:+e,Wl=e=>e?e[0]:void 0,yl=e=>e?e[1]:void 0,wU=e=>e?e[2]:void 0,Bn=e=>()=>e;function u1(e){const t=+`${e}`.slice(1)/100;return(n,i)=>Xr(n,t,i)}function Qe(e){return e instanceof Ia?e:Ht(e,f1,Float64Array)}function f1(e){return e==null?NaN:Number(e)}function _U(e){return Ht(e,YI)}function YI(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?xg(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function nn(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:Hl(e)?[void 0,e]:[e,void 0]}function le(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function Kd(e,t,n){if(e!=null)return Fi(e,t,n)}function Fi(e,t,n){const i=`${e}`.toLowerCase();if(!n.includes(i))throw new Error(`invalid ${t}: ${e}`);return i}function rn(e){return e==null||e instanceof Array||e instanceof Ia?e:Array.from(e)}function Ht(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function pm(e,t=Array){return e instanceof t?e.slice():t.from(e)}function VI({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function WI({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function Qd(e){return VI(e)||WI(e)||e.interval!==void 0}function ni(e){return(e==null?void 0:e.toString)===mU}function Vs(e){return ni(e)&&(e.type!==void 0||e.domain!==void 0)}function li(e){return ni(e)&&typeof e.transform!="function"}function Qr(e){return li(e)&&e.value===void 0&&e.channel===void 0}function GI(e,t,n,i=ot){return t===void 0&&n===void 0?(t=0,n=e===void 0?i:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function ii(e,t){return e===void 0&&t===void 0?[Wl,yl]:[e,t]}function hs({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=nn(t)),e===void 0&&([e]=nn(n)),e}function wr(e){const t=e.length,n=new Uint32Array(t);for(let i=0;i<t;++i)n[i]=i;return n}function h1(e,t){return Ht(t,n=>e[n])}function d1(e){return e.length===1?(t,n)=>e(h1(n,t)):e}function Ws(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function Cs(e){return e!==null&&typeof e=="object"?e.valueOf():e}function HI(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function yn(e){let t;return[{transform:()=>t,label:_r(e)},n=>t=n]}function We(e){return e==null?[e]:yn(e)}function _r(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function zh(e,t){return{transform(n){const i=e.transform(n),r=t.transform(n);return Pn(i)||Pn(r)?Ht(i,(s,o)=>new Date((+i[o]+ +r[o])/2)):Ht(i,(s,o)=>(+i[o]+ +r[o])/2,Float64Array)},label:e.label}}function jh(e,t){const n=XI(t==null?void 0:t.interval,t==null?void 0:t.type);return n?Ht(e,n):e}function XI(e,t){const n=p1(e,t);return n&&(i=>qe(i)?n.floor(i):i)}function p1(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const n=Math.abs(e);return e<0?{floor:i=>Math.floor(i*n)/n,offset:i=>(i*n+1)/n,range:(i,r)=>dn(Math.ceil(i*n),r*n).map(s=>s/n)}:{floor:i=>Math.floor(i/n)*n,offset:i=>i+n,range:(i,r)=>dn(Math.ceil(i/n),r/n).map(s=>s*n)}}if(typeof e=="string")return(t==="time"?fU:jI)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function qa(e,t){if(e=p1(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function vU(e,t){if(e=qa(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function Gl(e){return e===void 0||li(e)?e:{value:e}}function xU(e){return e==null?null:{transform:t=>Et(t,e,Float64Array),label:_r(e)}}function SU(e){if(!Di(e))return!1;for(const t of e)if(t!=null)return typeof t=="object"&&"0"in t&&"1"in t}function Di(e){return e&&typeof e[Symbol.iterator]=="function"}function KI(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function De(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function Pn(e){for(const t of e)if(t!=null)return t instanceof Date}function EU(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&xg(t)}function AU(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function QI(e){for(const t of e)if(t!=null)return typeof t=="number"}function ky(e,t){let n;for(const i of e)if(i!=null){if(!t(i))return!1;n=!0}return n}function Hl(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),e==="none"||e==="currentcolor"||e.startsWith("url(")&&e.endsWith(")")||e.startsWith("var(")&&e.endsWith(")")||fr(e)!==null)}function TU(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function _e(e){return e==null||Ma(e)}function Ma(e){return/^\s*none\s*$/i.test(e)}function IU(e){return/^\s*round\s*$/i.test(e)}function JI(e,t){return Kd(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Xl(e="middle"){return JI(e,"frameAnchor")}function Na(e){if(e==null)return;const t=e[0],n=e[e.length-1];return Dl(t,n)}function MU(e={},...t){let n=e;for(const i of t)for(const r in i)if(n[r]===void 0){const s=i[r];n===e?n={...n,[r]:s}:n[r]=s}return n}function NU(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:i}=n;if(i==null)throw new Error("missing name");const r=`${i}`;if(r==="__proto__")throw new Error(`illegal name: ${r}`);if(t.has(r))throw new Error(`duplicate name: ${r}`);return t.add(r),[i,n]}))}function y1(e){return Di(e)?NU(e):e}const vi=Symbol("position"),vr=Symbol("color"),Jd=Symbol("radius"),Zd=Symbol("length"),tp=Symbol("opacity"),ep=Symbol("symbol"),$U=Symbol("projection"),se=new Map([["x",vi],["y",vi],["fx",vi],["fy",vi],["r",Jd],["color",vr],["opacity",tp],["symbol",ep],["length",Zd],["projection",$U]]),ZI=Math.sqrt(3),tM=2/ZI,kU={draw(e,t){const n=Math.sqrt(t/Math.PI),i=n*tM,r=i/2;e.moveTo(0,i),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(0,-i),e.lineTo(-n,-r),e.lineTo(-n,r),e.closePath()}},m1=new Map([["asterisk",mI],["circle",dl],["cross",gI],["diamond",wI],["diamond2",_I],["hexagon",kU],["plus",vI],["square",xI],["square2",SI],["star",AI],["times",NI],["triangle",TI],["triangle2",II],["wye",MI]]);function g1(e){return e&&typeof e.draw=="function"}function OU(e){return g1(e)?!0:typeof e!="string"?!1:m1.has(e.toLowerCase())}function b1(e){if(e==null||g1(e))return e;const t=m1.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function LU(e){if(e==null||g1(e))return[void 0,e];if(typeof e=="string"){const t=m1.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function Ci({filter:e,sort:t,reverse:n,transform:i,initializer:r,...s}={},o){if(i===void 0&&(e!=null&&(i=w1(e)),t!=null&&!Qr(t)&&(i=Oy(i,v1(t))),n&&(i=Oy(i,_1))),o!=null&&r!=null)throw new Error("transforms cannot be applied after initializers");return{...s,...(t===null||Qr(t))&&{sort:t},transform:Oy(i,o)}}function sn({filter:e,sort:t,reverse:n,initializer:i,...r}={},s){return i===void 0&&(e!=null&&(i=w1(e)),t!=null&&!Qr(t)&&(i=Ly(i,v1(t))),n&&(i=Ly(i,_1))),{...r,...(t===null||Qr(t))&&{sort:t},initializer:Ly(i,s)}}function Oy(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,i,r){return{data:n,facets:i}=e.call(this,n,i,r),t.call(this,rn(n),i,r)}}function Ly(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,i,r,...s){let o,a,c,l,u,h;return{data:a=n,facets:c=i,channels:o}=e.call(this,n,i,r,...s),{data:u=a,facets:h=c,channels:l}=t.call(this,a,c,{...r,...o},...s),{data:u,facets:h,channels:{...o,...l}}}}function np(e,t){return(e.initializer!=null?sn:Ci)(e,t)}function RU(e,t){return np(t,w1(e))}function w1(e){return(t,n)=>{const i=Et(t,e);return{data:t,facets:n.map(r=>r.filter(s=>i[s]))}}}function FU({sort:e,...t}={}){return{...np(t,_1),sort:Qr(e)?e:null}}function _1(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function DU({seed:e,sort:t,...n}={}){return{...np(n,nM(e==null?Math.random:Qg(e))),sort:Qr(t)?t:null}}function eM(e,{sort:t,...n}={}){return{...(li(e)&&e.channel!==void 0?sn:np)(n,v1(e)),sort:Qr(t)?t:null}}function v1(e){return(typeof e=="function"&&e.length!==1?CU:nM)(e)}function CU(e){return(t,n)=>{const i=(r,s)=>e(t[r],t[s]);return{data:t,facets:n.map(r=>r.slice().sort(i))}}}function nM(e){let t,n;({channel:t,value:e,order:n}={...Gl(e)});const i=t==null?void 0:t.startsWith("-");if(i&&(t=t.slice(1)),n===void 0&&(n=i?Ph:Cn),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=Cn;break;case"descending":n=Ph;break;default:throw new Error(`invalid order: ${n}`)}return(r,s,o)=>{let a;if(t===void 0)a=Et(r,e);else{if(o===void 0)throw new Error("channel sort requires an initializer");if(a=o[t],!a)return{};a=a.value}const c=(l,u)=>n(a[l],a[u]);return{data:r,facets:s.map(l=>l.slice().sort(c))}}}function x1(e,t){return ip(null,null,e,t)}function ml(e={y:"count"},t={}){const{x:n=ot}=t;if(n==null)throw new Error("missing channel: x");return ip(n,null,e,t)}function gl(e={x:"count"},t={}){const{y:n=ot}=t;if(n==null)throw new Error("missing channel: y");return ip(null,n,e,t)}function S1(e={fill:"count"},t={}){let{x:n,y:i}=t;if([n,i]=ii(n,i),n==null)throw new Error("missing channel: x");if(i==null)throw new Error("missing channel: y");return ip(n,i,e,t)}function ip(e,t,{data:n=M1,filter:i,sort:r,reverse:s,...o}={},a={}){o=E1(o,a),n=rp(n,ot),r=r==null?void 0:A1("sort",r,a),i=i==null?void 0:T1("filter",i,a);const[c,l]=We(e),[u,h]=We(t),{z:f,fill:d,stroke:p,x1:y,x2:m,y1:g,y2:b,...w}=a,[_,x]=We(f),[v]=nn(d),[E]=nn(p),[T,k]=We(v),[A,I]=We(E);return{..."z"in a&&{z:_||f},..."fill"in a&&{fill:T||d},..."stroke"in a&&{stroke:A||p},...Ci(w,(O,F,S)=>{const M=jh(Et(O,e),S==null?void 0:S.x),N=jh(Et(O,t),S==null?void 0:S.y),$=Et(O,f),D=Et(O,v),C=Et(O,E),B=I1(o,{z:$,fill:D,stroke:C}),z=[],j=[],V=M&&l([]),X=N&&h([]),tt=$&&x([]),Dt=D&&k([]),Y=C&&I([]);let W=0;for(const U of o)U.initialize(O);r&&r.initialize(O),i&&i.initialize(O);for(const U of F){const G=[];for(const H of o)H.scope("facet",U);r&&r.scope("facet",U),i&&i.scope("facet",U);for(const[H,P]of Jo(U,B))for(const[Q,at]of Jo(P,N))for(const[Nt,xt]of Jo(at,M))if(!(i&&!i.reduce(xt))){G.push(W++),j.push(n.reduceIndex(xt,O)),M&&V.push(Nt),N&&X.push(Q),$&&tt.push(B===$?H:$[xt[0]]),D&&Dt.push(B===D?H:D[xt[0]]),C&&Y.push(B===C?H:C[xt[0]]);for(const K of o)K.reduce(xt);r&&r.reduce(xt)}z.push(G)}return iM(z,r,s),{data:j,facets:z}}),...!Rr(o,"x")&&(c?{x:c}:{x1:y,x2:m}),...!Rr(o,"y")&&(u?{y:u}:{y1:g,y2:b}),...Object.fromEntries(o.map(({name:O,output:F})=>[O,F]))}}function Rr(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function E1(e,t,n=A1){const i=Object.entries(e);return t.title!=null&&e.title===void 0&&i.push(["title",jU]),t.href!=null&&e.href===void 0&&i.push(["href",N1]),i.filter(([,r])=>r!==void 0).map(([r,s])=>s===null?BU(r):n(r,s,t))}function A1(e,t,n,i=T1){let r;ni(t)&&"reduce"in t&&(r=t.scale,t=t.reduce);const s=i(e,t,n),[o,a]=yn(s.label);let c;return{name:e,output:r===void 0?o:{value:o,scale:r},initialize(l){s.initialize(l),c=a([])},scope(l,u){s.scope(l,u)},reduce(l,u){c.push(s.reduce(l,u))}}}function BU(e){return{name:e,initialize(){},scope(){},reduce(){}}}function T1(e,t,n,i=rp){const r=HI(e,n),s=i(t,r);let o,a;return{label:_r(s===qh?null:r,s.label),initialize(c){o=r===void 0?c:Et(c,r),s.scope==="data"&&(a=s.reduceIndex(wr(c),o))},scope(c,l){s.scope===c&&(a=s.reduceIndex(l,o))},reduce(c,l){return s.scope==null?s.reduceIndex(c,o,l):s.reduceIndex(c,o,a,l)}}}function Jo(e,t){return t?el(br(e,n=>t[n]),Wl):[[,e]]}function rp(e,t,n=PU){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&ni(e))return UU(e);if(typeof e=="function")return zU(e);if(/^p\d{2}$/i.test(e))return Wi(u1(e));switch(`${e}`.toLowerCase()){case"first":return N1;case"last":return qU;case"identity":return M1;case"count":return qh;case"distinct":return YU;case"sum":return t==null?qh:VU;case"proportion":return p2(t,"data");case"proportion-facet":return p2(t,"facet");case"deviation":return Wi(wd);case"min":return Wi(xe);case"min-index":return Wi(f5);case"max":return Wi(oe);case"max-index":return Wi(u5);case"mean":return d2(Og);case"median":return d2(ga);case"variance":return Wi(Tg);case"mode":return Wi(QS)}return n(e)}function PU(e){throw new Error(`invalid reduce: ${e}`)}function I1(e,t){for(const n in t){const i=t[n];if(i!==void 0&&!e.some(r=>r.name===n))return i}}function iM(e,t,n){if(t){const i=t.output.transform(),r=(s,o)=>Cn(i[s],i[o]);e.forEach(s=>s.sort(r))}n&&e.forEach(i=>i.reverse())}function UU(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function zU(e){return{reduceIndex(t,n,i){return e(h1(n,t),i)}}}function Wi(e){return{reduceIndex(t,n){return e(t,i=>n[i])}}}function d2(e){return{reduceIndex(t,n){const i=e(t,r=>n[r]);return Pn(n)?new Date(i):i}}}const M1={reduceIndex(e,t){return h1(t,e)}},N1={reduceIndex(e,t){return t[e[0]]}},jU={reduceIndex(e,t){const i=el(Ho(e,s=>s.length,s=>t[s]),yl),r=i.slice(-5).reverse();if(r.length<i.length){const s=i.slice(0,-4);r[5-1]=[`… ${s.length.toLocaleString("en-US")} more`,$i(s,yl)]}return r.map(([s,o])=>`${s} (${o.toLocaleString("en-US")})`).join(`
`)}},qU={reduceIndex(e,t){return t[e[e.length-1]]}},qh={label:"Frequency",reduceIndex(e){return e.length}},YU={label:"Distinct",reduceIndex(e,t){const n=new _d;for(const i of e)n.add(t[i]);return n.size}},VU=Wi($i);function p2(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,i,r=1)=>n.length/r}:{scope:t,reduceIndex:(n,i,r=1)=>$i(n,s=>i[s])/r}}function bl(e,{scale:t,type:n,value:i,filter:r,hint:s},o){return s===void 0&&typeof(i==null?void 0:i.transform)=="function"&&(s=i.hint),sM(o,{scale:t,type:n,value:Et(e,i),label:_r(i),filter:r,hint:s})}function rM(e,t){return Object.fromEntries(Object.entries(e).map(([n,i])=>[n,bl(t,i,n)]))}function $1(e,t){const n=Object.fromEntries(Object.entries(e).map(([i,{scale:r,value:s}])=>{const o=r==null?null:t[r];return[i,o==null?s:Ht(s,o)]}));return n.channels=e,n}function sM(e,t){const{scale:n,value:i}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&ky(i,Hl)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&ky(i,TU)?null:"opacity";break;case"symbol":n!==!0&&ky(i,OU)?(t.scale=null,t.value=Ht(i,b1)):t.scale="symbol";break;default:t.scale=se.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!se.has(n))throw new Error(`unknown scale: ${n}`);return t}function WU(e,t,n,i,r){const{order:s,reverse:o,reduce:a=!0,limit:c}=r;for(const l in r){if(!se.has(l))continue;let{value:u,order:h=s,reverse:f=o,reduce:d=a,limit:p=c}=Gl(r[l]);const y=u==null?void 0:u.startsWith("-");if(y&&(u=u.slice(1)),h=h===void 0?y!==(u==="width"||u==="height")?aM:oM:XU(h),d==null||d===!1)continue;const m=l==="fx"||l==="fy"?HU(t,i[l]):GU(n,l);if(!m)throw new Error(`missing channel for scale: ${l}`);const g=m.value,[b=0,w=1/0]=Di(p)?p:p<0?[p]:[0,p];if(u==null)m.domain=()=>{let _=Array.from(new _d(g));return f&&(_=_.reverse()),(b!==0||w!==1/0)&&(_=_.slice(b,w)),_};else{const _=u==="data"?e:u==="height"?y2(n,"y1","y2"):u==="width"?y2(n,"x1","x2"):ym(n,u,u==="y"?"y2":u==="x"?"x2":void 0),x=rp(d===!0?"max":d,_);m.domain=()=>{let v=s5(wr(g),E=>x.reduceIndex(E,_),E=>g[E]);return h&&v.sort(h),f&&v.reverse(),(b!==0||w!==1/0)&&(v=v.slice(b,w)),v.map(Wl)}}}}function GU(e,t){for(const n in e){const i=e[n];if(i.scale===t)return i}}function HU(e,t){const n=e.original;if(n===e)return t;const i=t.value,r=t.value=[];for(let s=0;s<n.length;++s){const o=i[n[s][0]];for(const a of e[s])r[a]=o}return t}function y2(e,t,n){const i=ym(e,t),r=ym(e,n);return Ht(r,(s,o)=>Math.abs(s-i[o]),Float64Array)}function ym(e,t,n){let i=e[t];if(!i&&n!==void 0&&(i=e[n]),i)return i.value;throw new Error(`missing channel: ${t}`)}function XU(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return oM;case"descending":return aM}throw new Error(`invalid order: ${e}`)}function oM([e,t],[n,i]){return Cn(t,i)||Cn(e,n)}function aM([e,t],[n,i]){return Ph(t,i)||Cn(e,n)}function cM(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}function sp(e={}){const{document:t=typeof window<"u"?window.document:void 0}=e;return{document:t}}function Ft(e,{document:t}){return zt(Sd(e).call(t.documentElement))}let mm=0;function KU(){const e=mm;return mm=0,e}function Br(e){console.warn(e),++mm}const lM=Math.PI,ji=2*lM,m2=.618;function QU({projection:e,inset:t=0,insetTop:n=t,insetRight:i=t,insetBottom:r=t,insetLeft:s=t}={},o){if(e==null)return;if(typeof e.stream=="function")return e;let a,c,l="frame";if(ni(e)){let x;if({type:e,domain:c,inset:x,insetTop:n=x!==void 0?x:n,insetRight:i=x!==void 0?x:i,insetBottom:r=x!==void 0?x:r,insetLeft:s=x!==void 0?x:s,clip:l=l,...a}=e,e==null)return}typeof e!="function"&&({type:e}=uM(e));const{width:u,height:h,marginLeft:f,marginRight:d,marginTop:p,marginBottom:y}=o,m=u-f-d-s-i,g=h-p-y-n-r;if(e=e==null?void 0:e({width:m,height:g,clip:l,...a}),e==null)return;l=JU(l,f,p,u-d,h-y);let b=f+s,w=p+n,_;if(c!=null){const[[x,v],[E,T]]=us(e).bounds(c),k=Math.min(m/(E-x),g/(T-v));k>0?(b-=(k*(x+E)-m)/2,w-=(k*(v+T)-g)/2,_=Th({point(A,I){this.stream.point(A*k+b,I*k+w)}})):Br("Warning: the projection could not be fit to the specified domain; using the default scale.")}return _??(_=b===0&&w===0?fM():Th({point(x,v){this.stream.point(x+b,v+w)}})),{stream:x=>e.stream(_.stream(l(x)))}}function uM(e){switch(`${e}`.toLowerCase()){case"albers-usa":return zn(H7,.7463,.4673);case"albers":return Lu(fA,.7463,.4673);case"azimuthal-equal-area":return zn(X7,4,4);case"azimuthal-equidistant":return zn(K7,ji,ji);case"conic-conformal":return Lu(Z7,ji,ji);case"conic-equal-area":return Lu(Ih,6.1702,2.9781);case"conic-equidistant":return Lu(nB,7.312,3.6282);case"equal-earth":return zn(rB,5.4133,2.6347);case"equirectangular":return zn(tB,ji,lM);case"gnomonic":return zn(sB,3.4641,3.4641);case"identity":return{type:fM};case"reflect-y":return{type:ZU};case"mercator":return zn(Q7,ji,ji);case"orthographic":return zn(oB,2,2);case"stereographic":return zn(aB,2,2);case"transverse-mercator":return zn(cB,ji,ji);default:throw new Error(`unknown projection type: ${e}`)}}function JU(e,t,n,i,r){if(e===!1||e==null||typeof e=="number")return s=>s;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return XE(t,n,i,r);default:throw new Error(`unknown projection clip type: ${e}`)}}function zn(e,t,n){return{type:({width:i,height:r,rotate:s,precision:o=.15,clip:a})=>{var l,u,h;const c=e();return o!=null&&((l=c.precision)==null||l.call(c,o)),s!=null&&((u=c.rotate)==null||u.call(c,s)),typeof a=="number"&&((h=c.clipAngle)==null||h.call(c,a)),c.scale(Math.min(i/t,r/n)),c.translate([i/2,r/2]),c},aspectRatio:n/t}}function Lu(e,t,n){const{type:i,aspectRatio:r}=zn(e,t,n);return{type:s=>{const{parallels:o,domain:a,width:c,height:l}=s,u=i(s);return o!=null&&(u.parallels(o),a===void 0&&u.fitSize([c,l],{type:"Sphere"})),u},aspectRatio:r}}const fM=Bn({stream:e=>e}),ZU=Bn(Th({point(e,t){this.stream.point(e,-t)}}));function hM(e,t,n,i){const r=n[e],s=n[t],o=r.length,a=n[e]=new Float64Array(o).fill(NaN),c=n[t]=new Float64Array(o).fill(NaN);let l;const u=i.stream({point(h,f){a[l]=h,c[l]=f}});for(l=0;l<o;++l)u.point(r[l],s[l])}function tz({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(ni(e)&&(e=e.type),e!=null)}function ez(e){if(typeof(e==null?void 0:e.stream)=="function")return m2;if(ni(e)&&(e=e.type),e!=null){if(typeof e!="function"){const{aspectRatio:t}=uM(e);if(t)return t}return m2}}function op(e,t,{projection:n}){const{x:i,y:r}=e;let s={};return i&&(s.x=i),r&&(s.y=r),s=$1(s,t),n&&(i==null?void 0:i.scale)==="x"&&(r==null?void 0:r.scale)==="y"&&hM("x","y",s,n),i&&(s.x=Qe(s.x)),r&&(s.y=Qe(s.y)),s}function nz(e){const t=[],n=[],i={scale:"x",value:t},r={scale:"y",value:n},s={point(o,a){t.push(o),n.push(a)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const o of e.value)Nr(o,s);return[i,r]}const dM=new Map([["accent",yP],["category10",pP],["dark2",mP],["paired",gP],["pastel1",bP],["pastel2",wP],["set1",_P],["set2",vP],["set3",xP],["tableau10",SP]]);function iz(e){return e!=null&&dM.has(`${e}`.toLowerCase())}const g2=new Map([...dM,["brbg",qi(eT,nT)],["prgn",qi(iT,rT)],["piyg",qi(sT,oT)],["puor",qi(aT,cT)],["rdbu",qi(lm,Oh)],["rdgy",qi(lT,uT)],["rdylbu",qi(um,Lh)],["rdylgn",qi(fT,hT)],["spectral",qi(dT,pT)],["burd",b2(lm,Oh)],["buylrd",b2(um,Lh)],["blues",be(PT,UT)],["greens",be(zT,jT)],["greys",be(qT,YT)],["oranges",be(XT,KT)],["purples",be(VT,WT)],["reds",be(GT,HT)],["turbo",Yi(iI)],["viridis",Yi(rI)],["magma",Yi(sI)],["inferno",Yi(oI)],["plasma",Yi(aI)],["cividis",Yi(QT)],["cubehelix",Yi(JT)],["warm",Yi(ZT)],["cool",Yi(tI)],["bugn",be(yT,mT)],["bupu",be(gT,bT)],["gnbu",be(wT,_T)],["orrd",be(vT,xT)],["pubu",be(AT,TT)],["pubugn",be(ST,ET)],["purd",be(IT,MT)],["rdpu",be(NT,$T)],["ylgn",be(LT,RT)],["ylgnbu",be(kT,OT)],["ylorbr",be(FT,DT)],["ylorrd",be(CT,BT)],["rainbow",w2(eI)],["sinebow",w2(nI)]]);function be(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?Xn(t,n):e[n])}function qi(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?Xn(t,n):e[n])}function b2(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?Xn(i=>t(1-i),n):e[n].slice().reverse())}function Yi(e){return({length:t})=>Xn(e,Math.max(2,Math.floor(t)))}function w2(e){return({length:t})=>Xn(e,Math.floor(t)+1).slice(0,-1)}function pM(e){const t=`${e}`.toLowerCase();if(!g2.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return g2.get(t)}function ap(e,t){const n=pM(e),i=typeof n=="function"?n({length:t}):n;return i.length!==t?i.slice(0,t):i}function rz(e,t="greys"){const n=new Set,[i,r]=ap(t,2);for(const s of e)if(s!=null)if(s===!0)n.add(r);else if(s===!1)n.add(i);else return;return[...n]}const _2=new Map([["brbg",nT],["prgn",rT],["piyg",oT],["puor",cT],["rdbu",Oh],["rdgy",uT],["rdylbu",Lh],["rdylgn",hT],["spectral",pT],["burd",e=>Oh(1-e)],["buylrd",e=>Lh(1-e)],["blues",UT],["greens",jT],["greys",YT],["purples",WT],["reds",HT],["oranges",KT],["turbo",iI],["viridis",rI],["magma",sI],["inferno",oI],["plasma",aI],["cividis",QT],["cubehelix",JT],["warm",ZT],["cool",tI],["bugn",mT],["bupu",bT],["gnbu",_T],["orrd",xT],["pubugn",ET],["pubu",TT],["purd",MT],["rdpu",$T],["ylgnbu",OT],["ylgn",RT],["ylorbr",DT],["ylorrd",BT],["rainbow",eI],["sinebow",nI]]);function k1(e){const t=`${e}`.toLowerCase();if(!_2.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return _2.get(t)}const sz=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function oz(e){return e!=null&&sz.has(`${e}`.toLowerCase())}const yM=e=>t=>e(1-t),Ry=[0,1],v2=new Map([["number",$e],["rgb",to],["hsl",qF],["hcl",WF],["lab",YF]]);function mM(e){const t=`${e}`.toLowerCase();if(!v2.has(t))throw new Error(`unknown interpolator: ${t}`);return v2.get(t)}function Kl(e,t,n,{type:i,nice:r,clamp:s,zero:o,domain:a=bM(e,n),unknown:c,round:l,scheme:u,interval:h,range:f=se.get(e)===Jd?gz(n,a):se.get(e)===Zd?bz(n,a):se.get(e)===tp?Ry:void 0,interpolate:d=se.get(e)===vr?u==null&&f!==void 0?to:k1(u!==void 0?u:i==="cyclical"?"rainbow":"turbo"):l?Pg:$e,reverse:p}){if(h=qa(h,i),(i==="cyclical"||i==="sequential")&&(i="linear"),typeof d!="function"&&(d=mM(d)),p=!!p,f!==void 0){const y=(a=rn(a)).length,m=(f=rn(f)).length;if(y!==m){if(d.length===1)throw new Error("invalid piecewise interpolator");d=Td(d,f),f=void 0}}if(d.length===1?(p&&(d=yM(d),p=!1),f===void 0&&(f=Float64Array.from(a,(y,m)=>m/(a.length-1)),f.length===2&&(f=Ry)),t.interpolate((f===Ry?Bn:L1)(d))):t.interpolate(d),o){const[y,m]=Ae(a);(y>0||m<0)&&(a=pm(a),Na(a)!==Math.sign(y)?a[a.length-1]=0:a[0]=0)}return p&&(a=Jf(a)),t.domain(a).unknown(c),r&&(t.nice(az(r,i)),a=t.domain()),f!==void 0&&t.range(f),s&&t.clamp(s),{type:i,domain:a,range:f,scale:t,interpolate:d,interval:h}}function az(e,t){return e===!0?void 0:typeof e=="number"?e:vU(e,t)}function cz(e,t,n){return Kl(e,Rd(),t,n)}function lz(e,t,n){return gM(e,t,{...n,exponent:.5})}function gM(e,t,{exponent:n=1,...i}){return Kl(e,RA().exponent(n),t,{...i,type:"pow"})}function uz(e,t,{base:n=10,domain:i=wz(t),...r}){return Kl(e,$A().base(n),t,{...r,domain:i})}function fz(e,t,{constant:n=1,...i}){return Kl(e,OA().constant(n),t,i)}function hz(e,t,{range:n,quantiles:i=n===void 0?5:(n=[...n]).length,n:r=i,scheme:s="rdylbu",domain:o=_z(t),unknown:a,interpolate:c,reverse:l}){return n===void 0&&(n=c!==void 0?Xn(c,r):se.get(e)===vr?ap(s,r):void 0),o.length>0&&(o=FA(o,n===void 0?{length:r}:n).quantiles()),O1(e,t,{domain:o,range:n,reverse:l,unknown:a})}function dz(e,t,{range:n,n:i=n===void 0?5:(n=[...n]).length,scheme:r="rdylbu",domain:s=bM(e,t),unknown:o,interpolate:a,reverse:c}){const[l,u]=Ae(s);let h;return n===void 0?(h=Hr(l,u,i),h[0]<=l&&h.splice(0,1),h[h.length-1]>=u&&h.pop(),i=h.length+1,n=a!==void 0?Xn(a,i):se.get(e)===vr?ap(r,i):void 0):(h=Xn($e(l,u),i+1).slice(1,-1),l instanceof Date&&(h=h.map(f=>new Date(f)))),Na(rn(s))<0&&h.reverse(),O1(e,t,{domain:h,range:n,reverse:c,unknown:o})}function O1(e,t,{domain:n=[0],unknown:i,scheme:r="rdylbu",interpolate:s,range:o=s!==void 0?Xn(s,n.length+1):se.get(e)===vr?ap(r,n.length+1):void 0,reverse:a}){n=rn(n);const c=Na(n);if(!isNaN(c)&&!pz(n,c))throw new Error(`the ${e} scale has a non-monotonic domain`);return a&&(o=Jf(o)),{type:"threshold",scale:DA(c<0?Jf(n):n,o===void 0?[]:o).unknown(i),domain:n,range:o}}function pz(e,t){for(let n=1,i=e.length,r=e[0];n<i;++n){const s=Dl(r,r=e[n]);if(s!==0&&s!==t)return!1}return!0}function yz(){return{type:"identity",scale:IA()}}function wl(e,t=Uh){return e.length?[xe(e,({value:n})=>n===void 0?n:xe(n,t)),oe(e,({value:n})=>n===void 0?n:oe(n,t))]:[0,1]}function bM(e,t){const n=se.get(e);return(n===Jd||n===tp||n===Zd?mz:wl)(t)}function mz(e){return[0,e.length?oe(e,({value:t})=>t===void 0?t:oe(t,Uh)):1]}function gz(e,t){const n=e.find(({radius:o})=>o!==void 0);if(n!==void 0)return[0,n.radius];const i=Xr(e,.5,({value:o})=>o===void 0?NaN:Xr(o,.25,cr)),r=t.map(o=>3*Math.sqrt(o/i)),s=30/oe(r);return s<1?r.map(o=>o*s):r}function bz(e,t){const n=ga(e,({value:s})=>s===void 0?NaN:ga(s,Math.abs)),i=t.map(s=>12*s/n),r=60/oe(i);return r<1?i.map(s=>s*r):i}function wz(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return wl(e,cr);if(n<0)return wl(e,Xd)}return[1,10]}function _z(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const i of n)t.push(i);return t}function L1(e){return(t,n)=>i=>e(t+i*(n-t))}function cp(e,t,n,i,{type:r,nice:s,clamp:o,domain:a=wl(i),unknown:c,pivot:l=0,scheme:u,range:h,symmetric:f=!0,interpolate:d=se.get(e)===vr?u==null&&h!==void 0?to:k1(u!==void 0?u:"rdbu"):$e,reverse:p}){l=+l,a=rn(a);let[y,m]=a;if(a.length>2&&Br(`Warning: the diverging ${e} scale domain contains extra elements.`),Dl(y,m)<0&&([y,m]=[m,y],p=!p),y=Math.min(y,l),m=Math.max(m,l),typeof d!="function"&&(d=mM(d)),h!==void 0&&(d=d.length===1?L1(d)(...h):Td(d,h)),p&&(d=yM(d)),f){const g=n.apply(l),b=g-n.apply(y),w=n.apply(m)-g;b<w?y=n.invert(g-w):b>w&&(m=n.invert(g+b))}return t.domain([y,l,m]).unknown(c).interpolator(d),o&&t.clamp(o),s&&t.nice(s),{type:r,domain:[y,m],pivot:l,interpolate:d,scale:t}}function vz(e,t,n){return cp(e,QA(),Az,t,n)}function xz(e,t,n){return wM(e,t,{...n,exponent:.5})}function wM(e,t,{exponent:n=1,...i}){return cp(e,tT().exponent(n=+n),Mz(n),t,{...i,type:"diverging-pow"})}function Sz(e,t,{base:n=10,pivot:i=1,domain:r=wl(t,i<0?Xd:cr),...s}){return cp(e,JA().base(n=+n),Tz,t,{domain:r,pivot:i,...s})}function Ez(e,t,{constant:n=1,...i}){return cp(e,ZA().constant(n=+n),Nz(n),t,i)}const Az={apply(e){return e},invert(e){return e}},Tz={apply:Math.log,invert:Math.exp},Iz={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function Mz(e){return e===.5?Iz:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function Nz(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function _M(e,t,n,i){return Kl(e,t,n,i)}function $z(e,t,n){return _M(e,hP(),t,n)}function kz(e,t,n){return _M(e,dP(),t,n)}const Ql=Symbol("ordinal");function vM(e,t,n,{type:i,interval:r,domain:s,range:o,reverse:a,hint:c}){return r=qa(r,i),s===void 0&&(s=SM(n,r,e)),(i==="categorical"||i===Ql)&&(i="ordinal"),a&&(s=Jf(s)),t.domain(s),o!==void 0&&(typeof o=="function"&&(o=o(s)),t.range(o)),{type:i,domain:s,range:o,scale:t,hint:c,interval:r}}function Oz(e,t,{type:n,interval:i,domain:r,range:s,scheme:o,unknown:a,...c}){i=qa(i,n),r===void 0&&(r=SM(t,i,e));let l;if(se.get(e)===ep)l=Fz(t),s=s===void 0?Dz(l):Ht(s,b1);else if(se.get(e)===vr&&(s===void 0&&(n==="ordinal"||n===Ql)&&(s=rz(r,o),s!==void 0&&(o=void 0)),o===void 0&&s===void 0&&(o=n==="ordinal"?"turbo":"tableau10"),o!==void 0))if(s!==void 0){const u=k1(o),h=s[0],f=s[1]-s[0];s=({length:d})=>Xn(p=>u(h+f*p),d)}else s=pM(o);if(a===om)throw new Error(`implicit unknown on ${e} scale is not supported`);return vM(e,Jg().unknown(a),t,{...c,type:n,domain:r,range:s,hint:l})}function Lz(e,t,{align:n=.5,padding:i=.5,...r}){return xM(GB().align(n).padding(i),t,r,e)}function Rz(e,t,{align:n=.5,padding:i=.1,paddingInner:r=i,paddingOuter:s=e==="fx"||e==="fy"?0:i,...o}){return xM(Od().align(n).paddingInner(r).paddingOuter(s),t,o,e)}function xM(e,t,n,i){let{round:r}=n;return r!==void 0&&e.round(r=!!r),e=vM(i,e,t,n),e.round=r,e}function SM(e,t,n){const i=new _d;for(const{value:r,domain:s}of e){if(s!==void 0)return s();if(r!==void 0)for(const o of r)i.add(o)}if(t!==void 0){const[r,s]=Ae(i).map(t.floor,t);return t.range(r,t.offset(s))}if(i.size>1e4&&se.get(n)===vi)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return el(i,Cn)}function x2(e,t){let n;for(const{hint:i}of e){const r=i==null?void 0:i[t];if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}}return n}function Fz(e){return{fill:x2(e,"fill"),stroke:x2(e,"stroke")}}function Dz(e){return _e(e.fill)?DP:FP}function gm(e,{label:t,inset:n=0,insetTop:i=n,insetRight:r=n,insetBottom:s=n,insetLeft:o=n,round:a,nice:c,clamp:l,zero:u,align:h,padding:f,projection:d,facet:{label:p=t}={},...y}={}){const m={};for(const[g,b]of e){const w=y[g],_=IM(g,b,{round:se.get(g)===vi?a:void 0,nice:c,clamp:l,zero:u,align:h,padding:f,projection:d,...w});if(_){let{label:x=g==="fx"||g==="fy"?p:t,percent:v,transform:E,inset:T,insetTop:k=T!==void 0?T:g==="y"?i:0,insetRight:A=T!==void 0?T:g==="x"?r:0,insetBottom:I=T!==void 0?T:g==="y"?s:0,insetLeft:O=T!==void 0?T:g==="x"?o:0}=w||{};if(E==null)E=void 0;else if(typeof E!="function")throw new Error("invalid scale transform; not a function");_.percent=!!v,_.label=x===void 0?Bz(b,_):x,_.transform=E,g==="x"||g==="fx"?(_.insetLeft=+O,_.insetRight=+A):(g==="y"||g==="fy")&&(_.insetTop=+k,_.insetBottom=+I),m[g]=_}}return m}function S2(e){return Object.fromEntries(Object.entries(e).filter(([,{scale:t}])=>t).map(([t,{scale:n,type:i,interval:r,label:s}])=>(n.type=i,r!=null&&(n.interval=r),s!=null&&(n.label=s),[t,n])))}function Cz(e,t){const{x:n,y:i,fx:r,fy:s}=e,o=r||s?R1(t):t;r&&E2(r,o),s&&A2(s,o);const a=r||s?EM(e,t):t;n&&E2(n,a),i&&A2(i,a)}function Bz(e=[],t){let n;for(const{label:i}of e)if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}if(n!==void 0)return!fo(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function R1(e){const{marginTop:t,marginRight:n,marginBottom:i,marginLeft:r,width:s,height:o,facet:{marginTop:a,marginRight:c,marginBottom:l,marginLeft:u}}=e;return{marginTop:Math.max(t,a),marginRight:Math.max(n,c),marginBottom:Math.max(i,l),marginLeft:Math.max(r,u),width:s,height:o}}function EM({fx:e,fy:t},n){const{marginTop:i,marginRight:r,marginBottom:s,marginLeft:o,width:a,height:c}=R1(n);return{marginTop:i,marginRight:r,marginBottom:s,marginLeft:o,width:e?e.scale.bandwidth()+o+r:a,height:t?t.scale.bandwidth()+i+s:c,facet:{width:a,height:c}}}function E2(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:i}=e,{width:r,marginLeft:s=0,marginRight:o=0}=t,a=s+n,c=r-o-i;e.range=[a,Math.max(a,c)],fo(e)||(e.range=TM(e)),e.scale.range(e.range)}AM(e)}function A2(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:i}=e,{height:r,marginTop:s=0,marginBottom:o=0}=t,a=s+n,c=r-o-i;e.range=[Math.max(a,c),a],fo(e)?e.range.reverse():e.range=TM(e),e.scale.range(e.range)}AM(e)}function AM(e){e.round===void 0&&zz(e)&&Pz(e)<=30&&e.scale.round(!0)}function Pz({scale:e}){const t=e.domain().length,[n,i]=e.range(),r=e.paddingInner?e.paddingInner():1,s=e.paddingOuter?e.paddingOuter():e.padding(),o=t-r,a=Math.abs(i-n)/Math.max(1,o+s*2);return(a-Math.floor(a))*o}function TM(e){const t=e.scale.domain().length+MM(e);if(!(t>2))return e.range;const[n,i]=e.range;return Array.from({length:t},(r,s)=>n+s/(t-1)*(i-n))}function bm(e,t,n){return IM(e,n===void 0?void 0:[{hint:n}],{...t})}function IM(e,t=[],n={}){const i=Uz(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&fo({type:i})){const r=t.map(({value:s})=>s).filter(s=>s!==void 0);r.some(Pn)?Br(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Eo(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${Eo(i)}".`):r.some(EU)?Br(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Eo(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${Eo(i)}".`):r.some(AU)&&Br(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Eo(i)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${Eo(i)}".`)}switch(n.type=i,i){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=Ru(t,n,Qe);break;case"identity":switch(se.get(e)){case vi:n=Ru(t,n,Qe);break;case ep:n=Ru(t,n,jz);break}break;case"utc":case"time":n=Ru(t,n,_U);break}switch(i){case"diverging":return vz(e,t,n);case"diverging-sqrt":return xz(e,t,n);case"diverging-pow":return wM(e,t,n);case"diverging-log":return Sz(e,t,n);case"diverging-symlog":return Ez(e,t,n);case"categorical":case"ordinal":case Ql:return Oz(e,t,n);case"cyclical":case"sequential":case"linear":return cz(e,t,n);case"sqrt":return lz(e,t,n);case"threshold":return O1(e,t,n);case"quantile":return hz(e,t,n);case"quantize":return dz(e,t,n);case"pow":return gM(e,t,n);case"log":return uz(e,t,n);case"symlog":return fz(e,t,n);case"utc":return kz(e,t,n);case"time":return $z(e,t,n);case"point":return Lz(e,t,n);case"band":return Rz(e,t,n);case"identity":return se.get(e)===vi?yz():{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${i}`)}}function Eo(e){return typeof e=="symbol"?e.description:e}const T2={toString:()=>"projection"};function Uz(e,t,{type:n,domain:i,range:r,scheme:s,pivot:o,projection:a}){if(e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&a!=null&&(n=T2);for(const{type:l}of t)if(l!==void 0){if(n===void 0)n=l;else if(n!==l)throw new Error(`scale incompatible with channel: ${n} !== ${l}`)}if(n===T2)return;if(n!==void 0)return n;if(i===void 0&&!t.some(({value:l})=>l!==void 0))return;const c=se.get(e);if(c===Jd)return"sqrt";if(c===tp||c===Zd)return"linear";if(c===ep)return"ordinal";if((i||r||[]).length>2)return Fy(c);if(i!==void 0){if(De(i))return Fy(c);if(Pn(i))return"utc"}else{const l=t.map(({value:u})=>u).filter(u=>u!==void 0);if(l.some(De))return Fy(c);if(l.some(Pn))return"utc"}if(c===vr){if(o!=null||oz(s))return"diverging";if(iz(s))return"categorical"}return"linear"}function Fy(e){switch(e){case vi:return"point";case vr:return Ql;default:return"ordinal"}}function F1({type:e}){return e==="time"||e==="utc"}function fo({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===Ql}function MM({type:e}){return e==="threshold"}function zz({type:e}){return e==="point"||e==="band"}function On(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let i=1,r=t.length;i<r;++i)if(e(t[i])-n)return!1;return!0}function Ru(e,{domain:t,...n},i){for(const r of e)r.value!==void 0&&(r.value=i(r.value));return{domain:t===void 0?t:i(t),...n}}function jz(e){return Ht(e,b1)}function so(e={}){let t;for(const n in e)if(se.has(n)&&Vs(e[n])){if(t!==void 0)throw new Error("ambiguous scale definition; multiple scales found");t=NM(bm(n,e[n]))}if(t===void 0)throw new Error("invalid scale definition; no scale found");return t}function qz(e){return t=>{if(!se.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return t in e?NM(e[t]):void 0}}function NM({scale:e,type:t,domain:n,range:i,interpolate:r,interval:s,transform:o,percent:a,pivot:c}){if(t==="identity")return{type:"identity",apply:u=>u,invert:u=>u};const l=e.unknown?e.unknown():void 0;return{type:t,domain:pm(n),...i!==void 0&&{range:pm(i)},...o!==void 0&&{transform:o},...a&&{percent:a},...l!==void 0&&{unknown:l},...s!==void 0&&{interval:s},...r!==void 0&&{interpolate:r},...e.clamp&&{clamp:e.clamp()},...c!==void 0&&{pivot:c,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:u=>e(u),...e.invert&&{invert:u=>e.invert(u)}}}function D1(e){let t,n;return(...i)=>(((n==null?void 0:n.length)!==i.length||n.some((r,s)=>r!==i[s]))&&(n=i,t=e(...i)),t)}const Yz=D1(e=>new Intl.NumberFormat(e)),Vz=D1((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{month:t}})),Wz=D1((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{weekday:t}}));function Gz(e="en-US"){const t=Yz(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function Hz(e="en-US",t="short"){const n=Vz(e,t);return i=>i!=null&&!isNaN(i=+new Date(Date.UTC(2e3,+i)))?n.format(i):void 0}function Xz(e="en-US",t="short"){const n=Wz(e,t);return i=>i!=null&&!isNaN(i=+new Date(Date.UTC(2001,0,+i)))?n.format(i):void 0}function $M(e){return DS(e,"Invalid Date")}function Kz(e="en-US"){const t=Gz(e);return n=>(n instanceof Date?$M:typeof n=="number"?t:ke)(n)}const lr=Kz(),Te=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let Qz=0;function I2(){return`plot-clip-${++Qz}`}function kM(e,{title:t,href:n,ariaLabel:i,ariaDescription:r,ariaHidden:s,target:o,fill:a,fillOpacity:c,stroke:l,strokeWidth:u,strokeOpacity:h,strokeLinejoin:f,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:y,strokeDashoffset:m,opacity:g,mixBlendMode:b,imageFilter:w,paintOrder:_,pointerEvents:x,shapeRendering:v,channels:E},{ariaLabel:T,fill:k="currentColor",fillOpacity:A,stroke:I="none",strokeOpacity:O,strokeWidth:F,strokeLinecap:S,strokeLinejoin:M,strokeMiterlimit:N,paintOrder:$}){k===null&&(a=null,c=null),I===null&&(l=null,h=null),_e(k)?!_e(I)&&(!_e(a)||E!=null&&E.fill)&&(I="none"):_e(I)&&(!_e(l)||E!=null&&E.stroke)&&(k="none");const[D,C]=nn(a,k),[B,z]=le(c,A),[j,V]=nn(l,I),[X,tt]=le(h,O),[Dt,Y]=le(g);Ma(V)||(u===void 0&&(u=F),d===void 0&&(d=S),f===void 0&&(f=M),p===void 0&&!IU(f)&&(p=N),!Ma(C)&&_===void 0&&(_=$));const[W,U]=le(u);return k!==null&&(e.fill=ae(C,"currentColor"),e.fillOpacity=bc(z,1)),I!==null&&(e.stroke=ae(V,"none"),e.strokeWidth=bc(U,1),e.strokeOpacity=bc(tt,1),e.strokeLinejoin=ae(f,"miter"),e.strokeLinecap=ae(d,"butt"),e.strokeMiterlimit=bc(p,4),e.strokeDasharray=ae(y,"none"),e.strokeDashoffset=ae(m,"0")),e.target=ke(o),e.ariaLabel=ke(T),e.ariaDescription=ke(r),e.ariaHidden=ke(s),e.opacity=bc(Y,1),e.mixBlendMode=ae(b,"normal"),e.imageFilter=ae(w,"none"),e.paintOrder=ae(_,"normal"),e.pointerEvents=ae(x,"auto"),e.shapeRendering=ae(v,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:i,optional:!0,filter:null},fill:{value:D,scale:"auto",optional:!0},fillOpacity:{value:B,scale:"auto",optional:!0},stroke:{value:j,scale:"auto",optional:!0},strokeOpacity:{value:X,scale:"auto",optional:!0},strokeWidth:{value:W,optional:!0},opacity:{value:Dt,scale:"auto",optional:!0}}}function Jz(e,t){t&&e.filter(n=>c1(t[n])).append("title").call(tj,t)}function Zz(e,t){t&&e.filter(([n])=>c1(t[n])).append("title").call(ej,t)}function tj(e,t){t&&e.text(n=>lr(t[n]))}function ej(e,t){t&&e.text(([n])=>lr(t[n]))}function ge(e,{target:t,tip:n},{ariaLabel:i,title:r,fill:s,fillOpacity:o,stroke:a,strokeOpacity:c,strokeWidth:l,opacity:u,href:h}){i&&et(e,"aria-label",f=>i[f]),s&&et(e,"fill",f=>s[f]),o&&et(e,"fill-opacity",f=>o[f]),a&&et(e,"stroke",f=>a[f]),c&&et(e,"stroke-opacity",f=>c[f]),l&&et(e,"stroke-width",f=>l[f]),u&&et(e,"opacity",f=>u[f]),h&&LM(e,f=>h[f],t),n||Jz(e,r)}function Yh(e,{target:t,tip:n},{ariaLabel:i,title:r,fill:s,fillOpacity:o,stroke:a,strokeOpacity:c,strokeWidth:l,opacity:u,href:h}){i&&et(e,"aria-label",([f])=>i[f]),s&&et(e,"fill",([f])=>s[f]),o&&et(e,"fill-opacity",([f])=>o[f]),a&&et(e,"stroke",([f])=>a[f]),c&&et(e,"stroke-opacity",([f])=>c[f]),l&&et(e,"stroke-width",([f])=>l[f]),u&&et(e,"opacity",([f])=>u[f]),h&&LM(e,([f])=>h[f],t),n||Zz(e,r)}function nj({ariaLabel:e,title:t,fill:n,fillOpacity:i,stroke:r,strokeOpacity:s,strokeWidth:o,opacity:a,href:c},{tip:l}){return[e,l?void 0:t,n,i,r,s,o,a,c].filter(u=>u!==void 0)}function C1(e,t,n){const i=br(e,r=>t[r]);return n===void 0&&i.size>1+e.length>>1&&Br("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),i.values()}function*OM(e,t,n,i){const{z:r}=n,{z:s}=i,o=nj(i,n),a=[...t,...o];for(const c of s?C1(e,s,r):[e]){let l,u;t:for(const h of c){for(const f of a)if(!qe(f[h])){u&&u.push(-1);continue t}if(l===void 0){u&&(yield u),l=o.map(f=>Cs(f[h])),u=[h];continue}u.push(h);for(let f=0;f<o.length;++f)if(Cs(o[f][h])!==l[f]){yield u,l=o.map(p=>Cs(p[h])),u=[h];continue t}}u&&(yield u)}}function ij(e){return e===!0?e="frame":e===!1&&(e=null),Kd(e,"clip",["frame","sphere"])}function rj(e,t,n,i){let r;switch(t.clip){case"frame":{const{width:s,height:o,marginLeft:a,marginRight:c,marginTop:l,marginBottom:u}=n,h=I2();r=`url(#${h})`,e=Ft("svg:g",i).call(f=>f.append("svg:clipPath").attr("id",h).append("rect").attr("x",a).attr("y",l).attr("width",s-c-a).attr("height",o-l-u)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{const{projection:s}=i;if(!s)throw new Error('the "sphere" clip option requires a projection');const o=I2();r=`url(#${o})`,e.append("clipPath").attr("id",o).append("path").attr("d",us(s)({type:"Sphere"}));break}}et(e,"aria-label",t.ariaLabel),et(e,"aria-description",t.ariaDescription),et(e,"aria-hidden",t.ariaHidden),et(e,"clip-path",r)}function Zt(e,t,n,i){rj(e,t,n,i),et(e,"fill",t.fill),et(e,"fill-opacity",t.fillOpacity),et(e,"stroke",t.stroke),et(e,"stroke-width",t.strokeWidth),et(e,"stroke-opacity",t.strokeOpacity),et(e,"stroke-linejoin",t.strokeLinejoin),et(e,"stroke-linecap",t.strokeLinecap),et(e,"stroke-miterlimit",t.strokeMiterlimit),et(e,"stroke-dasharray",t.strokeDasharray),et(e,"stroke-dashoffset",t.strokeDashoffset),et(e,"shape-rendering",t.shapeRendering),et(e,"filter",t.imageFilter),et(e,"paint-order",t.paintOrder);const{pointerEvents:r=i.pointerSticky===!1?"none":void 0}=t;et(e,"pointer-events",r)}function Qt(e,t){sj(e,"mix-blend-mode",t.mixBlendMode),et(e,"opacity",t.opacity)}function LM(e,t,n){e.each(function(i){const r=t(i);if(r!=null){const s=this.ownerDocument.createElementNS(Js.svg,"a");s.setAttribute("fill","inherit"),s.setAttributeNS(Js.xlink,"href",r),n!=null&&s.setAttribute("target",n),this.parentNode.insertBefore(s,this).appendChild(this)}})}function et(e,t,n){n!=null&&e.attr(t,n)}function sj(e,t,n){n!=null&&e.style(t,n)}function Yt(e,t,{x:n,y:i},r=Te,s=Te){r+=t.dx,s+=t.dy,n!=null&&n.bandwidth&&(r+=n.bandwidth()/2),i!=null&&i.bandwidth&&(s+=i.bandwidth()/2),(r||s)&&e.attr("transform",`translate(${r},${s})`)}function ae(e,t){if((e=ke(e))!==t)return e}function bc(e,t){if((e=Tt(e))!==t)return e}const oj=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function B1(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!oj.test(e))throw new Error(`invalid class name: ${e}`);return e}function P1(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function Bi({frameAnchor:e},{width:t,height:n,marginTop:i,marginRight:r,marginBottom:s,marginLeft:o}){return[/left$/.test(e)?o:/right$/.test(e)?t-r:(o+t-r)/2,/^top/.test(e)?i:/^bottom/.test(e)?n-s:(i+n-s)/2]}function aj(e,t,n={}){let i=.5-Te,r=.5+Te,s=.5+Te,o=.5-Te;for(const{marginTop:y,marginRight:m,marginBottom:g,marginLeft:b}of t)y>i&&(i=y),m>r&&(r=m),g>s&&(s=g),b>o&&(o=b);let{margin:a,marginTop:c=a!==void 0?a:i,marginRight:l=a!==void 0?a:r,marginBottom:u=a!==void 0?a:s,marginLeft:h=a!==void 0?a:o}=n;c=+c,l=+l,u=+u,h=+h;let{width:f=640,height:d=cj(e,n,{width:f,marginTopDefault:i,marginRightDefault:r,marginBottomDefault:s,marginLeftDefault:o})+Math.max(0,c-i+u-s)}=n;f=+f,d=+d;const p={width:f,height:d,marginTop:c,marginRight:l,marginBottom:u,marginLeft:h};if(e.fx||e.fy){let{margin:y,marginTop:m=y!==void 0?y:c,marginRight:g=y!==void 0?y:l,marginBottom:b=y!==void 0?y:u,marginLeft:w=y!==void 0?y:h}=n.facet??{};m=+m,g=+g,b=+b,w=+w,p.facet={marginTop:m,marginRight:g,marginBottom:b,marginLeft:w}}return p}function cj({x:e,y:t,fy:n,fx:i},{projection:r,aspectRatio:s},{width:o,marginTopDefault:a,marginRightDefault:c,marginBottomDefault:l,marginLeftDefault:u}){const h=n?n.scale.domain().length:1,f=ez(r);if(f){const p=i?i.scale.domain().length:1,y=(1.1*h-.1)/(1.1*p-.1)*f,m=Math.max(.1,Math.min(10,y));return Math.round((o-u-c)*m+a+l)}const d=t?fo(t)?t.scale.domain().length:Math.max(7,17/h):1;if(s!=null){if(s=+s,!(isFinite(s)&&s>0))throw new Error(`invalid aspectRatio: ${s}`);const p=M2("y",t)/(M2("x",e)*s),y=i?i.scale.bandwidth():1,m=n?n.scale.bandwidth():1,g=y*(o-u-c)-e.insetLeft-e.insetRight;return(p*g+t.insetTop+t.insetBottom)/m+a+l}return!!(t||n)*Math.max(1,Math.min(60,d*h))*20+!!i*30+60}function M2(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:i}=t;let r;switch(n){case"linear":case"utc":case"time":r=Number;break;case"pow":{const a=t.scale.exponent();r=c=>Math.pow(c,a);break}case"log":r=Math.log;break;case"point":case"band":return i.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[s,o]=Ae(i);return Math.abs(r(o)-r(s))}function lj(e,t){const{fx:n,fy:i}=gm(e,t),r=n==null?void 0:n.scale.domain(),s=i==null?void 0:i.scale.domain();return r&&s?i5(r,s).map(([o,a],c)=>({x:o,y:a,i:c})):r?r.map((o,a)=>({x:o,i:a})):s?s.map((o,a)=>({y:o,i:a})):void 0}function uj(e,{x:t,y:n}){return t&&(t=wm(t)),n&&(n=wm(n)),e.filter(t&&n?i=>t.has(i.x)&&n.has(i.y):t?i=>t.has(i.x):i=>n.has(i.y)).sort(t&&n?(i,r)=>t.get(i.x)-t.get(r.x)||n.get(i.y)-n.get(r.y):t?(i,r)=>t.get(i.x)-t.get(r.x):(i,r)=>n.get(i.y)-n.get(r.y))}function U1(e,{fx:t,fy:n}){const i=wr(e),r=t==null?void 0:t.value,s=n==null?void 0:n.value;return t&&n?Ho(i,o=>(o.fx=r[o[0]],o.fy=s[o[0]],o),o=>r[o],o=>s[o]):t?Ho(i,o=>(o.fx=r[o[0]],o),o=>r[o]):Ho(i,o=>(o.fy=s[o[0]],o),o=>s[o])}function fj(e,t,{marginTop:n,marginLeft:i}){return e&&t?({x:r,y:s})=>`translate(${e(r)-i},${t(s)-n})`:e?({x:r})=>`translate(${e(r)-i},0)`:({y:r})=>`translate(0,${t(r)-n})`}function hj(e){const t=[],n=new Uint32Array($i(e,i=>i.length));for(const i of e){let r=0;for(const s of e)i!==s&&(n.set(s,r),r+=s.length);t.push(n.slice(0,r))}return t}const dj=new Map([["top",Dy],["right",Py],["bottom",Cy],["left",By],["top-left",Fu(Dy,By)],["top-right",Fu(Dy,Py)],["bottom-left",Fu(Cy,By)],["bottom-right",Fu(Cy,Py)],["top-empty",mj],["right-empty",wj],["bottom-empty",gj],["left-empty",bj],["empty",_j]]);function pj(e){if(e==null)return null;const t=dj.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const N2=new WeakMap;function wm(e){let t=N2.get(e);return t||N2.set(e,t=new Qs(Ht(e,(n,i)=>[n,i]))),t}function ds(e,t){return wm(e).get(t)}function yj(e,t,n){return t=Cs(t),n=Cs(n),e.find(i=>Object.is(Cs(i.x),t)&&Object.is(Cs(i.y),n))}function lp(e,t,n){var i;return(i=yj(e,t,n))==null?void 0:i.empty}function Dy(e,{y:t},{y:n}){return t?ds(t,n)===0:!0}function Cy(e,{y:t},{y:n}){return t?ds(t,n)===t.length-1:!0}function By(e,{x:t},{x:n}){return t?ds(t,n)===0:!0}function Py(e,{x:t},{x:n}){return t?ds(t,n)===t.length-1:!0}function mj(e,{y:t},{x:n,y:i,empty:r}){if(r)return!1;if(!t)return;const s=ds(t,i);if(s>0)return lp(e,n,t[s-1])}function gj(e,{y:t},{x:n,y:i,empty:r}){if(r)return!1;if(!t)return;const s=ds(t,i);if(s<t.length-1)return lp(e,n,t[s+1])}function bj(e,{x:t},{x:n,y:i,empty:r}){if(r)return!1;if(!t)return;const s=ds(t,n);if(s>0)return lp(e,t[s-1],i)}function wj(e,{x:t},{x:n,y:i,empty:r}){if(r)return!1;if(!t)return;const s=ds(t,n);if(s<t.length-1)return lp(e,t[s+1],i)}function _j(e,t,{empty:n}){return n}function Fu(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function Uy(e,{channels:{fx:t,fy:n},groups:i}){return t&&n?e.map(({x:r,y:s})=>{var o;return((o=i.get(r))==null?void 0:o.get(s))??[]}):t?e.map(({x:r})=>i.get(r)??[]):e.map(({y:r})=>i.get(r)??[])}let Vt=class{constructor(t,n={},i={},r){const{facet:s="auto",facetAnchor:o,fx:a,fy:c,sort:l,dx:u=0,dy:h=0,margin:f=0,marginTop:d=f,marginRight:p=f,marginBottom:y=f,marginLeft:m=f,clip:g,channels:b,tip:w,render:_}=i;if(this.data=t,this.sort=Qr(l)?l:null,this.initializer=sn(i).initializer,this.transform=this.initializer?i.transform:Ci(i).transform,s===null||s===!1?this.facet=null:(this.facet=Fi(s===!0?"include":s,"facet",["auto","include","exclude","super"]),this.fx=t===zc&&typeof a=="string"?[a]:a,this.fy=t===zc&&typeof c=="string"?[c]:c),this.facetAnchor=pj(o),n=y1(n),b!==void 0&&(n={...vj(b),...n}),r!==void 0&&(n={...kM(this,i,r),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([x,v])=>{if(li(v.value)){const{value:E,scale:T=v.scale}=v.value;v={...v,scale:T,value:E}}if(t===zc&&typeof v.value=="string"){const{value:E}=v;v={...v,value:[E]}}return[x,v]}).filter(([x,{value:v,optional:E}])=>{if(v!=null)return!0;if(E)return!1;throw new Error(`missing channel value: ${x}`)})),this.dx=+u,this.dy=+h,this.marginTop=+d,this.marginRight=+p,this.marginBottom=+y,this.marginLeft=+m,this.clip=ij(g),this.tip=xj(w),this.facet==="super"){if(a||c)throw new Error("super-faceting cannot use fx or fy");for(const x in this.channels){const{scale:v}=n[x];if(!(v!=="x"&&v!=="y"))throw new Error("super-faceting cannot use x or y")}}_!=null&&(this.render=RM(_,this.render))}initialize(t,n,i){let r=rn(this.data);t===void 0&&r!=null&&(t=[wr(r)]);const s=t;this.transform!=null&&({facets:t,data:r}=this.transform(r,t,i),r=rn(r)),t!==void 0&&(t.original=s);const o=rM(this.channels,r);return this.sort!=null&&WU(r,t,o,n,this.sort),{data:r,facets:t,channels:o}}filter(t,n,i){for(const r in n){const{filter:s=qe}=n[r];if(s!==null){const o=i[r];t=t.filter(a=>s(o[a]))}}return t}project(t,n,i){for(const r in t)if(t[r].scale==="x"&&/^x|x$/.test(r)){const s=r.replace(/^x|x$/,"y");s in t&&t[s].scale==="y"&&hM(r,s,n,i.projection)}}scale(t,n,i){const r=$1(t,n);return i.projection&&this.project(t,r,i),r}};function pr(...e){return e.plot=Vt.prototype.plot,e}function RM(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,i,r,s,o,a){return e.call(this,n,i,r,s,o,(c,l,u,h,f)=>t.call(this,c,l,u,h,f,a))}}function vj(e){return Object.fromEntries(Object.entries(y1(e)).map(([t,n])=>(n=Gl(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function xj(e){return e===!0?"xy":e===!1?null:Kd(e,"tip",["x","y","xy"])}function Ya(e,t){return(e==null?void 0:e.tip)===!0?{...e,tip:t}:e}const $2=new WeakMap;function z1(e,t,{x:n,y:i,px:r,py:s,maxRadius:o=40,channels:a,render:c,...l}={}){return o=+o,r!=null&&(n??(n=null),a={...a,px:{value:r,scale:"x"}}),s!=null&&(i??(i=null),a={...a,py:{value:s,scale:"y"}}),{x:n,y:i,channels:a,...l,render:RM(function(u,h,f,d,p,y){p={...p,pointerSticky:!1};const m=p.ownerSVGElement,{data:g}=p.getMarkState(this);let b=$2.get(m);b||$2.set(m,b={sticky:!1,roots:[],renders:[]});let w=b.renders.push(V)-1;const{x:_,y:x,fx:v,fy:E}=h;let T=v?v(u.fx)-d.marginLeft:0,k=E?E(u.fy)-d.marginTop:0;_!=null&&_.bandwidth&&(T+=_.bandwidth()/2),x!=null&&x.bandwidth&&(k+=x.bandwidth()/2);const A=u.fi!=null;let I;if(A){let Y=b.facetStates;Y||(b.facetStates=Y=new Map),I=Y.get(this),I||Y.set(this,I=new Map)}const[O,F]=Bi(this,d),{px:S,py:M}=f,N=S?Y=>S[Y]:FM(f,O),$=M?Y=>M[Y]:DM(f,F);let D,C,B,z;function j(Y,W){if(A)if(z&&(z=cancelAnimationFrame(z)),Y==null)I.delete(u.fi);else{I.set(u.fi,W),z=requestAnimationFrame(()=>{z=null;for(const U of I.values())if(U<W){Y=null;break}V(Y)});return}V(Y)}function V(Y){if(D===Y&&B===b.sticky)return;D=Y,B=p.pointerSticky=b.sticky;const W=D==null?[]:[D];A&&(W.fx=u.fx,W.fy=u.fy,W.fi=u.fi);const U=y(W,h,f,d,p);if(C){if(A){const G=C.parentNode,H=C.getAttribute("transform"),P=U.getAttribute("transform");H?U.setAttribute("transform",H):U.removeAttribute("transform"),P?G.setAttribute("transform",P):G.removeAttribute("transform"),U.removeAttribute("aria-label"),U.removeAttribute("aria-description"),U.removeAttribute("aria-hidden")}C.replaceWith(U)}return b.roots[w]=C=U,p.dispatchValue(D==null?null:g[D]),U}function X(Y){if(b.sticky||Y.pointerType==="mouse"&&Y.buttons===1)return;let[W,U]=Yn(Y);W-=T,U-=k;let G=null,H=o*o;for(const P of u){const Q=e*(N(P)-W),at=t*($(P)-U),Nt=Q*Q+at*at;Nt<=H&&(G=P,H=Nt)}j(G,H)}function tt(Y){Y.pointerType==="mouse"&&D!=null&&(b.sticky&&b.roots.some(W=>W==null?void 0:W.contains(Y.target))||(b.sticky?(b.sticky=!1,b.renders.forEach(W=>W(null))):(b.sticky=!0,V(D)),Y.stopImmediatePropagation()))}function Dt(Y){Y.pointerType==="mouse"&&(b.sticky||j(null))}return m.addEventListener("pointerenter",X),m.addEventListener("pointermove",X),m.addEventListener("pointerdown",tt),m.addEventListener("pointerleave",Dt),V(null)},c)}}function j1(e){return z1(1,1,e)}function q1(e){return z1(1,.01,e)}function Y1(e){return z1(.01,1,e)}function FM({x1:e,x2:t,x:n=e},i){return e&&t?r=>(e[r]+t[r])/2:n?r=>n[r]:()=>i}function DM({y1:e,y2:t,y:n=e},i){return e&&t?r=>(e[r]+t[r])/2:n?r=>n[r]:()=>i}function CM(e){return fo(e)&&e.interval===void 0?void 0:"tabular-nums"}function Sj(e,t){let{label:n=e.label,tickSize:i=6,width:r=240,height:s=44+i,marginTop:o=18,marginRight:a=0,marginBottom:c=16+i,marginLeft:l=0,style:u,ticks:h=(r-l-a)/64,tickFormat:f,fontVariant:d=CM(e),round:p=!0,opacity:y,className:m}=t;const g=sp(t);m=B1(m),y=le(y)[1],f===null&&(f=()=>null);const b=Ft("svg",g).attr("class",`${m}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",r).attr("height",s).attr("viewBox",`0 0 ${r} ${s}`).call(O=>O.append("style").text(`.${m}-ramp {
  display: block;
  background: white;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
.${m}-ramp text {
  white-space: pre;
}`)).call(P1,u);let w=O=>O.selectAll(".tick line").attr("y1",o+c-s),_;const x=p?(O,F)=>O.rangeRound(F):(O,F)=>O.range(F),{type:v,domain:E,range:T,interpolate:k,scale:A,pivot:I}=e;if(k){const O=T===void 0?k:Td(k.length===1?L1(k):k,T);_=x(A.copy(),Xn($e(l,r-a),Math.min(E.length+(I!==void 0),T===void 0?1/0:T.length)));const F=256,S=g.document.createElement("canvas");S.width=F,S.height=1;const M=S.getContext("2d");for(let N=0,$=F-1;N<F;++N)M.fillStyle=O(N/$),M.fillRect(N,0,1,1);b.append("image").attr("opacity",y).attr("x",l).attr("y",o).attr("width",r-l-a).attr("height",s-o-c).attr("preserveAspectRatio","none").attr("xlink:href",S.toDataURL())}else if(v==="threshold"){const O=E,F=f===void 0?S=>S:typeof f=="string"?Ul(f):f;_=x(Rd().domain([-1,T.length-1]),[l,r-a]),b.append("g").attr("fill-opacity",y).selectAll().data(T).enter().append("rect").attr("x",(S,M)=>_(M-1)).attr("y",o).attr("width",(S,M)=>_(M)-_(M-1)).attr("height",s-o-c).attr("fill",S=>S),h=Ht(O,(S,M)=>M),f=S=>F(O[S],S)}else _=x(Od().domain(E),[l,r-a]),b.append("g").attr("fill-opacity",y).selectAll().data(E).enter().append("rect").attr("x",_).attr("y",o).attr("width",Math.max(0,_.bandwidth()-1)).attr("height",s-o-c).attr("fill",A),w=()=>{};return b.append("g").attr("transform",`translate(0,${s-c})`).call(A5(_).ticks(Array.isArray(h)?null:h,typeof f=="string"?f:void 0).tickFormat(typeof f=="function"?f:void 0).tickSize(i).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",ae(d,"normal")).call(w).call(O=>O.select(".domain").remove()),n!==void 0&&b.append("text").attr("x",l).attr("y",o-6).attr("fill","currentColor").attr("font-weight","bold").text(n),b.node()}const Vh=Math.PI/180;function Va(e,{marker:t,markerStart:n=t,markerMid:i=t,markerEnd:r=t}={}){e.markerStart=zy(n),e.markerMid=zy(i),e.markerEnd=zy(r)}function zy(e){if(e==null||e===!1)return null;if(e===!0)return O2;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return k2("auto");case"arrow-reverse":return k2("auto-start-reverse");case"dot":return Ej;case"circle":case"circle-fill":return O2;case"circle-stroke":return Aj}throw new Error(`invalid marker: ${e}`)}function k2(e){return(t,n)=>Ft("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(i=>i.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function Ej(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function O2(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","white").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Aj(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}let Tj=0;function Jl(e,t,{stroke:n},i){return BM(e,t,n&&(r=>n[r]),i)}function Ij(e,t,{stroke:n},i){return BM(e,t,n&&(([r])=>n[r]),i)}function BM(e,{markerStart:t,markerMid:n,markerEnd:i,stroke:r},s=()=>r,o){const a=new Map;function c(l){return function(u){const h=s(u);let f=a.get(l);f||a.set(l,f=new Map);let d=f.get(h);if(!d){const p=this.parentNode.insertBefore(l(h,o),this),y=`plot-marker-${++Tj}`;p.setAttribute("id",y),f.set(h,d=`url(#${y})`)}return d}}t&&e.attr("marker-start",c(t)),n&&e.attr("marker-mid",c(n)),i&&e.attr("marker-end",c(i))}function Zl({inset:e,insetLeft:t,insetRight:n,...i}={}){return[t,n]=PM(e,t,n),{inset:e,insetLeft:t,insetRight:n,...i}}function tu({inset:e,insetTop:t,insetBottom:n,...i}={}){return[t,n]=PM(e,t,n),{inset:e,insetTop:t,insetBottom:n,...i}}function PM(e,t,n){return e===void 0&&t===void 0&&n===void 0?Te?[1,0]:[.5,.5]:[t,n]}function UM(e,{interval:t}){return e={...Gl(e)},e.interval=p1(e.interval===void 0?t:e.interval),e}function up(e,t,n,i){const{[e]:r,[`${e}1`]:s,[`${e}2`]:o}=n,{value:a,interval:c}=UM(r,n);if(a==null||c==null&&!i)return n;const l=_r(r);if(c==null){let d;const p={transform:y=>d||(d=Et(y,a)),label:l};return{...n,[e]:void 0,[`${e}1`]:s===void 0?p:s,[`${e}2`]:o===void 0?p:o}}let u,h;function f(d){return h!==void 0&&d===u?h:h=Ht(Et(u=d,a),p=>c.floor(p))}return t({...n,[e]:void 0,[`${e}1`]:s===void 0?{transform:f,label:l}:s,[`${e}2`]:o===void 0?{transform:d=>f(d).map(p=>c.offset(p)),label:l}:o})}function zM(e,t,n){const{[e]:i}=n,{value:r,interval:s}=UM(i,n);return r==null||s==null?n:t({...n,[e]:{label:_r(i),transform:o=>{const a=Ht(Et(o,r),l=>s.floor(l)),c=a.map(l=>s.offset(l));return a.map(Pn(a)?(l,u)=>l==null||isNaN(l=+l)||(u=c[u],u==null)||isNaN(u=+u)?void 0:new Date((l+u)/2):(l,u)=>l==null||(u=c[u],u==null)?NaN:(+l+ +u)/2)}}})}function jM(e={}){return up("x",Zl,e,!0)}function qM(e={}){return up("y",tu,e,!0)}function YM(e={}){return up("x",Zl,e)}function VM(e={}){return up("y",tu,e)}function WM(e={}){return zM("x",Zl,e)}function GM(e={}){return zM("y",tu,e)}const HM={ariaLabel:"rule",fill:null,stroke:"currentColor"};class XM extends Vt{constructor(t,n={}){const{x:i,y1:r,y2:s,inset:o=0,insetTop:a=o,insetBottom:c=o}=n;super(t,{x:{value:i,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:s,scale:"y",optional:!0}},Ya(n,"x"),HM),this.insetTop=Tt(a),this.insetBottom=Tt(c),Va(this,n)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y1:l,y2:u}=i,{width:h,height:f,marginTop:d,marginRight:p,marginLeft:y,marginBottom:m}=r,{insetTop:g,insetBottom:b}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o},Te,0).call(w=>w.selectAll().data(t).enter().append("line").call(Qt,this).attr("x1",c?_=>c[_]:(y+h-p)/2).attr("x2",c?_=>c[_]:(y+h-p)/2).attr("y1",l&&!On(a)?_=>l[_]+g:d+g).attr("y2",u&&!On(a)?a.bandwidth?_=>u[_]+a.bandwidth()-b:_=>u[_]-b:f-m-b).call(ge,this,i).call(Jl,this,i,s)).node()}}class KM extends Vt{constructor(t,n={}){const{x1:i,x2:r,y:s,inset:o=0,insetRight:a=o,insetLeft:c=o}=n;super(t,{y:{value:s,scale:"y",optional:!0},x1:{value:i,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},Ya(n,"y"),HM),this.insetRight=Tt(a),this.insetLeft=Tt(c),Va(this,n)}render(t,n,i,r,s){const{x:o,y:a}=n,{y:c,x1:l,x2:u}=i,{width:h,height:f,marginTop:d,marginRight:p,marginLeft:y,marginBottom:m}=r,{insetLeft:g,insetRight:b}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{y:c&&a},0,Te).call(w=>w.selectAll().data(t).enter().append("line").call(Qt,this).attr("x1",l&&!On(o)?_=>l[_]+g:y+g).attr("x2",u&&!On(o)?o.bandwidth?_=>u[_]+o.bandwidth()-b:_=>u[_]-b:h-p-b).attr("y1",c?_=>c[_]:(d+f-m)/2).attr("y2",c?_=>c[_]:(d+f-m)/2).call(ge,this,i).call(Jl,this,i,s)).node()}}function Jr(e,t){let{x:n=ot,y:i,y1:r,y2:s,...o}=VM(t);return[r,s]=QM(i,r,s),new XM(e,{...o,x:n,y1:r,y2:s})}function Zr(e,t){let{y:n=ot,x:i,x1:r,x2:s,...o}=YM(t);return[r,s]=QM(i,r,s),new KM(e,{...o,y:n,x1:r,x2:s})}function QM(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function fp(e,...t){let n=t.length;for(let i=0,r=!0;i<n;++i)typeof t[i]!="function"&&(r&&(e=e.slice(),r=!1),e.splice(i,2,e[i]+t[i]+e[i+1]),t.splice(i,1),--i,--n);return i=>{let r=e[0];for(let s=0;s<n;++s)r+=t[s](i)+e[s+1];return r}}const Mj={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},JM="­";class hp extends Vt{constructor(t,n={}){const{x:i,y:r,text:s=Di(t)&&KI(t)?ot:an,frameAnchor:o,textAnchor:a=/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle",lineAnchor:c=/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle",lineHeight:l=1,lineWidth:u=1/0,textOverflow:h,monospace:f,fontFamily:d=f?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:y,fontVariant:m,fontWeight:g,rotate:b}=n,[w,_]=le(b,0),[x,v]=Oj(p);if(super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:x,optional:!0},rotate:{value:xU(w),optional:!0},text:{value:s,filter:c1,optional:!0}},n,Mj),this.rotate=_,this.textAnchor=ae(a,"middle"),this.lineAnchor=Fi(c,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+u,this.textOverflow=ZM(h),this.monospace=!!f,this.fontFamily=ke(d),this.fontSize=v,this.fontStyle=ke(y),this.fontVariant=ke(m),this.fontWeight=ke(g),this.frameAnchor=Xl(o),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=i3(this),this.clipLine=r3(this)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,rotate:u,text:h,title:f,fontSize:d}=i,{rotate:p}=this,[y,m]=Bi(this,r);return Ft("svg:g",s).call(Zt,this,r,s).call(n3,this,h,r).call(Yt,this,{x:c&&o,y:l&&a}).call(g=>g.selectAll().data(t).enter().append("text").call(Qt,this).call(Nj,this,h,f).attr("transform",fp`translate(${c?b=>c[b]:y},${l?b=>l[b]:m})${u?b=>` rotate(${u[b]})`:p?` rotate(${p})`:""}`).call(et,"font-size",d&&(b=>d[b])).call(ge,this,i)).node()}}function ZM(e){return e==null?null:Fi(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function Nj(e,t,n,i){if(!n)return;const{lineAnchor:r,lineHeight:s,textOverflow:o,splitLines:a,clipLine:c}=t;e.each(function(l){const u=a(lr(n[l])??"").map(c),h=u.length,f=r==="top"?.71:r==="bottom"?1-h:(164-h*100)/200;if(h>1){let d=0;for(let p=0;p<h;++p){if(++d,!u[p])continue;const y=this.ownerDocument.createElementNS(Js.svg,"tspan");y.setAttribute("x",0),p===d-1?y.setAttribute("y",`${(f+p)*s}em`):y.setAttribute("dy",`${d*s}em`),y.textContent=u[p],this.appendChild(y),d=0}}else f&&this.setAttribute("y",`${f*s}em`),this.textContent=u[0];if(o&&!i&&u[0]!==n[l]){const d=this.ownerDocument.createElementNS(Js.svg,"title");d.textContent=n[l],this.appendChild(d)}})}function $a(e,{x:t,y:n,...i}={}){return i.frameAnchor===void 0&&([t,n]=ii(t,n)),new hp(e,{...i,x:t,y:n})}function t3(e,{x:t=ot,...n}={}){return new hp(e,GM({...n,x:t}))}function e3(e,{y:t=ot,...n}={}){return new hp(e,WM({...n,y:t}))}function n3(e,t,n){et(e,"text-anchor",t.textAnchor),et(e,"font-family",t.fontFamily),et(e,"font-size",t.fontSize),et(e,"font-style",t.fontStyle),et(e,"font-variant",t.fontVariant===void 0?$j(n):t.fontVariant),et(e,"font-weight",t.fontWeight)}function $j(e){return e&&(QI(e)||Pn(e))?"tabular-nums":void 0}const kj=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Oj(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),kj.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function Lj(e,t,n){const i=[];let r,s=0;for(const[o,a,c]of Rj(e)){if(r===void 0&&(r=o),s>r&&n(e,r,a)>t&&(i.push(e.slice(r,s)+(e[s-1]===JM?"-":"")),r=o),c){i.push(e.slice(r,a)),r=void 0;continue}s=a}return i}function*Rj(e){let t=0,n=0;const i=e.length;for(;n<i;){let r=1;switch(e[n]){case JM:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++r;case`
`:yield[t,n,!0],n+=r,t=n;break;default:++n;break}}yield[t,n,!0]}const L2={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function V1(e,t=0,n=e.length){let i=0;for(let r=t;r<n;r=Wa(e,r))i+=L2[e[r]]??(o3(e,r)?120:L2.e);return i}function W1(e,t=0,n=e.length){let i=0;for(let r=t;r<n;r=Wa(e,r))i+=o3(e,r)?200:100;return i}function i3({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return s=>s.split(/\r\n?|\n/g);const i=e?W1:V1,r=t*100;return s=>Lj(s,r,i)}function r3({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return s=>s;const i=e?W1:V1,r=t*100;switch(n){case"clip-start":return s=>F2(s,r,i,"");case"clip-end":return s=>R2(s,r,i,"");case"ellipsis-start":return s=>F2(s,r,i,Zo);case"ellipsis-middle":return s=>Fj(s,r,i,Zo);case"ellipsis-end":return s=>R2(s,r,i,Zo)}}const Zo="…";function ka(e,t,n,i){const r=[];let s=0;for(let o=0,a=0,c=e.length;o<c;o=a){a=Wa(e,o);const l=n(e,o,a);if(s+l>t){for(s+=i;s>t&&o>0;)a=o,o=r.pop(),s-=n(e,o,a);return[o,t-s]}s+=l,r.push(o)}return[-1,0]}function R2(e,t,n,i){e=e.trim();const r=n(i),[s]=ka(e,t,n,r);return s<0?e:e.slice(0,s).trimEnd()+i}function Fj(e,t,n,i){e=e.trim();const r=n(e);if(r<=t)return e;const s=n(i)/2,[o,a]=ka(e,t/2,n,s),[c]=ka(e,r-t/2-a+s,n,-s);return c<0?i:e.slice(0,o).trimEnd()+i+e.slice(Wa(e,c)).trimStart()}function F2(e,t,n,i){e=e.trim();const r=n(e);if(r<=t)return e;const s=n(i),[o]=ka(e,r-t+s,n,-s);return o<0?i:i+e.slice(Wa(e,o)).trimStart()}const _m=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,D2=/\p{Extended_Pictographic}/uy;function Wa(e,t){return t+=Dj(e,t)?2:1,Bj(e,t)&&(t=_m.lastIndex),Cj(e,t)?Wa(e,t+1):t}function s3(e,t){return e.charCodeAt(t)<128}function Dj(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const i=e.charCodeAt(t+1);return i>=56320&&i<57344}return!1}function Cj(e,t){return e.charCodeAt(t)===8205}function Bj(e,t){return s3(e,t)?!1:(_m.lastIndex=t,_m.test(e))}function o3(e,t){return s3(e,t)?!1:(D2.lastIndex=t,D2.test(e))}const a3={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},c3=3.5,Pj=c3*5,l3={draw(e,t,n){const i=t*n/Pj;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-i,i-t),e.lineTo(0,-t),e.lineTo(i,i-t)}},u3={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},Uj=new Map([["arrow",l3],["spike",u3]]);function zj(e){return e&&typeof e.draw=="function"}function jj(e){if(zj(e))return e;const t=Uj.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class dp extends Vt{constructor(t,n={}){const{x:i,y:r,r:s=c3,length:o,rotate:a,shape:c=l3,anchor:l="middle",frameAnchor:u}=n,[h,f]=le(o,12),[d,p]=le(a,0);super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:h,scale:"length",optional:!0},rotate:{value:d,optional:!0}},n,a3),this.r=+s,this.length=f,this.rotate=p,this.shape=jj(c),this.anchor=Fi(l,"anchor",["start","middle","end"]),this.frameAnchor=Xl(u)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,length:u,rotate:h}=i,{length:f,rotate:d,anchor:p,shape:y,r:m}=this,[g,b]=Bi(this,r);return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(w=>w.selectAll().data(t).enter().append("path").call(Qt,this).attr("transform",fp`translate(${c?_=>c[_]:g},${l?_=>l[_]:b})${h?_=>` rotate(${h[_]})`:d?` rotate(${d})`:""}${p==="start"?"":p==="end"?u?_=>` translate(0,${u[_]})`:` translate(0,${f})`:u?_=>` translate(0,${u[_]/2})`:` translate(0,${f/2})`}`).attr("d",u?_=>{const x=tr();return y.draw(x,u[_],m),x}:(()=>{const _=tr();return y.draw(_,f,m),_})()).call(ge,this,i)).node()}}function f3(e,t={}){let{x:n,y:i,...r}=t;return t.frameAnchor===void 0&&([n,i]=ii(n,i)),new dp(e,{...r,x:n,y:i})}function h3(e,t={}){const{x:n=ot,...i}=t;return new dp(e,{...i,x:n})}function d3(e,t={}){const{y:n=ot,...i}=t;return new dp(e,{...i,y:n})}function qj(e,t={}){const{shape:n=u3,stroke:i=a3.stroke,strokeWidth:r=1,fill:s=i,fillOpacity:o=.3,anchor:a="start",...c}=t;return f3(e,{...c,shape:n,stroke:i,strokeWidth:r,fill:s,fillOpacity:o,anchor:a})}function ps(e,t){return arguments.length<2&&!Di(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function pp({anchor:e}={},t){return e===void 0?t[0]:Fi(e,"anchor",t)}function p3(e){return pp(e,["left","right"])}function y3(e){return pp(e,["right","left"])}function m3(e){return pp(e,["bottom","top"])}function g3(e){return pp(e,["top","bottom"])}function G1(){const[e,t]=ps(...arguments);return _3("y",p3(t),e,t)}function b3(){const[e,t]=ps(...arguments);return _3("fy",y3(t),e,t)}function H1(){const[e,t]=ps(...arguments);return v3("x",m3(t),e,t)}function w3(){const[e,t]=ps(...arguments);return v3("fx",g3(t),e,t)}function _3(e,t,n,{color:i="currentColor",opacity:r=1,stroke:s=i,strokeOpacity:o=r,strokeWidth:a=1,fill:c=i,fillOpacity:l=r,textAnchor:u,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:p=e==="y"?6:0,tickPadding:y,tickRotate:m,x:g,margin:b,marginTop:w=b===void 0?20:b,marginRight:_=b===void 0?t==="right"?40:0:b,marginBottom:x=b===void 0?20:b,marginLeft:v=b===void 0?t==="left"?40:0:b,label:E,labelAnchor:T,labelArrow:k,labelOffset:A,...I}){return p=Tt(p),y=Tt(y),m=Tt(m),T!==void 0&&(T=Fi(T,"labelAnchor",["center","top","bottom"])),k=L3(k),pr(p&&!_e(s)?Yj(e,t,n,{stroke:s,strokeOpacity:o,strokeWidth:a,tickSize:p,tickPadding:y,tickRotate:m,x:g,...I}):null,_e(c)?null:Wj(e,t,n,{fill:c,fillOpacity:l,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:y,tickRotate:m,x:g,marginTop:w,marginRight:_,marginBottom:x,marginLeft:v,...I}),!_e(c)&&E!==null?$a([],N3({fill:c,fillOpacity:l,...I},function(O,F,S,M,N){const $=M[e],{marginTop:D,marginRight:C,marginBottom:B,marginLeft:z}=e==="y"&&N.inset||N,j=T??($.bandwidth?"center":"top"),V=A??(t==="right"?C:z)-3;return j==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=j,this.frameAnchor=`${j}-${t}`,this.rotate=0),this.dy=j==="top"?3-D:j==="bottom"?B-3:0,this.dx=t==="right"?V:-V,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[O3(e,$,{anchor:t,label:E,labelAnchor:j,labelArrow:k})]}}}})):null)}function v3(e,t,n,{color:i="currentColor",opacity:r=1,stroke:s=i,strokeOpacity:o=r,strokeWidth:a=1,fill:c=i,fillOpacity:l=r,textAnchor:u,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:p=e==="x"?6:0,tickPadding:y,tickRotate:m,y:g,margin:b,marginTop:w=b===void 0?t==="top"?30:0:b,marginRight:_=b===void 0?20:b,marginBottom:x=b===void 0?t==="bottom"?30:0:b,marginLeft:v=b===void 0?20:b,label:E,labelAnchor:T,labelArrow:k,labelOffset:A,...I}){return p=Tt(p),y=Tt(y),m=Tt(m),T!==void 0&&(T=Fi(T,"labelAnchor",["center","left","right"])),k=L3(k),pr(p&&!_e(s)?Vj(e,t,n,{stroke:s,strokeOpacity:o,strokeWidth:a,tickSize:p,tickPadding:y,tickRotate:m,y:g,...I}):null,_e(c)?null:Gj(e,t,n,{fill:c,fillOpacity:l,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:y,tickRotate:m,y:g,marginTop:w,marginRight:_,marginBottom:x,marginLeft:v,...I}),!_e(c)&&E!==null?$a([],N3({fill:c,fillOpacity:l,...I},function(O,F,S,M,N){const $=M[e],{marginTop:D,marginRight:C,marginBottom:B,marginLeft:z}=e==="x"&&N.inset||N,j=T??($.bandwidth?"center":"right"),V=A??(t==="top"?D:B)-3;return j==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${j}`,this.textAnchor=j==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-V:V,this.dx=j==="right"?C-3:j==="left"?3-z:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[O3(e,$,{anchor:t,label:E,labelAnchor:j,labelArrow:k})]}}}})):null)}function Yj(e,t,n,{strokeWidth:i=1,strokeLinecap:r=null,strokeLinejoin:s=null,facetAnchor:o=t+(e==="y"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:l=0,insetLeft:u=l,insetRight:h=l,dx:f=0,y:d=e==="y"?void 0:null,...p}){return Ga(d3,e,`${e}-axis tick`,n,{strokeWidth:i,strokeLinecap:r,strokeLinejoin:s,facetAnchor:o,frameAnchor:a,y:d,...p,dx:t==="left"?+f-Te+ +u:+f+Te-h,anchor:"start",length:c,shape:t==="left"?Kj:Qj})}function Vj(e,t,n,{strokeWidth:i=1,strokeLinecap:r=null,strokeLinejoin:s=null,facetAnchor:o=t+(e==="x"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:l=0,insetTop:u=l,insetBottom:h=l,dy:f=0,x:d=e==="x"?void 0:null,...p}){return Ga(h3,e,`${e}-axis tick`,n,{strokeWidth:i,strokeLinejoin:s,strokeLinecap:r,facetAnchor:o,frameAnchor:a,x:d,...p,dy:t==="bottom"?+f-Te-h:+f+Te+ +u,anchor:"start",length:c,shape:t==="bottom"?Hj:Xj})}function Wj(e,t,n,{facetAnchor:i=t+(e==="y"?"-empty":""),frameAnchor:r=t,tickSize:s,tickRotate:o=0,tickPadding:a=Math.max(3,9-s)+(Math.abs(o)>60?4*Math.cos(o*Vh):0),tickFormat:c,text:l=typeof c=="function"?c:void 0,textAnchor:u=Math.abs(o)>60?"middle":t==="left"?"end":"start",lineAnchor:h=o>60?"top":o<-60?"bottom":"middle",fontVariant:f,inset:d=0,insetLeft:p=d,insetRight:y=d,dx:m=0,y:g=e==="y"?void 0:null,...b}){return Ga(e3,e,`${e}-axis tick label`,n,{facetAnchor:i,frameAnchor:r,text:l===void 0?null:l,textAnchor:u,lineAnchor:h,fontVariant:f,rotate:o,y:g,...b,dx:t==="left"?+m-s-a+ +p:+m+ +s+ +a-y},function(w,_,x,v){f===void 0&&(this.fontVariant=k3(w)),l===void 0&&(v.text=$3(w,_,x,c,t))})}function Gj(e,t,n,{facetAnchor:i=t+(e==="x"?"-empty":""),frameAnchor:r=t,tickSize:s,tickRotate:o=0,tickPadding:a=Math.max(3,9-s)+(Math.abs(o)>=10?4*Math.cos(o*Vh):0),tickFormat:c,text:l=typeof c=="function"?c:void 0,textAnchor:u=Math.abs(o)>=10?o<0^t==="bottom"?"start":"end":"middle",lineAnchor:h=Math.abs(o)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:f,inset:d=0,insetTop:p=d,insetBottom:y=d,dy:m=0,x:g=e==="x"?void 0:null,...b}){return Ga(t3,e,`${e}-axis tick label`,n,{facetAnchor:i,frameAnchor:r,text:l===void 0?null:l,textAnchor:u,lineAnchor:h,fontVariant:f,rotate:o,x:g,...b,dy:t==="bottom"?+m+ +s+ +a-y:+m-s-a+ +p},function(w,_,x,v){f===void 0&&(this.fontVariant=k3(w)),l===void 0&&(v.text=$3(w,_,x,c,t))})}function x3(){const[e,t]=ps(...arguments);return T3("y",p3(t),e,t)}function S3(){const[e,t]=ps(...arguments);return T3("fy",y3(t),e,t)}function E3(){const[e,t]=ps(...arguments);return I3("x",m3(t),e,t)}function A3(){const[e,t]=ps(...arguments);return I3("fx",g3(t),e,t)}function T3(e,t,n,{y:i=e==="y"?void 0:null,x:r=null,x1:s=t==="left"?r:null,x2:o=t==="right"?r:null,...a}){return Ga(Zr,e,`${e}-grid`,n,{y:i,x1:s,x2:o,...M3(a)})}function I3(e,t,n,{x:i=e==="x"?void 0:null,y:r=null,y1:s=t==="top"?r:null,y2:o=t==="bottom"?r:null,...a}){return Ga(Jr,e,`${e}-grid`,n,{x:i,y1:s,y2:o,...M3(a)})}function M3({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:i=t,strokeWidth:r=1,...s}){return{stroke:n,strokeOpacity:i,strokeWidth:r,...s}}function N3({fill:e,fillOpacity:t,fontFamily:n,fontSize:i,fontStyle:r,fontWeight:s,monospace:o,pointerEvents:a,shapeRendering:c},l){return[,e]=nn(e),[,t]=le(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:i,fontStyle:r,fontWeight:s,monospace:o,pointerEvents:a,shapeRendering:c,initializer:l}}function Ga(e,t,n,i,r,s){let o;function a(u,h,f,d,p,y){const m=u==null&&(t==="fx"||t==="fy"),{[t]:g}=d;if(!g)throw new Error(`missing scale: ${t}`);let{ticks:b,tickSpacing:w,interval:_}=r;if(F1(g)&&typeof b=="string"&&(_=b,b=void 0),u==null){if(Di(b))u=rn(b);else if(g.ticks)if(b!==void 0)u=g.ticks(b);else if(_=qa(_===void 0?g.interval:_,g.type),_!==void 0){const[v,E]=Ae(g.domain());u=_.range(v,_.offset(_.floor(E)))}else{const[v,E]=Ae(g.range());b=(E-v)/(w===void 0?t==="x"?80:35:w),u=g.ticks(b)}else u=g.domain();t==="y"||t==="x"?h=[wr(u)]:o[t]={scale:t,value:ot}}s==null||s.call(this,g,u,b,o);const x=Object.fromEntries(Object.entries(o).map(([v,E])=>[v,{...E,value:Et(u,E.value)}]));return m&&(h=y.filterFacets(u,x)),{data:u,facets:h,channels:x}}const c=sn(r).initializer,l=e(i,sn({...r,initializer:a},c));return i==null?(o=l.channels,l.channels={}):o={},l.ariaLabel=n,l}function $3(e,t,n,i,r){return{value:Wh(e,t,n,i,r)}}function Wh(e,t,n,i,r){return i===void 0&&F1(e)?pU(e,t,n,r):e.tickFormat?e.tickFormat(Di(n)?null:n,i):i===void 0?hU(e.interval)?hl("%Y"):dU(e.interval)?jd("%Y"):lr:typeof i=="string"?(Pn(e.domain())?hl:Ul)(i):Bn(i)}const Hj={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},Xj={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},Kj={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},Qj={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function k3(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function Jj(e){return Math.sign(Na(e.domain()))*Math.sign(Na(e.range()))}function O3(e,t,{anchor:n,label:i=t.label,labelAnchor:r,labelArrow:s}={}){if(!(i==null||i.inferred&&Zj(t)&&/^(date|time|year)$/i.test(i))){if(i=String(i),s==="auto"&&(s=(!t.bandwidth||t.interval)&&!/[↑↓→←]/.test(i)),!s)return i;if(s===!0){const o=Jj(t);o&&(s=/x$/.test(e)||r==="center"?/x$/.test(e)===o<0?"left":"right":o<0?"up":"down")}switch(s){case"left":return`← ${i}`;case"right":return`${i} →`;case"up":return n==="right"?`${i} ↑`:`↑ ${i}`;case"down":return n==="right"?`${i} ↓`:`↓ ${i}`}return i}}function L3(e="auto"){return _e(e)?!1:typeof e=="boolean"?e:Fi(e,"labelArrow",["auto","up","right","down","left"])}function Zj(e){return F1(e)||e.interval!=null}function C2(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function tq(e,{opacity:t,...n}={}){if(!fo(e)&&!MM(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return R3(e,n,(i,r,s,o)=>i.append("svg").attr("width",s).attr("height",o).attr("fill",r.scale).attr("fill-opacity",le(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function eq(e,{fill:t=(l=>(l=e.hint)==null?void 0:l.fill)()!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:i=(u=>(u=e.hint)==null?void 0:u.stroke)()!==void 0?e.hint.stroke:_e(t)?"currentColor":"none",strokeOpacity:r=1,strokeWidth:s=1.5,r:o=4.5,...a}={},c){const[h,f]=nn(t),[d,p]=nn(i),y=C2(c,h),m=C2(c,d),g=o*o*Math.PI;return n=le(n)[1],r=le(r)[1],s=le(s)[1],R3(e,a,(b,w,_,x)=>b.append("svg").attr("viewBox","-8 -8 16 16").attr("width",_).attr("height",x).attr("fill",h==="color"?v=>y.scale(v):f).attr("fill-opacity",n).attr("stroke",d==="color"?v=>m.scale(v):p).attr("stroke-opacity",r).attr("stroke-width",s).append("path").attr("d",v=>{const E=tr();return e.scale(v).draw(E,g),E}))}function R3(e,t={},n){let{columns:i,tickFormat:r,fontVariant:s=CM(e),swatchSize:o=15,swatchWidth:a=o,swatchHeight:c=o,marginLeft:l=0,className:u,style:h,width:f}=t;const d=sp(t);u=B1(u),typeof r!="function"&&(r=Wh(e.scale,e.domain,void 0,r));const p=Ft("div",d).attr("class",`${u}-swatches ${u}-swatches-${i!=null?"columns":"wrap"}`);let y;return i!=null?(y=`.${u}-swatches-columns .${u}-swatch {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
.${u}-swatches-columns .${u}-swatch::before {
  flex-shrink: 0;
}
.${u}-swatches-columns .${u}-swatch-label {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",i).selectAll().data(e.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,e,a,c).call(m=>m.append("div").attr("class",`${u}-swatch-label`).attr("title",r).text(r))):(y=`.${u}-swatches-wrap {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
.${u}-swatches-wrap .${u}-swatch {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(e.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,e,a,c).append(function(){return this.ownerDocument.createTextNode(r.apply(this,arguments))})),p.call(m=>m.insert("style","*").text(`.${u}-swatches {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
.${u}-swatch > svg {
  margin-right: 0.5em;
  overflow: visible;
}
${y}`)).style("margin-left",l?`${+l}px`:null).style("width",f===void 0?null:`${+f}px`).style("font-variant",ae(s,"normal")).call(P1,h).node()}const Gh=new Map([["symbol",eq],["color",F3],["opacity",rq]]);function nq(e={}){for(const[t,n]of Gh){const i=e[t];if(Vs(i)){const r=sp(e);let s;if(t==="symbol"){const{fill:o,stroke:a=o===void 0&&Vs(e.color)?"color":void 0}=e;s={fill:o,stroke:a}}return n(bm(t,i,s),X1(r,i,e),o=>Vs(e[o])?bm(o,e[o]):null)}}throw new Error("unknown legend type; no scale found")}function iq(e,t,n={}){return(i,r)=>{if(!Gh.has(i))throw new Error(`unknown legend type: ${i}`);if(i in e)return Gh.get(i)(e[i],X1(t,n[i],r),s=>e[s])}}function X1({className:e,...t},{label:n,ticks:i,tickFormat:r}={},s){return MU(s,{className:e,...t},{label:n,ticks:i,tickFormat:r})}function F3(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return tq(e,n);case"ramp":return Sj(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function rq({type:e,interpolate:t,...n},{legend:i=!0,color:r=Dn(0,0,0),...s}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(i===!0&&(i="ramp"),`${i}`.toLowerCase()!=="ramp")throw new Error(`${i} opacity legends are not supported`);return F3({type:e,...n,interpolate:sq(r)},{legend:i,...s})}function sq(e){const{r:t,g:n,b:i}=Dn(e)||Dn(0,0,0);return r=>`rgba(${t},${n},${i},${r})`}function oq(e,t,n){const i=[];for(const[r,s]of Gh){const o=n[r];if(o!=null&&o.legend&&r in e){const a=s(e[r],X1(t,e[r],o),c=>e[c]);a!=null&&i.push(a)}}return i}const aq={ariaLabel:"frame",fill:"none",stroke:"currentColor"},cq={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class D3 extends Vt{constructor(t={}){const{anchor:n=null,inset:i=0,insetTop:r=i,insetRight:s=i,insetBottom:o=i,insetLeft:a=i,rx:c,ry:l}=t;super(zc,void 0,t,n==null?aq:cq),this.anchor=Kd(n,"anchor",["top","right","bottom","left"]),this.insetTop=Tt(r),this.insetRight=Tt(s),this.insetBottom=Tt(o),this.insetLeft=Tt(a),this.rx=Tt(c),this.ry=Tt(l)}render(t,n,i,r,s){const{marginTop:o,marginRight:a,marginBottom:c,marginLeft:l,width:u,height:h}=r,{anchor:f,insetTop:d,insetRight:p,insetBottom:y,insetLeft:m,rx:g,ry:b}=this,w=l+m,_=u-a-p,x=o+d,v=h-c-y;return Ft(f?"svg:line":"svg:rect",s).datum(0).call(Zt,this,r,s).call(Qt,this).call(ge,this,i).call(Yt,this,{}).call(f==="left"?E=>E.attr("x1",w).attr("x2",w).attr("y1",x).attr("y2",v):f==="right"?E=>E.attr("x1",_).attr("x2",_).attr("y1",x).attr("y2",v):f==="top"?E=>E.attr("x1",w).attr("x2",_).attr("y1",x).attr("y2",x):f==="bottom"?E=>E.attr("x1",w).attr("x2",_).attr("y1",v).attr("y2",v):E=>E.attr("x",w).attr("y",x).attr("width",_-w).attr("height",v-x).attr("rx",g).attr("ry",b)).node()}}function K1(e){return new D3(e)}const jy={ariaLabel:"tip",fill:"white",stroke:"currentColor"},lq=new Set(["geometry","href","src","ariaLabel"]);class C3 extends Vt{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Di(t)&&KI(t)&&(n={...n,title:ot});const{x:i,y:r,x1:s,x2:o,y1:a,y2:c,anchor:l,monospace:u,fontFamily:h=u?"ui-monospace, monospace":void 0,fontSize:f,fontStyle:d,fontVariant:p,fontWeight:y,lineHeight:m=1,lineWidth:g=20,frameAnchor:b,textAnchor:w="start",textOverflow:_,textPadding:x=8,title:v,pointerSize:E=12,pathFilter:T="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:s!=null&&o!=null?null:i,scale:"x",optional:!0},y:{value:a!=null&&c!=null?null:r,scale:"y",optional:!0},x1:{value:s,scale:"x",optional:o==null},y1:{value:a,scale:"y",optional:c==null},x2:{value:o,scale:"x",optional:s==null},y2:{value:c,scale:"y",optional:a==null},title:{value:v,optional:!0}},n,jy),this.anchor=JI(l,"anchor"),this.previousAnchor=this.anchor??"top-left",this.frameAnchor=Xl(b),this.textAnchor=ae(w,"middle"),this.textPadding=+x,this.pointerSize=+E,this.pathFilter=ke(T),this.lineHeight=+m,this.lineWidth=+g,this.textOverflow=ZM(_),this.monospace=!!u,this.fontFamily=ke(h),this.fontSize=Tt(f),this.fontStyle=ke(d),this.fontVariant=ke(p),this.fontWeight=ke(y);for(const k in jy)k in this.channels&&(this[k]=jy[k]);this.splitLines=i3(this),this.clipLine=r3(this)}render(t,n,i,r,s){const o=this,{x:a,y:c,fx:l,fy:u}=n,{ownerSVGElement:h,document:f}=s,{anchor:d,monospace:p,lineHeight:y,lineWidth:m}=this,{textPadding:g,pointerSize:b,pathFilter:w}=this,{marginTop:_,marginLeft:x}=r,v=dq(i),{x1:E,y1:T,x2:k,y2:A,x:I=E??k,y:O=T??A}=i,F=l?l(t.fx)-x:0,S=u?u(t.fy)-_:0,[M,N]=Bi(this,r),$=FM(i,M),D=DM(i,N),C=p?W1:V1,B=C(Zo),z=l&&Wh(l),j=u&&Wh(u);function*V(Y,W){if("title"in Y){const U=Y.title.value[W];for(const G of o.splitLines(lr(U)))yield{name:"",value:o.clipLine(G)};return}for(const U in Y){if(U==="x1"&&"x2"in Y||U==="y1"&&"y2"in Y)continue;const G=Y[U],H=G.value[W];if(!(!qe(H)&&G.scale==null))if(U==="x2"&&"x1"in Y)yield{name:qy(n,G,"x"),value:B2(Y.x1,G,W)};else if(U==="y2"&&"y1"in Y)yield{name:qy(n,G,"y"),value:B2(Y.y1,G,W)};else{const P=G.scale,Q={name:qy(n,G,U),value:lr(H)};(P==="color"||P==="opacity")&&(Q[P]=i[U][W]),yield Q}}t.fi!=null&&l&&(yield{name:String(l.label??"fx"),value:z(t.fx)}),t.fi!=null&&u&&(yield{name:String(u.label??"fy"),value:j(t.fy)})}const X=Ft("svg:g",s).call(Zt,this,r,s).call(n3,this).call(Yt,this,{x:I&&a,y:O&&c}).call(Y=>Y.selectAll().data(t).enter().append("g").attr("transform",W=>`translate(${Math.round($(W))},${Math.round(D(W))})`).call(Qt,this).call(W=>W.append("path").attr("filter",w)).call(W=>W.append("text").each(function(U){const G=zt(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const H=new Set;for(const P of V(v,U)){const Q=P.name;Q&&H.has(Q)||(H.add(Q),tt(G,P))}})));function tt(Y,{name:W,value:U,color:G,opacity:H}){const P=G!=null||H!=null;let Q,at=m*100;const[Nt]=ka(W,at,C,B);if(Nt>=0)W=W.slice(0,Nt).trimEnd()+Zo,Q=U.trim(),U="";else{(W||!U&&!P)&&(U=" "+U);const[K]=ka(U,at-C(W),C,B);K>=0&&(U=U.slice(0,K).trimEnd()+Zo,Q=U.trim())}const xt=Y.append("tspan").attr("x",0).attr("dy",`${y}em`).text("​");W&&xt.append("tspan").attr("font-weight","bold").text(W),U&&xt.append(()=>f.createTextNode(U)),P&&xt.append("tspan").text(" ■").attr("fill",G).attr("fill-opacity",H).style("user-select","none"),Q&&xt.append("title").text(Q)}function Dt(){const{width:Y,height:W}=r.facet??r;X.selectChildren().each(function(U){let{x:G,width:H,height:P}=this.getBBox();H=Math.round(H),P=Math.round(P);let Q=d;if(Q===void 0){Q=o.previousAnchor;const xt=$(U)+F,K=D(U)+S,Pt=xt+H+g*2<Y,si=xt-H-g*2>0,cn=K+P+b+g*2+7<W,uu=K-P-b-g*2>0,fu=(/-left$/.test(Q)?Pt||!si:Pt&&!si)?"left":"right",Pp=(/^top-/.test(Q)?cn||!uu:cn&&!uu)?"top":"bottom";Q=o.previousAnchor=`${Pp}-${fu}`}const at=this.firstChild,Nt=this.lastChild;if(at.setAttribute("d",hq(Q,b,g,H,P)),G)for(const xt of Nt.childNodes)xt.setAttribute("x",-G);Nt.setAttribute("y",`${+uq(Q,Nt.childNodes.length,y).toFixed(6)}em`),Nt.setAttribute("transform",`translate(${fq(Q,b,g,H,P)})`)})}return h.isConnected?Promise.resolve().then(Dt):typeof requestAnimationFrame<"u"&&requestAnimationFrame(Dt),X.node()}}function B3(e,{x:t,y:n,...i}={}){return i.frameAnchor===void 0&&([t,n]=ii(t,n)),new C3(e,{...i,x:t,y:n})}function uq(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function fq(e,t,n,i,r){switch(e){case"middle":return[-i/2,r/2];case"top-left":return[n,t+n];case"top":return[-i/2,t/2+n];case"top-right":return[-i-n,t+n];case"right":return[-t/2-i-n,r/2];case"bottom-left":return[n,-t-n];case"bottom":return[-i/2,-t/2-n];case"bottom-right":return[-i-n,-t-n];case"left":return[n+t/2,r/2]}}function hq(e,t,n,i,r){const s=i+n*2,o=r+n*2;switch(e){case"middle":return`M${-s/2},${-o/2}h${s}v${o}h${-s}z`;case"top-left":return`M0,0l${t},${t}h${s-t}v${o}h${-s}z`;case"top":return`M0,0l${t/2},${t/2}h${(s-t)/2}v${o}h${-s}v${-o}h${(s-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-s}v${o}h${s}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-o/2}h${-s}v${o}h${s}v${t/2-o/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${s-t}v${-o}h${-s}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(s-t)/2}v${-o}h${-s}v${o}h${(s-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-s}v${-o}h${s}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-o/2}h${s}v${o}h${-s}v${t/2-o/2}z`}}function dq({channels:e}){const t={};for(const n in e){if(lq.has(n))continue;const i=cM(e,n);i&&(t[n]=i)}return t}function B2(e,t,n){var i;return(i=t.hint)!=null&&i.length?`${lr(t.value[n]-e.value[n])}`:`${lr(e.value[n])}–${lr(t.value[n])}`}function qy(e,t,n){var i;return String(((i=e[t.scale])==null?void 0:i.label)??(t==null?void 0:t.label)??n)}function Q1(e={}){var N;const{facet:t,style:n,caption:i,ariaLabel:r,ariaDescription:s}=e,o=B1(e.className),a=e.marks===void 0?[]:P2(e.marks);a.push(..._q(a));const c=bq(t,e),l=new Map;for(const $ of a){const D=U2($,c,e);D&&l.set($,D)}const u=new Map;c&&wc(u,[c],e),wc(u,l,e);const h=P2(vq(a,u,e));for(const $ of h){const D=U2($,c,e);D&&l.set($,D)}a.unshift(...h);let f=lj(u,e);if(f!==void 0){const $=c?Uy(f,c):void 0;for(const C of a){if(C.facet===null||C.facet==="super")continue;const B=l.get(C);B!==void 0&&(B.facetsIndex=C.fx!=null||C.fy!=null?Uy(f,B):$)}const D=new Set;for(const{facetsIndex:C}of l.values())C==null||C.forEach((B,z)=>{(B==null?void 0:B.length)>0&&D.add(z)});f.forEach(0<D.size&&D.size<f.length?(C,B)=>C.empty=!D.has(B):C=>C.empty=!1);for(const C of a)if(C.facet==="exclude"){const B=l.get(C);B!==void 0&&(B.facetsIndex=hj(B.facetsIndex))}}for(const $ of se.keys())Vs(e[$])&&$!=="fx"&&$!=="fy"&&u.set($,[]);const d=new Map;for(const $ of a){if(d.has($))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:D,channels:C}=l.get($)??{},{data:B,facets:z,channels:j}=$.initialize(D,C,e);J1(j,e),d.set($,{data:B,facets:z,channels:j})}const p=gm(wc(u,d,e),e),y=S2(p),m=aj(p,a,e);Cz(p,m);const{fx:g,fy:b}=y,w=g||b?EM(p,m):m,_=g||b?Mq(y,m):m,x=sp(e),v=x.document,E=Sd("svg").call(v.documentElement);let T=E;x.ownerSVGElement=E,x.className=o,x.projection=QU(e,w),x.filterFacets=($,D)=>Uy(f,{channels:D,groups:U1($,D)}),x.getMarkState=$=>{const D=d.get($),C=l.get($);return{...D,channels:{...D.channels,...C==null?void 0:C.channels}}},x.dispatchValue=$=>{T.value!==$&&(T.value=$,T.dispatchEvent(new Event("input",{bubbles:!0})))};const k=new Set;for(const[$,D]of d)if($.initializer!=null){const C=$.facet==="super"?_:w,B=$.initializer(D.data,D.facets,D.channels,y,C,x);if(B.data!==void 0&&(D.data=B.data),B.facets!==void 0&&(D.facets=B.facets),B.channels!==void 0){const{fx:z,fy:j,...V}=B.channels;gq(V),Object.assign(D.channels,V);for(const X of Object.values(V)){const{scale:tt}=X;tt!=null&&se.get(tt)!==vi&&(P3(X,e),k.add(tt))}(z!=null||j!=null)&&l.set($,!0)}}if(k.size){const $=new Map;wc($,d,e,B=>k.has(B)),wc(u,d,e,B=>k.has(B));const D=Iq(gm($,e),p),C=S2(D);Object.assign(p,D),Object.assign(y,C)}let A,I;f!==void 0&&(A={x:g==null?void 0:g.domain(),y:b==null?void 0:b.domain()},f=uj(f,A),I=fj(g,b,m));for(const[$,D]of d)D.values=$.scale(D.channels,y,x);const{width:O,height:F}=m;zt(E).attr("class",o).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",O).attr("height",F).attr("viewBox",`0 0 ${O} ${F}`).attr("aria-label",r).attr("aria-description",s).call($=>$.append("style").text(`.${o} {
  display: block;
  background: white;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
.${o} text,
.${o} tspan {
  white-space: pre;
}`)).call(P1,n);for(const $ of a){const{channels:D,values:C,facets:B}=d.get($);if(f===void 0||$.facet==="super"){let z=null;if(B&&(z=B[0],z=$.filter(z,D,C),z.length===0))continue;const j=$.render(z,y,C,_,x);if(j==null)continue;E.appendChild(j)}else{let z;for(const j of f){if(!(((N=$.facetAnchor)==null?void 0:N.call($,f,A,j))??!j.empty))continue;let V=null;if(B){const tt=l.has($);if(V=B[tt?j.i:0],V=$.filter(V,D,C),V.length===0)continue;!tt&&V===B[0]&&(V=Ws(V)),V.fx=j.x,V.fy=j.y,V.fi=j.i}const X=$.render(V,y,C,w,x);if(X!=null){(z??(z=zt(E).append("g"))).append(()=>X).datum(j);for(const tt of["aria-label","aria-description","aria-hidden","transform"])X.hasAttribute(tt)&&(z.attr(tt,X.getAttribute(tt)),X.removeAttribute(tt))}}z==null||z.selectChildren().attr("transform",I)}}const S=oq(p,x,e);if(i!=null||S.length>0){T=v.createElement("figure"),T.style.maxWidth="initial";for(const $ of S)T.appendChild($);if(T.appendChild(E),i!=null){const $=v.createElement("figcaption");$.appendChild(i!=null&&i.ownerDocument?i:v.createTextNode(i)),T.appendChild($)}}T.scale=qz(p),T.legend=iq(p,x,e);const M=KU();return M>0&&zt(E).append("text").attr("x",O).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${M.toLocaleString("en-US")} warning${M===1?"":"s"}. Please check the console.`),T}function pq({marks:e=[],...t}={}){return Q1({...t,marks:[...e,this]})}Vt.prototype.plot=pq;function P2(e){return e.flat(1/0).filter(t=>t!=null).map(yq)}function yq(e){return typeof e.render=="function"?e:new mq(e)}class mq extends Vt{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function J1(e,t){for(const n in e)P3(e[n],t);return e}function P3(e,t){const{scale:n,transform:i=!0}=e;if(n==null||!i)return;const{type:r,percent:s,interval:o,transform:a=s?c=>c*100:XI(o,r)}=t[n]??{};a!=null&&(e.value=Ht(e.value,a),e.transform=!1)}function gq(e){for(const t in e)sM(t,e[t])}function wc(e,t,n,i=bU){var r,s;for(const{channels:o}of t.values())for(const a in o){const c=o[a],{scale:l}=c;if(l!=null&&i(l))if(l==="projection"){if(!tz(n)){const u=((r=n.x)==null?void 0:r.domain)===void 0,h=((s=n.y)==null?void 0:s.domain)===void 0;if(u||h){const[f,d]=nz(c);u&&Yy(e,"x",f),h&&Yy(e,"y",d)}}}else Yy(e,l,c)}return e}function Yy(e,t,n){const i=e.get(t);i!==void 0?i.push(n):e.set(t,[n])}function bq(e,t){if(e==null)return;const{x:n,y:i}=e;if(n==null&&i==null)return;const r=rn(e.data);if(r==null)throw new Error("missing facet data");const s={};n!=null&&(s.fx=bl(r,{value:n,scale:"fx"})),i!=null&&(s.fy=bl(r,{value:i,scale:"fy"})),J1(s,t);const o=U1(r,s);return{channels:s,groups:o,data:e.data}}function U2(e,t,n){var c;if(e.facet===null||e.facet==="super")return;const{fx:i,fy:r}=e;if(i!=null||r!=null){const l=rn(e.data??i??r);if(l===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(l===null)return;const u={};return i!=null&&(u.fx=bl(l,{value:i,scale:"fx"})),r!=null&&(u.fy=bl(l,{value:r,scale:"fy"})),J1(u,n),{channels:u,groups:U1(l,u)}}if(t===void 0)return;const{channels:s,groups:o,data:a}=t;if(e.facet!=="auto"||e.data===a)return{channels:s,groups:o};a.length>0&&(o.size>1||o.size===1&&s.fx&&s.fy&&[...o][0][1].size>1)&&((c=rn(e.data))==null?void 0:c.length)===a.length&&Br(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function wq(e,t={}){return sn({...t,x:null,y:null},(n,i,r,s,o,a)=>a.getMarkState(e))}function _q(e){const t=[];for(const n of e){const i=n.tip;if(i){const s=(i==="x"?q1:i==="y"?Y1:j1)(wq(n));s.title=null,t.push(B3(n.data,s))}}return t}function vq(e,t,n){let{projection:i,x:r={},y:s={},fx:o={},fy:a={},axis:c,grid:l,facet:u={},facet:{axis:h=c,grid:f}=u,x:{axis:d=c,grid:p=d===null?null:l}=r,y:{axis:y=c,grid:m=y===null?null:l}=s,fx:{axis:g=h,grid:b=g===null?null:f}=o,fy:{axis:w=h,grid:_=w===null?null:f}=a}=n;(i||!Vs(r)&&!z2("x",e))&&(d=p=null),(i||!Vs(s)&&!z2("y",e))&&(y=m=null),t.has("fx")||(g=b=null),t.has("fy")||(w=_=null),d===void 0&&(d=!Bu(e,"x")),y===void 0&&(y=!Bu(e,"y")),g===void 0&&(g=!Bu(e,"fx")),w===void 0&&(w=!Bu(e,"fy")),d===!0&&(d="bottom"),y===!0&&(y="left"),g===!0&&(g=d==="top"||d===null?"bottom":"top"),w===!0&&(w=y==="right"||y===null?"left":"right");const x=[];return Cu(x,_,S3,a),Du(x,w,b3,"right","left",u,a),Cu(x,b,A3,o),Du(x,g,w3,"top","bottom",u,o),Cu(x,m,x3,s),Du(x,y,G1,"left","right",n,s),Cu(x,p,E3,r),Du(x,d,H1,"bottom","top",n,r),x}function Du(e,t,n,i,r,s,o){if(!t)return;const a=xq(t);o=Sq(a?i:t,s,o);const{line:c}=o;(n===G1||n===H1)&&c&&!Ma(c)&&e.push(K1(Eq(o))),e.push(n(o)),a&&e.push(n({...o,anchor:r,label:null}))}function Cu(e,t,n,i){!t||Ma(t)||e.push(n(Aq(t,i)))}function xq(e){return/^\s*both\s*$/i.test(e)}function Sq(e,t,{line:n=t.line,ticks:i,tickSize:r,tickSpacing:s,tickPadding:o,tickFormat:a,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:h,label:f=t.label,labelAnchor:d,labelArrow:p=t.labelArrow,labelOffset:y}){return{anchor:e,line:n,ticks:i,tickSize:r,tickSpacing:s,tickPadding:o,tickFormat:a,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:h,label:f,labelAnchor:d,labelArrow:p,labelOffset:y}}function Eq(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function Aq(e,{stroke:t=Hl(e)?e:void 0,ticks:n=Tq(e)?e:void 0,tickSpacing:i,ariaLabel:r,ariaDescription:s}){return{stroke:t,ticks:n,tickSpacing:i,ariaLabel:r,ariaDescription:s}}function Tq(e){switch(typeof e){case"number":return!0;case"string":return!Hl(e)}return Di(e)||typeof(e==null?void 0:e.range)=="function"}function Bu(e,t){const n=`${t}-axis `;return e.some(i=>{var r;return(r=i.ariaLabel)==null?void 0:r.startsWith(n)})}function z2(e,t){for(const n of t)for(const i in n.channels){const{scale:r}=n.channels[i];if(r===e||r==="projection")return!0}return!1}function Iq(e,t){for(const n in e){const i=e[n],r=t[n];i.label===void 0&&r&&(i.label=r.label)}return e}function Mq({fx:e,fy:t},n){const{marginTop:i,marginRight:r,marginBottom:s,marginLeft:o,width:a,height:c}=R1(n),l=e&&j2(e),u=t&&j2(t);return{marginTop:t?u[0]:i,marginRight:e?a-l[1]:r,marginBottom:t?c-u[1]:s,marginLeft:e?l[0]:o,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:a,height:c}}function j2(e){const t=e.domain();let n=e(t[0]),i=e(t[t.length-1]);return i<n&&([n,i]=[i,n]),[n,i+e.bandwidth()]}const Nq=new Map([["basis",CP],["basis-closed",BP],["basis-open",PP],["bundle",UP],["bump-x",TP],["bump-y",IP],["cardinal",zP],["cardinal-closed",jP],["cardinal-open",qP],["catmull-rom",YP],["catmull-rom-closed",VP],["catmull-rom-open",WP],["linear",Vl],["linear-closed",GP],["monotone-x",HP],["monotone-y",XP],["natural",KP],["step",QP],["step-after",ZP],["step-before",JP]]);function Z1(e=Vl,t){if(typeof e=="function")return e;const n=Nq.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function U3(e=Oa,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?Oa:Z1(e,t)}function Oa(e){return Vl(e)}function kr(e={y:"count"},t={}){[e,t]=ib(e,t);const{x:n,y:i}=t;return nb(Hh(n,t,ot),null,null,i,e,Zl(t))}function Or(e={x:"count"},t={}){[e,t]=ib(e,t);const{x:n,y:i}=t;return nb(null,Hh(i,t,ot),n,null,e,tu(t))}function Is(e={fill:"count"},t={}){[e,t]=ib(e,t);const{x:n,y:i}=$q(t);return nb(n,i,null,null,e,Zl(tu(t)))}function z3(e,t,n={}){return(n==null?void 0:n.interval)==null?n:e({[t]:(n==null?void 0:n.reduce)===void 0?N1:n.reduce,filter:null},n)}function tb(e={}){return z3(kr,"y",Ya(e,"x"))}function eb(e={}){return z3(Or,"x",Ya(e,"y"))}function nb(e,t,n,i,{data:r=M1,filter:s=qh,sort:o,reverse:a,...c}={},l={}){e=q2(e),t=q2(t),c=kq(c,l),r=V3(r,ot),o=o==null?void 0:q3("sort",o,l),s=s==null?void 0:Y3("filter",s,l),n!=null&&Rr(c,"x","x1","x2")&&(n=null),i!=null&&Rr(c,"y","y1","y2")&&(i=null);const[u,h]=We(e),[f,d]=We(e),[p,y]=We(t),[m,g]=We(t),[b,w]=n!=null?[n,"x"]:i!=null?[i,"y"]:[],[_,x]=We(b),{x:v,y:E,z:T,fill:k,stroke:A,x1:I,x2:O,y1:F,y2:S,domain:M,cumulative:N,thresholds:$,interval:D,...C}=l,[B,z]=We(T),[j]=nn(k),[V]=nn(A),[X,tt]=We(j),[Dt,Y]=We(V);return{..."z"in l&&{z:B||T},..."fill"in l&&{fill:X||k},..."stroke"in l&&{stroke:Dt||A},...Ci(C,(W,U,G)=>{const H=jh(Et(W,b),G==null?void 0:G[w]),P=Et(W,T),Q=Et(W,j),at=Et(W,V),Nt=I1(c,{z:P,fill:Q,stroke:at}),xt=[],K=[],Pt=H&&x([]),si=P&&z([]),cn=Q&&tt([]),uu=at&&Y([]),fu=e&&h([]),Pp=e&&d([]),Kb=t&&y([]),w$=t&&g([]),_$=Fq(e==null?void 0:e(W),t==null?void 0:t(W));let v$=0;for(const yo of c)yo.initialize(W);o&&o.initialize(W),s&&s.initialize(W);for(const yo of U){const Qb=[];for(const ac of c)ac.scope("facet",yo);o&&o.scope("facet",yo),s&&s.scope("facet",yo);for(const[ac,x$]of Jo(yo,Nt))for(const[S$,E$]of Jo(x$,H))for(const[gs,bs]of _$(E$))if(!(s&&!s.reduce(gs,bs))){Qb.push(v$++),K.push(r.reduceIndex(gs,W,bs)),H&&Pt.push(S$),P&&si.push(Nt===P?ac:P[gs[0]]),Q&&cn.push(Nt===Q?ac:Q[gs[0]]),at&&uu.push(Nt===at?ac:at[gs[0]]),fu&&(fu.push(bs.x1),Pp.push(bs.x2)),Kb&&(Kb.push(bs.y1),w$.push(bs.y2));for(const A$ of c)A$.reduce(gs,bs);o&&o.reduce(gs)}xt.push(Qb)}return iM(xt,o,a),{data:K,facets:xt}}),...!Rr(c,"x")&&(u?{x1:u,x2:f,x:zh(u,f)}:{x:v,x1:I,x2:O}),...!Rr(c,"y")&&(p?{y1:p,y2:m,y:zh(p,m)}:{y:E,y1:F,y2:S}),..._&&{[w]:_},...Object.fromEntries(c.map(({name:W,output:U})=>[W,U]))}}function ib({cumulative:e,domain:t,thresholds:n,interval:i,...r},s){return[r,{cumulative:e,domain:t,thresholds:n,interval:i,...s}]}function Hh(e,{cumulative:t,domain:n,thresholds:i,interval:r},s){return e={...Gl(e)},e.domain===void 0&&(e.domain=n),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=i),e.interval===void 0&&(e.interval=r),e.value===void 0&&(e.value=s),e.thresholds=j3(e.thresholds,e.interval),e}function $q(e){let{x:t,y:n}=e;return t=Hh(t,e),n=Hh(n,e),[t.value,n.value]=ii(t.value,n.value),{x:t,y:n}}function q2(e){if(e==null)return;const{value:t,cumulative:n,domain:i=Ae,thresholds:r}=e,s=o=>{let a=Et(o,t),c;if(Pn(a)||Lq(r)){a=Ht(a,YI,Float64Array);let[u,h]=typeof i=="function"?i(a):i,f=typeof r=="function"&&!Lc(r)?r(a,u,h):r;typeof f=="number"&&(f=WA(u,h,f)),Lc(f)&&(i===Ae&&(u=f.floor(u),h=f.offset(f.floor(h))),f=f.range(u,f.offset(h))),c=f}else{a=Qe(a);let[u,h]=typeof i=="function"?i(a):i,f=typeof r=="function"&&!Lc(r)?r(a,u,h):r;if(typeof f=="number")if(i===Ae){let d=il(u,h,f);if(isFinite(d))if(d>0){let p=Math.round(u/d),y=Math.round(h/d);p*d<=u||--p,y*d>h||++y;let m=y-p+1;f=new Float64Array(m);for(let g=0;g<m;++g)f[g]=(p+g)*d}else if(d<0){d=-d;let p=Math.round(u*d),y=Math.round(h*d);p/d<=u||--p,y/d>h||++y;let m=y-p+1;f=new Float64Array(m);for(let g=0;g<m;++g)f[g]=(p+g)/d}else f=[u];else f=[u]}else f=Hr(u,h,f);else Lc(f)&&(i===Ae&&(u=f.floor(u),h=f.offset(f.floor(h))),f=f.range(u,f.offset(h)));c=f}const l=[];if(c.length===1)l.push([c[0],c[0]]);else for(let u=1;u<c.length;++u)l.push([c[u-1],c[u]]);return l.bin=(n<0?Cq:n>0?Dq:rb)(l,c,a),l};return s.label=_r(t),s}function j3(e,t,n=Y2){if(e===void 0)return t===void 0?n:qa(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return d5;case"scott":return XS;case"sturges":return $g;case"auto":return Y2}return jI(e)}return e}function kq(e,t){return E1(e,t,q3)}function q3(e,t,n){return A1(e,t,n,Y3)}function Y3(e,t,n){return T1(e,t,n,V3)}function V3(e,t){return rp(e,t,Oq)}function Oq(e){switch(`${e}`.toLowerCase()){case"x":return Bq;case"x1":return Uq;case"x2":return zq;case"y":return Pq;case"y1":return jq;case"y2":return qq}throw new Error(`invalid bin reduce: ${e}`)}function Y2(e,t,n){return Math.min(200,XS(e,t,n))}function Lq(e){return Rq(e)||Di(e)&&Pn(e)}function Rq(e){return Lc(e)&&typeof e=="function"&&e()instanceof Date}function Lc(e){return typeof(e==null?void 0:e.range)=="function"}function Fq(e,t){return e&&t?function*(n){const i=e.bin(n);for(const[r,[s,o]]of e.entries()){const a=t.bin(i[r]);for(const[c,[l,u]]of t.entries())yield[a[c],{x1:s,y1:l,x2:o,y2:u}]}}:e?function*(n){const i=e.bin(n);for(const[r,[s,o]]of e.entries())yield[i[r],{x1:s,x2:o}]}:function*(n){const i=t.bin(n);for(const[r,[s,o]]of t.entries())yield[i[r],{y1:s,y2:o}]}}function rb(e,t,n){return t=Qe(t),i=>{var s;const r=e.map(()=>[]);for(const o of i)(s=r[gd(t,n[o])-1])==null||s.push(o);return r}}function Dq(e,t,n){const i=rb(e,t,n);return r=>{const s=i(r);for(let o=1,a=s.length;o<a;++o){const c=s[o-1],l=s[o];for(const u of c)l.push(u)}return s}}function Cq(e,t,n){const i=rb(e,t,n);return r=>{const s=i(r);for(let o=s.length-2;o>=0;--o){const a=s[o+1],c=s[o];for(const l of a)c.push(l)}return s}}function W3(e,t){const n=(+e+ +t)/2;return e instanceof Date?new Date(n):n}const Bq={reduceIndex(e,t,{x1:n,x2:i}){return W3(n,i)}},Pq={reduceIndex(e,t,{y1:n,y2:i}){return W3(n,i)}},Uq={reduceIndex(e,t,{x1:n}){return n}},zq={reduceIndex(e,t,{x2:n}){return n}},jq={reduceIndex(e,t,{y1:n}){return n}},qq={reduceIndex(e,t,{y2:n}){return n}};function sb(e={}){return VI(e)?e:{...e,x:ot}}function ob(e={}){return WI(e)?e:{...e,y:ot}}function G3(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{y1:n,y:i=n,x:r,...s}=t,[o,a,c,l]=Xa(i,r,"y","x",e,s);return{...o,y1:n,y:a,x1:c,x2:l,x:zh(c,l)}}function Yq(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{y1:n,y:i=n,x:r}=t,[s,o,a]=Xa(i,r,"y","x",e,t);return{...s,y1:n,y:o,x:a}}function Vq(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{y1:n,y:i=n,x:r}=t,[s,o,,a]=Xa(i,r,"y","x",e,t);return{...s,y1:n,y:o,x:a}}function H3(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{x1:n,x:i=n,y:r,...s}=t,[o,a,c,l]=Xa(i,r,"x","y",e,s);return{...o,x1:n,x:a,y1:c,y2:l,y:zh(c,l)}}function Wq(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{x1:n,x:i=n,y:r}=t,[s,o,a]=Xa(i,r,"x","y",e,t);return{...s,x1:n,x:o,y:a}}function Gq(e={},t={}){arguments.length===1&&([e,t]=Ha(e));const{x1:n,x:i=n,y:r}=t,[s,o,,a]=Xa(i,r,"x","y",e,t);return{...s,x1:n,x:o,y:a}}function ab({x:e,x1:t,x2:n,...i}={}){return i=Ya(i,"y"),t===void 0&&n===void 0?G3({x:e,...i}):([t,n]=GI(e,t,n),{...i,x1:t,x2:n})}function cb({y:e,y1:t,y2:n,...i}={}){return i=Ya(i,"x"),t===void 0&&n===void 0?H3({y:e,...i}):([t,n]=GI(e,t,n),{...i,y1:t,y2:n})}function Ha(e){const{offset:t,order:n,reverse:i,...r}=e;return[{offset:t,order:n,reverse:i},r]}const Hq={length:!0};function Xa(e,t=l1,n,i,{offset:r,order:s,reverse:o},a){const c=hs(a),[l,u]=We(e),[h,f]=yn(t),[d,p]=yn(t);return h.hint=d.hint=Hq,r=Xq(r),s=Jq(s,r,i),[Ci(a,(y,m,g)=>{const b=e==null?void 0:u(jh(Et(y,e),g==null?void 0:g[n])),w=Et(y,t,Float64Array),_=Et(y,c),x=s&&s(y,b,w,_),v=y.length,E=f(new Float64Array(v)),T=p(new Float64Array(v)),k=[];for(const A of m){const I=b?Array.from(br(A,O=>b[O]).values()):[A];if(x)for(const O of I)O.sort(x);for(const O of I){let F=0,S=0;o&&O.reverse();for(const M of O){const N=w[M];N<0?F=T[M]=(E[M]=F)+N:N>0?S=T[M]=(E[M]=S)+N:T[M]=E[M]=S}}k.push(I)}return r&&r(k,E,T,_),{data:y,facets:m}}),l,h,d]}function Xq(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return Kq;case"center":case"silhouette":return Qq;case"wiggle":return K3}throw new Error(`unknown offset: ${e}`)}}function X3(e,t){let n=0,i=0;for(const r of e){const s=t[r];s<n&&(n=s),s>i&&(i=s)}return[n,i]}function Kq(e,t,n){for(const i of e)for(const r of i){const[s,o]=X3(r,n);for(const a of r){const c=1/(o-s||1);t[a]=c*(t[a]-s),n[a]=c*(n[a]-s)}}}function Qq(e,t,n){for(const i of e){for(const r of i){const[s,o]=X3(r,n);for(const a of r){const c=(o+s)/2;t[a]-=c,n[a]-=c}}Q3(i,t,n)}J3(e,t,n)}function K3(e,t,n,i){for(const r of e){const s=new Qs;let o=0;for(const a of r){let c=-1;const l=a.map(d=>Math.abs(n[d]-t[d])),u=a.map(d=>{c=i?i[d]:++c;const p=n[d]-t[d],y=s.has(c)?p-s.get(c):0;return s.set(c,p),y}),h=[0,...r5(u)];for(const d of a)t[d]+=o,n[d]+=o;const f=$i(l);f&&(o-=$i(l,(d,p)=>(u[p]/2+h[p])*d)/f)}Q3(r,t,n)}J3(e,t,n)}function Q3(e,t,n){const i=xe(e,r=>xe(r,s=>t[s]));for(const r of e)for(const s of r)t[s]-=i,n[s]-=i}function J3(e,t,n){const i=e.length;if(i===1)return;const r=e.map(a=>a.flat()),s=r.map(a=>(xe(a,c=>t[c])+oe(a,c=>n[c]))/2),o=xe(s);for(let a=0;a<i;a++){const c=o-s[a];for(const l of r[a])t[l]+=c,n[l]+=c}}function Jq(e,t,n){if(e===void 0&&t===K3)return V2(Cn);if(e!=null){if(typeof e=="string"){const i=e.startsWith("-"),r=i?Ph:Cn;switch((i?e.slice(1):e).toLowerCase()){case"value":case n:return Zq(r);case"z":return tY(r);case"sum":return eY(r);case"appearance":return nY(r);case"inside-out":return V2(r)}return W2(qI(e))}if(typeof e=="function")return(e.length===1?W2:iY)(e);if(Array.isArray(e))return rY(e);throw new Error(`invalid order: ${e}`)}}function Zq(e){return(t,n,i)=>(r,s)=>e(i[r],i[s])}function tY(e){return(t,n,i,r)=>(s,o)=>e(r[s],r[o])}function eY(e){return yp(e,(t,n,i,r)=>Ng(wr(t),s=>$i(s,o=>i[o]),s=>r[s]))}function nY(e){return yp(e,(t,n,i,r)=>Ng(wr(t),s=>n[kg(s,o=>i[o])],s=>r[s]))}function V2(e){return yp(e,(t,n,i,r)=>{const s=wr(t),o=Ng(s,h=>n[kg(h,f=>i[f])],h=>r[h]),a=Ho(s,h=>$i(h,f=>i[f]),h=>r[h]),c=[],l=[];let u=0;for(const h of o)u<0?(u+=a.get(h),c.push(h)):(u-=a.get(h),l.push(h));return l.reverse().concat(c)})}function W2(e){return t=>{const n=Et(t,e);return(i,r)=>Cn(n[i],n[r])}}function iY(e){return t=>(n,i)=>e(t[n],t[i])}function rY(e){return yp(Cn,()=>e)}function yp(e,t){return(n,i,r,s)=>{if(!s)throw new Error("missing channel: z");const o=new Qs(t(n,i,r,s).map((a,c)=>[a,c]));return(a,c)=>e(o.get(s[a]),o.get(s[c]))}}const sY={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class mp extends Vt{constructor(t,n={}){const{x1:i,y1:r,x2:s,y2:o,z:a,curve:c,tension:l}=n;super(t,{x1:{value:i,scale:"x"},y1:{value:r,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0},z:{value:hs(n),optional:!0}},n,sY),this.z=a,this.curve=Z1(c,l)}filter(t){return t}render(t,n,i,r,s){const{x1:o,y1:a,x2:c=o,y2:l=a}=i;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n,0,0).call(u=>u.selectAll().data(OM(t,[o,a,c,l],this,i)).enter().append("path").call(Qt,this).call(Yh,this,i).attr("d",i1().curve(this.curve).defined(h=>h>=0).x0(h=>o[h]).y0(h=>a[h]).x1(h=>c[h]).y1(h=>l[h]))).node()}}function oY(e,t){return t===void 0?_l(e,{x:Wl,y:yl}):new mp(e,t)}function Xh(e,t){const{y:n=an,...i}=eb(t);return new mp(e,ab(sb({...i,y1:n,y2:void 0})))}function _l(e,t){const{x:n=an,...i}=tb(t);return new mp(e,cb(ob({...i,x1:n,x2:void 0})))}const aY={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Z3 extends Vt{constructor(t,n={}){const{x1:i,y1:r,x2:s,y2:o,curve:a,tension:c}=n;super(t,{x1:{value:i,scale:"x"},y1:{value:r,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,aY),this.curve=U3(a,c),Va(this,n)}project(t,n,i){this.curve!==Oa&&super.project(t,n,i)}render(t,n,i,r,s){const{x1:o,y1:a,x2:c=o,y2:l=a}=i,{curve:u}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(h=>h.selectAll().data(t).enter().append("path").call(Qt,this).attr("d",u===Oa&&s.projection?cY(s.projection,o,a,c,l):f=>{const d=tr(),p=u(d);return p.lineStart(),p.point(o[f],a[f]),p.point(c[f],l[f]),p.lineEnd(),d}).call(ge,this,i).call(Jl,this,i,s)).node()}}function cY(e,t,n,i,r){const s=us(e);return t=Qe(t),n=Qe(n),i=Qe(i),r=Qe(r),o=>s({type:"LineString",coordinates:[[t[o],n[o]],[i[o],r[o]]]})}function t6(e,{x:t,x1:n,x2:i,y:r,y1:s,y2:o,...a}={}){return[n,i]=Kh(t,n,i),[s,o]=Kh(r,s,o),new Z3(e,{...a,x1:n,x2:i,y1:s,y2:o})}function Kh(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}const lY={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class e6 extends Vt{constructor(t,n={}){const{x1:i,y1:r,x2:s,y2:o,bend:a=0,headAngle:c=60,headLength:l=8,inset:u=0,insetStart:h=u,insetEnd:f=u}=n;super(t,{x1:{value:i,scale:"x"},y1:{value:r,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,lY),this.bend=a===!0?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+c,this.headLength=+l,this.insetStart=+h,this.insetEnd=+f}render(t,n,i,r,s){const{x1:o,y1:a,x2:c=o,y2:l=a,SW:u}=i,{strokeWidth:h,bend:f,headAngle:d,headLength:p,insetStart:y,insetEnd:m}=this,g=u?x=>u[x]:Bn(h===void 0?1:h),b=f*Vh,w=d*Vh/2,_=p/1.5;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(x=>x.selectAll().data(t).enter().append("path").call(Qt,this).attr("d",v=>{let E=o[v],T=a[v],k=c[v],A=l[v];const I=Math.hypot(k-E,A-T);if(I<=y+m)return null;let O=Math.atan2(A-T,k-E);const F=Math.min(_*g(v),I/3),S=Math.hypot(I/Math.tan(b),I)/2;if(y||m)if(S<1e5){const j=Math.sign(b),[V,X]=uY([E,T],[k,A],S,j);if(y&&([E,T]=G2([V,X,S],[E,T,y],-j*Math.sign(y))),m){const[tt,Dt]=G2([V,X,S],[k,A,m],j*Math.sign(m));O+=Math.atan2(Dt-X,tt-V)-Math.atan2(A-X,k-V),k=tt,A=Dt}}else{const j=k-E,V=A-T,X=Math.hypot(j,V);y&&(E+=j/X*y,T+=V/X*y),m&&(k-=j/X*m,A-=V/X*m)}const M=O+b,N=M+w,$=M-w,D=k-F*Math.cos(N),C=A-F*Math.sin(N),B=k-F*Math.cos($),z=A-F*Math.sin($);return`M${E},${T}${S<1e5?`A${S},${S} 0,0,${b>0?1:0} `:"L"}${k},${A}M${D},${C}L${k},${A}L${B},${z}`}).call(ge,this,i)).node()}}function uY([e,t],[n,i],r,s){const o=n-e,a=i-t,c=Math.hypot(o,a),l=s*Math.sqrt(r*r-c*c/4)/c;return[(e+n)/2-a*l,(t+i)/2+o*l]}function G2([e,t,n],[i,r,s],o){const a=i-e,c=r-t,l=Math.hypot(a,c),u=(a*a+c*c-s*s+n*n)/(2*l),h=o*Math.sqrt(n*n-u*u);return[e+(a*u+c*h)/l,t+(c*u-a*h)/l]}function fY(e,{x:t,x1:n,x2:i,y:r,y1:s,y2:o,...a}={}){return[n,i]=Kh(t,n,i),[s,o]=Kh(r,s,o),new e6(e,{...a,x1:n,x2:i,y1:s,y2:o})}class lb extends Vt{constructor(t,n,i={},r){super(t,n,i,r);const{inset:s=0,insetTop:o=s,insetRight:a=s,insetBottom:c=s,insetLeft:l=s,rx:u,ry:h}=i;this.insetTop=Tt(o),this.insetRight=Tt(a),this.insetBottom=Tt(c),this.insetLeft=Tt(l),this.rx=ae(u,"auto"),this.ry=ae(h,"auto")}render(t,n,i,r,s){const{rx:o,ry:a}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(this._transform,this,n).call(c=>c.selectAll().data(t).enter().append("rect").call(Qt,this).attr("x",this._x(n,i,r)).attr("width",this._width(n,i,r)).attr("y",this._y(n,i,r)).attr("height",this._height(n,i,r)).call(et,"rx",o).call(et,"ry",a).call(ge,this,i)).node()}_x(t,{x:n},{marginLeft:i}){const{insetLeft:r}=this;return n?s=>n[s]+r:i+r}_y(t,{y:n},{marginTop:i}){const{insetTop:r}=this;return n?s=>n[s]+r:i+r}_width({x:t},{x:n},{marginRight:i,marginLeft:r,width:s}){const{insetLeft:o,insetRight:a}=this,c=n&&t?t.bandwidth():s-i-r;return Math.max(0,c-o-a)}_height({y:t},{y:n},{marginTop:i,marginBottom:r,height:s}){const{insetTop:o,insetBottom:a}=this,c=n&&t?t.bandwidth():s-i-r;return Math.max(0,c-o-a)}}const n6={ariaLabel:"bar"};class i6 extends lb{constructor(t,n={}){const{x1:i,x2:r,y:s}=n;super(t,{x1:{value:i,scale:"x"},x2:{value:r,scale:"x"},y:{value:s,scale:"y",type:"band",optional:!0}},n,n6)}_transform(t,n,{x:i}){t.call(Yt,n,{x:i},0,0)}_x({x:t},{x1:n,x2:i},{marginLeft:r}){const{insetLeft:s}=this;return On(t)?r+s:o=>Math.min(n[o],i[o])+s}_width({x:t},{x1:n,x2:i},{marginRight:r,marginLeft:s,width:o}){const{insetLeft:a,insetRight:c}=this;return On(t)?o-r-s-a-c:l=>Math.max(0,Math.abs(i[l]-n[l])-a-c)}}class r6 extends lb{constructor(t,n={}){const{x:i,y1:r,y2:s}=n;super(t,{y1:{value:r,scale:"y"},y2:{value:s,scale:"y"},x:{value:i,scale:"x",type:"band",optional:!0}},n,n6)}_transform(t,n,{y:i}){t.call(Yt,n,{y:i},0,0)}_y({y:t},{y1:n,y2:i},{marginTop:r}){const{insetTop:s}=this;return On(t)?r+s:o=>Math.min(n[o],i[o])+s}_height({y:t},{y1:n,y2:i},{marginTop:r,marginBottom:s,height:o}){const{insetTop:a,insetBottom:c}=this;return On(t)?o-r-s-a-c:l=>Math.max(0,Math.abs(i[l]-n[l])-a-c)}}function ta(e,t={}){return Qd(t)||(t={...t,y:an,x2:ot}),new i6(e,ab(YM(sb(t))))}function ea(e,t={}){return Qd(t)||(t={...t,x:an,y2:ot}),new r6(e,cb(VM(ob(t))))}const hY={ariaLabel:"cell"};class gp extends lb{constructor(t,{x:n,y:i,...r}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:i,scale:"y",type:"band",optional:!0}},r,hY)}_transform(t,n){t.call(Yt,n,{},0,0)}}function Qh(e,{x:t,y:n,...i}={}){return[t,n]=ii(t,n),new gp(e,{...i,x:t,y:n})}function dY(e,{x:t=an,fill:n,stroke:i,...r}={}){return n===void 0&&nn(i)[0]===void 0&&(n=ot),new gp(e,{...r,x:t,fill:n,stroke:i})}function pY(e,{y:t=an,fill:n,stroke:i,...r}={}){return n===void 0&&nn(i)[0]===void 0&&(n=ot),new gp(e,{...r,y:t,fill:n,stroke:i})}const yY={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function ub(e){return e.sort===void 0&&e.reverse===void 0?eM({channel:"-r"},e):e}class bp extends Vt{constructor(t,n={}){const{x:i,y:r,r:s,rotate:o,symbol:a=dl,frameAnchor:c}=n,[l,u]=le(o,0),[h,f]=LU(a),[d,p]=le(s,h==null?3:4.5);super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:d,scale:"r",filter:cr,optional:!0},rotate:{value:l,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},ub(n),yY),this.r=p,this.rotate=u,this.symbol=f,this.frameAnchor=Xl(c);const{channels:y}=this,{symbol:m}=y;if(m){const{fill:g,stroke:b}=y;m.hint={fill:g?g.value===m.value?"color":"currentColor":this.fill,stroke:b?b.value===m.value?"color":"currentColor":this.stroke}}}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,r:u,rotate:h,symbol:f}=i,{r:d,rotate:p,symbol:y}=this,[m,g]=Bi(this,r),b=y===dl,w=u?void 0:d*d*Math.PI;return Xd(d)&&(t=[]),Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(_=>_.selectAll().data(t).enter().append(b?"circle":"path").call(Qt,this).call(b?x=>{x.attr("cx",c?v=>c[v]:m).attr("cy",l?v=>l[v]:g).attr("r",u?v=>u[v]:d)}:x=>{x.attr("transform",fp`translate(${c?v=>c[v]:m},${l?v=>l[v]:g})${h?v=>` rotate(${h[v]})`:p?` rotate(${p})`:""}`).attr("d",u&&f?v=>{const E=tr();return f[v].draw(E,u[v]*u[v]*Math.PI),E}:u?v=>{const E=tr();return y.draw(E,u[v]*u[v]*Math.PI),E}:f?v=>{const E=tr();return f[v].draw(E,w),E}:(()=>{const v=tr();return y.draw(v,w),v})())}).call(ge,this,i)).node()}}function ys(e,{x:t,y:n,...i}={}){return i.frameAnchor===void 0&&([t,n]=ii(t,n)),new bp(e,{...i,x:t,y:n})}function mY(e,{x:t=ot,...n}={}){return new bp(e,GM({...n,x:t}))}function gY(e,{y:t=ot,...n}={}){return new bp(e,WM({...n,y:t}))}function bY(e,t){return ys(e,{...t,symbol:"circle"})}function wY(e,t){return ys(e,{...t,symbol:"hexagon"})}const _Y={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class wp extends Vt{constructor(t,n={}){const{x:i,y:r,z:s,curve:o,tension:a}=n;super(t,{x:{value:i,scale:"x"},y:{value:r,scale:"y"},z:{value:hs(n),optional:!0}},n,_Y),this.z=s,this.curve=U3(o,a),Va(this,n)}filter(t){return t}project(t,n,i){this.curve!==Oa&&super.project(t,n,i)}render(t,n,i,r,s){const{x:o,y:a}=i,{curve:c}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(l=>l.selectAll().data(OM(t,[o,a],this,i)).enter().append("path").call(Qt,this).call(Yh,this,i).call(Ij,this,i,s).attr("d",c===Oa&&s.projection?vY(s.projection,o,a):pI().curve(c).defined(u=>u>=0).x(u=>o[u]).y(u=>a[u]))).node()}}function vY(e,t,n){const i=us(e);return t=Qe(t),n=Qe(n),r=>{let s=[];const o=[s];for(const a of r)a===-1?(s=[],o.push(s)):s.push([t[a],n[a]]);return i({type:"MultiLineString",coordinates:o})}}function fb(e,{x:t,y:n,...i}={}){return[t,n]=ii(t,n),new wp(e,{...i,x:t,y:n})}function Jh(e,{x:t=ot,y:n=an,...i}={}){return new wp(e,eb({...i,x:t,y:n}))}function Zh(e,{x:t=an,y:n=ot,...i}={}){return new wp(e,tb({...i,x:t,y:n}))}const xY={ariaLabel:"rect"};class _p extends Vt{constructor(t,n={}){const{x1:i,y1:r,x2:s,y2:o,inset:a=0,insetTop:c=a,insetRight:l=a,insetBottom:u=a,insetLeft:h=a,rx:f,ry:d}=n;super(t,{x1:{value:i,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,xY),this.insetTop=Tt(c),this.insetRight=Tt(l),this.insetBottom=Tt(u),this.insetLeft=Tt(h),this.rx=ae(f,"auto"),this.ry=ae(d,"auto")}render(t,n,i,r,s){const{x:o,y:a}=n,{x1:c,y1:l,x2:u,y2:h}=i,{marginTop:f,marginRight:d,marginBottom:p,marginLeft:y,width:m,height:g}=r,{projection:b}=s,{insetTop:w,insetRight:_,insetBottom:x,insetLeft:v,rx:E,ry:T}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&u&&o,y:l&&h&&a},0,0).call(k=>k.selectAll().data(t).enter().append("rect").call(Qt,this).attr("x",c&&u&&(b||!On(o))?A=>Math.min(c[A],u[A])+v:y+v).attr("y",l&&h&&(b||!On(a))?A=>Math.min(l[A],h[A])+w:f+w).attr("width",c&&u&&(b||!On(o))?A=>Math.max(0,Math.abs(u[A]-c[A])-v-_):m-d-y-_-v).attr("height",l&&h&&(b||!On(a))?A=>Math.max(0,Math.abs(l[A]-h[A])-w-x):g-f-p-w-x).call(et,"rx",E).call(et,"ry",T).call(ge,this,i)).node()}}function hb(e,t){return new _p(e,jM(qM(t)))}function jc(e,t={}){return Qd(t)||(t={...t,y:an,x2:ot,interval:1}),new _p(e,ab(qM(sb(t))))}function qc(e,t={}){return Qd(t)||(t={...t,x:an,y2:ot,interval:1}),new _p(e,cb(jM(ob(t))))}function s6(e,t){t=EY(t);const{x:n,y:i,color:r,size:s}=t,o=Pu(e,n),a=Pu(e,i),c=Pu(e,r),l=Pu(e,s);let{fx:u,fy:h,x:{value:f,reduce:d,zero:p,...y},y:{value:m,reduce:g,zero:b,...w},color:{value:_,color:x,reduce:v},size:{value:E,reduce:T},mark:k}=t;if(d===void 0&&(d=g==null&&f==null&&E==null&&m!=null?"count":null),g===void 0&&(g=d==null&&m==null&&E==null&&f!=null?"count":null),T===void 0&&E==null&&v==null&&d==null&&g==null&&(f==null||De(o))&&(m==null||De(a))&&(T="count"),p===void 0&&(p=Uu(d)?!0:void 0),b===void 0&&(b=Uu(g)?!0:void 0),f==null&&m==null)throw new Error("must specify x or y");if(d!=null&&m==null)throw new Error("reducing x requires y");if(g!=null&&f==null)throw new Error("reducing y requires x");k===void 0&&(k=E!=null||T!=null?"dot":Uu(d)||Uu(g)||v!=null?"bar":f!=null&&m!=null?De(o)||De(a)||d==null&&g==null&&!_c(o)&&!_c(a)?"dot":"line":f!=null||m!=null?"rule":null);let A,I,O;switch(k){case"dot":O=ys,I="stroke";break;case"line":O=o&&a||d!=null||g!=null?b||g!=null||o&&_c(o)?Zh:p||d!=null||a&&_c(a)?Jh:fb:o?Jh:Zh,I="stroke",H2(c)&&(A=null);break;case"area":O=!(b||g!=null)&&(p||d!=null||a&&_c(a))?Xh:_l,I="fill",H2(c)&&(A=null);break;case"rule":O=o?Jr:Zr,I="stroke";break;case"bar":O=b?To(d,o)?ea:qc:p?To(g,a)?ta:jc:To(d,o)&&To(g,a)?Qh:To(d,o)?ea:To(g,a)?ta:d!=null?jc:g!=null?qc:v!=null?hb:Qh,I="fill";break;default:throw new Error(`invalid mark: ${k}`)}let F={fx:u,fy:h,x:o??void 0,y:a??void 0,[I]:c??x,z:A,r:l??void 0,tip:!0},S,M={[I]:v??void 0,r:T??void 0};if(d!=null&&g!=null)throw new Error("cannot reduce both x and y");return g!=null?(M.y=g,S=De(o)?ml:kr):d!=null?(M.x=d,S=De(a)?gl:Or):(v!=null||T!=null)&&(o&&a?S=De(o)&&De(a)?S1:De(o)?Or:De(a)?kr:Is:o?S=De(o)?ml:kr:a&&(S=De(a)?gl:Or)),(S===Is||S===kr)&&(F.x={value:o,...y}),(S===Is||S===Or)&&(F.y={value:a,...w}),p===void 0&&(p=o&&!(S===Is||S===kr)&&(O===ta||O===Xh||O===jc||O===Zr)),b===void 0&&(b=a&&!(S===Is||S===Or)&&(O===ea||O===_l||O===qc||O===Jr)),{fx:u??null,fy:h??null,x:{value:f??null,reduce:d??null,zero:!!p,...y},y:{value:m??null,reduce:g??null,zero:!!b,...w},color:{value:_??null,reduce:v??null,...x!==void 0&&{color:x}},size:{value:E??null,reduce:T??null},mark:k,markImpl:X2[O],markOptions:F,transformImpl:X2[S],transformOptions:M,colorMode:I}}function SY(e,t){const n=s6(e,t),{fx:i,fy:r,x:{zero:s},y:{zero:o},markOptions:a,transformOptions:c,colorMode:l}=n,u=vm[n.markImpl],h=vm[n.transformImpl],f=i!=null||r!=null?K1({strokeOpacity:.1}):null,d=[s?Jr([0]):null,o?Zr([0]):null],p=u(e,h?h(c,a):a);return l==="stroke"?pr(f,d,p):pr(f,p,d)}function _c(e){let t,n;for(const i of e){if(i==null)continue;if(t===void 0){t=i;continue}const r=Math.sign(ue(t,i));if(r){if(n!==void 0&&r!==n)return!1;t=i,n=r}}return!0}function EY({x:e,y:t,color:n,size:i,fx:r,fy:s,mark:o}={}){return li(e)||(e=Ao(e)),li(t)||(t=Ao(t)),li(n)||(n=Hl(n)?{color:n}:Ao(n)),li(i)||(i=Ao(i)),li(r)&&({value:r}=Ao(r)),li(s)&&({value:s}=Ao(s)),o!=null&&(o=`${o}`.toLowerCase()),{x:e,y:t,color:n,size:i,fx:r,fy:s,mark:o}}function Pu(e,t){const n=Et(e,t.value);return n&&(n.label=_r(t.value)),n}function Ao(e){return TY(e)?{reduce:e}:{value:e}}function Uu(e){return/^(?:distinct|count|sum|proportion)$/i.test(e)}function AY(e){return/^(?:first|last|mode)$/i.test(e)}function To(e,t){return e!=null&&!AY(e)||!t?!1:De(t)}function TY(e){if(e==null)return!1;if(typeof e.reduceIndex=="function"||typeof e.reduce=="function"&&ni(e)||/^p\d{2}$/i.test(e))return!0;switch(`${e}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}function H2(e){return e?new _d(e).size>e.length>>1:!1}const vm={dot:ys,line:fb,lineX:Jh,lineY:Zh,areaX:Xh,areaY:_l,ruleX:Jr,ruleY:Zr,barX:ta,barY:ea,rect:hb,rectX:jc,rectY:qc,cell:Qh,bin:Is,binX:kr,binY:Or,group:S1,groupX:ml,groupY:gl},X2=Object.fromEntries(Object.entries(vm).map(([e,t])=>[t,e]));function db(e,t={}){let{x:n,x1:i,x2:r}=t;n===void 0&&i===void 0&&r===void 0&&(t={...t,x:n=ot});const s={};return n!=null&&(s.x=e),i!=null&&(s.x1=e),r!=null&&(s.x2=e),eu(s,t)}function pb(e,t={}){let{y:n,y1:i,y2:r}=t;n===void 0&&i===void 0&&r===void 0&&(t={...t,y:n=ot});const s={};return n!=null&&(s.y=e),i!=null&&(s.y1=e),r!=null&&(s.y2=e),eu(s,t)}function eu(e={},t={}){const n=hs(t),i=Object.entries(e).map(([r,s])=>{const o=HI(r,t);if(o==null)throw new Error(`missing channel: ${r}`);const[a,c]=yn(o);return{key:r,input:o,output:a,setOutput:c,map:IY(s)}});return{...Ci(t,(r,s)=>{const o=Et(r,n),a=i.map(({input:l})=>Et(r,l)),c=i.map(({setOutput:l})=>l(new Array(r.length)));for(const l of s)for(const u of o?br(l,h=>o[h]).values():[l])i.forEach(({map:h},f)=>h.mapIndex(u,a[f],c[f]));return{data:r,facets:s}}),...Object.fromEntries(i.map(({key:r,output:s})=>[r,s]))}}function IY(e){if(e==null)throw new Error("missing map");if(typeof e.mapIndex=="function")return e;if(typeof e.map=="function"&&ni(e))return MY(e);if(typeof e=="function")return Vy(d1(e));switch(`${e}`.toLowerCase()){case"cumsum":return $Y;case"rank":return Vy((t,n)=>JS(t,i=>n[i]));case"quantile":return Vy((t,n)=>NY(t,i=>n[i]))}throw new Error(`invalid map: ${e}`)}function MY(e){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:e.map.bind(e)}}function NY(e,t){const n=bd(e,t)-1;return JS(e,t).map(i=>i/n)}function Vy(e){return{mapIndex(t,n,i){const r=e(t,n);if(r.length!==t.length)throw new Error("map function returned a mismatched length");for(let s=0,o=t.length;s<o;++s)i[t[s]]=r[s]}}}const $Y={mapIndex(e,t,n){let i=0;for(const r of e)n[r]=i+=t[r]}},kY={ariaLabel:"tick",fill:null,stroke:"currentColor"};class o6 extends Vt{constructor(t,n,i){super(t,n,i,kY),Va(this,i)}render(t,n,i,r,s){return Ft("svg:g",s).call(Zt,this,r,s).call(this._transform,this,n).call(o=>o.selectAll().data(t).enter().append("line").call(Qt,this).attr("x1",this._x1(n,i,r)).attr("x2",this._x2(n,i,r)).attr("y1",this._y1(n,i,r)).attr("y2",this._y2(n,i,r)).call(ge,this,i).call(Jl,this,i,s)).node()}}class a6 extends o6{constructor(t,n={}){const{x:i,y:r,inset:s=0,insetTop:o=s,insetBottom:a=s}=n;super(t,{x:{value:i,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},n),this.insetTop=Tt(o),this.insetBottom=Tt(a)}_transform(t,n,{x:i}){t.call(Yt,n,{x:i},Te,0)}_x1(t,{x:n}){return i=>n[i]}_x2(t,{x:n}){return i=>n[i]}_y1({y:t},{y:n},{marginTop:i}){const{insetTop:r}=this;return n&&t?s=>n[s]+r:i+r}_y2({y:t},{y:n},{height:i,marginBottom:r}){const{insetBottom:s}=this;return n&&t?o=>n[o]+t.bandwidth()-s:i-r-s}}class c6 extends o6{constructor(t,n={}){const{x:i,y:r,inset:s=0,insetRight:o=s,insetLeft:a=s}=n;super(t,{y:{value:r,scale:"y"},x:{value:i,scale:"x",type:"band",optional:!0}},n),this.insetRight=Tt(o),this.insetLeft=Tt(a)}_transform(t,n,{y:i}){t.call(Yt,n,{y:i},0,Te)}_x1({x:t},{x:n},{marginLeft:i}){const{insetLeft:r}=this;return n&&t?s=>n[s]+r:i+r}_x2({x:t},{x:n},{width:i,marginRight:r}){const{insetRight:s}=this;return n&&t?o=>n[o]+t.bandwidth()-s:i-r-s}_y1(t,{y:n}){return i=>n[i]}_y2(t,{y:n}){return i=>n[i]}}function l6(e,{x:t=ot,...n}={}){return new a6(e,{...n,x:t})}function u6(e,{y:t=ot,...n}={}){return new c6(e,{...n,y:t})}function OY(e,{x:t=ot,y:n=null,fill:i="#ccc",fillOpacity:r,stroke:s="currentColor",strokeOpacity:o,strokeWidth:a=2,sort:c,...l}={}){const u=n!=null?gl:x1;return pr(Zr(e,u({x1:yb,x2:mb},{x:t,y:n,stroke:s,strokeOpacity:o,...l})),ta(e,u({x1:"p25",x2:"p75"},{x:t,y:n,fill:i,fillOpacity:r,...l})),l6(e,u({x:"p50"},{x:t,y:n,stroke:s,strokeOpacity:o,strokeWidth:a,sort:c,...l})),ys(e,eu({x:f6},{x:t,y:n,z:n,stroke:s,strokeOpacity:o,...l})))}function LY(e,{y:t=ot,x:n=null,fill:i="#ccc",fillOpacity:r,stroke:s="currentColor",strokeOpacity:o,strokeWidth:a=2,sort:c,...l}={}){const u=n!=null?ml:x1;return pr(Jr(e,u({y1:yb,y2:mb},{x:n,y:t,stroke:s,strokeOpacity:o,...l})),ea(e,u({y1:"p25",y2:"p75"},{x:n,y:t,fill:i,fillOpacity:r,...l})),u6(e,u({y:"p50"},{x:n,y:t,stroke:s,strokeOpacity:o,strokeWidth:a,sort:c,...l})),ys(e,eu({y:f6},{x:n,y:t,z:n,stroke:s,strokeOpacity:o,...l})))}function f6(e){const t=yb(e),n=mb(e);return e.map(i=>i<t||i>n?i:NaN)}function yb(e){const t=h6(e)*2.5-d6(e)*1.5;return xe(e,n=>n>=t?n:NaN)}function mb(e){const t=d6(e)*2.5-h6(e)*1.5;return oe(e,n=>n<=t?n:NaN)}function h6(e){return Xr(e,.25)}function d6(e){return Xr(e,.75)}const RY={ariaLabel:"raster",stroke:null,pixelSize:1};function Io(e,t){const n=+e;if(isNaN(n))throw new Error(`invalid ${t}: ${e}`);return n}function K2(e,t){const n=Math.floor(e);if(isNaN(n))throw new Error(`invalid ${t}: ${e}`);return n}class p6 extends Vt{constructor(t,n,i={},r){let{width:s,height:o,x:a,y:c,x1:l=a==null?0:void 0,y1:u=c==null?0:void 0,x2:h=a==null?s:void 0,y2:f=c==null?o:void 0,pixelSize:d=r.pixelSize,blur:p=0,interpolate:y}=i;if(s!=null&&(s=K2(s,"width")),o!=null&&(o=K2(o,"height")),l!=null&&(l=Io(l,"x1")),u!=null&&(u=Io(u,"y1")),h!=null&&(h=Io(h,"x2")),f!=null&&(f=Io(f,"y2")),a==null&&(l==null||h==null))throw new Error("missing x");if(c==null&&(u==null||f==null))throw new Error("missing y");t!=null&&s!=null&&o!=null&&(a===void 0&&l!=null&&h!=null&&(a=qY(l,h,s)),c===void 0&&u!=null&&f!=null&&(c=YY(u,f,s,o))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:c,scale:"y",optional:!0},x1:{value:l==null?null:[l],scale:"x",optional:!0,filter:null},y1:{value:u==null?null:[u],scale:"y",optional:!0,filter:null},x2:{value:h==null?null:[h],scale:"x",optional:!0,filter:null},y2:{value:f==null?null:[f],scale:"y",optional:!0,filter:null},...n},i,r),this.width=s,this.height=o,this.pixelSize=Io(d,"pixelSize"),this.blur=Io(p,"blur"),this.interpolate=a==null||c==null?null:DY(y)}}class y6 extends p6{constructor(t,n={}){const{imageRendering:i}=n;if(t==null){const{fill:r,fillOpacity:s}=n;le(s)[0]!==void 0&&(n=xm("fillOpacity",n)),nn(r)[0]!==void 0&&(n=xm("fill",n))}super(t,void 0,n,RY),this.imageRendering=ae(i,"auto")}scale(t,{color:n,...i},r){return super.scale(t,i,r)}render(t,n,i,r,s){var M;const o=n[(M=i.channels.fill)==null?void 0:M.scale]??(N=>N),{x:a,y:c}=i,{document:l}=s,[u,h,f,d]=g6(i,r,s),p=f-u,y=d-h,{pixelSize:m,width:g=Math.round(Math.abs(p)/m),height:b=Math.round(Math.abs(y)/m)}=this,w=g*b;let{fill:_,fillOpacity:x}=i,v=0;if(this.interpolate){const N=g/p,$=b/y,D=Ht(a,B=>(B-u)*N,Float64Array),C=Ht(c,B=>(B-h)*$,Float64Array);_&&(_=this.interpolate(t,g,b,D,C,_)),x&&(x=this.interpolate(t,g,b,D,C,x))}else this.data==null&&t&&(v=t.fi*w);const E=l.createElement("canvas");E.width=g,E.height=b;const T=E.getContext("2d"),k=T.createImageData(g,b),A=k.data;let{r:I,g:O,b:F}=Dn(this.fill)??{r:0,g:0,b:0},S=(this.fillOpacity??1)*255;for(let N=0;N<w;++N){const $=N<<2;if(_){const D=o(_[N+v]);if(D==null){A[$+3]=0;continue}({r:I,g:O,b:F}=Dn(D))}x&&(S=x[N+v]*255),A[$+0]=I,A[$+1]=O,A[$+2]=F,A[$+3]=S}return this.blur>0&&KL(k,this.blur),T.putImageData(k,0,0),Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(N=>N.append("image").attr("transform",`translate(${u},${h}) scale(${Math.sign(f-u)},${Math.sign(d-h)})`).attr("width",Math.abs(p)).attr("height",Math.abs(y)).attr("preserveAspectRatio","none").call(et,"image-rendering",this.imageRendering).call(Qt,this).attr("xlink:href",E.toDataURL())).node()}}function m6(e,t,n){arguments.length<3&&(n=t,t=null);let{x:i,y:r,[e]:s,...o}=n;return i===void 0&&r===void 0&&SU(t)&&(i=Wl,r=yl,s===void 0&&(s=wU)),[t,{...o,x:i,y:r,[e]:s}]}function FY(){const[e,t]=m6("fill",...arguments);return new y6(e,e==null||t.fill!==void 0||t.fillOpacity!==void 0?t:{...t,fill:ot})}function g6({x1:e,y1:t,x2:n,y2:i},r,{projection:s}){const{width:o,height:a,marginTop:c,marginRight:l,marginBottom:u,marginLeft:h}=r;return[e&&s==null?e[0]:h,t&&s==null?t[0]:c,n&&s==null?n[0]:o-l,i&&s==null?i[0]:a-u]}function b6({x1:e,y1:t,x2:n,y2:i},r,s,o){const a={};return e&&(a.x1=e),t&&(a.y1=t),n&&(a.x2=n),i&&(a.y2=i),g6($1(a,r),s,o)}function xm(e,t={}){const{[e]:n}=t;if(typeof n!="function")throw new Error(`invalid ${e}: not a function`);return sn({...t,[e]:void 0},function(i,r,s,o,a,c){const{x:l,y:u}=o;if(!l)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[h,f,d,p]=b6(s,o,a,c),y=d-h,m=p-f,{pixelSize:g}=this,{width:b=Math.round(Math.abs(y)/g),height:w=Math.round(Math.abs(m)/g)}=t,_=new Array(b*w*(r?r.length:1)),x=y/b,v=m/w;let E=0;for(const T of r??[void 0])for(let k=.5;k<w;++k)for(let A=.5;A<b;++A,++E)_[E]=n(l.invert(h+A*x),u.invert(f+k*v),T);return{data:_,facets:r,channels:{[e]:{value:_,scale:"auto"}}}})}function DY(e){if(typeof e=="function")return e;if(e==null)return Sm;switch(`${e}`.toLowerCase()){case"none":return Sm;case"nearest":return _6;case"barycentric":return w6();case"random-walk":return v6()}throw new Error(`invalid interpolate: ${e}`)}function Sm(e,t,n,i,r,s){const o=new Array(t*n);for(const a of e)i[a]<0||i[a]>=t||r[a]<0||r[a]>=n||(o[Math.floor(r[a])*t+Math.floor(i[a])]=s[a]);return o}function w6({random:e=Qg(42)}={}){return(t,n,i,r,s,o)=>{const{points:a,triangles:c,hull:l}=ls.from(t,d=>r[d],d=>s[d]),u=new o.constructor(n*i).fill(NaN),h=new Uint8Array(n*i),f=jY(o,e);for(let d=0;d<c.length;d+=3){const p=c[d],y=c[d+1],m=c[d+2],g=a[2*p],b=a[2*y],w=a[2*m],_=a[2*p+1],x=a[2*y+1],v=a[2*m+1],E=Math.min(g,b,w),T=Math.max(g,b,w),k=Math.min(_,x,v),A=Math.max(_,x,v),I=(x-v)*(g-w)+(_-v)*(w-b);if(!I)continue;const O=o[t[p]],F=o[t[y]],S=o[t[m]];for(let M=Math.floor(E);M<T;++M)for(let N=Math.floor(k);N<A;++N){if(M<0||M>=n||N<0||N>=i)continue;const $=M+.5,D=N+.5,C=((x-v)*($-w)+(D-v)*(w-b))/I;if(C<0)continue;const B=((v-_)*($-w)+(D-v)*(g-w))/I;if(B<0)continue;const z=1-C-B;if(z<0)continue;const j=M+n*N;u[j]=f(O,C,F,B,S,z,M,N),h[j]=1}}return CY(u,h,r,s,o,n,i,l,t,f),u}}function CY(e,t,n,i,r,s,o,a,c,l){n=Float64Array.from(a,d=>n[c[d]]),i=Float64Array.from(a,d=>i[c[d]]),r=Array.from(a,d=>r[c[d]]);const u=n.length,h=Array.from({length:u},(d,p)=>PY(p,n,i));let f=0;for(let d=0;d<o;++d){const p=d+.5;for(let y=0;y<s;++y){const m=y+s*d;if(!t[m]){const g=y+.5;for(let b=0;b<u;++b){const w=(u+f+(b%2?(b+1)/2:-b/2))%u;if(h[w](g,p)){const _=BY(n.at(w-1),i.at(w-1),n[w],i[w],g,p);e[m]=l(r.at(w-1),_,r[w],1-_,r[w],0,y,d),f=w;break}}}}}}function BY(e,t,n,i,r,s){const o=n-e,a=i-t,c=o*(n-r)+a*(i-s),l=o*(r-e)+a*(s-t);return c>0&&l>0?c/(c+l):+(c>l)}function vc(e,t,n,i){return e*i-n*t}function PY(e,t,n){const i=t.length,r=t.at(e-2),s=n.at(e-2),o=t.at(e-1),a=n.at(e-1),c=t[e],l=n[e],u=t.at(e+1-i),h=n.at(e+1-i),f=o-c,d=a-l,p=r-o,y=s-a,m=c-u,g=l-h,b=Math.hypot(f,d),w=Math.hypot(p,y),_=Math.hypot(m,g);return(x,v)=>{const E=x-o,T=v-a,k=x-c,A=v-l;return vc(E,T,k,A)>-1e-6&&vc(E,T,f,d)*w-vc(E,T,p,y)*b>-1e-6&&vc(k,A,m,g)*b-vc(k,A,f,d)*_<=0}}function _6(e,t,n,i,r,s){const o=new s.constructor(t*n),a=ls.from(e,u=>i[u],u=>r[u]);let c,l;for(let u=.5,h=0;u<n;++u){l=c;for(let f=.5;f<t;++f,++h)l=a.find(f,u,l),f===.5&&(c=l),o[h]=s[e[l]]}return o}function v6({random:e=Qg(42),minDistance:t=.5,maxSteps:n=2}={}){return(i,r,s,o,a,c)=>{const l=new c.constructor(r*s),u=ls.from(i,p=>o[p],p=>a[p]);let h,f,d;for(let p=.5,y=0;p<s;++p){f=h;for(let m=.5;m<r;++m,++y){let g=m,b=p;d=f=u.find(g,b,f),m===.5&&(h=f);let w,_=0;for(;(w=Math.hypot(o[i[d]]-g,a[i[d]]-b))>t&&_<n;){const x=e(m,p,_)*2*Math.PI;g+=Math.cos(x)*w,b+=Math.sin(x)*w,d=u.find(g,b,d),++_}l[y]=c[i[d]]}}return l}}function UY(e,t,n,i,r,s){return t*e+i*n+s*r}function zY(e){return(t,n,i,r,s,o,a,c)=>{const l=e(a,c);return l<n?t:l<n+r?i:s}}function jY(e,t){return QI(e)||Pn(e)?UY:zY(t)}function qY(e,t,n){return{transform(i){const r=i.length,s=new Float64Array(r),o=(t-e)/n,a=e+o/2;for(let c=0;c<r;++c)s[c]=c%n*o+a;return s}}}function YY(e,t,n,i){return{transform(r){const s=r.length,o=new Float64Array(s),a=(t-e)/i,c=e+a/2;for(let l=0;l<s;++l)o[l]=Math.floor(l/n)%i*a+c;return o}}}const Q2={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class x6 extends p6{constructor(t,{smooth:n=!0,value:i,...r}={}){const s=kM({},r,Q2);if(i===void 0){for(const a in s)if(s[a].value!=null){if(i!==void 0)throw new Error("ambiguous contour value");i=r[a],r[a]="value"}}if(i!=null){const a={transform:c=>c.map(l=>l.value),label:_r(i)};for(const c in s)r[c]==="value"&&(r[c]=a)}if(t==null){if(i==null)throw new Error("missing contour value");r=xm("value",{value:i,...r}),i=null}else{let{interpolate:a}=r;i===void 0&&(i=ot),a===void 0&&(r.interpolate="nearest")}super(t,{value:{value:i,optional:!0}},VY(r),Q2);const o={geometry:{value:ot}};for(const a in this.channels){const c=this.channels[a],{scale:l}=c;l==="x"||l==="y"||a==="value"||(o[a]=c,delete this.channels[a])}this.contourChannels=o,this.smooth=!!n}filter(t,{x:n,y:i,value:r,...s},o){return super.filter(t,s,o)}render(t,n,i,r,s){const{geometry:o}=i,a=us();return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(c=>{c.selectAll().data(t).enter().append("path").call(Qt,this).attr("d",l=>a(o[l])).call(ge,this,i)}).node()}}function VY({thresholds:e,interval:t,...n}){return e=j3(e,t,$g),sn(n,function(i,r,s,o,a,c){const[l,u,h,f]=b6(s,o,a,c),d=h-l,p=f-u,{pixelSize:y,width:m=Math.round(Math.abs(d)/y),height:g=Math.round(Math.abs(p)/y)}=this,b=m/d,w=g/p,_=s.value.value,x=[];if(this.interpolate){const{x:A,y:I}=op(s,o,c),O=Ht(A,N=>(N-l)*b,Float64Array),F=Ht(I,N=>(N-u)*w,Float64Array),S=[s.x,s.y,s.value],M=[O,F,_];for(const N of r){const $=this.filter(N,S,M);x.push(this.interpolate($,m,g,O,F,_))}}else if(r){const A=m*g,I=r.length;for(let O=0;O<I;++O)x.push(_.slice(O*A,O*A+A))}else x.push(_);if(this.blur>0)for(const A of x)zS({data:A,width:m,height:g},this.blur);const v=WY(e,_,...HY(x));if(v===null)throw new Error(`unsupported thresholds: ${e}`);const{contour:E}=sh().size([m,g]).smooth(this.smooth),T=[],k=[];for(const A of x)k.push(dn(T.length,T.push(...Ht(v,I=>E(A,I)))));for(const{coordinates:A}of T)for(const I of A)for(const O of I)for(const F of O)F[0]=F[0]/b+l,F[1]=F[1]/w+u;return{data:T,facets:k,channels:rM(this.contourChannels,T)}})}function WY(e,t,n,i){if(typeof(e==null?void 0:e.range)=="function")return e.range(e.floor(n),i);if(typeof e=="function"&&(e=e(t,n,i)),typeof e!="number")return rn(e);const r=Hr(...GS(n,i,e),e);for(;r[r.length-1]>=i;)r.pop();for(;r[1]<n;)r.shift();return r}function GY(){return new x6(...m6("value",...arguments))}function HY(e){return[xe(e,t=>xe(t,J2)),oe(e,t=>oe(t,J2))]}function J2(e){return isFinite(e)?e:NaN}function XY(e,t){return gb(j1,e,t)}function KY(e,t={}){return gb(q1,e,t)}function QY(e,t={}){return gb(Y1,e,t)}function gb(e,t,n={}){const{x:i,y:r,maxRadius:s}=n,o=e({px:i,py:r,maxRadius:s}),a=[];i!=null&&a.push(Jr(t,Z2("x",{...o,inset:-6},n))),r!=null&&a.push(Zr(t,Z2("y",{...o,inset:-6},n))),i!=null&&a.push($a(t,tv("x",{...o,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),r!=null&&a.push($a(t,tv("y",{...o,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const c of a)c.ariaLabel=`crosshair ${c.ariaLabel}`;return pr(...a)}function S6(e,{channels:t,...n},{facet:i,facetAnchor:r,fx:s,fy:o,[e]:a,channels:c,transform:l,initializer:u}){return{...n,facet:i,facetAnchor:r,fx:s,fy:o,[e]:a,channels:{...t,...c},transform:l,initializer:JY(e,u)}}function JY(e,t){return t==null?t:function(n,i,{x:r,y:s,px:o,py:a,...c},...l){const{channels:{x:u,y:h,...f}={},...d}=t.call(this,n,i,{...c,x:o,y:a},...l);return{channels:{...f,...u&&{px:u,...e==="x"&&{x:u}},...h&&{py:h,...e==="y"&&{y:h}}},...d}}}function Z2(e,t,n){const{color:i="currentColor",opacity:r=.2,ruleStroke:s=i,ruleStrokeOpacity:o=r,ruleStrokeWidth:a}=n;return{...S6(e,t,n),stroke:s,strokeOpacity:o,strokeWidth:a}}function tv(e,t,n){const{color:i="currentColor",textFill:r=i,textFillOpacity:s,textStroke:o="white",textStrokeOpacity:a,textStrokeWidth:c=5}=n;return{...S6(e,t,ZY(e,n)),fill:r,fillOpacity:s,stroke:o,strokeOpacity:a,strokeWidth:c}}function ZY(e,t){return sn(t,(n,i,r)=>{var s;return{channels:{text:{value:(s=cM(r,e))==null?void 0:s.value}}}})}const tV={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},eV={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},nV={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},iV={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},rV={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class sV extends Vt{constructor(t,n={}){const{x:i,y:r,z:s,curve:o,tension:a}=n;super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:s,optional:!0}},n,tV),this.curve=Z1(o,a),Va(this,n)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,z:u}=i,{curve:h}=this,[f,d]=Bi(this,r),p=c?b=>c[b]:Bn(f),y=l?b=>l[b]:Bn(d),m=this;function g(b){let w=-1;const _=[],x={};for(const S in i)x[S]=[];const v=[],E=[],T=[],k=[];function A(S,M){S=b[S],M=b[M],_.push(++w),v[w]=p(S),T[w]=y(S),E[w]=p(M),k[w]=y(M);for(const N in i)x[N].push(i[N][M])}const{halfedges:I,hull:O,triangles:F}=ls.from(b,p,y);for(let S=0;S<I.length;++S){const M=I[S];M>S&&A(F[S],F[M])}for(let S=0;S<O.length;++S)A(O[S],O[(S+1)%O.length]);zt(this).selectAll().data(_).enter().append("path").call(Qt,m).attr("d",S=>{const M=tr(),N=h(M);return N.lineStart(),N.point(v[S],T[S]),N.point(E[S],k[S]),N.lineEnd(),M}).call(ge,m,x).call(Jl,m,x,s)}return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(u?b=>b.selectAll().data(br(t,w=>u[w]).values()).enter().append("g").each(g):b=>b.datum(t).each(g)).node()}}class bb extends Vt{constructor(t,n={},i,r=({z:s})=>s){const{x:s,y:o}=n;super(t,{x:{value:s,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:r(n),optional:!0}},n,i)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,z:u}=i,[h,f]=Bi(this,r),d=c?g=>c[g]:Bn(h),p=l?g=>l[g]:Bn(f),y=this;function m(g){const b=ls.from(g,d,p);zt(this).append("path").datum(g[0]).call(Qt,y).attr("d",y._render(b,r)).call(ge,y,i)}return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(u?g=>g.selectAll().data(br(t,b=>u[b]).values()).enter().append("g").each(m):g=>g.datum(t).each(m)).node()}}class oV extends bb{constructor(t,n={}){super(t,n,eV),this.fill="none"}_render(t){return t.render()}}class aV extends bb{constructor(t,n={}){super(t,n,nV,hs)}_render(t){return t.renderHull()}}class cV extends Vt{constructor(t,n={}){const{x:i,y:r,z:s}=n;super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:s,optional:!0}},n,iV)}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,z:u}=i,[h,f]=Bi(this,r),d=c?g=>c[g]:Bn(h),p=l?g=>l[g]:Bn(f),y=this;function m(g){const b=ls.from(g,d,p),w=E6(b,r);zt(this).selectAll().data(g).enter().append("path").call(Qt,y).attr("d",(_,x)=>w.renderCell(x)).call(ge,y,i)}return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(u?g=>g.selectAll().data(br(t,b=>u[b]).values()).enter().append("g").each(m):g=>g.datum(t).each(m)).node()}}class lV extends bb{constructor(t,n){super(t,n,rV),this.fill="none"}_render(t,n){return E6(t,n).render()}}function E6(e,t){const{width:n,height:i,marginTop:r,marginRight:s,marginBottom:o,marginLeft:a}=t;return e.voronoi([a,r,n-s,i-o])}function nu(e,t,{x:n,y:i,...r}={}){return[n,i]=ii(n,i),new e(t,{...r,x:n,y:i})}function uV(e,t){return nu(sV,e,t)}function fV(e,t){return nu(oV,e,t)}function hV(e,t){return nu(aV,e,t)}function dV(e,t){return nu(cV,e,t)}function pV(e,t){return nu(lV,e,t)}const yV={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class A6 extends Vt{constructor(t,{x:n,y:i,z:r,weight:s,fill:o,stroke:a,...c}={}){const l=ev(o)&&(o="currentColor",!0),u=ev(a)&&(a="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:hs({z:r,fill:o,stroke:a}),optional:!0},weight:{value:s,optional:!0}},bV({...c,fill:o,stroke:a},l,u),yV),l&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=r}filter(t){return t}render(t,n,i,r,s){const{contours:o}=i,a=us();return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{}).call(c=>c.selectAll().data(t).enter().append("path").call(Qt,this).call(ge,this,i).attr("d",l=>a(o[l]))).node()}}function mV(e,{x:t,y:n,...i}={}){return[t,n]=ii(t,n),new A6(e,{...i,x:t,y:n})}const gV=new Set(["x","y","z","weight"]);function bV(e,t,n){let{bandwidth:r,thresholds:s}=e;return r=r===void 0?20:+r,s=s===void 0?20:typeof(s==null?void 0:s[Symbol.iterator])=="function"?Qe(s):+s,sn(e,function(o,a,c,l,u,h){var F;const f=c.weight?Qe(c.weight.value):null,d=(F=c.z)==null?void 0:F.value,{z:p}=this,[y,m]=Bi(this,u),{width:g,height:b}=u,{x:w,y:_}=op(c,l,h),x=Object.fromEntries(Object.entries(c).filter(([S])=>!gV.has(S)).map(([S,M])=>[S,{...M,value:[]}])),v=t&&[],E=n&&[],T=kC().x(w?S=>w[S]:y).y(_?S=>_[S]:m).weight(f?S=>f[S]:1).size([g,b]).bandwidth(r),k=[];for(const S of a){const M=[];k.push(M);for(const N of d?C1(S,d,p):[S]){const $=T.contours(N);M.push([N,$])}}let A=s;if(!(A instanceof Ia)){let S=0;for(const M of k)for(const[,N]of M){const $=N.max;$>S&&(S=$)}A=Float64Array.from({length:s-1},(M,N)=>S*100*(N+1)/s)}const I=[],O=[];for(const S of k){const M=[];I.push(M);for(const[N,$]of S)for(const D of A){M.push(O.length),O.push($(D/100)),v&&v.push(D),E&&E.push(D);for(const C in x)x[C].value.push(c[C].value[N[0]])}}return v&&v.push(0),E&&E.push(0),{data:o,facets:I,channels:{...x,...v&&{fill:{value:v,scale:"color"}},...E&&{stroke:{value:E,scale:"color"}},contours:{value:O}}}})}function ev(e){return/^density$/i.test(e)}const wV={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class T6 extends Vt{constructor(t,n={}){const[i,r]=le(n.r,3);super(t,{geometry:{value:n.geometry,scale:"projection"},r:{value:i,scale:"r",filter:cr,optional:!0}},ub(n),wV),this.r=r}render(t,n,i,r,s){const{geometry:o,r:a}=i,c=us(s.projection??_V(n)),{r:l}=this;return Xd(l)?t=[]:l!==void 0&&c.pointRadius(l),Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(u=>{u.selectAll().data(t).enter().append("path").call(Qt,this).attr("d",a?h=>c.pointRadius(a[h])(o[h]):h=>c(o[h])).call(ge,this,i)}).node()}}function _V({x:e,y:t}){if(e||t)return e??(e=n=>n),t??(t=n=>n),Th({point(n,i){this.stream.point(e(n),t(i))}})}function wb(e,{geometry:t=ot,...n}={}){switch(e==null?void 0:e.type){case"FeatureCollection":e=e.features;break;case"GeometryCollection":e=e.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":e=[e];break}return new T6(e,{geometry:t,...n})}function vV({strokeWidth:e=1.5,...t}={}){return wb({type:"Sphere"},{strokeWidth:e,...t})}function xV({strokeOpacity:e=.1,...t}={}){return wb(T7(),{strokeOpacity:e,...t})}const Yc=.5,Vc=0;function SV(e={fill:"count"},{binWidth:t,...n}={}){const{z:i}=n;return t=t===void 0?20:Tt(t),e=E1(e,n),Rr(e,"fill")&&(n.channels={...n.channels,fill:{value:[]}}),n.symbol===void 0&&(n.symbol="hexagon"),n.r===void 0&&!Rr(e,"r")&&(n.r=t/2),sn(n,(r,s,o,a,c,l)=>{let{x:u,y:h,z:f,fill:d,stroke:p,symbol:y}=o;if(u===void 0)throw new Error("missing channel: x");if(h===void 0)throw new Error("missing channel: y");({x:u,y:h}=op(o,a,l)),f=f?f.value:Et(r,i),d=d==null?void 0:d.value,p=p==null?void 0:p.value,y=y==null?void 0:y.value;const m=I1(e,{z:f,fill:d,stroke:p,symbol:y}),g=f&&[],b=d&&[],w=p&&[],_=y&&[],x=[],v=[],E=[];let T=-1;for(const O of e)O.initialize(r);for(const O of s){const F=[];for(const S of e)S.scope("facet",O);for(const[S,M]of Jo(O,m))for(const N of EV(M,u,h,t)){F.push(++T),v.push(N.x),E.push(N.y),f&&g.push(m===f?S:f[N[0]]),d&&b.push(m===d?S:d[N[0]]),p&&w.push(m===p?S:p[N[0]]),y&&_.push(m===y?S:y[N[0]]);for(const $ of e)$.reduce(N)}x.push(F)}const k=o.x.scale,A=o.y.scale,I={x:{value:v,source:a[k]?{value:Ht(v,a[k].invert),scale:k}:null},y:{value:E,source:a[A]?{value:Ht(E,a[A].invert),scale:A}:null},...f&&{z:{value:g}},...d&&{fill:{value:b,scale:"auto"}},...p&&{stroke:{value:w,scale:"auto"}},...y&&{symbol:{value:_,scale:"auto"}},...Object.fromEntries(e.map(({name:O,output:F})=>[O,{scale:"auto",label:F.label,radius:O==="r"?t/2:void 0,value:F.transform()}]))};return{data:r,facets:x,channels:I}})}function EV(e,t,n,i){const r=i*(1.5/ZI),s=new Map;for(const o of e){let a=t[o],c=n[o];if(isNaN(a)||isNaN(c))continue;let l=Math.round(c=(c-Vc)/r),u=Math.round(a=(a-Yc)/i-(l&1)/2),h=c-l;if(Math.abs(h)*3>1){let p=a-u,y=u+(a<u?-1:1)/2,m=l+(c<l?-1:1),g=a-y,b=c-m;p*p+h*h>g*g+b*b&&(u=y+(l&1?1:-1)/2,l=m)}const f=`${u},${l}`;let d=s.get(f);d===void 0&&(s.set(f,d=[]),d.x=(u+(l&1)/2)*i+Yc,d.y=l*r+Vc),d.push(o)}return s.values()}const AV={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function TV(e){return new I6(e)}class I6 extends Vt{constructor({binWidth:t=20,clip:n=!0,...i}={}){super(zc,void 0,{clip:n,...i},AV),this.binWidth=Tt(t)}render(t,n,i,r,s){const{binWidth:o}=this,{marginTop:a,marginRight:c,marginBottom:l,marginLeft:u,width:h,height:f}=r,d=u-Yc,p=h-c-Yc,y=a-Vc,m=f-l-Vc,g=o/2,b=g*tM,w=b/2,_=g*2,x=b*1.5,v=Math.floor(d/_),E=Math.ceil(p/_),T=Math.floor((y+w)/x),k=Math.ceil((m-w)/x)+1,A=`m0,${Sr(-b)}l${Sr(g)},${Sr(w)}v${Sr(b)}l${Sr(-g)},${Sr(w)}`;let I=A;for(let O=T;O<k;++O)for(let F=v;F<E;++F)I+=`M${Sr(F*_+(O&1)*g)},${Sr(O*x)}${A}`;return Ft("svg:g",s).datum(0).call(Zt,this,r,s).call(Yt,this,{},Te+Yc,Te+Vc).call(O=>O.append("path").call(Qt,this).call(ge,this,i).attr("d",I)).node()}}function Sr(e){return Math.round(e*1e3)/1e3}const IV={ariaLabel:"image",fill:null,stroke:null};function MV(e){return/^\.*\//.test(e)}function NV(e){return/^(blob|data|file|http|https):/i.test(e)}function $V(e){return typeof e=="string"&&(MV(e)||NV(e))?[void 0,e]:[e,void 0]}class M6 extends Vt{constructor(t,n={}){let{x:i,y:r,r:s,width:o,height:a,rotate:c,src:l,preserveAspectRatio:u,crossOrigin:h,frameAnchor:f,imageRendering:d}=n;s==null&&(s=void 0),s===void 0&&o===void 0&&a===void 0?o=a=16:o===void 0&&a!==void 0?o=a:a===void 0&&o!==void 0&&(a=o);const[p,y]=$V(l),[m,g]=le(s),[b,w]=le(o,g!==void 0?g*2:void 0),[_,x]=le(a,g!==void 0?g*2:void 0),[v,E]=le(c,0);super(t,{x:{value:i,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:m,scale:"r",filter:cr,optional:!0},width:{value:b,filter:cr,optional:!0},height:{value:_,filter:cr,optional:!0},rotate:{value:v,optional:!0},src:{value:p,optional:!0}},ub(n),IV),this.src=y,this.width=w,this.rotate=E,this.height=x,this.r=g,this.preserveAspectRatio=ae(u,"xMidYMid"),this.crossOrigin=ke(h),this.frameAnchor=Xl(f),this.imageRendering=ae(d,"auto")}render(t,n,i,r,s){const{x:o,y:a}=n,{x:c,y:l,width:u,height:h,r:f,rotate:d,src:p}=i,{r:y,width:m,height:g,rotate:b}=this,[w,_]=Bi(this,r);return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,{x:c&&o,y:l&&a}).call(x=>x.selectAll().data(t).enter().append("image").call(Qt,this).attr("x",nv(c,u,f,w,m,y)).attr("y",nv(l,h,f,_,g,y)).attr("width",u?v=>u[v]:m!==void 0?m:f?v=>f[v]*2:y*2).attr("height",h?v=>h[v]:g!==void 0?g:f?v=>f[v]*2:y*2).attr("transform",d?v=>`rotate(${d[v]})`:b?`rotate(${b})`:null).attr("transform-origin",d||b?fp`${c?v=>c[v]:w}px ${l?v=>l[v]:_}px`:null).call(et,"href",p?v=>p[v]:this.src).call(et,"preserveAspectRatio",this.preserveAspectRatio).call(et,"crossorigin",this.crossOrigin).call(et,"image-rendering",this.imageRendering).call(et,"clip-path",f?v=>`circle(${f[v]}px)`:y!==void 0?`circle(${y}px)`:null).call(ge,this,i)).node()}}function nv(e,t,n,i,r,s){return t&&e?o=>e[o]-t[o]/2:t?o=>i-t[o]/2:e&&r!==void 0?o=>e[o]-r/2:r!==void 0?i-r/2:n&&e?o=>e[o]-n[o]:n?o=>i-n[o]:e?o=>e[o]-s:i-s}function kV(e,{x:t,y:n,...i}={}){return i.frameAnchor===void 0&&([t,n]=ii(t,n)),new M6(e,{...i,x:t,y:n})}function OV(e,t,n){var i=1e-8,r=t-1,s=n-1,o=0,a,c,l,u,h,f,d,p,y,m,g;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(l=e<.5?e:1-e,u=Math.sqrt(-2*Math.log(l)),d=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,e<.5&&(d=-d),p=(d*d-3)/6,y=2/(1/(2*t-1)+1/(2*n-1)),m=d*Math.sqrt(p+y)/y-(1/(2*n-1)-1/(2*t-1))*(p+5/6-2/(3*y)),d=t/(t+n*Math.exp(2*m))):(a=Math.log(t/(t+n)),c=Math.log(n/(t+n)),u=Math.exp(t*a)/t,h=Math.exp(n*c)/n,m=u+h,e<u/m?d=Math.pow(t*m*e,1/t):d=1-Math.pow(n*m*(1-e),1/n)),g=-na(t)-na(n)+na(t+n);o<10;o++){if(d===0||d===1)return d;if(f=LV(d,t,n)-e,u=Math.exp(r*Math.log(d)+s*Math.log(1-d)+g),h=f/u,d-=u=h/(1-.5*Math.min(1,h*(r/d-s/(1-d)))),d<=0&&(d=.5*(d+u)),d>=1&&(d=.5*(d+u+1)),Math.abs(u)<i*d&&o>0)break}return d}function LV(e,t,n){var i=e===0||e===1?0:Math.exp(na(t+n)-na(t)-na(n)+t*Math.log(e)+n*Math.log(1-e));return e<0||e>1?!1:e<(t+1)/(t+n+2)?i*iv(e,t,n)/t:1-i*iv(1-e,n,t)/n}function iv(e,t,n){var i=1e-30,r=1,s=t+n,o=t+1,a=t-1,c=1,l=1-s*e/o,u,h,f,d;for(Math.abs(l)<i&&(l=i),l=1/l,d=l;r<=100&&(u=2*r,h=r*(n-r)*e/((a+u)*(t+u)),l=1+h*l,Math.abs(l)<i&&(l=i),c=1+h/c,Math.abs(c)<i&&(c=i),l=1/l,d*=l*c,h=-(t+r)*(s+r)*e/((t+u)*(o+u)),l=1+h*l,Math.abs(l)<i&&(l=i),c=1+h/c,Math.abs(c)<i&&(c=i),l=1/l,f=l*c,d*=f,!(Math.abs(f-1)<3e-7));r++);return d}function na(e){var t=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015,r,s,o;for(o=(s=r=e)+5.5,o-=(r+.5)*Math.log(o);t<6;t++)i+=n[t]/++s;return Math.log(2.506628274631*i/r)-o}function RV(e,t){var n=OV(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n}const FV={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class N6 extends Vt{constructor(t,n={}){const{x:i,y:r,z:s,ci:o=.95,precision:a=4}=n;if(super(t,{x:{value:i,scale:"x"},y:{value:r,scale:"y"},z:{value:hs(n),optional:!0}},n,FV),this.z=s,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${o}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,n,i,r,s){const{x:o,y:a,z:c}=i,{ci:l}=this;return Ft("svg:g",s).call(Zt,this,r,s).call(Yt,this,n).call(u=>u.selectAll().data(c?C1(t,c,this.z):[t]).enter().call(h=>h.append("path").attr("fill","none").call(Qt,this).call(Yh,this,{...i,fill:null,fillOpacity:null}).attr("d",f=>this._renderLine(f,o,a)).call(l&&!Ma(this.fill)?f=>f.select(DV).attr("stroke","none").call(Qt,this).call(Yh,this,{...i,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",d=>this._renderBand(d,o,a)):()=>{}))).node()}}function DV(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Js.svg,"path"),this)}class CV extends N6{constructor(t,n){super(t,n)}_renderBand(t,n,i){const{ci:r,precision:s}=this,[o,a]=Ae(t,u=>i[u]),c=td(t,i,n),l=$6(t,i,n,(1-r)/2,c);return i1().y(u=>u).x0(u=>l(u,-1)).x1(u=>l(u,1))(dn(o,a-s/2,s).concat(a))}_renderLine(t,n,i){const[r,s]=Ae(t,a=>i[a]),o=td(t,i,n);return`M${o(r)},${r}L${o(s)},${s}`}}class BV extends N6{constructor(t,n){super(t,n)}_renderBand(t,n,i){const{ci:r,precision:s}=this,[o,a]=Ae(t,u=>n[u]),c=td(t,n,i),l=$6(t,n,i,(1-r)/2,c);return i1().x(u=>u).y0(u=>l(u,-1)).y1(u=>l(u,1))(dn(o,a-s/2,s).concat(a))}_renderLine(t,n,i){const[r,s]=Ae(t,a=>n[a]),o=td(t,n,i);return`M${r},${o(r)}L${s},${o(s)}`}}function PV(e,{y:t=an,x:n=ot,stroke:i,fill:r=_e(i)?"currentColor":i,...s}={}){return new CV(e,eb({...s,x:n,y:t,fill:r,stroke:i}))}function UV(e,{x:t=an,y:n=ot,stroke:i,fill:r=_e(i)?"currentColor":i,...s}={}){return new BV(e,tb({...s,x:t,y:n,fill:r,stroke:i}))}function td(e,t,n){let i=0,r=0,s=0,o=0;for(const u of e){const h=t[u],f=n[u];i+=h,r+=f,s+=h*f,o+=h*h}const a=e.length,c=(a*s-i*r)/(a*o-i*i),l=(r-c*i)/a;return u=>c*u+l}function $6(e,t,n,i,r){const s=$i(e,u=>t[u])/e.length;let o=0,a=0;for(const u of e)o+=(t[u]-s)**2,a+=(n[u]-r(t[u]))**2;const c=Math.sqrt(a/(e.length-2)),l=RV(i,e.length-2);return(u,h)=>{const f=r(u),d=c*Math.sqrt(1/e.length+(u-s)**2/o);return f+h*l*d}}function Em({path:e=ot,delimiter:t,frameAnchor:n,treeLayout:i=$h,treeSort:r,treeSeparation:s,treeAnchor:o,treeFilter:a,...c}={}){o=_b(o),r=O6(r),a!=null&&(a=Am(a)),n===void 0&&(n=o.frameAnchor);const l=L6(t),u=P6(c,Am),[h,f]=yn(),[d,p]=yn();return{x:h,y:d,frameAnchor:n,...Ci(c,(y,m)=>{const g=l(Et(y,e)),b=f([]),w=p([]);let _=-1;const x=[],v=[],E=EA().path(k=>g[k]),T=i();T.nodeSize&&T.nodeSize([1,1]),T.separation&&s!==void 0&&T.separation(s??l1);for(const k of u)k[ed]=k[C6]([]);for(const k of m){const A=[],I=E(k.filter(O=>g[O]!=null)).each(O=>O.data=y[O.data]);r!=null&&I.sort(r),T(I);for(const O of I.descendants())if(!(a!=null&&!a(O))){A.push(++_),x[_]=O.data,o.position(O,_,b,w);for(const F of u)F[ed][_]=F[B6](O)}v.push(A)}return{data:x,facets:v}}),...Object.fromEntries(u)}}function k6({path:e=ot,delimiter:t,curve:n="bump-x",stroke:i="#555",strokeWidth:r=1.5,strokeOpacity:s=.5,treeLayout:o=$h,treeSort:a,treeSeparation:c,treeAnchor:l,treeFilter:u,...h}={}){l=_b(l),a=O6(a),u!=null&&(u=sv(u)),h={curve:n,stroke:i,strokeWidth:r,strokeOpacity:s,...h};const f=L6(t),d=P6(h,sv),[p,y]=yn(),[m,g]=yn(),[b,w]=yn(),[_,x]=yn();return{x1:p,x2:m,y1:b,y2:_,...Ci(h,(v,E)=>{const T=f(Et(v,e)),k=y([]),A=g([]),I=w([]),O=x([]);let F=-1;const S=[],M=[],N=EA().path(D=>T[D]),$=o();$.nodeSize&&$.nodeSize([1,1]),$.separation&&c!==void 0&&$.separation(c??l1);for(const D of d)D[ed]=D[C6]([]);for(const D of E){const C=[],B=N(D.filter(z=>T[z]!=null)).each(z=>z.data=v[z.data]);a!=null&&B.sort(a),$(B);for(const{source:z,target:j}of B.links())if(!(u!=null&&!u(j,z))){C.push(++F),S[F]=j.data,l.position(z,F,k,I),l.position(j,F,A,O);for(const V of d)V[ed][F]=V[B6](j,z)}M.push(C)}return{data:S,facets:M}}),...Object.fromEntries(d)}}function _b(e="left"){switch(`${e}`.trim().toLowerCase()){case"left":return zV;case"right":return jV}throw new Error(`invalid tree anchor: ${e}`)}const zV={frameAnchor:"left",dx:6,position({x:e,y:t},n,i,r){i[n]=t,r[n]=-e}},jV={frameAnchor:"right",dx:-6,position({x:e,y:t},n,i,r){i[n]=-t,r[n]=-e}};function O6(e){return e==null||typeof e=="function"?e:`${e}`.trim().toLowerCase().startsWith("node:")?rv(Am(e)):rv(qV(e))}function rv(e){return(t,n)=>Cn(e(t),e(n))}function qV(e){return t=>{var n;return(n=t.data)==null?void 0:n[e]}}function L6(e="/"){return`${e}`=="/"?t=>t:t=>t.map(YV(e,"/"))}function YV(e,t){return e=new RegExp(VV(e),"g"),n=>n==null?null:`${n}`.replace(e,t)}function VV(e){return`${e}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}function R6(e){return ni(e)&&typeof e.node=="function"}function WV(e){return ni(e)&&typeof e.link=="function"}function Am(e){if(R6(e))return e.node;if(e=`${e}`.trim().toLowerCase(),!!e.startsWith("node:")){switch(e){case"node:name":return Im;case"node:path":return Tm;case"node:internal":return F6;case"node:external":return D6;case"node:depth":return Mm;case"node:height":return Nm}throw new Error(`invalid node value: ${e}`)}}function sv(e){if(R6(e))return e.node;if(WV(e))return e.link;if(e=`${e}`.trim().toLowerCase(),!(!e.startsWith("node:")&&!e.startsWith("parent:"))){switch(e){case"parent:name":return zu(Im);case"parent:path":return zu(Tm);case"parent:depth":return zu(Mm);case"parent:height":return zu(Nm);case"node:name":return Im;case"node:path":return Tm;case"node:internal":return F6;case"node:external":return D6;case"node:depth":return Mm;case"node:height":return Nm}throw new Error(`invalid link value: ${e}`)}}function Tm(e){return e.id}function Im(e){return GV(e.id)}function Mm(e){return e.depth}function Nm(e){return e.height}function F6(e){return!!e.children}function D6(e){return!e.children}function zu(e){return(t,n)=>n==null?void 0:e(n)}function GV(e){let t=e.length;for(;--t>0&&!HV(e,t););return e.slice(t+1)}function HV(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}const C6=2,B6=3,ed=4;function P6(e,t){const n=[];for(const i in e){const r=e[i],s=t(r);s!==void 0&&n.push([i,...yn(r),s])}return n}function U6(e,{fill:t,stroke:n,strokeWidth:i,strokeOpacity:r,strokeLinejoin:s,strokeLinecap:o,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:l,marker:u,markerStart:h=u,markerEnd:f=u,dot:d=_e(h)&&_e(f),text:p="node:name",textStroke:y="white",title:m="node:path",dx:g,dy:b,textAnchor:w,treeLayout:_=$h,textLayout:x=_===$h||_===vA?"mirrored":"normal",tip:v,...E}={}){if(g===void 0&&(g=_b(E.treeAnchor).dx),w!==void 0)throw new Error("textAnchor is not a configurable tree option");x=Fi(x,"textLayout",["mirrored","normal"]);function T(k){return $a(e,Em({treeLayout:_,text:p,fill:t===void 0?"currentColor":t,stroke:y,dx:g,dy:b,title:m,...k,...E}))}return pr(t6(e,k6({treeLayout:_,markerStart:h,markerEnd:f,stroke:n!==void 0?n:t===void 0?"node:internal":t,strokeWidth:i,strokeOpacity:r,strokeLinejoin:s,strokeLinecap:o,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:l,...E})),d?ys(e,Em({treeLayout:_,fill:t===void 0?"node:internal":t,title:m,tip:v,...E})):null,p!=null?x==="mirrored"?[T({textAnchor:"start",treeFilter:"node:external"}),T({textAnchor:"end",treeFilter:"node:internal",dx:-g})]:T():null)}function XV(e,t){return U6(e,{...t,treeLayout:vA})}function KV({geometry:e=ot,...t}={}){return sn({...t,x:null,y:null},(n,i,r,s,o,{projection:a})=>{const c=Et(n,e),l=c.length,u=new Float64Array(l),h=new Float64Array(l),f=us(a);for(let d=0;d<l;++d)[u[d],h[d]]=f.centroid(c[d]);return{data:n,facets:i,channels:{x:{value:u,source:null},y:{value:h,source:null}}}})}function QV({geometry:e=ot,...t}={}){let n;return{...t,x:{transform:i=>Float64Array.from(n=Et(Et(i,e),p7),([r])=>r)},y:{transform:()=>Float64Array.from(n,([,i])=>i)}}}function JV(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ZV(e,t,n,i,r){for(var s=r+1;i<=r;){var o=i+r>>>1,a=e[o],c=n!==void 0?n(a,t):a-t;c>=0?(s=o,r=o-1):i=o+1}return s}function tW(e,t,n,i,r){for(var s=r+1;i<=r;){var o=i+r>>>1,a=e[o],c=n!==void 0?n(a,t):a-t;c>0?(s=o,r=o-1):i=o+1}return s}function eW(e,t,n,i,r){for(var s=i-1;i<=r;){var o=i+r>>>1,a=e[o],c=n!==void 0?n(a,t):a-t;c<0?(s=o,i=o+1):r=o-1}return s}function nW(e,t,n,i,r){for(var s=i-1;i<=r;){var o=i+r>>>1,a=e[o],c=n!==void 0?n(a,t):a-t;c<=0?(s=o,i=o+1):r=o-1}return s}function iW(e,t,n,i,r){for(;i<=r;){var s=i+r>>>1,o=e[s],a=n!==void 0?n(o,t):o-t;if(a===0)return s;a<=0?i=s+1:r=s-1}return-1}function xc(e,t,n,i,r,s){return typeof n=="function"?s(e,t,n,i===void 0?0:i|0,r===void 0?e.length-1:r|0):s(e,t,void 0,n===void 0?0:n|0,i===void 0?e.length-1:i|0)}var rW={ge:function(e,t,n,i,r){return xc(e,t,n,i,r,ZV)},gt:function(e,t,n,i,r){return xc(e,t,n,i,r,tW)},lt:function(e,t,n,i,r){return xc(e,t,n,i,r,eW)},le:function(e,t,n,i,r){return xc(e,t,n,i,r,nW)},eq:function(e,t,n,i,r){return xc(e,t,n,i,r,iW)}},nd=rW,Bo=0,Ts=1,df=2,sW=aW;function vb(e,t,n,i,r){this.mid=e,this.left=t,this.right=n,this.leftPoints=i,this.rightPoints=r,this.count=(t?t.count:0)+(n?n.count:0)+i.length}var iu=vb.prototype;function Wy(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function z6(e,t){var n=La(t);e.mid=n.mid,e.left=n.left,e.right=n.right,e.leftPoints=n.leftPoints,e.rightPoints=n.rightPoints,e.count=n.count}function ov(e,t){var n=e.intervals([]);n.push(t),z6(e,n)}function av(e,t){var n=e.intervals([]),i=n.indexOf(t);return i<0?Bo:(n.splice(i,1),z6(e,n),Ts)}iu.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e};iu.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?ov(this,e):this.left.insert(e):this.left=La([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?ov(this,e):this.right.insert(e):this.right=La([e]);else{var n=nd.ge(this.leftPoints,e,xb),i=nd.ge(this.rightPoints,e,Sb);this.leftPoints.splice(n,0,e),this.rightPoints.splice(i,0,e)}};iu.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left)return Bo;var n=this.right?this.right.count:0;if(4*n>3*(t-1))return av(this,e);var i=this.left.remove(e);return i===df?(this.left=null,this.count-=1,Ts):(i===Ts&&(this.count-=1),i)}else if(e[0]>this.mid){if(!this.right)return Bo;var r=this.left?this.left.count:0;if(4*r>3*(t-1))return av(this,e);var i=this.right.remove(e);return i===df?(this.right=null,this.count-=1,Ts):(i===Ts&&(this.count-=1),i)}else{if(this.count===1)return this.leftPoints[0]===e?df:Bo;if(this.leftPoints.length===1&&this.leftPoints[0]===e){if(this.left&&this.right){for(var s=this,o=this.left;o.right;)s=o,o=o.right;if(s===this)o.right=this.right;else{var a=this.left,i=this.right;s.count-=o.count,s.right=o.left,o.left=a,o.right=i}Wy(this,o),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Wy(this,this.left):Wy(this,this.right);return Ts}for(var a=nd.ge(this.leftPoints,e,xb);a<this.leftPoints.length&&this.leftPoints[a][0]===e[0];++a)if(this.leftPoints[a]===e){this.count-=1,this.leftPoints.splice(a,1);for(var i=nd.ge(this.rightPoints,e,Sb);i<this.rightPoints.length&&this.rightPoints[i][1]===e[1];++i)if(this.rightPoints[i]===e)return this.rightPoints.splice(i,1),Ts}return Bo}};function j6(e,t,n){for(var i=0;i<e.length&&e[i][0]<=t;++i){var r=n(e[i]);if(r)return r}}function q6(e,t,n){for(var i=e.length-1;i>=0&&e[i][1]>=t;--i){var r=n(e[i]);if(r)return r}}function Y6(e,t){for(var n=0;n<e.length;++n){var i=t(e[n]);if(i)return i}}iu.queryPoint=function(e,t){if(e<this.mid){if(this.left){var n=this.left.queryPoint(e,t);if(n)return n}return j6(this.leftPoints,e,t)}else if(e>this.mid){if(this.right){var n=this.right.queryPoint(e,t);if(n)return n}return q6(this.rightPoints,e,t)}else return Y6(this.leftPoints,t)};iu.queryInterval=function(e,t,n){if(e<this.mid&&this.left){var i=this.left.queryInterval(e,t,n);if(i)return i}if(t>this.mid&&this.right){var i=this.right.queryInterval(e,t,n);if(i)return i}return t<this.mid?j6(this.leftPoints,t,n):e>this.mid?q6(this.rightPoints,e,n):Y6(this.leftPoints,n)};function oW(e,t){return e-t}function xb(e,t){var n=e[0]-t[0];return n||e[1]-t[1]}function Sb(e,t){var n=e[1]-t[1];return n||e[0]-t[0]}function La(e){if(e.length===0)return null;for(var t=[],n=0;n<e.length;++n)t.push(e[n][0],e[n][1]);t.sort(oW);for(var i=t[t.length>>1],r=[],s=[],o=[],n=0;n<e.length;++n){var a=e[n];a[1]<i?r.push(a):i<a[0]?s.push(a):o.push(a)}var c=o,l=o.slice();return c.sort(xb),l.sort(Sb),new vb(i,La(r),La(s),c,l)}function $m(e){this.root=e}var Ka=$m.prototype;Ka.insert=function(e){this.root?this.root.insert(e):this.root=new vb(e[0],null,null,[e],[e])};Ka.remove=function(e){if(this.root){var t=this.root.remove(e);return t===df&&(this.root=null),t!==Bo}return!1};Ka.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)};Ka.queryInterval=function(e,t,n){if(e<=t&&this.root)return this.root.queryInterval(e,t,n)};Object.defineProperty(Ka,"count",{get:function(){return this.root?this.root.count:0}});Object.defineProperty(Ka,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function aW(e){return!e||e.length===0?new $m(null):new $m(La(e))}const cW=JV(sW),lW=({marginLeft:e})=>[1,e],uW=({width:e,marginRight:t})=>[-1,e-t],fW=({width:e,marginLeft:t,marginRight:n})=>[0,(t+e-n)/2],hW=({marginTop:e})=>[1,e],dW=({height:e,marginBottom:t})=>[-1,e-t],pW=({height:e,marginTop:t,marginBottom:n})=>[0,(t+e-n)/2];function V6(e){return typeof e=="string"?{anchor:e}:e}function yW(e={},t={}){arguments.length===1&&([e,t]=W6(e));let{anchor:n="left",padding:i=1,r=t.r}=V6(e);switch(`${n}`.toLowerCase()){case"left":n=lW;break;case"right":n=uW;break;case"middle":n=fW;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return G6("x","y",n,Tt(i),r,t)}function mW(e={},t={}){arguments.length===1&&([e,t]=W6(e));let{anchor:n="bottom",padding:i=1,r=t.r}=V6(e);switch(`${n}`.toLowerCase()){case"top":n=hW;break;case"bottom":n=dW;break;case"middle":n=pW;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return G6("y","x",n,Tt(i),r,t)}function W6(e){const{anchor:t,padding:n,...i}=e,{r}=i;return[{anchor:t,padding:n,r},i]}function G6(e,t,n,i,r,s){if(r!=null&&typeof r!="number"){let{channels:o,sort:a,reverse:c}=s;o=y1(o),(o==null?void 0:o.r)===void 0&&(s={...s,channels:{...o,r:{value:r,scale:"r"}}}),a===void 0&&c===void 0&&(s.sort={channel:"-r"})}return sn(s,function(o,a,c,l,u,h){let{[t]:f,r:d}=c;if(!c[t])throw new Error(`missing channel: ${t}`);({[t]:f}=op(c,l,h));const p=d?void 0:r!==void 0?Tt(r):this.r!==void 0?this.r:3;d&&(d=Et(d.value,l[d.scale]||ot,Float64Array));let[y,m]=n(u);const g=y?bW:gW,b=new Float64Array(f.length),w=d?_=>d[_]:()=>p;for(let _ of a){const x=cW();_=_.filter(d?E=>Uh(f[E])&&cr(d[E]):E=>Uh(f[E]));const v=new Float64Array(2*_.length+2);for(const E of _){const T=w(E),k=y?T+i:0,A=f[E]-T,I=f[E]+T;let O=2;x.queryInterval(A-i,I+i,([,,S])=>{const M=b[S]-k,N=f[E]-f[S],$=i+(d?d[E]+d[S]:2*p),D=Math.sqrt($*$-N*N);v[O++]=M-D,v[O++]=M+D});let F=v.slice(0,O);y&&(F=F.filter(S=>S>=0));t:for(const S of F.sort(g)){for(let M=0;M<O;M+=2)if(v[M]+1e-6<S&&S<v[M+1]-1e-6)continue t;b[E]=S+k;break}x.insert([A,I,E])}}y||(y=1);for(const _ of a)for(const x of _)b[x]=b[x]*y+m;return{data:o,facets:a,channels:{[e]:{value:b,source:null},[t]:{value:f,source:c[t]},...d&&{r:{value:d,source:c.r}}}}})}function gW(e,t){return Math.abs(e)-Math.abs(t)}function bW(e,t){return e-t}function wW(e,t){return arguments.length===1&&({basis:e,...t}=e),db(Eb(e),t)}function _W(e,t){return arguments.length===1&&({basis:e,...t}=e),pb(Eb(e),t)}function Eb(e){if(e===void 0)return cv;if(typeof e=="function")return vp(d1(e));if(/^p\d{2}$/i.test(e))return Qa(u1(e));switch(`${e}`.toLowerCase()){case"deviation":return SW;case"first":return cv;case"last":return xW;case"max":return EW;case"mean":return AW;case"median":return TW;case"min":return IW;case"sum":return MW;case"extent":return vW}throw new Error(`invalid basis: ${e}`)}function vp(e){return{mapIndex(t,n,i){const r=+e(t,n);for(const s of t)i[s]=n[s]===null?NaN:n[s]/r}}}function Qa(e){return vp((t,n)=>e(t,i=>n[i]))}const vW={mapIndex(e,t,n){const[i,r]=Ae(e,o=>t[o]),s=r-i;for(const o of e)n[o]=t[o]===null?NaN:(t[o]-i)/s}},cv=vp((e,t)=>{for(let n=0;n<e.length;++n){const i=t[e[n]];if(qe(i))return i}}),xW=vp((e,t)=>{for(let n=e.length-1;n>=0;--n){const i=t[e[n]];if(qe(i))return i}}),SW={mapIndex(e,t,n){const i=Og(e,s=>t[s]),r=wd(e,s=>t[s]);for(const s of e)n[s]=t[s]===null?NaN:r?(t[s]-i)/r:0}},EW=Qa(oe),AW=Qa(Og),TW=Qa(ga),IW=Qa(xe),MW=Qa($i);function NW(e={},t){return arguments.length===1&&(t=e),db(Ab(e),t)}function $W(e={},t){return arguments.length===1&&(t=e),pb(Ab(e),t)}function Ab(e={}){typeof e=="number"&&(e={k:e});let{k:t,reduce:n,shift:i,anchor:r,strict:s}=e;if(r===void 0&&i!==void 0&&(r=OW(i),Br(`Warning: the shift option is deprecated; please use anchor "${r}" instead.`)),!((t=Math.floor(t))>0))throw new Error(`invalid k: ${t}`);return LW(n)(t,kW(r,t),s)}function kW(e="middle",t){switch(`${e}`.toLowerCase()){case"middle":return t-1>>1;case"start":return 0;case"end":return t-1}throw new Error(`invalid anchor: ${e}`)}function OW(e){switch(`${e}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${e}`)}function LW(e="mean"){if(typeof e=="string"){if(/^p\d{2}$/i.test(e))return ju(u1(e));switch(e.toLowerCase()){case"deviation":return ju(wd);case"max":return qu((t,n)=>oe(t,i=>n[i]));case"mean":return RW;case"median":return ju(ga);case"min":return qu((t,n)=>xe(t,i=>n[i]));case"mode":return qu((t,n)=>QS(t,i=>n[i]));case"sum":return H6;case"variance":return ju(Tg);case"difference":return CW;case"ratio":return BW;case"first":return PW;case"last":return UW}}if(typeof e!="function")throw new Error(`invalid reduce: ${e}`);return qu(d1(e))}function ju(e){return(t,n,i)=>i?{mapIndex(r,s,o){const a=l=>s[l]==null?NaN:+s[l];let c=0;for(let l=0;l<t-1;++l)isNaN(a(l))&&++c;for(let l=0,u=r.length-t+1;l<u;++l)isNaN(a(l+t-1))&&++c,o[r[l+n]]=c===0?e(Ws(r,l,l+t),a):NaN,isNaN(a(l))&&--c}}:{mapIndex(r,s,o){const a=c=>s[c]==null?NaN:+s[c];for(let c=-n;c<0;++c)o[r[c+n]]=e(Ws(r,0,c+t),a);for(let c=0,l=r.length-n;c<l;++c)o[r[c+n]]=e(Ws(r,c,c+t),a)}}}function qu(e){return(t,n,i)=>i?{mapIndex(r,s,o){let a=0;for(let c=0;c<t-1;++c)a+=qe(s[r[c]]);for(let c=0,l=r.length-t+1;c<l;++c)a+=qe(s[r[c+t-1]]),a===t&&(o[r[c+n]]=e(Ws(r,c,c+t),s)),a-=qe(s[r[c]])}}:{mapIndex(r,s,o){for(let a=-n;a<0;++a)o[r[a+n]]=e(Ws(r,0,a+t),s);for(let a=0,c=r.length-n;a<c;++a)o[r[a+n]]=e(Ws(r,a,a+t),s)}}}function H6(e,t,n){return n?{mapIndex(i,r,s){let o=0,a=0;for(let c=0;c<e-1;++c){const l=r[i[c]];l===null||isNaN(l)?++o:a+=+l}for(let c=0,l=i.length-e+1;c<l;++c){const u=r[i[c]],h=r[i[c+e-1]];h===null||isNaN(h)?++o:a+=+h,s[i[c+t]]=o===0?a:NaN,u===null||isNaN(u)?--o:a-=+u}}}:{mapIndex(i,r,s){let o=0;const a=i.length;for(let c=0,l=Math.min(a,e-t-1);c<l;++c)o+=+r[i[c]]||0;for(let c=-t,l=a-t;c<l;++c)o+=+r[i[c+e-1]]||0,s[i[c+t]]=o,o-=+r[i[c]]||0}}}function RW(e,t,n){if(n){const i=H6(e,t,n);return{mapIndex(r,s,o){i.mapIndex(r,s,o);for(let a=0,c=r.length-e+1;a<c;++a)o[r[a+t]]/=e}}}else return{mapIndex(i,r,s){let o=0,a=0;const c=i.length;for(let l=0,u=Math.min(c,e-t-1);l<u;++l){let h=r[i[l]];h!==null&&!isNaN(h=+h)&&(o+=h,++a)}for(let l=-t,u=c-t;l<u;++l){let h=r[i[l+e-1]],f=r[i[l]];h!==null&&!isNaN(h=+h)&&(o+=h,++a),s[i[l+t]]=o/a,f!==null&&!isNaN(f=+f)&&(o-=f,--a)}}}}function FW(e,t,n,i){for(let r=n+i;n<r;++n){const s=e[t[n]];if(qe(s))return s}}function DW(e,t,n,i){for(let r=n+i-1;r>=n;--r){const s=e[t[r]];if(qe(s))return s}}function X6(e,t,n,i){for(let r=n+i;n<r;++n){let s=e[t[n]];if(s!==null&&!isNaN(s=+s))return s}}function K6(e,t,n,i){for(let r=n+i-1;r>=n;--r){let s=e[t[r]];if(s!==null&&!isNaN(s=+s))return s}}function CW(e,t,n){return n?{mapIndex(i,r,s){for(let o=0,a=i.length-e;o<a;++o){const c=r[i[o]],l=r[i[o+e-1]];s[i[o+t]]=c===null||l===null?NaN:l-c}}}:{mapIndex(i,r,s){for(let o=-t,a=i.length-e+t+1;o<a;++o)s[i[o+t]]=K6(r,i,o,e)-X6(r,i,o,e)}}}function BW(e,t,n){return n?{mapIndex(i,r,s){for(let o=0,a=i.length-e;o<a;++o){const c=r[i[o]],l=r[i[o+e-1]];s[i[o+t]]=c===null||l===null?NaN:l/c}}}:{mapIndex(i,r,s){for(let o=-t,a=i.length-e+t+1;o<a;++o)s[i[o+t]]=K6(r,i,o,e)/X6(r,i,o,e)}}}function PW(e,t,n){return n?{mapIndex(i,r,s){for(let o=0,a=i.length-e;o<a;++o)s[i[o+t]]=r[i[o]]}}:{mapIndex(i,r,s){for(let o=-t,a=i.length-e+t+1;o<a;++o)s[i[o+t]]=FW(r,i,o,e)}}}function UW(e,t,n){return n?{mapIndex(i,r,s){for(let o=0,a=i.length-e;o<a;++o)s[i[o+t]]=r[i[o+e-1]]}}:{mapIndex(i,r,s){for(let o=-t,a=i.length-e+t+1;o<a;++o)s[i[o+t]]=DW(r,i,o,e)}}}function zW(e,t={}){if(typeof e=="string")switch(e.toLowerCase()){case"first":return Q6(t);case"last":return J6(t)}if(typeof e=="function")return ts(null,e,t);let n,i;for(n in e){if(i!==void 0)throw new Error("ambiguous selector; multiple inputs");i=jW(e[n])}if(i===void 0)throw new Error(`invalid selector: ${e}`);return ts(n,i,t)}function jW(e){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"min":return Tb;case"max":return Ib}throw new Error(`unknown selector: ${e}`)}function Q6(e){return ts(null,GW,e)}function J6(e){return ts(null,HW,e)}function qW(e){return ts("x",Tb,e)}function YW(e){return ts("y",Tb,e)}function VW(e){return ts("x",Ib,e)}function WW(e){return ts("y",Ib,e)}function*GW(e){yield e[0]}function*HW(e){yield e[e.length-1]}function*Tb(e,t){yield g5(e,n=>t[n])}function*Ib(e,t){yield kg(e,n=>t[n])}function ts(e,t,n){if(e!=null){if(n[e]==null)throw new Error(`missing channel: ${e}`);e=n[e]}const i=hs(n);return Ci(n,(r,s)=>{const o=Et(r,i),a=Et(r,e),c=[];for(const l of s){const u=[];for(const h of o?br(l,f=>o[f]).values():[l])for(const f of t(h,a))u.push(f);c.push(u)}return{data:r,facets:c}})}const lv=Object.freeze(Object.defineProperty({__proto__:null,Area:mp,Arrow:e6,BarX:i6,BarY:r6,Cell:gp,Contour:x6,Density:A6,Dot:bp,Frame:D3,Geo:T6,Hexgrid:I6,Image:M6,Line:wp,Link:Z3,Mark:Vt,Raster:y6,Rect:_p,RuleX:XM,RuleY:KM,Text:hp,TickX:a6,TickY:c6,Tip:C3,Vector:dp,area:oY,areaX:Xh,areaY:_l,arrow:fY,auto:SY,autoSpec:s6,axisFx:w3,axisFy:b3,axisX:H1,axisY:G1,barX:ta,barY:ea,bin:Is,binX:kr,binY:Or,boxX:OY,boxY:LY,cell:Qh,cellX:dY,cellY:pY,centroid:KV,circle:bY,cluster:XV,column:yn,contour:GY,crosshair:XY,crosshairX:KY,crosshairY:QY,delaunayLink:uV,delaunayMesh:fV,density:mV,dodgeX:yW,dodgeY:mW,dot:ys,dotX:mY,dotY:gY,filter:RU,formatIsoDate:$M,formatMonth:Hz,formatWeekday:Xz,frame:K1,geo:wb,geoCentroid:QV,graticule:xV,gridFx:A3,gridFy:S3,gridX:E3,gridY:x3,group:S1,groupX:ml,groupY:gl,groupZ:x1,hexagon:wY,hexbin:SV,hexgrid:TV,hull:hV,identity:ot,image:kV,indexOf:an,initializer:sn,interpolateNearest:_6,interpolateNone:Sm,interpolatorBarycentric:w6,interpolatorRandomWalk:v6,legend:nq,line:fb,lineX:Jh,lineY:Zh,linearRegressionX:PV,linearRegressionY:UV,link:t6,map:eu,mapX:db,mapY:pb,marks:pr,normalize:Eb,normalizeX:wW,normalizeY:_W,plot:Q1,pointer:j1,pointerX:q1,pointerY:Y1,raster:FY,rect:hb,rectX:jc,rectY:qc,reverse:FU,ruleX:Jr,ruleY:Zr,scale:so,select:zW,selectFirst:Q6,selectLast:J6,selectMaxX:VW,selectMaxY:WW,selectMinX:qW,selectMinY:YW,shuffle:DU,sort:eM,sphere:vV,spike:qj,stackX:G3,stackX1:Yq,stackX2:Vq,stackY:H3,stackY1:Wq,stackY2:Gq,text:$a,textX:t3,textY:e3,tickX:l6,tickY:u6,tip:B3,transform:Ci,tree:U6,treeLink:k6,treeNode:Em,valueof:Et,vector:f3,vectorX:h3,vectorY:d3,voronoi:dV,voronoiMesh:pV,window:Ab,windowX:NW,windowY:$W},Symbol.toStringTag,{value:"Module"})),XW=new Map([["style","style"],["width","width"],["height","height"],["margin","margin"],["marginLeft","marginLeft"],["marginRight","marginRight"],["marginTop","marginTop"],["marginBottom","marginBottom"],["align","align"],["aspectRatio","aspectRatio"],["axis","axis"],["inset","inset"],["grid","grid"],["label","label"],["padding","padding"],["round","round"],["xScale","x.type"],["xDomain","x.domain"],["xRange","x.range"],["xNice","x.nice"],["xInset","x.inset"],["xInsetLeft","x.insetLeft"],["xInsetRight","x.insetRight"],["xClamp","x.clamp"],["xRound","x.round"],["xAlign","x.align"],["xPadding","x.padding"],["xPaddingInner","x.paddingInner"],["xPaddingOuter","x.paddingOuter"],["xAxis","x.axis"],["xTicks","x.ticks"],["xTickSize","x.tickSize"],["xTickSpacing","x.tickSpacing"],["xTickPadding","x.tickPadding"],["xTickFormat","x.tickFormat"],["xTickRotate","x.tickRotate"],["xGrid","x.grid"],["xLine","x.line"],["xLabel","x.label"],["xLabelAnchor","x.labelAnchor"],["xLabelOffset","x.labelOffset"],["xFontVariant","x.fontVariant"],["xAriaLabel","x.ariaLabel"],["xAriaDescription","x.ariaDescription"],["xReverse","x.reverse"],["xZero","x.zero"],["yScale","y.type"],["yDomain","y.domain"],["yRange","y.range"],["yNice","y.nice"],["yInset","y.inset"],["yInsetTop","y.insetTop"],["yInsetBottom","y.insetBottom"],["yClamp","y.clamp"],["yRound","y.round"],["yAlign","y.align"],["yPadding","y.padding"],["yPaddingInner","y.paddingInner"],["yPaddingOuter","y.paddingOuter"],["yAxis","y.axis"],["yTicks","y.ticks"],["yTickSize","y.tickSize"],["yTickSpacing","y.tickSpacing"],["yTickPadding","y.tickPadding"],["yTickFormat","y.tickFormat"],["yTickRotate","y.tickRotate"],["yGrid","y.grid"],["yLine","y.line"],["yLabel","y.label"],["yLabelAnchor","y.labelAnchor"],["yLabelOffset","y.labelOffset"],["yFontVariant","y.fontVariant"],["yAriaLabel","y.ariaLabel"],["yAriaDescription","y.ariaDescription"],["yReverse","y.reverse"],["yZero","y.zero"],["facetMargin","facet.margin"],["facetMarginTop","facet.marginTop"],["facetMarginBottom","facet.marginBottom"],["facetMarginLeft","facet.marginLeft"],["facetMarginRight","facet.marginRight"],["facetGrid","facet.grid"],["facetLabel","facet.label"],["fxDomain","fx.domain"],["fxRange","fx.range"],["fxNice","fx.nice"],["fxInset","fx.inset"],["fxInsetLeft","fx.insetLeft"],["fxInsetRight","fx.insetRight"],["fxRound","fx.round"],["fxAlign","fx.align"],["fxPadding","fx.padding"],["fxPaddingInner","fx.paddingInner"],["fxPaddingOuter","fx.paddingOuter"],["fxAxis","fx.axis"],["fxTicks","fx.ticks"],["fxTickSize","fx.tickSize"],["fxTickSpacing","fx.tickSpacing"],["fxTickPadding","fx.tickPadding"],["fxTickFormat","fx.tickFormat"],["fxTickRotate","fx.tickRotate"],["fxGrid","fx.grid"],["fxLine","fx.line"],["fxLabel","fx.label"],["fxLabelAnchor","fx.labelAnchor"],["fxLabelOffset","fx.labelOffset"],["fxFontVariant","fx.fontVariant"],["fxAriaLabel","fx.ariaLabel"],["fxAriaDescription","fx.ariaDescription"],["fxReverse","fx.reverse"],["fyDomain","fy.domain"],["fyRange","fy.range"],["fyNice","fy.mice"],["fyInset","fy,inset"],["fyInsetTop","fy.insetTop"],["fyInsetBottom","fy.insetBottom"],["fyRound","fy.round"],["fyAlign","fy.align"],["fyPadding","fy.padding"],["fyPaddingInner","fy.paddingInner"],["fyPaddingOuter","fy.paddingOuter"],["fyAxis","fy.axis"],["fyTicks","fy.ticks"],["fyTickSize","fy.tickSize"],["fyTickSpacing","fy.tickSpacing"],["fyTickPadding","fy.tickPadding"],["fyTickFormat","fy.tickFormat"],["fyTickRotate","fy.tickRotate"],["fyGrid","fy.grid"],["fyLine","fy.line"],["fyLabel","fy.label"],["fyLabelAnchor","fy.labelAnchor"],["fyLabelOffset","fy.labelOffset"],["fyFontVariant","fy.fontVariant"],["fyAriaLabel","fy.ariaLabel"],["fyAriaDescription","fy.ariaDescription"],["fyReverse","fy.reverse"],["colorScale","color.type"],["colorDomain","color.domain"],["colorRange","color.range"],["colorClamp","color.clamp"],["colorNice","color.nice"],["colorScheme","color.scheme"],["colorInterpolate","color.interpolate"],["colorPivot","color.pivot"],["colorSymmetric","color.symmetric"],["colorLabel","color.label"],["colorReverse","color.reverse"],["colorZero","color.zero"],["colorTickFormat","color.tickFormat"],["opacityScale","opacity.type"],["opacityDomain","opacity.domain"],["opacityRange","opacity.range"],["opacityClamp","opacity.clamp"],["opacityNice","opacity.nice"],["opacityLabel","opacity.label"],["opacityReverse","opacity.reverse"],["opacityZero","opacity.zero"],["opacityTickFormat","opacity.tickFormat"],["rScale","r.type"],["rDomain","r.domain"],["rRange","r.range"],["rClamp","r.clamp"],["rNice","r.nice"],["rZero","r.zero"],["lengthScale","length.type"],["lengthDomain","length.domain"],["lengthRange","length.range"],["lengthClamp","length.clamp"],["lengthNice","length.nice"],["lengthZero","length.zero"],["projectionType","projection.type"],["projectionParallels","projection.parallels"],["projectionPrecision","projection.precision"],["projectionRotate","projection.rotate"],["projectionDomain","projection.domain"],["projectionInset","projection.inset"],["projectionInsetLeft","projection.insetLeft"],["projectionInsetRight","projection.insetRight"],["projectionInsetTop","projection.insetTop"],["projectionInsetBottom","projection.insetBottom"],["projectionClip","projection.clip"]]),KW=new Set(["frame","hexgrid","sphere","graticule"]);function QW(e,t,n){for(let i=0;i<t.length;++i){const r=t[i];i===t.length-1?e[r]=n:e=e[r]||(e[r]={})}}async function JW(e){const t={marks:[]},n=[],{attributes:i,marks:r}=e;for(const a in i){const c=XW.get(a);if(c==null)throw new Error(`Unrecognized plot attribute: ${a}`);const l=i[a];typeof l=="symbol"?n.push(a):l!==void 0&&QW(t,c.split("."),l)}const s=[];for(const a of r)for(const{type:c,data:l,options:u}of a.plotSpecs())KW.has(c)?t.marks.push(lv[c](u)):t.marks.push(lv[c](l,u)),s.push(a.index);tG(t,e);const o=Q1(t);eG(o,s),ZW(e,o,i,n);for(const a of e.interactors)await a.init(o);return o}function ZW(e,t,n,i){i.forEach(r=>{const s=n[r];if(s===Ag){if(!r.endsWith("Domain"))throw new Error(`Unsupported fixed attribute: ${r}`);const o=r.slice(0,-6),a=t.scale(o);a!=null&&a.domain&&e.setAttribute(r,n[`${o}Reverse`]?a.domain.slice().reverse():a.domain)}else throw new Error(`Unrecognized symbol: ${s}`)})}function tG(e,t){const{marks:n}=t;Yu("x",e,n,["x","x1","x2"]),Yu("y",e,n,["y","y1","y2"]),Yu("fx",e,n),Yu("fy",e,n)}function Yu(e,t,n,i=[e]){const r=t[e]||{};if(r.axis===null||r.label!==void 0)return;const s=n.map(u=>{var h;return(h=u.channelField(i))==null?void 0:h.field});if(s.every(u=>u==null))return;let o,a,c;for(let u=0;u<s.length;++u){const{column:h,label:f}=s[u]||{};h===void 0&&f===void 0||(o===void 0&&a===void 0?(o=h,a=f,c=nG(n[u].data,i)||"number"):a!==f?a=void 0:o!==h&&(o=void 0))}let l=a||o;if(l!==void 0){if((c==="number"||c==="date")&&(e==="x"||e==="y")){r.percent&&(l=`${l} (%)`);const u=(e==="x"?1:-1)*(r.reverse?-1:1);e==="x"||r.labelAnchor==="center"?l=e==="x"==u<0?`← ${l}`:`${l} →`:l=`${u<0?"↑ ":"↓ "}${l}`}t[e]={...r,label:l}}}function eG(e,t){const n=e.querySelectorAll('g[aria-label="facet"]');if(n.length)for(const i of n)uv(i,t);else uv(e,t)}function uv(e,t){let n=-1;for(const i of e.children){const r=i.getAttribute("aria-label")||"";i.nodeName==="style"||r.includes("-axis")||r.includes("-grid")||i.setAttribute("data-index",t[++n])}}function nG(e,t){for(const n of e)for(let i=0;i<t.length;++i){const r=n[t[i]];if(r!=null)return r instanceof Date?"date":typeof r}}const iG={width:640,marginLeft:40,marginRight:20,marginTop:20,marginBottom:30};class rG{constructor(t){this.attributes={...iG},this.listeners=null,this.interactors=[],this.legends=[],this.marks=[],this.markset=null,this.element=t||document.createElement("div"),this.element.setAttribute("class","plot"),this.element.style.display="flex",this.element.value=this,this.params=new Map,this.synch=SL()}margins(){return{left:this.getAttribute("marginLeft"),top:this.getAttribute("marginTop"),bottom:this.getAttribute("marginBottom"),right:this.getAttribute("marginRight")}}innerWidth(){const{left:t,right:n}=this.margins();return this.getAttribute("width")-t-n}innerHeight(){const{top:t,bottom:n}=this.margins();return this.getAttribute("height")-t-n}pending(t){this.synch.pending(t)}update(t){return this.synch.ready(t)&&!this.pendingRender&&(this.pendingRender=!0,requestAnimationFrame(()=>this.render())),this.synch.promise}async render(){this.pendingRender=!1;const t=await JW(this),n=this.legends.flatMap(({legend:i,include:r})=>{const s=i.init(t);return r?s:[]});this.element.replaceChildren(t,...n),this.synch.resolve()}getAttribute(t){return this.attributes[t]}setAttribute(t,n,i){var r,s;return LS(this.attributes[t],n)?(n===void 0?delete this.attributes[t]:this.attributes[t]=n,i!=null&&i.silent||(s=(r=this.listeners)==null?void 0:r.get(t))==null||s.forEach(o=>o(t,n)),!0):!1}addAttributeListener(t,n){const i=this.listeners||(this.listeners=new Map);return i.has(t)||i.set(t,new Set),i.get(t).add(n),this}removeAttributeListener(t,n){var i,r;return(r=(i=this.listeners)==null?void 0:i.get(t))==null?void 0:r.delete(n)}addParams(t,n){const{params:i}=this;for(const r of n)i.has(r)?i.get(r).push(t):(i.set(r,[t]),r.addEventListener("value",()=>Promise.allSettled(i.get(r).map(s=>s.requestQuery()))))}addMark(t){return t.setPlot(this,this.marks.length),this.marks.push(t),this.markset=null,this}get markSet(){return this.markset||(this.markset=new Set(this.marks))}addInteractor(t){return this.interactors.push(t),this}addLegend(t,n=!0){t.setPlot(this),this.legends.push({legend:t,include:n})}}function sG(...e){const t=new rG;return e.flat().forEach(n=>n(t)),t.marks.forEach(n=>as().connect(n)),t.element}class oG extends Map{request(t,n){if(this.has(t))n(this.get(t));else{const i=this.waiting||(this.waiting=new Map),r=i.get(t)||[];i.set(t,r.concat(n))}}set(t,n){this.has(t)&&console.warn(`Overwriting named plot "${t}".`);const{waiting:i}=this;return i!=null&&i.has(t)&&(i.get(t).forEach(r=>r(n)),i.delete(t)),super.set(t,n)}}const Z6=new oG;function aG(e){return t=>Z6.set(e,t)}function tN(e,t,n){Cr(n)?(n.addEventListener("value",i=>{e.setAttribute(t,i),e.update()}),n.value!==void 0&&e.setAttribute(t,n.value)):e.setAttribute(t,n)}function eN(e,t){return n=>{tN(n,e,t)}}function Mb(e){return t=>{for(const[n,i]of Object.entries(e))tN(t,n,i)}}function cG(e){const{top:t,bottom:n,left:i,right:r}=e,s={};return t!==void 0&&(s.marginTop=t),n!==void 0&&(s.marginBottom=n),i!==void 0&&(s.marginLeft=i),r!==void 0&&(s.marginRight=r),Mb(s)}function lG(e){return Mb({xDomain:e,yDomain:e})}const R=e=>t=>eN(e,t),uG=R("style"),fG=R("width"),hG=R("height"),dG=R("margin"),pG=R("marginLeft"),yG=R("marginRight"),mG=R("marginTop"),gG=R("marginBottom"),bG=R("align"),wG=R("aspectRatio"),_G=R("axis"),vG=R("inset"),xG=R("grid"),SG=R("label"),EG=R("padding"),AG=R("round"),TG=R("xScale"),IG=R("xDomain"),MG=R("xRange"),NG=R("xNice"),$G=R("xInset"),kG=R("xInsetLeft"),OG=R("xInsetRight"),LG=R("xClamp"),RG=R("xRound"),FG=R("xAlign"),DG=R("xPadding"),CG=R("xPaddingInner"),BG=R("xPaddingOuter"),PG=R("xAxis"),UG=R("xTicks"),zG=R("xTickSize"),jG=R("xTickSpacing"),qG=R("xTickPadding"),YG=R("xTickFormat"),VG=R("xTickRotate"),WG=R("xGrid"),GG=R("xLine"),HG=R("xLabel"),XG=R("xLabelAnchor"),KG=R("xLabelOffset"),QG=R("xFontVariant"),JG=R("xAriaLabel"),ZG=R("xAriaDescription"),tH=R("xReverse"),eH=R("xZero"),nH=R("yScale"),iH=R("yDomain"),rH=R("yRange"),sH=R("yNice"),oH=R("yInset"),aH=R("yInsetTop"),cH=R("yInsetBottom"),lH=R("yClamp"),uH=R("yRound"),fH=R("yAlign"),hH=R("yPadding"),dH=R("yPaddingInner"),pH=R("yPaddingOuter"),yH=R("yAxis"),mH=R("yTicks"),gH=R("yTickSize"),bH=R("yTickSpacing"),wH=R("yTickPadding"),_H=R("yTickFormat"),vH=R("yTickRotate"),xH=R("yGrid"),SH=R("yLine"),EH=R("yLabel"),AH=R("yLabelAnchor"),TH=R("yLabelOffset"),IH=R("yFontVariant"),MH=R("yAriaLabel"),NH=R("yAriaDescription"),$H=R("yReverse"),kH=R("yZero"),OH=R("facetMargin"),LH=R("facetMarginTop"),RH=R("facetMarginBottom"),FH=R("facetMarginLeft"),DH=R("facetMarginRight"),CH=R("facetGrid"),BH=R("facetLabel"),PH=R("fxDomain"),UH=R("fxRange"),zH=R("fxNice"),jH=R("fxInset"),qH=R("fxInsetLeft"),YH=R("fxInsetRight"),VH=R("fxRound"),WH=R("fxAlign"),GH=R("fxPadding"),HH=R("fxPaddingInner"),XH=R("fxPaddingOuter"),KH=R("fxAxis"),QH=R("fxTicks"),JH=R("fxTickSize"),ZH=R("fxTickSpacing"),tX=R("fxTickPadding"),eX=R("fxTickFormat"),nX=R("fxTickRotate"),iX=R("fxGrid"),rX=R("fxLine"),sX=R("fxLabel"),oX=R("fxLabelAnchor"),aX=R("fxLabelOffset"),cX=R("fxFontVariant"),lX=R("fxAriaLabel"),uX=R("fxAriaDescription"),fX=R("fxReverse"),hX=R("fyDomain"),dX=R("fyRange"),pX=R("fyNice"),yX=R("fyInset"),mX=R("fyInsetTop"),gX=R("fyInsetBottom"),bX=R("fyRound"),wX=R("fyAlign"),_X=R("fyPadding"),vX=R("fyPaddingInner"),xX=R("fyPaddingOuter"),SX=R("fyAxis"),EX=R("fyTicks"),AX=R("fyTickSize"),TX=R("fyTickSpacing"),IX=R("fyTickPadding"),MX=R("fyTickFormat"),NX=R("fyTickRotate"),$X=R("fyGrid"),kX=R("fyLine"),OX=R("fyLabel"),LX=R("fyLabelAnchor"),RX=R("fyLabelOffset"),FX=R("fyFontVariant"),DX=R("fyAriaLabel"),CX=R("fyAriaDescription"),BX=R("fyReverse"),PX=R("colorScale"),UX=R("colorDomain"),zX=R("colorRange"),jX=R("colorClamp"),qX=R("colorNice"),YX=R("colorScheme"),VX=R("colorInterpolate"),WX=R("colorPivot"),GX=R("colorSymmetric"),HX=R("colorLabel"),XX=R("colorReverse"),KX=R("colorZero"),QX=R("colorTickFormat"),JX=R("opacityScale"),ZX=R("opacityDomain"),tK=R("opacityRange"),eK=R("opacityClamp"),nK=R("opacityNice"),iK=R("opacityLabel"),rK=R("opacityReverse"),sK=R("opacityZero"),oK=R("opacityTickFormat"),aK=R("rScale"),cK=R("rDomain"),lK=R("rRange"),uK=R("rClamp"),fK=R("rNice"),hK=R("rZero"),dK=R("lengthScale"),pK=R("lengthDomain"),yK=R("lengthRange"),mK=R("lengthClamp"),gK=R("lengthNice"),bK=R("lengthZero"),wK=R("projectionType"),_K=R("projectionParallels"),vK=R("projectionPrecision"),xK=R("projectionRotate"),SK=R("projectionDomain"),EK=R("projectionInset"),AK=R("projectionInsetLeft"),TK=R("projectionInsetRight"),IK=R("projectionInsetTop"),MK=R("projectionInsetBottom"),NK=R("projectionClip"),$K=Object.freeze(Object.defineProperty({__proto__:null,align:bG,aspectRatio:wG,attribute:eN,attributes:Mb,axis:_G,colorClamp:jX,colorDomain:UX,colorInterpolate:VX,colorLabel:HX,colorNice:qX,colorPivot:WX,colorRange:zX,colorReverse:XX,colorScale:PX,colorScheme:YX,colorSymmetric:GX,colorTickFormat:QX,colorZero:KX,facetGrid:CH,facetLabel:BH,facetMargin:OH,facetMarginBottom:RH,facetMarginLeft:FH,facetMarginRight:DH,facetMarginTop:LH,fxAlign:WH,fxAriaDescription:uX,fxAriaLabel:lX,fxAxis:KH,fxDomain:PH,fxFontVariant:cX,fxGrid:iX,fxInset:jH,fxInsetLeft:qH,fxInsetRight:YH,fxLabel:sX,fxLabelAnchor:oX,fxLabelOffset:aX,fxLine:rX,fxNice:zH,fxPadding:GH,fxPaddingInner:HH,fxPaddingOuter:XH,fxRange:UH,fxReverse:fX,fxRound:VH,fxTickFormat:eX,fxTickPadding:tX,fxTickRotate:nX,fxTickSize:JH,fxTickSpacing:ZH,fxTicks:QH,fyAlign:wX,fyAriaDescription:CX,fyAriaLabel:DX,fyAxis:SX,fyDomain:hX,fyFontVariant:FX,fyGrid:$X,fyInset:yX,fyInsetBottom:gX,fyInsetTop:mX,fyLabel:OX,fyLabelAnchor:LX,fyLabelOffset:RX,fyLine:kX,fyNice:pX,fyPadding:_X,fyPaddingInner:vX,fyPaddingOuter:xX,fyRange:dX,fyReverse:BX,fyRound:bX,fyTickFormat:MX,fyTickPadding:IX,fyTickRotate:NX,fyTickSize:AX,fyTickSpacing:TX,fyTicks:EX,grid:xG,height:hG,inset:vG,label:SG,lengthClamp:mK,lengthDomain:pK,lengthNice:gK,lengthRange:yK,lengthScale:dK,lengthZero:bK,margin:dG,marginBottom:gG,marginLeft:pG,marginRight:yG,marginTop:mG,margins:cG,name:aG,opacityClamp:eK,opacityDomain:ZX,opacityLabel:iK,opacityNice:nK,opacityRange:tK,opacityReverse:rK,opacityScale:JX,opacityTickFormat:oK,opacityZero:sK,padding:EG,projectionClip:NK,projectionDomain:SK,projectionInset:EK,projectionInsetBottom:MK,projectionInsetLeft:AK,projectionInsetRight:TK,projectionInsetTop:IK,projectionParallels:_K,projectionPrecision:vK,projectionRotate:xK,projectionType:wK,rClamp:uK,rDomain:cK,rNice:fK,rRange:lK,rScale:aK,rZero:hK,round:AG,style:uG,width:fG,xAlign:FG,xAriaDescription:ZG,xAriaLabel:JG,xAxis:PG,xClamp:LG,xDomain:IG,xFontVariant:QG,xGrid:WG,xInset:$G,xInsetLeft:kG,xInsetRight:OG,xLabel:HG,xLabelAnchor:XG,xLabelOffset:KG,xLine:GG,xNice:NG,xPadding:DG,xPaddingInner:CG,xPaddingOuter:BG,xRange:MG,xReverse:tH,xRound:RG,xScale:TG,xTickFormat:YG,xTickPadding:qG,xTickRotate:VG,xTickSize:zG,xTickSpacing:jG,xTicks:UG,xZero:eH,xyDomain:lG,yAlign:fH,yAriaDescription:NH,yAriaLabel:MH,yAxis:yH,yClamp:lH,yDomain:iH,yFontVariant:IH,yGrid:xH,yInset:oH,yInsetBottom:cH,yInsetTop:aH,yLabel:EH,yLabelAnchor:AH,yLabelOffset:TH,yLine:SH,yNice:sH,yPadding:hH,yPaddingInner:dH,yPaddingOuter:pH,yRange:rH,yReverse:$H,yRound:uH,yScale:nH,yTickFormat:_H,yTickPadding:wH,yTickRotate:vH,yTickSize:gH,yTickSpacing:bH,yTicks:mH,yZero:kH},Symbol.toStringTag,{value:"Module"}));function kK(e,t){return{table:e,options:t}}function Nb(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),e==="none"||e==="currentcolor"||e.startsWith("url(")&&e.endsWith(")")||e.startsWith("var(")&&e.endsWith(")")||fr(e)!==null)}const OK=new Set(["order","sort","label","anchor","curve","tension","marker","markerStart","markerMid","markerEnd","textAnchor","lineAnchor","lineHeight","textOverflow","monospace","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","frameAnchor","strokeLinejoin","strokeLinecap","strokeMiterlimit","strokeDasharray","strokeDashoffset","mixBlendMode","shapeRendering","imageRendering","preserveAspectRatio","interpolate","crossOrigin","paintOrder","pointerEvents"]);function LK(e){return OK.has(e)}const RK=new Set(["asterisk","circle","cross","diamond","diamond2","hexagon","plus","square","square2","star","times","triangle","triangle2","wye"]);function FK(e){return RK.has(`${e}`.toLowerCase())}const nN=e=>e==="stroke"||e==="fill",DK=e=>e==="symbol",CK=(e,t)=>e!=="sort"&&t!=null&&!Array.isArray(t),Gy=(e,t)=>({channel:e,field:t,as:t instanceof Gr?t.column:e}),Hy=(e,t)=>({channel:e,value:t});class Ja extends Fl{constructor(t,n,i,r={}){var c;super((c=n==null?void 0:n.options)==null?void 0:c.filterBy),this.type=t,this.reqs=r,this.source=n,Array.isArray(this.source)&&(this.data=this.source);const s=this.channels=[],o=this.params=new Set,a=(l,u)=>{const h=typeof u;if(h==="function"&&u[PS]){const f=u(this,l);for(const d in f)a(d,f[d])}else if(h==="string")LK(l)||nN(l)&&Nb(u)||DK(l)&&FK(u)?s.push(Hy(l,u)):s.push(Gy(l,bg(u)));else if(pa(u))if(Array.isArray(u.columns))s.push(Gy(l,u)),o.add(u);else{const f=Hy(l,u.value);s.push(f),u.addEventListener("value",d=>(f.value=d,this.update()))}else h==="object"&&CK(l,u)?s.push(Gy(l,u)):u!==void 0&&s.push(Hy(l,u))};for(const l in i)a(l,i[l])}setPlot(t,n){var i;this.plot=t,this.index=n,t.addParams(this,this.params),(i=this.source)!=null&&i.table&&this.queryPending()}hasOwnData(){return this.source==null||Array.isArray(this.source)}channel(t){return this.channels.find(n=>n.channel===t)}channelField(...t){const n=t.flat();for(const i of n){const r=this.channel(i);if(r!=null&&r.field)return r}return null}fields(){var s,o,a;if(this.hasOwnData())return null;const{source:{table:t},channels:n,reqs:i}=this,r=new Map;for(const{channel:c,field:l}of n){const u=l==null?void 0:l.column;if(u){if((s=l.stats)!=null&&s.length||i[c]){r.has(u)||r.set(u,new Set);const h=r.get(u);(o=i[c])==null||o.forEach(f=>h.add(f)),(a=l.stats)==null||a.forEach(f=>h.add(f))}}else continue}return Array.from(r,([c,l])=>({table:t,column:c,stats:Array.from(l)}))}fieldInfo(t){return this.stats=t.reduce((n,i)=>(n[i.column]=i,n),Object.create(null)),this}query(t=[]){if(this.hasOwnData())return null;const{channels:n,source:{table:i}}=this;return iN(n,i).where(t)}queryPending(){return this.plot.pending(this),this}queryResult(t){return this.data=Array.from(t),this}update(){return this.plot.update(this)}plotSpecs(){const{type:t,data:n,channels:i}=this,r={};for(const s of i)r[s.channel]=Fr(s);return[{type:t,data:n,options:r}]}}function Fr(e){return Object.hasOwn(e,"value")?e.value:nN(e.channel)?{value:e.as,scale:"color"}:e.as}function iN(e,t,n=[]){const i=St.from({source:t}),r=new Set;let s=!1;for(const o of e){const{channel:a,field:c,as:l}=o;if(!n.includes(a)){if(a==="order")i.orderby(o.value);else if(c){if(c.aggregate)s=!0;else{if(r.has(l))continue;r.add(l)}i.select({[l]:c})}}}return s&&i.groupby(Array.from(r)),i}function es(e,t,n){if(!e.stats)return i;const{field:i}=e.channelField(t),{type:r}=e.stats[i.column];return n=n??i,r==="date"?MS(n):n}function km(e,t,n,i,r=!1,s=1){const o=(i-s)/(n-t),a=o!==1?` * ${o}::DOUBLE`:"";return r?q`(${+n} - ${e}::DOUBLE)${a}`:q`(${e}::DOUBLE - ${+t})${a}`}const rN={x:["min","max"]},sN={y:["min","max"]},oN={...rN,...sN};function aN(e,t,n,i,r){const{plot:s,stats:o}=e,a=s.getAttribute(i),c=s.getAttribute(r);if(Array.isArray(a)&&!a[Ks])return a;{const{field:l}=e.channelField(n),{column:u}=l,{min:h,max:f}=o[u],d=cN(t,u)||(c?Rd().domain([h,f]).nice().domain():[h,f]);return a!==Ag&&(d[Ks]=!0),s.setAttribute(i,d,{silent:!0}),d}}function ru(e,t){return aN(e,t,"x","xDomain","xNice")}function su(e,t){return aN(e,t,"y","yDomain","yNice")}function cN(e,t){if(!e)return;let n,i;const r=(s,o)=>{if(s==="BETWEEN"&&o.field.column===t){const{range:a}=o;a&&(n==null||a[0]<n)&&(n=a[0]),a&&(i==null||a[1]>i)&&(i=a[1])}};return Array.isArray(e)?e.forEach(s=>{var o;return(o=s.visit)==null?void 0:o.call(s,r)}):e.visit&&e.visit(r),n!=null&&i!=null&&n!==i?[n,i]:void 0}class BK extends Ja{constructor(t,n,i){const r=t.endsWith("X")?"y":"x",s={[r]:["count","min","max"]};super(t,n,i,s),this.dim=r}query(t=[]){const{plot:n,dim:i,source:r,stats:s}=this,{optimize:o=!0}=r.options||{},{field:a,as:c}=this.channelField(i),l=super.query(t);if(o){const{column:u}=a,{count:h,max:f,min:d}=s[u],p=i==="x"?n.innerWidth():n.innerHeight(),[y,m]=cN(t,u)||[d,f],g=(m-y)/(f-d);if(h*g>p*4){const b=es(this,i,c),w=this.channelField(i==="x"?"y":"x").as,_=l.select().map(x=>x.as).filter(x=>x!==c&&x!==w);return PK(l,b,c,w,y,m,p,_)}}return l.orderby(c)}}function PK(e,t,n,i,r,s,o,a=[]){const c=q`FLOOR(${o/(s-r)}::DOUBLE * (${t} - ${+r}::DOUBLE))::INTEGER`,l=u=>St.from(e).select(u).groupby(c,a);return St.union(l([{[n]:ma(n),[i]:xw(i,n)},...a]),l([{[n]:ya(n),[i]:Sw(i,n)},...a]),l([{[n]:xw(n,i),[i]:ma(i)},...a]),l([{[n]:Sw(n,i),[i]:ya(i)},...a])).orderby(a,n)}function Om(e,t=!1){const n=new Float64Array(5),i=new Float64Array(4);UK(n,i,e);const r=Float64Array.of(0,i[1]-n[1]*i[0],i[2]-n[2]*i[0],i[3]-n[3]*i[0],-n[4]*i[0]),s=1+n[1]+n[2]+n[3]+n[4],o=(i[0]+i[1]+i[2]+i[3])/s,a=(r[1]+r[2]+r[3]+r[4])/s;return{sigma:e,negative:t,a:n,b_causal:i,b_anticausal:r,sum_causal:o,sum_anticausal:a}}function UK(e,t,n){const r=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),s=Math.exp(-1.783/n),o=Math.exp(-1.723/n),a=.6318/n,c=1.997/n,l=Float64Array.of(-s*Math.cos(a),s*Math.sin(a),-s*Math.cos(-a),s*Math.sin(-a),-o*Math.cos(c),o*Math.sin(c),-o*Math.cos(-c),o*Math.sin(-c)),u=n*2.5066282746310007,h=Float64Array.of(r[0],r[1],0,0,0,0,0,0),f=Float64Array.of(1,0,l[0],l[1],0,0,0,0,0,0);let d,p;for(p=2;p<8;p+=2){for(h[p]=l[p]*h[p-2]-l[p+1]*h[p-1],h[p+1]=l[p]*h[p-1]+l[p+1]*h[p-2],d=p-2;d>0;d-=2)h[d]+=l[p]*h[d-2]-l[p+1]*h[d-1],h[d+1]+=l[p]*h[d-1]+l[p+1]*h[d-2];for(d=0;d<=p;d+=2)h[d]+=r[p]*f[d]-r[p+1]*f[d+1],h[d+1]+=r[p]*f[d+1]+r[p+1]*f[d];for(f[p+2]=l[p]*f[p]-l[p+1]*f[p+1],f[p+3]=l[p]*f[p+1]+l[p+1]*f[p],d=p;d>0;d-=2)f[d]+=l[p]*f[d-2]-l[p+1]*f[d-1],f[d+1]+=l[p]*f[d-1]+l[p+1]*f[d-2]}for(p=0;p<4;++p)d=p<<1,t[p]=h[d]/u,e[p+1]=f[d+2]}function zK(e,t,n,[i,r]){const s=new Float64Array(Math.max(i,r)),o=new Float64Array(Math.max(i,r)),a=new Float64Array(5),c=new Float64Array(n.length);for(let l=0,u=0;l<r;++l,u+=i){const h=c.subarray(u);Lm(e,n.subarray(u),i,1,s,o,a,h)}for(let l=0;l<i;++l){const u=c.subarray(l);Lm(t,u,r,i,s,o,a,u)}return c}function Lm(e,t,n,i=1,r=new Float64Array(n),s=new Float64Array(n),o=new Float64Array(5),a=r,c=jK){const l=i*2,u=i*3,h=i*4,f=i*n;let d,p;for(c(r,t,n,i,e.b_causal,3,e.a,4,e.sum_causal,o,e.sigma),p=4,d=h;p<n;++p,d+=i)r[p]=e.b_causal[0]*t[d]+e.b_causal[1]*t[d-i]+e.b_causal[2]*t[d-l]+e.b_causal[3]*t[d-u]-e.a[1]*r[p-1]-e.a[2]*r[p-2]-e.a[3]*r[p-3]-e.a[4]*r[p-4];for(c(s,t,n,-i,e.b_anticausal,4,e.a,4,e.sum_anticausal,o,e.sigma),p=4,d=f-i*5;p<n;++p,d-=i)s[p]=e.b_anticausal[1]*t[d+i]+e.b_anticausal[2]*t[d+l]+e.b_anticausal[3]*t[d+u]+e.b_anticausal[4]*t[d+h]-e.a[1]*s[p-1]-e.a[2]*s[p-2]-e.a[3]*s[p-3]-e.a[4]*s[p-4];if(e.negative)for(p=0,d=0;p<n;++p,d+=i)a[d]=r[p]+s[n-p-1];else for(p=0,d=0;p<n;++p,d+=i)a[d]=Math.max(0,r[p]+s[n-p-1]);return a}function jK(e,t,n,i,r,s,o,a,c,l){const u=Math.abs(i)*n,h=i<0?u+i:0;let f,d,p;for(d=0;d<a;++d)for(l[d]=d<=s?r[d]:0,p=1;p<=a&&p<=d;++p)l[d]-=o[p]*l[d-p];for(p=0;p<a;++p)for(e[p]=0,d=1;d<=p;++d)f=h+i*d,f>=0&&f<u&&(e[p]+=l[p-d]*t[f]);const y=t[h];if(y>0)for(p=0;p<a;++p)e[p]+=l[p]*y}function qK(e,t){return uN(new Float64Array(e),t)}function YK(e,t,n,i=[]){return i.length?Object.values(VK(e*t,n,i)):[{grid:uN(new Float64Array(e*t),n)}]}function lN(e){return typeof e.getChild=="function"}function uN(e,t){if(lN(t)){const n=t.numRows;if(n===0)return e;const i=t.getChild("index").toArray(),r=t.getChild("value").toArray();for(let s=0;s<n;++s)e[i[s]]=r[s]}else for(const n of t)e[n.index]=n.value;return e}function VK(e,t,n){const i={},r=s=>(i[s]||(i[s]={key:s,grid:new Float64Array(e)})).grid;if(lN(t)){const s=t.numRows;if(s===0)return i;const o=t.getChild("index").toArray(),a=t.getChild("value").toArray(),c=n.map(l=>t.getChild(l));for(let l=0;l<s;++l){const u=c.map(h=>h.get(l));r(u)[o[l]]=a[l]}}else for(const s of t){const o=n.map(a=>s[a]);r(o)[s.index]=s.value}return i}function Ln(e,t,n,i){Cr(n)?(i=i||(()=>e.requestUpdate()),n.addEventListener("value",r=>(e[t]=r,i())),e[t]=n.value):e[t]=n}class fN extends Ja{constructor(t,n,i){const{bins:r=1024,bandwidth:s=20,...o}=i,a=t.endsWith("X")?"y":"x";super(t,n,o,a==="x"?rN:sN),this.dim=a,Ln(this,"bins",r),Ln(this,"bandwidth",s,()=>this.grid?this.convolve().update():null)}get filterIndexable(){const t=this.dim==="x"?"xDomain":"yDomain",n=this.plot.getAttribute(t);return n&&!n[Ks]}query(t=[]){if(this.hasOwnData())throw new Error("Density1DMark requires a data source");const{bins:n,channels:i,dim:r,source:{table:s}}=this,[o,a]=this.extent=(r==="x"?ru:su)(this,t),c=es(this,r);return WK(iN(i,s,[r]).where(t.concat(wn(c,[o,a]))),km(c,o,a,n),this.channelField("weight")?"weight":null)}queryResult(t){return this.grid=qK(this.bins,t),this.convolve()}convolve(){const{bins:t,bandwidth:n,dim:i,grid:r,plot:s,extent:[o,a]}=this,c=r.some(b=>b<0),l=i==="x"?s.innerWidth():s.innerHeight(),u=Om(n*(t-1)/l,c),h=Lm(u,r,t),f=this.data=[],d=i==="x"?"y":"x",p=this.channelField(i).as,y=+o,m=(a-y)/(t-1),g=1/m;for(let b=0;b<t;++b)f.push({[p]:y+b*m,[d]:h[b]*g});return this}plotSpecs(){const{type:t,data:n,channels:i,dim:r}=this,s=r==="x"?{y:"y"}:{x:"x"};for(const o of i)s[o.channel]=Fr(o);return[{type:t,data:n,options:s}]}}function WK(e,t,n){const i=n?`* ${n}`:"",r=e.clone().select({p:t,i:q`FLOOR(p)::INTEGER`,w:q`(FLOOR(p) + 1 - p)${i}`}),s=e.clone().select({p:t,i:q`FLOOR(p)::INTEGER + 1`,w:q`(p - FLOOR(p))${i}`});return St.from(St.unionAll(r,s)).select({index:"i",value:co("w")}).groupby("index").having(IS("value",0))}class xp extends Ja{constructor(t,n,i){const{bandwidth:r=20,binType:s="linear",binWidth:o=2,binPad:a=1,...c}=i,l=GK(c);super(t,n,c,oN),this.densityMap=l,Ln(this,"bandwidth",r,()=>this.grids?this.convolve().update():null),Ln(this,"binWidth",o),Ln(this,"binType",s),Ln(this,"binPad",a)}setPlot(t,n){const i=()=>{this.stats&&this.requestUpdate()};return t.addAttributeListener("domainX",i),t.addAttributeListener("domainY",i),super.setPlot(t,n)}get filterIndexable(){const t=this.plot.getAttribute("xDomain"),n=this.plot.getAttribute("yDomain");return t&&n&&!t[Ks]&&!n[Ks]}query(t=[]){const{plot:n,binType:i,binPad:r,channels:s,densityMap:o,source:a}=this,[c,l]=this.extentX=ru(this,t),[u,h]=this.extentY=su(this,t),[f,d]=this.bins=this.binDimensions(this),p=es(this,"x"),y=es(this,"y"),m=!!n.getAttribute("xReverse"),g=!!n.getAttribute("yReverse"),b=fv(p,c,l,f,m,this.binPad),w=fv(y,u,h,d,g,this.binPad),_=r?[wn(p,[c,l]),wn(y,[u,h])]:[Xf(c,p),Hf(p,l),Xf(u,y),Hf(y,h)],x=St.from(a.table).where(t.concat(_)),v=this.groupby=[];let E=js();for(const T of s)if(Object.hasOwn(T,"field")){const{as:k,channel:A,field:I}=T;I.aggregate?(E=I,o[A]=!0):A==="weight"?E=co(I):A!=="x"&&A!=="y"&&(x.select({[k]:I}),v.push(k))}return i==="linear"?XK(x,b,w,E,f,v):HK(x,b,w,E,f,v)}binDimensions(){const{plot:t,binWidth:n}=this;return[Math.round(t.innerWidth()/n),Math.round(t.innerHeight()/n)]}queryResult(t){const[n,i]=this.bins;return this.grids=YK(n,i,t,this.groupby),this.convolve()}convolve(){const{bandwidth:t,bins:n,grids:i,plot:r}=this;if(t<=0)this.kde=this.grids.map(({key:s,grid:o})=>(o.key=s,o));else{const s=r.innerWidth(),o=r.innerHeight(),[a,c]=n,l=i.some(({grid:f})=>f.some(d=>d<0)),u=Om(t*(a-1)/s,l),h=Om(t*(c-1)/o,l);this.kde=this.grids.map(({key:f,grid:d})=>{const p=zK(u,h,d,n);return p.key=f,p})}return this}plotSpecs(){throw new Error("Unimplemented. Use a Grid2D mark subclass.")}}function GK(e){const t={};for(const n in e)e[n]==="density"&&(delete e[n],t[n]=!0);return t}function fv(e,t,n,i,r,s){const o=(i-s)/(n-t),a=o!==1?` * ${o}::DOUBLE`:"";return r?q`(${n} - ${e}::DOUBLE)${a}`:q`(${e}::DOUBLE - ${t})${a}`}function HK(e,t,n,i,r,s){return e.select({index:q`FLOOR(${t})::INTEGER + FLOOR(${n})::INTEGER * ${r}`,value:i}).groupby("index",s)}function XK(e,t,n,i,r,s){const o=i.column?`* ${i.column}`:"",a=(f,d)=>e.clone().select({xp:t,yp:n,i:f,w:d}),c=a(q`FLOOR(xp)::INTEGER + FLOOR(yp)::INTEGER * ${r}`,q`(FLOOR(xp)::INTEGER + 1 - xp) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),l=a(q`FLOOR(xp)::INTEGER + (FLOOR(yp)::INTEGER + 1) * ${r}`,q`(FLOOR(xp)::INTEGER + 1 - xp) * (yp - FLOOR(yp)::INTEGER)${o}`),u=a(q`FLOOR(xp)::INTEGER + 1 + FLOOR(yp)::INTEGER * ${r}`,q`(xp - FLOOR(xp)::INTEGER) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),h=a(q`FLOOR(xp)::INTEGER + 1 + (FLOOR(yp)::INTEGER + 1) * ${r}`,q`(xp - FLOOR(xp)::INTEGER) * (yp - FLOOR(yp)::INTEGER)${o}`);return St.from(St.unionAll(c,l,u,h)).select({index:"i",value:co("w")},s).groupby("index",s).having(IS("value",0))}class KK extends xp{constructor(t,n){const{type:i="dot",binsX:r,binsY:s,...o}=n;o.binPad=o.binPad??0,super(i,t,o),Ln(this,"binsX",r),Ln(this,"binsY",s)}convolve(){super.convolve();const{bins:t,binPad:n,extentX:i,extentY:r}=this,[s,o]=t,[a,c]=i,[l,u]=r,h=(c-a)/(s-n),f=(u-l)/(o-n),d=n?0:.5;return this.data=QK(this.kde,t,a,l,h,f,d),this}binDimensions(){const{plot:t,binWidth:n,binsX:i,binsY:r}=this;return[i??Math.round(t.innerWidth()/n),r??Math.round(t.innerHeight()/n)]}plotSpecs(){const{type:t,channels:n,densityMap:i,data:r}=this,s={};for(const o of n){const{channel:a}=o;s[a]=a==="x"||a==="y"?a:Fr(o)}for(const o in i)i[o]&&(s[o]="density");return[{type:t,data:r,options:s}]}}function QK(e,t,n,i,r,s,o){const a=1/(r*s),[c,l]=t,u=[];for(const h of e)for(let f=0,d=0;d<l;++d)for(let p=0;p<c;++p,++f)u.push({x:n+(p+o)*r,y:i+(d+o)*s,density:h[f]*a});return u}function hN(e,t,n,i,r,s){const o=(s.length>>2)-1;for(let a=0,c=0;a<i;++a)for(let l=0,u=(i-a-1)*n;l<n;++l,c+=4){const h=o*r(e[l+u])<<2;t[c+0]=s[h+0],t[c+1]=s[h+1],t[c+2]=s[h+2],t[c+3]=s[h+3]}}function id(e,t){const n=new Uint8ClampedArray(4*e),i=e-1;for(let r=0;r<=i;++r){const s=t(r/i),{r:o,g:a,b:c,opacity:l=1}=typeof s=="string"?Dn(s):s,u=r<<2;n[u+0]=o,n[u+1]=a,n[u+2]=c,n[u+3]=255*l|0}return n}function dN(e,t){if(typeof document<"u"){const n=document.createElement("canvas");return n.setAttribute("width",e),n.setAttribute("height",t),n}throw new Error("Can not create a canvas instance.")}function pN(e="black"){const{r:t,g:n,b:i}=Dn(e);return r=>({r:t,g:n,b:i,opacity:r})}class yN extends xp{constructor(t,n){super("image",t,n)}setPlot(t,n){const i=()=>{this.stats&&this.rasterize()};t.addAttributeListener("schemeColor",i),super.setPlot(t,n)}convolve(){return super.convolve().rasterize()}rasterize(){var f;const{bins:t,kde:n,groupby:i}=this,[r,s]=t,{canvas:o,ctx:a,img:c}=JK(this,r,s),l=ZK(this),u=i.indexOf((f=this.channelField("fill"))==null?void 0:f.as),h=u<0?[]:n.map(({key:d})=>d[u]);return this.data=n.map(d=>{var y;const p=tQ(this,h,(y=d.key)==null?void 0:y[u]);return hN(d,c.data,r,s,l,p),a.putImageData(c,0,0),{src:o.toDataURL()}}),this}plotSpecs(){var s;const{type:t,plot:n,data:i}=this,r={src:"src",width:n.innerWidth(),height:n.innerHeight(),preserveAspectRatio:"none",imageRendering:(s=this.channel("imageRendering"))==null?void 0:s.value,frameAnchor:"middle"};return[{type:t,data:i,options:r}]}}function JK(e,t,n){if(!e.image||e.image.w!==t||e.image.h!==n){const i=dN(t,n),r=i.getContext("2d",{willReadFrequently:!0}),s=r.getImageData(0,0,t,n);e.image={canvas:i,ctx:r,img:s,w:t,h:n}}return e.image}function ZK(e){const{densityMap:t,kde:n,plot:i}=e;let r=t.fill&&i.getAttribute("colorDomain");if(!r){let o=0,a=0;n.forEach(c=>{for(const l of c)l<o&&(o=l),l>a&&(a=l)}),r=o===0&&a===0?[0,1]:[o,a]}const s=i.getAttribute("colorScale");return so({x:{type:s,domain:r,range:[0,1]}}).apply}function tQ(e,t,n,i=1024){const{densityMap:r,plot:s}=e,o=s.getAttribute("colorScheme");let a;if(r.fill){if(o)try{return id(i,so({color:{scheme:o,domain:[0,1]}}).interpolate)}catch(c){console.warn(c)}}else if(t.length){const c=s.getAttribute("colorRange");a=so({color:{domain:t,range:c,scheme:o||(c?void 0:"tableau10")}}).apply(n)}else{const c=e.channelField("fill");a=Nb(c==null?void 0:c.value)?c.value:void 0}return id(i,pN(a))}class eQ extends yN{constructor(t,n){const{normalize:i=!0,...r}=n;super(t,{bandwidth:0,...r}),Ln(this,"normalize",i)}query(t=[]){const{plot:n,channels:i,normalize:r,source:s}=this,[o,a]=ru(this,t),[c,l]=su(this,t),[u,h]=this.bins=this.binDimensions(this),f=es(this,"x"),d=es(this,"y"),p=!!n.getAttribute("xReverse"),y=!!n.getAttribute("yReverse"),m=km(f,o,a,u,p,this.binPad),g=km(d,c,l,h,y,this.binPad),b=St.from(s.table).where(nQ(this,t)),w=this.groupby=[],_=[];for(const x of i)if(Object.hasOwn(x,"field")){const{channel:v,field:E}=x;v==="z"?(b.select({[v]:E}),_.push("z")):v!=="x"&&v!=="y"&&(b.select({[v]:E}),w.push(v))}return iQ(b,m,g,_,u,h,w,r)}}function nQ(e,t){if(Array.isArray(t)&&!t.length)return t;const n=e.channelField("x").field.column,i=e.channelField("y").field.column,r=o=>o.op!=="BETWEEN"||o.field.column!==n&&o.field.column!==i,s=o=>o.op==="AND"?Hs(o.children.filter(a=>r(a))):o;return Array.isArray(t)?t.filter(o=>r(o)).map(o=>s(o)):s(t)}function iQ(e,t,n,i,r,s,o=[],a=!0){e.select({x:q`FLOOR(${t})::INTEGER`,y:q`FLOOR(${n})::INTEGER`});const c=o.concat(i),l=c.length?`PARTITION BY ${c.join(", ")} `:"",u=St.from(e).select(c,{x0:"x",y0:"y",dx:q`(lead(x) OVER sw - x)`,dy:q`(lead(y) OVER sw - y)`}).window({sw:q`${l}ORDER BY x ASC`}).qualify(Hs(q`(x0 < ${r} OR x0 + dx < ${r})`,q`(y0 < ${s} OR y0 + dy < ${s})`,q`(x0 > 0 OR x0 + dx > 0)`,q`(y0 > 0 OR y0 + dy > 0)`)),h=St.select({x:q`GREATEST(MAX(ABS(dx)), MAX(ABS(dy)))`}).from("pairs"),f=St.select({i:q`UNNEST(range((${h})))::INTEGER`}),d=St.unionAll(St.select(c,{x:q`x0 + i`,y:q`y0 + ROUND(i * dy / dx::FLOAT)::INTEGER`}).from("pairs","indices").where(q`ABS(dy) <= ABS(dx) AND i < ABS(dx)`),St.select(c,{x:q`x0 + ROUND(SIGN(dy) * i * dx / dy::FLOAT)::INTEGER`,y:q`y0 + SIGN(dy) * i`}).from("pairs","indices").where(q`ABS(dy) > ABS(dx) AND i < ABS(dy)`),St.select(c,{x:"x0",y:"y0"}).from("pairs").where(TS("dx"))),p=["x"].concat(c).join(", "),y=St.from("raster").select(c,"x","y",a?{w:q`1.0 / COUNT(*) OVER (PARTITION BY ${p})`}:null).where(Hs(wn("x",[0,r]),wn("y",[0,s])));return St.with({pairs:u,indices:f,raster:d,points:y}).from("points").select(o,{index:q`x + y * ${r}::INTEGER`,value:a?co("w"):js()}).groupby("index",o)}class rQ extends xp{constructor(t,n){const{thresholds:i=10,...r}=n;super("geo",t,r),Ln(this,"thresholds",i,()=>this.grids?this.contours().update():null)}convolve(){return super.convolve().contours()}contours(){const{bins:t,densityMap:n,kde:i,thresholds:r,groupby:s,plot:o}=this;let a=r;if(!Array.isArray(a)){const x=oe(i.map(v=>oe(v)));a=Array.from({length:a-1},(v,E)=>x*(E+1)/a)}(n.fill||n.stroke)&&this.plot.getAttribute("colorScale")!=="log"&&this.plot.setAttribute("colorZero",!0);const[c,l]=t,[u,h]=o.getAttribute("xDomain"),[f,d]=o.getAttribute("yDomain"),p=(h-u)/c,y=(d-f)/l,m=+u,g=+f,b=x=>m+x*p,w=x=>g+x*y,_=sh().size(t);return this.data=i.flatMap(x=>a.map(v=>{const E=sQ(_.contour(x,v),b,w);return s.forEach((T,k)=>E[T]=x.key[k]),E.density=v,E})),this}plotSpecs(){const{type:t,channels:n,densityMap:i,data:r}=this,s={};for(const o of n){const{channel:a}=o;a!=="x"&&a!=="y"&&(s[a]=Fr(o))}return i.fill&&(s.fill="density"),i.stroke&&(s.stroke="density"),[{type:t,data:r,options:s}]}}function sQ(e,t,n){function i(o){o.forEach(r)}function r(o){o.forEach(s)}function s(o){o[0]=t(o[0]),o[1]=n(o[1])}return e.coordinates.forEach(i),e}class oQ extends Ja{constructor(t,n){const{type:i="hexagon",binWidth:r=20,...s}=n;super(i,t,{r:r/2,clip:!0,...s},oN),this.binWidth=r}get filterIndexable(){const t=this.plot.getAttribute("xDomain"),n=this.plot.getAttribute("yDomain");return t&&n&&!t[Ks]&&!n[Ks]}query(t=[]){if(this.hasOwnData())return null;const{plot:n,binWidth:i,channels:r,source:s}=this,[o,a]=ru(this,t),[c,l]=su(this,t),u=.5-n.getAttribute("marginLeft"),h=0-n.getAttribute("marginTop"),f=`${i}::DOUBLE`,d=`${i*(1.5/Math.sqrt(3))}::DOUBLE`,p=`${n.innerWidth()/(a-o)}::DOUBLE`,y=`${n.innerHeight()/(l-c)}::DOUBLE`;let m,g;const b=new Set,w={};for(const T of r)T.channel==="order"?_.orderby(T.value):T.channel==="x"?m=T:T.channel==="y"?g=T:Object.hasOwn(T,"field")&&(w[T.as]=T.field,T.field.aggregate&&T.field.columns.forEach(k=>b.add(k)));const _=St.select({[m.as]:q`${o}::DOUBLE + ((x + 0.5 * (y & 1)) * ${f} + ${u})::DOUBLE / ${p}`,[g.as]:q`${l}::DOUBLE - (y * ${d} + ${h})::DOUBLE / ${y}`,...w}).groupby("x","y"),x=`${p} * (${m.field} - ${o}::DOUBLE)`,v=`${y} * (${l}::DOUBLE - ${g.field})`,E=St.select({py:q`(${v} - ${h}) / ${d}`,pj:q`ROUND(py)::INTEGER`,px:q`(${x} - ${u}) / ${f} - 0.5 * (pj & 1)`,pi:q`ROUND(px)::INTEGER`,tt:q`ABS(py-pj) * 3 > 1 AND (px-pi)**2 + (py-pj)**2 > (px - pi - 0.5 * CASE WHEN px < pi THEN -1 ELSE 1 END)**2 + (py - pj - CASE WHEN py < pj THEN -1 ELSE 1 END)**2`,x:q`CASE WHEN tt THEN (pi + (CASE WHEN px < pi THEN -0.5 ELSE 0.5 END) + (CASE WHEN pj & 1 <> 0 THEN 0.5 ELSE -0.5 END))::INTEGER ELSE pi END`,y:q`CASE WHEN tt THEN (pj + CASE WHEN py < pj THEN -1 ELSE 1 END)::INTEGER ELSE pj END`}).select(Array.from(b)).from(s.table).where(Gf(m.field),Gf(g.field),t);return _.from(E)}}class aQ extends xp{constructor(t,n){const{origin:i=[0,0],dim:r="xy",...s}=n;super("image",t,s),this.origin=i,this.tileX=r.toLowerCase().includes("x"),this.tileY=r.toLowerCase().includes("y")}setPlot(t,n){const i=()=>{this.stats&&this.rasterize()};t.addAttributeListener("schemeColor",i),super.setPlot(t,n)}requestQuery(){return this.requestTiles()}query(t=[]){return this._filter=t,null}tileQuery(t){const{plot:n,binType:i,binPad:r,channels:s,densityMap:o,source:a}=this,[[c,l],[u,h]]=t,[f,d]=this.bins,p=es(this,"x"),y=es(this,"y"),m=!!n.getAttribute("xReverse"),g=!!n.getAttribute("yReverse"),b=hv(p,c,l,f,m,r),w=hv(y,u,h,d,g,r),_=r?[wn(p,[c,l]),wn(y,[u,h])]:[Xf(c,p),Hf(p,l),Xf(u,y),Hf(y,h)],x=St.from(a.table).where(_),v=this.groupby=[];let E=js();for(const T of s)if(Object.hasOwn(T,"field")){const{channel:k,field:A}=T;A.aggregate?(E=A,o[k]=!0):k==="weight"?E=co(A):k!=="x"&&k!=="y"&&(x.select({[k]:A}),v.push(k))}return i==="linear"?pQ(x,b,w,E,f,v):dQ(x,b,w,E,f,v)}async requestTiles(){const t=as();this.prefetch&&t.cancel(this.prefetch);const{binPad:n,tileX:i,tileY:r,origin:[s,o]}=this,[a,c]=this.bins=this.binDimensions(this),[l,u]=ru(this,this._filter),[h,f]=su(this,this._filter),d=u-l,p=f-h,y=Math.floor((l-s)*(a-n)/d),m=Math.floor((h-o)*(c-n)/p),g=(A,I)=>[[s+A*d,s+(A+1)*d],[o+I*p,o+(I+1)*p]],b=Math.floor((l-s)/d),w=i?dv((u-s)/d):b,_=Math.floor((h-o)/p),x=r?dv((f-o)/p):_,v=[];for(let A=b;A<=w;++A)for(let I=_;I<=x;++I)v.push([A,I]);const E=v.map(([A,I])=>t.query(this.tileQuery(g(A,I)))),T=[];if(i)for(let A=_;A<=x;++A)T.push([w+1,A]),T.push([b-1,A]);if(r){const A=i?b-1:b,I=i?w+1:w;for(let O=A;O<=I;++O)T.push([O,x+1]),T.push([O,_-1])}this.prefetch=T.map(([A,I])=>t.prefetch(this.tileQuery(g(A,I))));const k=await Promise.all(E);this.grids=[{grid:cQ(a,c,y,m,v,k)}],this.convolve().update()}convolve(){return super.convolve().rasterize()}rasterize(){var f;const{bins:t,kde:n,groupby:i}=this,[r,s]=t,{canvas:o,ctx:a,img:c}=uQ(this,r,s),l=fQ(this),u=i.indexOf((f=this.channelField("fill"))==null?void 0:f.as),h=u<0?[]:n.map(({key:d})=>d[u]);return this.data=n.map(d=>{var y;const p=hQ(this,h,(y=d.key)==null?void 0:y[u]);return hN(d,c.data,r,s,l,p),a.putImageData(c,0,0),{src:o.toDataURL()}}),this}plotSpecs(){var s;const{type:t,data:n,plot:i}=this,r={src:"src",width:i.innerWidth(),height:i.innerHeight(),preserveAspectRatio:"none",imageRendering:(s=this.channel("imageRendering"))==null?void 0:s.value,frameAnchor:"middle"};return[{type:t,data:n,options:r}]}}function cQ(e,t,n,i,r,s){const o=new Float64Array(e*t);return s.forEach((a,c)=>{const[l,u]=r[c],h=l*e-n,f=u*t-i;lQ(e,t,o,a,h,f)}),o}function lQ(e,t,n,i,r,s){const o=i.numRows;if(o===0)return;const a=i.getChild("index").toArray(),c=i.getChild("value").toArray();for(let l=0;l<o;++l){const u=a[l],h=r+u%e,f=s+Math.floor(u/e);0<=h&&h<e&&0<=f&&f<t&&(n[h+f*e]=c[l])}}function uQ(e,t,n){if(!e.image||e.image.w!==t||e.image.h!==n){const i=dN(t,n),r=i.getContext("2d",{willReadFrequently:!0}),s=r.getImageData(0,0,t,n);e.image={canvas:i,ctx:r,img:s,w:t,h:n}}return e.image}function fQ(e){const{densityMap:t,kde:n,plot:i}=e;let r=t.fill&&i.getAttribute("colorDomain");if(!r){let o=0,a=0;n.forEach(c=>{for(const l of c)l<o&&(o=l),l>a&&(a=l)}),r=o===0&&a===0?[0,1]:[o,a]}const s=i.getAttribute("colorScale");return so({x:{type:s,domain:r,range:[0,1]}}).apply}function hQ(e,t,n,i=1024){const{densityMap:r,plot:s}=e,o=s.getAttribute("colorScheme");let a;if(r.fill){if(o)try{return id(i,so({color:{scheme:o,domain:[0,1]}}).interpolate)}catch(c){console.warn(c)}}else if(t.length){const c=s.getAttribute("colorRange");a=so({color:{domain:t,range:c,scheme:o||(c?void 0:"tableau10")}}).apply(n)}else{const c=e.channelField("fill");a=Nb(c==null?void 0:c.value)?c.value:void 0}return id(i,pN(a))}function hv(e,t,n,i,r,s){const o=(i-s)/(n-t),a=o!==1?` * ${o}::DOUBLE`:"";return r?q`(${n} - ${e}::DOUBLE)${a}`:q`(${e}::DOUBLE - ${t})${a}`}function dQ(e,t,n,i,r,s){return e.select({index:q`FLOOR(${t})::INTEGER + FLOOR(${n})::INTEGER * ${r}`,value:i}).groupby("index",s)}function pQ(e,t,n,i,r,s){const o=i.column?`* ${i.column}`:"",a=(f,d)=>e.clone().select({xp:t,yp:n,i:f,w:d}),c=a(q`FLOOR(xp)::INTEGER + FLOOR(yp)::INTEGER * ${r}`,q`(FLOOR(xp)::INTEGER + 1 - xp) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),l=a(q`FLOOR(xp)::INTEGER + (FLOOR(yp)::INTEGER + 1) * ${r}`,q`(FLOOR(xp)::INTEGER + 1 - xp) * (yp - FLOOR(yp)::INTEGER)${o}`),u=a(q`FLOOR(xp)::INTEGER + 1 + FLOOR(yp)::INTEGER * ${r}`,q`(xp - FLOOR(xp)::INTEGER) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),h=a(q`FLOOR(xp)::INTEGER + 1 + (FLOOR(yp)::INTEGER + 1) * ${r}`,q`(xp - FLOOR(xp)::INTEGER) * (yp - FLOOR(yp)::INTEGER)${o}`);return St.from(St.unionAll(c,l,u,h)).select({index:"i",value:co("w")},s).groupby("index",s).having(m8("value",0))}function dv(e){const t=Math.floor(e);return t===e?t-1:t}function yQ(e,t,n){var i=1e-8,r=t-1,s=n-1,o=0,a,c,l,u,h,f,d,p,y,m,g;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(l=e<.5?e:1-e,u=Math.sqrt(-2*Math.log(l)),d=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,e<.5&&(d=-d),p=(d*d-3)/6,y=2/(1/(2*t-1)+1/(2*n-1)),m=d*Math.sqrt(p+y)/y-(1/(2*n-1)-1/(2*t-1))*(p+5/6-2/(3*y)),d=t/(t+n*Math.exp(2*m))):(a=Math.log(t/(t+n)),c=Math.log(n/(t+n)),u=Math.exp(t*a)/t,h=Math.exp(n*c)/n,m=u+h,e<u/m?d=Math.pow(t*m*e,1/t):d=1-Math.pow(n*m*(1-e),1/n)),g=-ia(t)-ia(n)+ia(t+n);o<10;o++){if(d===0||d===1)return d;if(f=mQ(d,t,n)-e,u=Math.exp(r*Math.log(d)+s*Math.log(1-d)+g),h=f/u,d-=u=h/(1-.5*Math.min(1,h*(r/d-s/(1-d)))),d<=0&&(d=.5*(d+u)),d>=1&&(d=.5*(d+u+1)),Math.abs(u)<i*d&&o>0)break}return d}function mQ(e,t,n){var i=e===0||e===1?0:Math.exp(ia(t+n)-ia(t)-ia(n)+t*Math.log(e)+n*Math.log(1-e));return e<0||e>1?!1:e<(t+1)/(t+n+2)?i*pv(e,t,n)/t:1-i*pv(1-e,n,t)/n}function pv(e,t,n){var i=1e-30,r=1,s=t+n,o=t+1,a=t-1,c=1,l=1-s*e/o,u,h,f,d;for(Math.abs(l)<i&&(l=i),l=1/l,d=l;r<=100&&(u=2*r,h=r*(n-r)*e/((a+u)*(t+u)),l=1+h*l,Math.abs(l)<i&&(l=i),c=1+h/c,Math.abs(c)<i&&(c=i),l=1/l,d*=l*c,h=-(t+r)*(s+r)*e/((t+u)*(o+u)),l=1+h*l,Math.abs(l)<i&&(l=i),c=1+h/c,Math.abs(c)<i&&(c=i),l=1/l,f=l*c,d*=f,!(Math.abs(f-1)<3e-7));r++);return d}function ia(e){var t=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015,r,s,o;for(o=(s=r=e)+5.5,o-=(r+.5)*Math.log(o);t<6;t++)i+=n[t]/++s;return Math.log(2.506628274631*i/r)-o}function gQ(e,t){var n=yQ(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n}class bQ extends Ja{constructor(t,n){const{ci:i=.95,precision:r=4,...s}=n;super("line",t,s);const o=()=>this.modelFit?this.confidenceBand().update():null;Ln(this,"ci",i,o),Ln(this,"precision",r,o)}query(t=[]){const n=this.channelField("x").as,i=this.channelField("y").as,r=Array.from(new Set(["stroke","z","fx","fy"].flatMap(s=>{var o;return((o=this.channelField(s))==null?void 0:o.as)||[]})));return St.from(super.query(t)).select({intercept:P8(i,n),slope:U8(i,n),n:z8(i,n),ssy:j8(i,n),ssx:q8(i,n),xm:Y8(i,n),x0:Ew(ma(n).where(Gf(i))),x1:Ew(ya(n).where(Gf(i)))}).select(r).groupby(r)}queryResult(t){return this.modelFit=Array.from(t),this.lineData=this.modelFit.flatMap(n=>wQ(n)),this.confidenceBand()}confidenceBand(){const{ci:t,modelFit:n,precision:i,plot:r}=this,s=r.innerWidth();return this.areaData=t?n.flatMap(o=>_Q(t,i,o,s)):null,this}plotSpecs(){const{lineData:t,areaData:n,channels:i,ci:r}=this,s={x:"x",y:"y"},o={x:"x",y1:"y1",y2:"y2",fillOpacity:.1};for(const a of i)switch(a.channel){case"x":case"y":case"fill":break;case"stroke":s.stroke=o.fill=Fr(a);break;case"strokeOpacity":s.strokeOpacity=Fr(a);break;case"fillOpacity":o.fillOpacity=Fr(a);break;default:s[a.channel]=o[a.channel]=Fr(a);break}return[...r?[{type:"areaY",data:n,options:o}]:[],{type:"line",data:t,options:s}]}}function wQ(e){const{x0:t,x1:n,xm:i,intercept:r,slope:s,n:o,ssx:a,ssy:c,...l}=e;return[{x:t,y:r+t*s,...l},{x:n,y:r+n*s,...l}]}function _Q(e,t,n,i){const{x0:r,x1:s,xm:o,intercept:a,slope:c,n:l,ssx:u,ssy:h,...f}=n,d=t*(s-r)/i,p=gQ((1-e)/2,l-2)*Math.sqrt(h/(l-2));return dn(r,s-d/2,d).concat(s).map(y=>{const m=a+y*c,g=p*Math.sqrt(1/l+(y-o)**2/u);return{x:y,y1:m-g,y2:m+g,...f}})}const vQ=new Set(["frame","axisX","axisY","axisFx","axisFy","gridX","gridY","gridFx","gridFy","hexgrid","graticule","sphere"]);function Z(e,t,n){arguments.length===2&&(n=t,t=vQ.has(e)?null:[{}]);const i=e.startsWith("area")||e.startsWith("line")?BK:Ja;return $b(i,e,t,n)}function $b(e,t,n,i){return r=>{r.addMark(new e(t,n,i))}}function ho(e,t,n){return i=>{i.addMark(new e(t,n))}}const xQ=(...e)=>Z("area",...e),SQ=(...e)=>Z("areaX",...e),EQ=(...e)=>Z("areaY",...e),AQ=(...e)=>Z("line",...e),TQ=(...e)=>Z("lineX",...e),IQ=(...e)=>Z("lineY",...e),MQ=(...e)=>Z("barX",...e),NQ=(...e)=>Z("barY",...e),$Q=(...e)=>Z("cell",...e),kQ=(...e)=>Z("cellX",...e),OQ=(...e)=>Z("cellY",...e),LQ=(...e)=>Z("rect",...e),RQ=(...e)=>Z("rectX",...e),FQ=(...e)=>Z("rectY",...e),DQ=(...e)=>Z("dot",...e),CQ=(...e)=>Z("dotX",...e),BQ=(...e)=>Z("dotY",...e),PQ=(...e)=>Z("circle",...e),UQ=(...e)=>Z("hexagon",...e),zQ=(...e)=>Z("text",...e),jQ=(...e)=>Z("textX",...e),qQ=(...e)=>Z("textY",...e),YQ=(...e)=>Z("ruleX",...e),VQ=(...e)=>Z("ruleY",...e),WQ=(...e)=>Z("tickX",...e),GQ=(...e)=>Z("tickY",...e),HQ=(...e)=>Z("vector",...e),XQ=(...e)=>Z("vectoX",...e),KQ=(...e)=>Z("vectorY",...e),QQ=(...e)=>Z("spike",...e),JQ=(...e)=>Z("image",...e),ZQ=(...e)=>$b(fN,"areaX",...e),tJ=(...e)=>$b(fN,"areaY",...e),eJ=(...e)=>ho(KK,...e),nJ=(...e)=>ho(eQ,...e),iJ=(...e)=>ho(rQ,...e),rJ=(...e)=>ho(yN,...e),sJ=(...e)=>ho(aQ,...e),oJ=(...e)=>ho(oQ,...e),aJ=(...e)=>Z("hexgrid",...e),cJ=(...e)=>ho(bQ,...e),lJ=(...e)=>Z("voronoi",...e),uJ=(...e)=>Z("voronoiMesh",...e),fJ=(...e)=>Z("delaunayLink",...e),hJ=(...e)=>Z("delaunayMesh",...e),dJ=(...e)=>Z("hull",...e),pJ=(...e)=>Z("arrow",...e),yJ=(...e)=>Z("link",...e),mJ=(...e)=>Z("frame",...e),gJ=(...e)=>Z("axisX",...e),bJ=(...e)=>Z("axisY",...e),wJ=(...e)=>Z("axisFx",...e),_J=(...e)=>Z("axisFy",...e),vJ=(...e)=>Z("gridX",...e),xJ=(...e)=>Z("gridY",...e),SJ=(...e)=>Z("gridFx",...e),EJ=(...e)=>Z("gridFy",...e),AJ=(...e)=>Z("geo",...e),TJ=(...e)=>Z("sphere",...e),IJ=(...e)=>Z("graticule",...e),MJ=Object.freeze(Object.defineProperty({__proto__:null,area:xQ,areaX:SQ,areaY:EQ,arrow:pJ,axisFx:wJ,axisFy:_J,axisX:gJ,axisY:bJ,barX:MQ,barY:NQ,cell:$Q,cellX:kQ,cellY:OQ,circle:PQ,contour:iJ,delaunayLink:fJ,delaunayMesh:hJ,denseLine:nJ,density:eJ,densityX:ZQ,densityY:tJ,dot:DQ,dotX:CQ,dotY:BQ,frame:mJ,geo:AJ,graticule:IJ,gridFx:SJ,gridFy:EJ,gridX:vJ,gridY:xJ,hexagon:UQ,hexbin:oJ,hexgrid:aJ,hull:dJ,image:JQ,line:AQ,lineX:TQ,lineY:IQ,link:yJ,raster:rJ,rasterTile:sJ,rect:LQ,rectX:RQ,rectY:FQ,regressionY:cJ,ruleX:YQ,ruleY:VQ,sphere:TJ,spike:QQ,text:zQ,textX:jQ,textY:qQ,tickX:WQ,tickY:GQ,vector:HQ,vectorX:XQ,vectorY:KQ,voronoi:lJ,voronoiMesh:uJ},Symbol.toStringTag,{value:"Module"}));function NJ(e){const t=e.toLowerCase(),n=e.length;let i="";for(let r=0;r<n;++r)i+=(e[r]!==t[r]?"-":"")+t[r];return i}function kb(e){const t={};for(const n in e)t[NJ(n)]=e[n];return t}class $J{constructor(t,{selection:n,channels:i={}}){this.mark=t,this.selection=n;const r=Object.entries(kb(i));this.channels=r.length?r:[["opacity",.2]],this.selection.addEventListener("value",OS(()=>this.update()))}init(t){this.svg=t;const n=this.values=[],i=this.mark.index,r=this.nodes=t.querySelectorAll(`[data-index="${i}"] > *`),{channels:s}=this;for(let o=0;o<r.length;++o){const a=r[o];n.push(s.map(c=>a.getAttribute(c[0])))}return this.update()}async update(){const{svg:t,nodes:n,channels:i,values:r,mark:s,selection:o}=this;if(!t)return;const a=await kJ(s,o);for(let c=0;c<n.length;++c){const l=n[c],u=r[c],h=a(l.__data__);for(let f=0;f<i.length;++f){const[d,p]=i[f];l.setAttribute(d,h?u[f]:p)}}}}async function kJ(e,t){var c,l;const n=t==null?void 0:t.predicate(e);if(!n||n.length===0)return()=>!0;const i={__:Hs(n)},r=e.query((c=e.filterBy)==null?void 0:c.predicate(e)),s=r.groupby().length?r.select(i):r.$select(i),o=await as().query(s),a=(l=o.getChild)==null?void 0:l.call(o,"__");return a?u=>a.get(u):u=>o[u].__}class mN{constructor(t,{selection:n,channels:i}){this.value=null,this.mark=t,this.selection=n,this.clients=new Set().add(t),this.channels=i.map(r=>{var o;const s=r==="color"?["fill","stroke"]:r==="x"?["x","x1","x2"]:r==="y"?["y","y1","y2"]:[r];for(let a=0;a<s.length;++a){const c=t.channelField(s[a]);if(c)return{field:((o=c.field)==null?void 0:o.basis)||c.field,as:c.as}}throw new Error(`Missing channel: ${r}`)})}clause(t){const{channels:n,clients:i}=this;let r=null;if(t){const s=t.map(o=>{const a=o.map((c,l)=>pd(n[l].field,Ol(c)));return a.length>1?Hs(a):a[0]});r=s.length>1?ES(s):s[0]}return{source:this,schema:{type:"point"},clients:i,value:t,predicate:r}}init(t,n,i){const{mark:r,channels:s,selection:o}=this,{data:a}=r;i=i||(l=>{const u=a[l.__data__];return s.map(h=>u[h.as])}),n=n||`[data-index="${r.index}"]`;const c=new Set(t.querySelectorAll(n));t.addEventListener("pointerdown",l=>{const u=o.single?o.value:this.value,h=l.target;let f=null;if(OJ(c,h)){const d=i(h);l.shiftKey&&(u!=null&&u.length)?(f=u.filter(p=>Rm(p,d)),f.length===u.length&&f.push(d)):(u==null?void 0:u.length)===1&&!Rm(u[0],d)?f=null:f=[d]}this.value=f,LJ(u,f)&&o.update(this.clause(f))}),t.addEventListener("pointerenter",()=>{this.selection.activate(this.clause([this.channels.map(()=>0)]))})}}function OJ(e,t){var n;return e.has(t)||e.has(t.parentNode)||e.has((n=t.parentNode)==null?void 0:n.parentNode)}function LJ(e,t){return e==null||t==null?e!=null||t!=null:e.length!==t.length||e.some((n,i)=>Rm(n,t[i]))}function Rm(e,t){const n=e.length;if(t.length!==n)return!0;for(let i=0;i<n;++i)if(e[i]!==t[i])return!0;return!1}function Ob(e){const t=e.on;let n=!0;function i(r){n=!1,r(),n=!0}return e.reset=(...r)=>{i(()=>e.clear(...r))},e.moveSilent=(...r)=>{i(()=>e.move(...r))},e.on=(...r)=>{if(r.length>1&&r[1]){const s=r[1];r[1]=(...o)=>n&&s(...o)}return t(...r)},e}function RJ(){return Ob(yC())}function FJ(){return Ob(dC())}function DJ(){return Ob(pC())}const yv=1e-12;function Fm(e,t){return e===t||e&&t&&Math.abs(e[0]-t[0])<yv&&Math.abs(e[1]-t[1])<yv||!1}function Ra(e,t){var i;const n=(i=e.channelField(t))==null?void 0:i.field;return(n==null?void 0:n.basis)||n}function Dm(e,t,n=1){return t.invert(n*Math.floor(e/n))}function gN(){const e=this,t=e.getScreenCTM;let n;e.getScreenCTM=()=>e.isConnected?n=t.call(e):n}class bN{constructor(t,{channel:n,selection:i,field:r,pixelSize:s=1,peers:o=!0,brush:a}){this.mark=t,this.channel=n,this.pixelSize=s||1,this.selection=i,this.peers=o,this.field=r||Ra(t,[n,n+"1",n+"2"]),this.style=a&&kb(a),this.brush=n==="y"?DJ():FJ(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[0,1]))}publish(t){let n;t&&(n=t.map(i=>Dm(i,this.scale,this.pixelSize)).sort((i,r)=>i-r)),Fm(n,this.value)||(this.value=n,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(n)))}clause(t){const{mark:n,pixelSize:i,field:r,scale:s}=this;return{source:this,schema:{type:"interval",pixelSize:i,scales:[s]},clients:this.peers?n.plot.markSet:new Set().add(n),value:t,predicate:t?wn(r,t):null}}init(t){var l;const{brush:n,channel:i,style:r}=this;this.scale=t.scale(i);const s=t.scale("x").range,o=t.scale("y").range;n.extent([[xe(s),xe(o)],[oe(s),oe(o)]]);const a=zt(t).selectAll('g[aria-label="facet"]'),c=a.size()?a:zt(t);if(this.g=c.append("g").attr("class",`interval-${i}`).each(gN).call(n).call(n.moveSilent,(l=this.value)==null?void 0:l.map(this.scale.apply)),r){const u=this.g.selectAll("rect.selection");for(const h in r)u.attr(h,r[h])}t.addEventListener("pointerenter",()=>this.activate())}}const Vu=(e,t)=>e-t;class CJ{constructor(t,{selection:n,xfield:i,yfield:r,pixelSize:s=1,peers:o=!0,brush:a}){this.mark=t,this.pixelSize=s||1,this.selection=n,this.peers=o,this.xfield=i||Ra(t,["x","x1","x2"]),this.yfield=r||Ra(t,["y","y1","y2"]),this.style=a&&kb(a),this.brush=RJ(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[[0,1],[0,1]]))}publish(t){const{value:n,pixelSize:i,xscale:r,yscale:s}=this;let o,a;if(t){const[c,l]=t;o=[c[0],l[0]].map(u=>Dm(u,r,i)).sort(Vu),a=[c[1],l[1]].map(u=>Dm(u,s,i)).sort(Vu)}(!Fm(o,n==null?void 0:n[0])||!Fm(a,n==null?void 0:n[1]))&&(this.value=t?[o,a]:void 0,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(this.value)))}clause(t){const{mark:n,pixelSize:i,xfield:r,yfield:s,xscale:o,yscale:a}=this;return{source:this,schema:{type:"interval",pixelSize:i,scales:[o,a]},clients:this.peers?n.plot.markSet:new Set().add(n),value:t,predicate:t?Hs(wn(r,t[0]),wn(s,t[1])):null}}init(t){const{brush:n,style:i}=this,r=this.xscale=t.scale("x"),s=this.yscale=t.scale("y"),o=r.range,a=s.range;n.extent([[xe(o),xe(a)],[oe(o),oe(a)]]);const c=zt(t).selectAll('g[aria-label="facet"]'),l=c.size()?c:zt(t);if(this.g=l.append("g").attr("class","interval-xy").each(gN).call(n),i){const u=this.g.selectAll("rect.selection");for(const h in i)u.attr(h,i[h])}if(this.value){const[u,h]=this.value[0].map(r.apply).sort(Vu),[f,d]=this.value[1].map(s.apply).sort(Vu);this.g.call(n.moveSilent,[[u,f],[h,d]])}t.addEventListener("pointerenter",()=>this.activate())}}const mv=(e,t)=>e-t;class BJ{constructor(t,{x:n=new Lr,y:i=new Lr,xfield:r,yfield:s,zoom:o=!0,panx:a=!0,pany:c=!0}){this.mark=t,this.xsel=n,this.ysel=i,this.xfield=r||Ra(t,["x","x1","x2"]),this.yfield=s||Ra(t,["y","y1","y2"]),this.zoom=Xy(o,[0,1/0],[1,1]),this.panx=this.xsel&&a,this.pany=this.ysel&&c;const{plot:l}=t;a&&this.xsel.addEventListener("value",u=>{l.setAttribute("xDomain",u)&&l.update()}),c&&this.ysel.addEventListener("value",u=>{l.setAttribute("yDomain",u)&&l.update()})}publish(t){if(this.panx){const n=PJ(t,this.xscale);this.xsel.update(this.clause(n,this.xfield,this.xscale))}if(this.pany){const n=UJ(t,this.yscale);this.ysel.update(this.clause(n,this.yfield,this.yscale))}}clause(t,n,i){return{source:this,schema:{type:"interval",scales:[i]},clients:this.mark.plot.markSet,value:t,predicate:t?wn(n,t):null}}init(t){if(this.svg=t,this.initialized)return;this.initialized=!0;const{panx:n,pany:i,mark:{plot:{element:r}},xsel:s,ysel:o}=this;this.xscale=t.scale("x"),this.yscale=t.scale("y");const a=this.xscale.range.slice().sort(mv),c=this.yscale.range.slice().sort(mv),l=Xy(n,[-1/0,1/0],a),u=Xy(i,[-1/0,1/0],c),h=oU().extent([[a[0],c[0]],[a[1],c[1]]]).scaleExtent(this.zoom).translateExtent([[l[0],u[0]],[l[1],u[1]]]).on("start",()=>{this.xscale=this.svg.scale("x"),this.yscale=this.svg.scale("y")}).on("end",()=>r.__zoom=new _i(1,0,0)).on("zoom",({transform:f})=>this.publish(f));if(zt(r).call(h),n||i){let f=!1;r.addEventListener("mouseenter",()=>{if(!f){if(f=!0,n){const{xscale:d,xfield:p}=this;s.activate(this.clause(d.domain,p,d))}if(i){const{yscale:d,yfield:p}=this;o.activate(this.clause(d.domain,p,d))}}}),r.addEventListener("mouseleave",()=>f=!1)}}}function Xy(e,t,n){return e?Array.isArray(e)?e:t:n}function PJ(e,t){return t.range.map(e.invertX,e).map(t.invert,t)}function UJ(e,t){return t.range.map(e.invertY,e).map(t.invert,t)}class wN{constructor(t,{selection:n,channel:i,field:r}){this.mark=t,this.selection=n,this.clients=new Set().add(t),this.channel=i,this.field=r||Ra(t,[i])}clause(t){const{clients:n,field:i}=this,r=t?pd(i,Ol(t)):null;return{source:this,schema:{type:"point"},clients:n,value:t,predicate:r}}init(t){const n=this,{mark:i,channel:r,selection:s}=this,{data:o}=i,a=i.channelField(r).as,c=zt(t).selectAll('g[aria-label="facet"]'),l=c.size()?c:zt(t),u=t.scale(r),h=!Xs(s);l.on("pointerdown pointermove",function(f){const[d,p]=Yn(f,this),y=zJ(o,a,u.invert(r==="x"?d:p));s.update(h?y:n.clause(y))}),!h&&t.addEventListener("pointerenter",()=>{this.selection.activate(this.clause(0))})}}function zJ(e,t,n){let i=1/0,r;return e.forEach(s=>{const o=Math.abs(s[t]-n);o<i&&(i=o,r=s[t])}),r}function ms(e,t){return n=>{const i=n.marks[n.marks.length-1];n.addInteractor(new e(i,t))}}function jJ({by:e,...t}){return ms($J,{selection:e,channels:t})}function Sp({as:e,...t}){return ms(mN,{...t,selection:e})}function qJ({as:e}){return Sp({as:e,channels:["x"]})}function YJ({as:e}){return Sp({as:e,channels:["y"]})}function VJ({as:e}){return Sp({as:e,channels:["color"]})}function WJ({as:e,...t}){return ms(wN,{...t,selection:e,channel:"x"})}function GJ({as:e,...t}){return ms(wN,{...t,selection:e,channel:"y"})}function HJ({as:e,...t}){return ms(bN,{...t,selection:e,channel:"x"})}function XJ({as:e,...t}){return ms(bN,{...t,selection:e,channel:"y"})}function KJ({as:e,...t}){return ms(CJ,{...t,selection:e})}function Za(e){return ms(BJ,e)}function QJ(e={}){return Za({...e,zoom:!1})}function JJ(e={}){return Za({...e,zoom:!1,pany:!1})}function ZJ(e={}){return Za({...e,zoom:!1,panx:!1})}function tZ(e={}){return Za(e)}function eZ(e={}){return Za({...e,pany:!1})}function nZ(e={}){return Za({...e,panx:!1})}const iZ=Object.freeze(Object.defineProperty({__proto__:null,highlight:jJ,intervalX:HJ,intervalXY:KJ,intervalY:XJ,nearestX:WJ,nearestY:GJ,pan:QJ,panX:JJ,panY:ZJ,panZoom:tZ,panZoomX:eZ,panZoomY:nZ,toggle:Sp,toggleColor:VJ,toggleX:qJ,toggleY:YJ},Symbol.toStringTag,{value:"Module"}));class gv{constructor(t,n){const{as:i,...r}=n;this.channel=t,this.options={label:null,...r},this.selection=i,this.element=document.createElement("div"),this.element.setAttribute("class","legend"),this.element.value=this}setPlot(t){const{channel:n,selection:i}=this,r=rZ(t,n);this.selection&&r&&(this.handler=new mN(r,{selection:i,channels:[n]}),this.selection.addEventListener("value",()=>this.update()))}init(t){const{channel:n,options:i,handler:r}=this,o=t.scale(n).type==="ordinal"?i:{marginTop:1,tickSize:2,height:28,...i};return this.legend=t.legend(n,o),r&&(r.init(this.legend,":scope > div",a=>[a.__data__]),this.update()),this.element.replaceChildren(this.legend),this.element}update(){if(!this.legend)return;const{value:t}=this.selection,n=t&&t.length?new Set(t.map(r=>r[0])):null,i=this.legend.querySelectorAll(":scope > div");for(const r of i){const s=n?n.has(r.__data__):!0;r.style.opacity=s?1:.2}}}function rZ({marks:e},t){const n=t==="color"?["fill","stroke"]:t==="opacity"?["opacity","fillOpacity","strokeOpacity"]:null;if(n==null)return null;for(let i=e.length-1;i>-1;--i)if(e[i].channelField(n))return e[i];return null}function Lb(e,t={}){if(t.for){const{for:n,...i}=t,r=new gv(e,i),s=typeof n,o=a=>a.addLegend(r,!1);return s==="string"?Z6.request(n,o):n.value&&o(n.value),r.element}else return n=>n.addLegend(new gv(e,t))}const sZ=e=>Lb("color",e),oZ=e=>Lb("opacity",e),aZ=e=>Lb("symbol",e),cZ=Object.freeze(Object.defineProperty({__proto__:null,colorLegend:sZ,opacityLegend:oZ,symbolLegend:aZ},Symbol.toStringTag,{value:"Module"}));function _N({direction:e="vertical",wrap:t=!1},n){const i=document.createElement("div");return i.style.display="flex",i.style.flexDirection=e==="vertical"?"column":"row",i.style.flexWrap=t?t===!0?"wrap":t:"nowrap",i.style.justifyContent="flex-start",i.style.alignItems="flex-start",n.forEach(r=>i.appendChild(r)),i.value={element:i},i}function lZ(...e){return _N({direction:"vertical"},e.flat())}function uZ(...e){return _N({direction:"horizontal"},e.flat())}function vN({dim:e="width",size:t=10}){const n=document.createElement("span");n.style.display="inline-block",n.style[e]=Number.isNaN(+t)?t:`${t}px`;const i={element:n};return n.value=i,n}function fZ(e){return vN({dim:"height",size:e})}function hZ(e){return vN({dim:"width",size:e})}function dZ(e){return e}function pZ(e){if(e==null)return dZ;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,c){c||(t=n=0);var l=2,u=a.length,h=new Array(u);for(h[0]=(t+=a[0])*i+s,h[1]=(n+=a[1])*r+o;l<u;)h[l]=a[l],++l;return h}}function yZ(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function mZ(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return bv(e,n)})}:bv(e,t)}function bv(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=xN(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function xN(e,t){var n=pZ(e.transform),i=e.arcs;function r(u,h){h.length&&h.pop();for(var f=i[u<0?~u:u],d=0,p=f.length;d<p;++d)h.push(n(f[d],d));u<0&&yZ(h,p)}function s(u){return n(u)}function o(u){for(var h=[],f=0,d=u.length;f<d;++f)r(u[f],h);return h.length<2&&h.push(h[0]),h}function a(u){for(var h=o(u);h.length<4;)h.push(h[0]);return h}function c(u){return u.map(a)}function l(u){var h=u.type,f;switch(h){case"GeometryCollection":return{type:h,geometries:u.geometries.map(l)};case"Point":f=s(u.coordinates);break;case"MultiPoint":f=u.coordinates.map(s);break;case"LineString":f=o(u.arcs);break;case"MultiLineString":f=u.arcs.map(o);break;case"Polygon":f=c(u.arcs);break;case"MultiPolygon":f=u.arcs.map(c);break;default:return null}return{type:h,coordinates:f}}return l(t)}function gZ(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,u){var h=e.arcs[l<0?~l:l],f;h.length<3&&!h[1][0]&&!h[1][1]&&(f=t[++o],t[o]=l,t[u]=f)}),t.forEach(function(l){var u=a(l),h=u[0],f=u[1],d,p;if(d=r[h])if(delete r[d.end],d.push(l),d.end=f,p=i[f]){delete i[p.start];var y=p===d?d:d.concat(p);i[y.start=d.start]=r[y.end=p.end]=y}else i[d.start]=r[d.end]=d;else if(d=i[f])if(delete i[d.start],d.unshift(l),d.start=h,p=r[h]){delete r[p.end];var m=p===d?d:p.concat(d);i[m.start=p.start]=r[m.end=d.end]=m}else i[d.start]=r[d.end]=d;else d=[l],i[d.start=h]=r[d.end=f]=d});function a(l){var u=e.arcs[l<0?~l:l],h=u[0],f;return e.transform?(f=[0,0],u.forEach(function(d){f[0]+=d[0],f[1]+=d[1]})):f=u[u.length-1],l<0?[f,h]:[h,f]}function c(l,u){for(var h in l){var f=l[h];delete u[f.start],delete f.start,delete f.end,f.forEach(function(d){n[d<0?~d:d]=1}),s.push(f)}}return c(r,i),c(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function bZ(e){return xN(e,wZ.apply(this,arguments))}function wZ(e,t,n){var i,r,s;if(arguments.length>1)i=_Z(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:gZ(e,i)}}function _Z(e,t,n){var i=[],r=[],s;function o(h){var f=h<0?~h:h;(r[f]||(r[f]=[])).push({i:h,g:s})}function a(h){h.forEach(o)}function c(h){h.forEach(a)}function l(h){h.forEach(c)}function u(h){switch(s=h,h.type){case"GeometryCollection":h.geometries.forEach(u);break;case"LineString":a(h.arcs);break;case"MultiLineString":case"Polygon":c(h.arcs);break;case"MultiPolygon":l(h.arcs);break}}return u(t),r.forEach(n==null?function(h){i.push(h[0].i)}:function(h){n(h[0].g,h[h.length-1].g)&&i.push(h[0].i)}),i}function vZ(e){const t=typeof e;return t==="object"?e==null?void 0:e.param:t==="string"?xZ(e):null}function xZ(e){return(e==null?void 0:e[0])==="$"?e.slice(1):null}function Ky(e){return[e].flat()}function ra(e){return Array.isArray(e)}function SN(e){return e!==null&&typeof e=="object"&&!ra(e)}function wv(e){const t=typeof e;return t==="number"||t==="string"}function Pr(e){return typeof e=="string"}function ou(e){return typeof e=="function"}function Oi(e,t){throw Object.assign(Error(e),{data:t})}function SZ(e,t,n){t=EZ(t,n);const i=n.dataFormats.get(t.type);if(i)return i(e,t,n);Oi("Unrecognized data format type.",t)}function EZ(e,t){return ra(e)&&(e={type:"json",data:e}),Pr(e)&&(e={type:"table",query:e}),{...e,type:AZ(e),file:IZ(e,t)}}function AZ(e){return e.type||TZ(e.file)||"table"}function TZ(e){const t=e==null?void 0:e.lastIndexOf(".");return t>0?e.slice(t+1):null}function IZ({file:e},t){return e&&t.baseURL?new URL(e,t.baseURL).toString():e}function MZ(e,t){const{query:n,type:i,...r}=t;if(n)return yd(e,n,r)}function NZ(e,t){const{file:n,type:i,...r}=t;return Z8(e,n,r)}function $Z(e,t){const{file:n,type:i,...r}=t;return Q8(e,n,r)}function kZ(e,t){const{data:n,file:i,type:r,...s}=t;return n?tO(e,n,s):J8(e,i,s)}const OZ={menu:AL,search:NL,slider:OL,table:CL},LZ=new Map([["intersect",()=>Lr.intersect()],["crossfilter",()=>Lr.crossfilter()],["union",()=>Lr.union()],["single",()=>Lr.single()],["value",({date:e,value:t},n)=>Array.isArray(t)?or.array(t.map(i=>n.maybeParam(i))):or.value(xg(e,t))]]),RZ=new Map([["plot",{type:ra,parse:AN}],["mark",{type:Pr,parse:JZ}],["legend",{type:Pr,parse:TN}],["hconcat",{type:ra,parse:QZ}],["vconcat",{type:ra,parse:KZ}],["hspace",{type:wv,parse:GZ}],["vspace",{type:wv,parse:HZ}],["input",{type:Pr,parse:XZ}]]),FZ=new Map([["csv",$Z],["json",kZ],["geojson",YZ],["topojson",VZ],["parquet",NZ],["table",MZ]]),DZ=new Map([["avg",F8],["bin",Nw],["count",js],["dateMonth",W8],["dateMonthDay",G8],["dateDay",H8],["bin",Nw],["max",ya],["median",D8],["min",ma],["mode",B8],["quantile",C8],["sum",co],["row_number",x8],["rank",S8],["dense_rank",E8],["percent_rank",A8],["cume_dist",T8],["ntile",I8],["lag",M8],["lead",N8],["first_value",$8],["last_value",k8],["nth_value",O8]]),CZ=new Map(Object.entries(MJ)),BZ=new Map(Object.entries(OZ)),PZ=new Map(Object.entries(cZ)),UZ=new Map(Object.entries($K)),zZ=new Map(Object.entries(iZ));function jZ(e,t){return e=Pr(e)?JSON.parse(e):e,new qZ(t).parse(e)}class qZ{constructor({specParsers:t=RZ,paramParsers:n=LZ,dataFormats:i=FZ,transforms:r=DZ,attributes:s=UZ,interactors:o=zZ,legends:a=PZ,inputs:c=BZ,marks:l=CZ,params:u=[],datasets:h=[],baseURL:f=null}={}){this.specParsers=t,this.paramParsers=n,this.dataFormats=i,this.transforms=r,this.attributes=s,this.interactors=o,this.legends=a,this.inputs=c,this.marks=l,this.params=new Map(u),this.datasets=new Map(h),this.baseURL=f,this.postQueue=[]}after(t){this.postQueue.push(t)}maybeParam(t,n=()=>or.value()){const{params:i}=this,r=vZ(t);if(r){if(i.has(r))return i.get(r);{const s=n();return i.set(r,s),s}}return t}maybeSelection(t){return this.maybeParam(t,()=>Lr.intersect())}maybeTransform(t){if(SN(t))return t.expr?rtt(t,this):stt(t,this)}async parse(t){const{meta:n,data:i={},plotDefaults:r={},params:s,...o}=t;for(const c in i){const l=await SZ(c,i[c],this);l!=null&&l.data?this.datasets.set(c,l.data):l&&await as().exec(l)}this.plotDefaults=Object.keys(r).map(c=>IN(r,c,this));for(const c in s)this.params.set(c,WZ(s[c],this));const a=Rb(o,this);return this.postQueue.forEach(c=>c()),this.postQueue=[],this.plotDefaults={},a}}async function EN(e){const{data:t,file:n}=e;return t||await fetch(n).then(i=>i.json())}async function YZ(e,t){return{data:await EN(t)}}async function VZ(e,t){const n=await EN(t);let i;if(t.feature)i=mZ(n,n.objects[t.feature]);else{const r=t.mesh?n.objects[t.mesh]:void 0,s={interior:(o,a)=>o!==a,exterior:(o,a)=>o===a}[t.filter];i=bZ(n,r,s)}return{data:i&&i.features||[i]}}function WZ(e,t){e=SN(e)?e:{value:e};const{select:n="value"}=e,i=t.paramParsers.get(n);return i||Oi(`Unrecognized param type: ${n}`,e),i(e,t)}function Rb(e,t){for(const[n,{type:i,parse:r}]of t.specParsers){const s=e[n];if(s!=null){if(i(s))return r(e,t);Oi(`Invalid property type: ${n}`,e)}}Oi("Invalid specification.",e)}function GZ(e){return hZ(e.hspace)}function HZ(e){return fZ(e.vspace)}function XZ(e,t){const{input:n,...i}=e,r=t.inputs.get(n);ou(r)||Oi(`Unrecognized input: ${n}`,e);for(const s in i)i[s]=t.maybeSelection(i[s]);return r(i)}function KZ(e,t){return lZ(e.vconcat.map(n=>Rb(n,t)))}function QZ(e,t){return uZ(e.hconcat.map(n=>Rb(n,t)))}function AN(e,t){const{plot:n,...i}=e,r=t.plotDefaults.concat(Object.keys(i).map(o=>IN(e,o,t))),s=n.map(o=>ZZ(o,t));return sG(r,s)}function JZ(e,t){return AN({plot:[e]},t)}function TN(e,t){const{legend:n,...i}=e,r=`${n}Legend`,s=t.legends.get(r);ou(s)||Oi(`Unrecognized legend type: ${n}`,e);for(const o in i)i[o]=t.maybeSelection(i[o]);return s(i)}function IN(e,t,n){const i=n.attributes.get(t);ou(i)||Oi(`Unrecognized attribute: ${t}`,e);const r=e[t],s=r==="Fixed"?Ag:n.maybeParam(r);return i(s)}function ZZ(e,t){return Pr(e.mark)?ttt(e,t):Pr(e.legend)?TN(e,t):Pr(e.select)?itt(e,t):Oi("Invalid plot entry.",e)}function ttt(e,t){const{mark:n,data:i,...r}=e,s=t.marks.get(n);ou(s)||Oi(`Unrecognized mark type: ${n}`,e);const o=ett(i,t);for(const a in r)r[a]=ntt(r[a],t);return o?s(o,r):s(r)}function ett(e,t){if(!e)return null;if(ra(e))return e;const{from:n,...i}=e;if(t.datasets.has(n))return t.datasets.get(n);for(const r in i)i[r]=t.maybeSelection(i[r]);return kK(n,i)}function ntt(e,t){return t.maybeTransform(e)||t.maybeParam(e)}function itt(e,t){const{select:n,...i}=e,r=t.interactors.get(n);ou(r)||Oi(`Unrecognized interactor type: ${n}`,e);for(const s in i)i[s]=t.maybeSelection(i[s]);return r(i)}function rtt(e,t){const{expr:n,label:i}=e,r=n.split(/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\$\w+)/g),s=[""],o=[];for(let a=0,c=0;a<r.length;++a){const l=r[a];l.startsWith("$")?(o[c]=t.maybeParam(l),s[++c]=""):s[c]+=l}return q(s,...o).annotate({label:i})}function stt(e,t){const{transforms:n}=t;let i;for(const a in e)n.has(a)&&(i=a);if(!i)return;const r=n.get(i),s=i==="count"||i==null?[]:Ky(e[i]);let o=r(...s);if(e.distinct&&(o=o.distinct()),e.order){const a=Ky(e.order).map(c=>t.maybeParam(c));o=o.orderby(a)}if(e.partition){const a=Ky(e.partition).map(c=>t.maybeParam(c));o=o.partitionby(a)}return e.rows?o=o.rows(t.maybeParam(e.rows)):e.range&&(o=o.range(t.maybeParam(e.range))),o}const Fb=Symbol.for("yaml.alias"),Cm=Symbol.for("yaml.document"),Ur=Symbol.for("yaml.map"),MN=Symbol.for("yaml.pair"),yr=Symbol.for("yaml.scalar"),tc=Symbol.for("yaml.seq"),Un=Symbol.for("yaml.node.type"),po=e=>!!e&&typeof e=="object"&&e[Un]===Fb,ec=e=>!!e&&typeof e=="object"&&e[Un]===Cm,nc=e=>!!e&&typeof e=="object"&&e[Un]===Ur,Jt=e=>!!e&&typeof e=="object"&&e[Un]===MN,Xt=e=>!!e&&typeof e=="object"&&e[Un]===yr,ic=e=>!!e&&typeof e=="object"&&e[Un]===tc;function ne(e){if(e&&typeof e=="object")switch(e[Un]){case Ur:case tc:return!0}return!1}function fe(e){if(e&&typeof e=="object")switch(e[Un]){case Fb:case Ur:case yr:case tc:return!0}return!1}const ott=e=>(Xt(e)||ne(e))&&!!e.anchor,Ke=Symbol("break visit"),NN=Symbol("skip children"),Ai=Symbol("remove node");function ns(e,t){const n=$N(t);ec(e)?Po(null,e.contents,n,Object.freeze([e]))===Ai&&(e.contents=null):Po(null,e,n,Object.freeze([]))}ns.BREAK=Ke;ns.SKIP=NN;ns.REMOVE=Ai;function Po(e,t,n,i){const r=kN(e,t,n,i);if(fe(r)||Jt(r))return ON(e,i,r),Po(e,r,n,i);if(typeof r!="symbol"){if(ne(t)){i=Object.freeze(i.concat(t));for(let s=0;s<t.items.length;++s){const o=Po(s,t.items[s],n,i);if(typeof o=="number")s=o-1;else{if(o===Ke)return Ke;o===Ai&&(t.items.splice(s,1),s-=1)}}}else if(Jt(t)){i=Object.freeze(i.concat(t));const s=Po("key",t.key,n,i);if(s===Ke)return Ke;s===Ai&&(t.key=null);const o=Po("value",t.value,n,i);if(o===Ke)return Ke;o===Ai&&(t.value=null)}}return r}async function Ep(e,t){const n=$N(t);ec(e)?await Uo(null,e.contents,n,Object.freeze([e]))===Ai&&(e.contents=null):await Uo(null,e,n,Object.freeze([]))}Ep.BREAK=Ke;Ep.SKIP=NN;Ep.REMOVE=Ai;async function Uo(e,t,n,i){const r=await kN(e,t,n,i);if(fe(r)||Jt(r))return ON(e,i,r),Uo(e,r,n,i);if(typeof r!="symbol"){if(ne(t)){i=Object.freeze(i.concat(t));for(let s=0;s<t.items.length;++s){const o=await Uo(s,t.items[s],n,i);if(typeof o=="number")s=o-1;else{if(o===Ke)return Ke;o===Ai&&(t.items.splice(s,1),s-=1)}}}else if(Jt(t)){i=Object.freeze(i.concat(t));const s=await Uo("key",t.key,n,i);if(s===Ke)return Ke;s===Ai&&(t.key=null);const o=await Uo("value",t.value,n,i);if(o===Ke)return Ke;o===Ai&&(t.value=null)}}return r}function $N(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function kN(e,t,n,i){var r,s,o,a,c;if(typeof n=="function")return n(e,t,i);if(nc(t))return(r=n.Map)==null?void 0:r.call(n,e,t,i);if(ic(t))return(s=n.Seq)==null?void 0:s.call(n,e,t,i);if(Jt(t))return(o=n.Pair)==null?void 0:o.call(n,e,t,i);if(Xt(t))return(a=n.Scalar)==null?void 0:a.call(n,e,t,i);if(po(t))return(c=n.Alias)==null?void 0:c.call(n,e,t,i)}function ON(e,t,n){const i=t[t.length-1];if(ne(i))i.items[e]=n;else if(Jt(i))e==="key"?i.key=n:i.value=n;else if(ec(i))i.contents=n;else{const r=po(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${r} parent`)}}const att={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},ctt=e=>e.replace(/[!,[\]{}]/g,t=>att[t]);class Ce{constructor(t,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Ce.defaultYaml,t),this.tags=Object.assign({},Ce.defaultTags,n)}clone(){const t=new Ce(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){const t=new Ce(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Ce.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Ce.defaultTags);break}return t}add(t,n){this.atNextDocument&&(this.yaml={explicit:Ce.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Ce.defaultTags),this.atNextDocument=!1);const i=t.trim().split(/[ \t]+/),r=i.shift();switch(r){case"%TAG":{if(i.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[s,o]=i;return this.tags[s]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[s]=i;if(s==="1.1"||s==="1.2")return this.yaml.version=s,!0;{const o=/^\d+\.\d+$/.test(s);return n(6,`Unsupported YAML version ${s}`,o),!1}}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(t,n){if(t==="!")return"!";if(t[0]!=="!")return n(`Not a valid tag: ${t}`),null;if(t[1]==="<"){const o=t.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,i,r]=t.match(/^(.*!)([^!]*)$/);r||n(`The ${t} tag has no suffix`);const s=this.tags[i];return s?s+decodeURIComponent(r):i==="!"?t:(n(`Could not resolve tag: ${t}`),null)}tagString(t){for(const[n,i]of Object.entries(this.tags))if(t.startsWith(i))return n+ctt(t.substring(i.length));return t[0]==="!"?t:`!<${t}>`}toString(t){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let r;if(t&&i.length>0&&fe(t.contents)){const s={};ns(t.contents,(o,a)=>{fe(a)&&a.tag&&(s[a.tag]=!0)}),r=Object.keys(s)}else r=[];for(const[s,o]of i)s==="!!"&&o==="tag:yaml.org,2002:"||(!t||r.some(a=>a.startsWith(o)))&&n.push(`%TAG ${s} ${o}`);return n.join(`
`)}}Ce.defaultYaml={explicit:!1,version:"1.2"};Ce.defaultTags={"!!":"tag:yaml.org,2002:"};function LN(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw new Error(n)}return!0}function RN(e){const t=new Set;return ns(e,{Value(n,i){i.anchor&&t.add(i.anchor)}}),t}function FN(e,t){for(let n=1;;++n){const i=`${e}${n}`;if(!t.has(i))return i}}function ltt(e,t){const n=[],i=new Map;let r=null;return{onAnchor:s=>{n.push(s),r||(r=RN(e));const o=FN(t,r);return r.add(o),o},setAnchors:()=>{for(const s of n){const o=i.get(s);if(typeof o=="object"&&o.anchor&&(Xt(o.node)||ne(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=s,a}}},sourceObjects:i}}function zo(e,t,n,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let r=0,s=i.length;r<s;++r){const o=i[r],a=zo(e,i,String(r),o);a===void 0?delete i[r]:a!==o&&(i[r]=a)}else if(i instanceof Map)for(const r of Array.from(i.keys())){const s=i.get(r),o=zo(e,i,r,s);o===void 0?i.delete(r):o!==s&&i.set(r,o)}else if(i instanceof Set)for(const r of Array.from(i)){const s=zo(e,i,r,r);s===void 0?i.delete(r):s!==r&&(i.delete(r),i.add(s))}else for(const[r,s]of Object.entries(i)){const o=zo(e,i,r,s);o===void 0?delete i[r]:o!==s&&(i[r]=o)}return e.call(t,n,i)}function Rn(e,t,n){if(Array.isArray(e))return e.map((i,r)=>Rn(i,String(r),n));if(e&&typeof e.toJSON=="function"){if(!n||!ott(e))return e.toJSON(t,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(e,i),n.onCreate=s=>{i.res=s,delete n.onCreate};const r=e.toJSON(t,n);return n.onCreate&&n.onCreate(r),r}return typeof e=="bigint"&&!(n!=null&&n.keep)?Number(e):e}class Db{constructor(t){Object.defineProperty(this,Un,{value:t})}clone(){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:n,maxAliasCount:i,onAnchor:r,reviver:s}={}){if(!ec(t))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:t,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},a=Rn(this,"",o);if(typeof r=="function")for(const{count:c,res:l}of o.anchors.values())r(l,c);return typeof s=="function"?zo(s,{"":a},"",a):a}}class Ap extends Db{constructor(t){super(Fb),this.source=t,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(t){let n;return ns(t,{Node:(i,r)=>{if(r===this)return ns.BREAK;r.anchor===this.source&&(n=r)}}),n}toJSON(t,n){if(!n)return{source:this.source};const{anchors:i,doc:r,maxAliasCount:s}=n,o=this.resolve(r);if(!o){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let a=i.get(o);if(a||(Rn(o,null,n),a=i.get(o)),!a||a.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(s>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=pf(r,o,i)),a.count*a.aliasCount>s)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return a.res}toString(t,n,i){const r=`*${this.source}`;if(t){if(LN(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){const s=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(s)}if(t.implicitKey)return`${r} `}return r}}function pf(e,t,n){if(po(t)){const i=t.resolve(e),r=n&&i&&n.get(i);return r?r.count*r.aliasCount:0}else if(ne(t)){let i=0;for(const r of t.items){const s=pf(e,r,n);s>i&&(i=s)}return i}else if(Jt(t)){const i=pf(e,t.key,n),r=pf(e,t.value,n);return Math.max(i,r)}return 1}const DN=e=>!e||typeof e!="function"&&typeof e!="object";class mt extends Db{constructor(t){super(yr),this.value=t}toJSON(t,n){return n!=null&&n.keep?this.value:Rn(this.value,t,n)}toString(){return String(this.value)}}mt.BLOCK_FOLDED="BLOCK_FOLDED";mt.BLOCK_LITERAL="BLOCK_LITERAL";mt.PLAIN="PLAIN";mt.QUOTE_DOUBLE="QUOTE_DOUBLE";mt.QUOTE_SINGLE="QUOTE_SINGLE";const utt="tag:yaml.org,2002:";function ftt(e,t,n){if(t){const i=n.filter(s=>s.tag===t),r=i.find(s=>!s.format)??i[0];if(!r)throw new Error(`Tag ${t} not found`);return r}return n.find(i=>{var r;return((r=i.identify)==null?void 0:r.call(i,e))&&!i.format})}function vl(e,t,n){var h,f,d;if(ec(e)&&(e=e.contents),fe(e))return e;if(Jt(e)){const p=(f=(h=n.schema[Ur]).createNode)==null?void 0:f.call(h,n.schema,null,n);return p.items.push(e),p}(e instanceof String||e instanceof Number||e instanceof Boolean||typeof BigInt<"u"&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:i,onAnchor:r,onTagObj:s,schema:o,sourceObjects:a}=n;let c;if(i&&e&&typeof e=="object"){if(c=a.get(e),c)return c.anchor||(c.anchor=r(e)),new Ap(c.anchor);c={anchor:null,node:null},a.set(e,c)}t!=null&&t.startsWith("!!")&&(t=utt+t.slice(2));let l=ftt(e,t,o.tags);if(!l){if(e&&typeof e.toJSON=="function"&&(e=e.toJSON()),!e||typeof e!="object"){const p=new mt(e);return c&&(c.node=p),p}l=e instanceof Map?o[Ur]:Symbol.iterator in Object(e)?o[tc]:o[Ur]}s&&(s(l),delete n.onTagObj);const u=l!=null&&l.createNode?l.createNode(n.schema,e,n):typeof((d=l==null?void 0:l.nodeClass)==null?void 0:d.from)=="function"?l.nodeClass.from(n.schema,e,n):new mt(e);return t?u.tag=t:l.default||(u.tag=l.tag),c&&(c.node=u),u}function rd(e,t,n){let i=n;for(let r=t.length-1;r>=0;--r){const s=t[r];if(typeof s=="number"&&Number.isInteger(s)&&s>=0){const o=[];o[s]=i,i=o}else i=new Map([[s,i]])}return vl(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const Rc=e=>e==null||typeof e=="object"&&!!e[Symbol.iterator]().next().done;class Tp extends Db{constructor(t,n){super(t),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(t){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(n.schema=t),n.items=n.items.map(i=>fe(i)||Jt(i)?i.clone(t):i),this.range&&(n.range=this.range.slice()),n}addIn(t,n){if(Rc(t))this.add(n);else{const[i,...r]=t,s=this.get(i,!0);if(ne(s))s.addIn(r,n);else if(s===void 0&&this.schema)this.set(i,rd(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}deleteIn(t){const[n,...i]=t;if(i.length===0)return this.delete(n);const r=this.get(n,!0);if(ne(r))return r.deleteIn(i);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}getIn(t,n){const[i,...r]=t,s=this.get(i,!0);return r.length===0?!n&&Xt(s)?s.value:s:ne(s)?s.getIn(r,n):void 0}hasAllNullValues(t){return this.items.every(n=>{if(!Jt(n))return!1;const i=n.value;return i==null||t&&Xt(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(t){const[n,...i]=t;if(i.length===0)return this.has(n);const r=this.get(n,!0);return ne(r)?r.hasIn(i):!1}setIn(t,n){const[i,...r]=t;if(r.length===0)this.set(i,n);else{const s=this.get(i,!0);if(ne(s))s.setIn(r,n);else if(s===void 0&&this.schema)this.set(i,rd(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}}Tp.maxFlowStringSingleLineLength=60;const htt=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function rr(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const Dr=(e,t,n)=>e.endsWith(`
`)?rr(n,t):n.includes(`
`)?`
`+rr(n,t):(e.endsWith(" ")?"":" ")+n,CN="flow",Bm="block",yf="quoted";function Ip(e,t,n="flow",{indentAtStart:i,lineWidth:r=80,minContentWidth:s=20,onFold:o,onOverflow:a}={}){if(!r||r<0)return e;const c=Math.max(1+s,1+r-t.length);if(e.length<=c)return e;const l=[],u={};let h=r-t.length;typeof i=="number"&&(i>r-Math.max(2,s)?l.push(0):h=r-i);let f,d,p=!1,y=-1,m=-1,g=-1;n===Bm&&(y=_v(e,y),y!==-1&&(h=y+c));for(let w;w=e[y+=1];){if(n===yf&&w==="\\"){switch(m=y,e[y+1]){case"x":y+=3;break;case"u":y+=5;break;case"U":y+=9;break;default:y+=1}g=y}if(w===`
`)n===Bm&&(y=_v(e,y)),h=y+c,f=void 0;else{if(w===" "&&d&&d!==" "&&d!==`
`&&d!=="	"){const _=e[y+1];_&&_!==" "&&_!==`
`&&_!=="	"&&(f=y)}if(y>=h)if(f)l.push(f),h=f+c,f=void 0;else if(n===yf){for(;d===" "||d==="	";)d=w,w=e[y+=1],p=!0;const _=y>g+1?y-2:m-1;if(u[_])return e;l.push(_),u[_]=!0,h=_+c,f=void 0}else p=!0}d=w}if(p&&a&&a(),l.length===0)return e;o&&o();let b=e.slice(0,l[0]);for(let w=0;w<l.length;++w){const _=l[w],x=l[w+1]||e.length;_===0?b=`
${t}${e.slice(0,x)}`:(n===yf&&u[_]&&(b+=`${e[_]}\\`),b+=`
${t}${e.slice(_+1,x)}`)}return b}function _v(e,t){let n=e[t+1];for(;n===" "||n==="	";){do n=e[t+=1];while(n&&n!==`
`);n=e[t+1]}return t}const Mp=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Np=e=>/^(%|---|\.\.\.)/m.test(e);function dtt(e,t,n){if(!t||t<0)return!1;const i=t-n,r=e.length;if(r<=i)return!1;for(let s=0,o=0;s<r;++s)if(e[s]===`
`){if(s-o>i)return!0;if(o=s+1,r-o<=i)return!1}return!0}function Wc(e,t){const n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;const{implicitKey:i}=t,r=t.options.doubleQuotedMinMultiLineLength,s=t.indent||(Np(e)?"  ":"");let o="",a=0;for(let c=0,l=n[c];l;l=n[++c])if(l===" "&&n[c+1]==="\\"&&n[c+2]==="n"&&(o+=n.slice(a,c)+"\\ ",c+=1,a=c,l="\\"),l==="\\")switch(n[c+1]){case"u":{o+=n.slice(a,c);const u=n.substr(c+2,4);switch(u){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:u.substr(0,2)==="00"?o+="\\x"+u.substr(2):o+=n.substr(c,6)}c+=5,a=c+1}break;case"n":if(i||n[c+2]==='"'||n.length<r)c+=1;else{for(o+=n.slice(a,c)+`

`;n[c+2]==="\\"&&n[c+3]==="n"&&n[c+4]!=='"';)o+=`
`,c+=2;o+=s,n[c+2]===" "&&(o+="\\"),c+=1,a=c+1}break;default:c+=1}return o=a?o+n.slice(a):n,i?o:Ip(o,s,yf,Mp(t,!1))}function Pm(e,t){if(t.options.singleQuote===!1||t.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return Wc(e,t);const n=t.indent||(Np(e)?"  ":""),i="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return t.implicitKey?i:Ip(i,n,CN,Mp(t,!1))}function jo(e,t){const{singleQuote:n}=t.options;let i;if(n===!1)i=Wc;else{const r=e.includes('"'),s=e.includes("'");r&&!s?i=Pm:s&&!r?i=Wc:i=n?Pm:Wc}return i(e,t)}let Um;try{Um=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Um=/\n+(?!\n|$)/g}function mf({comment:e,type:t,value:n},i,r,s){const{blockQuote:o,commentString:a,lineWidth:c}=i.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return jo(n,i);const l=i.indent||(i.forceBlockIndent||Np(n)?"  ":""),u=o==="literal"?!0:o==="folded"||t===mt.BLOCK_FOLDED?!1:t===mt.BLOCK_LITERAL?!0:!dtt(n,c,l.length);if(!n)return u?`|
`:`>
`;let h,f;for(f=n.length;f>0;--f){const v=n[f-1];if(v!==`
`&&v!=="	"&&v!==" ")break}let d=n.substring(f);const p=d.indexOf(`
`);p===-1?h="-":n===d||p!==d.length-1?(h="+",s&&s()):h="",d&&(n=n.slice(0,-d.length),d[d.length-1]===`
`&&(d=d.slice(0,-1)),d=d.replace(Um,`$&${l}`));let y=!1,m,g=-1;for(m=0;m<n.length;++m){const v=n[m];if(v===" ")y=!0;else if(v===`
`)g=m;else break}let b=n.substring(0,g<m?g+1:m);b&&(n=n.substring(b.length),b=b.replace(/\n+/g,`$&${l}`));let _=(u?"|":">")+(y?l?"2":"1":"")+h;if(e&&(_+=" "+a(e.replace(/ ?[\r\n]+/g," ")),r&&r()),u)return n=n.replace(/\n+/g,`$&${l}`),`${_}
${l}${b}${n}${d}`;n=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${l}`);const x=Ip(`${b}${n}${d}`,l,Bm,Mp(i,!0));return`${_}
${l}${x}`}function ptt(e,t,n,i){const{type:r,value:s}=e,{actualString:o,implicitKey:a,indent:c,indentStep:l,inFlow:u}=t;if(a&&/[\n[\]{},]/.test(s)||u&&/[[\]{},]/.test(s))return jo(s,t);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return a||u||!s.includes(`
`)?jo(s,t):mf(e,t,n,i);if(!a&&!u&&r!==mt.PLAIN&&s.includes(`
`))return mf(e,t,n,i);if(Np(s)){if(c==="")return t.forceBlockIndent=!0,mf(e,t,n,i);if(a&&c===l)return jo(s,t)}const h=s.replace(/\n+/g,`$&
${c}`);if(o){const f=y=>{var m;return y.default&&y.tag!=="tag:yaml.org,2002:str"&&((m=y.test)==null?void 0:m.test(h))},{compat:d,tags:p}=t.doc.schema;if(p.some(f)||d!=null&&d.some(f))return jo(s,t)}return a?h:Ip(h,c,CN,Mp(t,!1))}function au(e,t,n,i){const{implicitKey:r,inFlow:s}=t,o=typeof e.value=="string"?e:Object.assign({},e,{value:String(e.value)});let{type:a}=e;a!==mt.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=mt.QUOTE_DOUBLE);const c=u=>{switch(u){case mt.BLOCK_FOLDED:case mt.BLOCK_LITERAL:return r||s?jo(o.value,t):mf(o,t,n,i);case mt.QUOTE_DOUBLE:return Wc(o.value,t);case mt.QUOTE_SINGLE:return Pm(o.value,t);case mt.PLAIN:return ptt(o,t,n,i);default:return null}};let l=c(a);if(l===null){const{defaultKeyType:u,defaultStringType:h}=t.options,f=r&&u||h;if(l=c(f),l===null)throw new Error(`Unsupported default string type ${f}`)}return l}function BN(e,t){const n=Object.assign({blockQuote:!0,commentString:htt,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let i;switch(n.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:i,options:n}}function ytt(e,t){var r;if(t.tag){const s=e.filter(o=>o.tag===t.tag);if(s.length>0)return s.find(o=>o.format===t.format)??s[0]}let n,i;if(Xt(t)){i=t.value;const s=e.filter(o=>{var a;return(a=o.identify)==null?void 0:a.call(o,i)});n=s.find(o=>o.format===t.format)??s.find(o=>!o.format)}else i=t,n=e.find(s=>s.nodeClass&&i instanceof s.nodeClass);if(!n){const s=((r=i==null?void 0:i.constructor)==null?void 0:r.name)??typeof i;throw new Error(`Tag not resolved for ${s} value`)}return n}function mtt(e,t,{anchors:n,doc:i}){if(!i.directives)return"";const r=[],s=(Xt(e)||ne(e))&&e.anchor;s&&LN(s)&&(n.add(s),r.push(`&${s}`));const o=e.tag?e.tag:t.default?null:t.tag;return o&&r.push(i.directives.tagString(o)),r.join(" ")}function Fa(e,t,n,i){var c;if(Jt(e))return e.toString(t,n,i);if(po(e)){if(t.doc.directives)return e.toString(t);if((c=t.resolvedAliases)!=null&&c.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let r;const s=fe(e)?e:t.doc.createNode(e,{onTagObj:l=>r=l});r||(r=ytt(t.doc.schema.tags,s));const o=mtt(s,r,t);o.length>0&&(t.indentAtStart=(t.indentAtStart??0)+o.length+1);const a=typeof r.stringify=="function"?r.stringify(s,t,n,i):Xt(s)?au(s,t,n,i):s.toString(t,n,i);return o?Xt(s)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${t.indent}${a}`:a}function gtt({key:e,value:t},n,i,r){const{allNullValues:s,doc:o,indent:a,indentStep:c,options:{commentString:l,indentSeq:u,simpleKeys:h}}=n;let f=fe(e)&&e.comment||null;if(h){if(f)throw new Error("With simple keys, key nodes cannot have comments");if(ne(e)){const E="With simple keys, collection cannot be used as a key value";throw new Error(E)}}let d=!h&&(!e||f&&t==null&&!n.inFlow||ne(e)||(Xt(e)?e.type===mt.BLOCK_FOLDED||e.type===mt.BLOCK_LITERAL:typeof e=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!d&&(h||!s),indent:a+c});let p=!1,y=!1,m=Fa(e,n,()=>p=!0,()=>y=!0);if(!d&&!n.inFlow&&m.length>1024){if(h)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");d=!0}if(n.inFlow){if(s||t==null)return p&&i&&i(),m===""?"?":d?`? ${m}`:m}else if(s&&!h||t==null&&d)return m=`? ${m}`,f&&!p?m+=Dr(m,n.indent,l(f)):y&&r&&r(),m;p&&(f=null),d?(f&&(m+=Dr(m,n.indent,l(f))),m=`? ${m}
${a}:`):(m=`${m}:`,f&&(m+=Dr(m,n.indent,l(f))));let g,b,w;fe(t)?(g=!!t.spaceBefore,b=t.commentBefore,w=t.comment):(g=!1,b=null,w=null,t&&typeof t=="object"&&(t=o.createNode(t))),n.implicitKey=!1,!d&&!f&&Xt(t)&&(n.indentAtStart=m.length+1),y=!1,!u&&c.length>=2&&!n.inFlow&&!d&&ic(t)&&!t.flow&&!t.tag&&!t.anchor&&(n.indent=n.indent.substring(2));let _=!1;const x=Fa(t,n,()=>_=!0,()=>y=!0);let v=" ";if(f||g||b){if(v=g?`
`:"",b){const E=l(b);v+=`
${rr(E,n.indent)}`}x===""&&!n.inFlow?v===`
`&&(v=`

`):v+=`
${n.indent}`}else if(!d&&ne(t)){const E=x[0],T=x.indexOf(`
`),k=T!==-1,A=n.inFlow??t.flow??t.items.length===0;if(k||!A){let I=!1;if(k&&(E==="&"||E==="!")){let O=x.indexOf(" ");E==="&"&&O!==-1&&O<T&&x[O+1]==="!"&&(O=x.indexOf(" ",O+1)),(O===-1||T<O)&&(I=!0)}I||(v=`
${n.indent}`)}}else(x===""||x[0]===`
`)&&(v="");return m+=v+x,n.inFlow?_&&i&&i():w&&!_?m+=Dr(m,n.indent,l(w)):y&&r&&r(),m}function PN(e,t){(e==="debug"||e==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(t):console.warn(t))}const vv="<<";function UN(e,t,{key:n,value:i}){if(e!=null&&e.doc.schema.merge&&btt(n))if(i=po(i)?i.resolve(e.doc):i,ic(i))for(const r of i.items)Qy(e,t,r);else if(Array.isArray(i))for(const r of i)Qy(e,t,r);else Qy(e,t,i);else{const r=Rn(n,"",e);if(t instanceof Map)t.set(r,Rn(i,r,e));else if(t instanceof Set)t.add(r);else{const s=wtt(n,r,e),o=Rn(i,s,e);s in t?Object.defineProperty(t,s,{value:o,writable:!0,enumerable:!0,configurable:!0}):t[s]=o}}return t}const btt=e=>e===vv||Xt(e)&&e.value===vv&&(!e.type||e.type===mt.PLAIN);function Qy(e,t,n){const i=e&&po(n)?n.resolve(e.doc):n;if(!nc(i))throw new Error("Merge sources must be maps or map aliases");const r=i.toJSON(null,e,Map);for(const[s,o]of r)t instanceof Map?t.has(s)||t.set(s,o):t instanceof Set?t.add(s):Object.prototype.hasOwnProperty.call(t,s)||Object.defineProperty(t,s,{value:o,writable:!0,enumerable:!0,configurable:!0});return t}function wtt(e,t,n){if(t===null)return"";if(typeof t!="object")return String(t);if(fe(e)&&n&&n.doc){const i=BN(n.doc,{});i.anchors=new Set;for(const s of n.anchors.keys())i.anchors.add(s.anchor);i.inFlow=!0,i.inStringifyKey=!0;const r=e.toString(i);if(!n.mapKeyWarned){let s=JSON.stringify(r);s.length>40&&(s=s.substring(0,36)+'..."'),PN(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${s}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(t)}function Cb(e,t,n){const i=vl(e,void 0,n),r=vl(t,void 0,n);return new Le(i,r)}class Le{constructor(t,n=null){Object.defineProperty(this,Un,{value:MN}),this.key=t,this.value=n}clone(t){let{key:n,value:i}=this;return fe(n)&&(n=n.clone(t)),fe(i)&&(i=i.clone(t)),new Le(n,i)}toJSON(t,n){const i=n!=null&&n.mapAsMap?new Map:{};return UN(n,i,this)}toString(t,n,i){return t!=null&&t.doc?gtt(this,t,n,i):JSON.stringify(this)}}function zN(e,t,n){return(t.inFlow??e.flow?vtt:_tt)(e,t,n)}function _tt({comment:e,items:t},n,{blockItemPrefix:i,flowChars:r,itemIndent:s,onChompKeep:o,onComment:a}){const{indent:c,options:{commentString:l}}=n,u=Object.assign({},n,{indent:s,type:null});let h=!1;const f=[];for(let p=0;p<t.length;++p){const y=t[p];let m=null;if(fe(y))!h&&y.spaceBefore&&f.push(""),sd(n,f,y.commentBefore,h),y.comment&&(m=y.comment);else if(Jt(y)){const b=fe(y.key)?y.key:null;b&&(!h&&b.spaceBefore&&f.push(""),sd(n,f,b.commentBefore,h))}h=!1;let g=Fa(y,u,()=>m=null,()=>h=!0);m&&(g+=Dr(g,s,l(m))),h&&m&&(h=!1),f.push(i+g)}let d;if(f.length===0)d=r.start+r.end;else{d=f[0];for(let p=1;p<f.length;++p){const y=f[p];d+=y?`
${c}${y}`:`
`}}return e?(d+=`
`+rr(l(e),c),a&&a()):h&&o&&o(),d}function vtt({comment:e,items:t},n,{flowChars:i,itemIndent:r,onComment:s}){const{indent:o,indentStep:a,flowCollectionPadding:c,options:{commentString:l}}=n;r+=a;const u=Object.assign({},n,{indent:r,inFlow:!0,type:null});let h=!1,f=0;const d=[];for(let g=0;g<t.length;++g){const b=t[g];let w=null;if(fe(b))b.spaceBefore&&d.push(""),sd(n,d,b.commentBefore,!1),b.comment&&(w=b.comment);else if(Jt(b)){const x=fe(b.key)?b.key:null;x&&(x.spaceBefore&&d.push(""),sd(n,d,x.commentBefore,!1),x.comment&&(h=!0));const v=fe(b.value)?b.value:null;v?(v.comment&&(w=v.comment),v.commentBefore&&(h=!0)):b.value==null&&x&&x.comment&&(w=x.comment)}w&&(h=!0);let _=Fa(b,u,()=>w=null);g<t.length-1&&(_+=","),w&&(_+=Dr(_,r,l(w))),!h&&(d.length>f||_.includes(`
`))&&(h=!0),d.push(_),f=d.length}let p;const{start:y,end:m}=i;if(d.length===0)p=y+m;else if(h||(h=d.reduce((b,w)=>b+w.length+2,2)>Tp.maxFlowStringSingleLineLength),h){p=y;for(const g of d)p+=g?`
${a}${o}${g}`:`
`;p+=`
${o}${m}`}else p=`${y}${c}${d.join(" ")}${c}${m}`;return e&&(p+=Dr(p,o,l(e)),s&&s()),p}function sd({indent:e,options:{commentString:t}},n,i,r){if(i&&r&&(i=i.replace(/^\n+/,"")),i){const s=rr(t(i),e);n.push(s.trimStart())}}function Bs(e,t){const n=Xt(t)?t.value:t;for(const i of e)if(Jt(i)&&(i.key===t||i.key===n||Xt(i.key)&&i.key.value===n))return i}class hn extends Tp{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(Ur,t),this.items=[]}static from(t,n,i){const{keepUndefined:r,replacer:s}=i,o=new this(t),a=(c,l)=>{if(typeof s=="function")l=s.call(n,c,l);else if(Array.isArray(s)&&!s.includes(c))return;(l!==void 0||r)&&o.items.push(Cb(c,l,i))};if(n instanceof Map)for(const[c,l]of n)a(c,l);else if(n&&typeof n=="object")for(const c of Object.keys(n))a(c,n[c]);return typeof t.sortMapEntries=="function"&&o.items.sort(t.sortMapEntries),o}add(t,n){var o;let i;Jt(t)?i=t:!t||typeof t!="object"||!("key"in t)?i=new Le(t,t==null?void 0:t.value):i=new Le(t.key,t.value);const r=Bs(this.items,i.key),s=(o=this.schema)==null?void 0:o.sortMapEntries;if(r){if(!n)throw new Error(`Key ${i.key} already set`);Xt(r.value)&&DN(i.value)?r.value.value=i.value:r.value=i.value}else if(s){const a=this.items.findIndex(c=>s(i,c)<0);a===-1?this.items.push(i):this.items.splice(a,0,i)}else this.items.push(i)}delete(t){const n=Bs(this.items,t);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(t,n){const i=Bs(this.items,t),r=i==null?void 0:i.value;return(!n&&Xt(r)?r.value:r)??void 0}has(t){return!!Bs(this.items,t)}set(t,n){this.add(new Le(t,n),!0)}toJSON(t,n,i){const r=i?new i:n!=null&&n.mapAsMap?new Map:{};n!=null&&n.onCreate&&n.onCreate(r);for(const s of this.items)UN(n,r,s);return r}toString(t,n,i){if(!t)return JSON.stringify(this);for(const r of this.items)if(!Jt(r))throw new Error(`Map items must all be pairs; found ${JSON.stringify(r)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),zN(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:i,onComment:n})}}const rc={collection:"map",default:!0,nodeClass:hn,tag:"tag:yaml.org,2002:map",resolve(e,t){return nc(e)||t("Expected a mapping for this tag"),e},createNode:(e,t,n)=>hn.from(e,t,n)};class is extends Tp{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(tc,t),this.items=[]}add(t){this.items.push(t)}delete(t){const n=Wu(t);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(t,n){const i=Wu(t);if(typeof i!="number")return;const r=this.items[i];return!n&&Xt(r)?r.value:r}has(t){const n=Wu(t);return typeof n=="number"&&n<this.items.length}set(t,n){const i=Wu(t);if(typeof i!="number")throw new Error(`Expected a valid index, not ${t}.`);const r=this.items[i];Xt(r)&&DN(n)?r.value=n:this.items[i]=n}toJSON(t,n){const i=[];n!=null&&n.onCreate&&n.onCreate(i);let r=0;for(const s of this.items)i.push(Rn(s,String(r++),n));return i}toString(t,n,i){return t?zN(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:i,onComment:n}):JSON.stringify(this)}static from(t,n,i){const{replacer:r}=i,s=new this(t);if(n&&Symbol.iterator in Object(n)){let o=0;for(let a of n){if(typeof r=="function"){const c=n instanceof Set?a:String(o++);a=r.call(n,c,a)}s.items.push(vl(a,void 0,i))}}return s}}function Wu(e){let t=Xt(e)?e.value:e;return t&&typeof t=="string"&&(t=Number(t)),typeof t=="number"&&Number.isInteger(t)&&t>=0?t:null}const sc={collection:"seq",default:!0,nodeClass:is,tag:"tag:yaml.org,2002:seq",resolve(e,t){return ic(e)||t("Expected a sequence for this tag"),e},createNode:(e,t,n)=>is.from(e,t,n)},$p={identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify(e,t,n,i){return t=Object.assign({actualString:!0},t),au(e,t,n,i)}},kp={identify:e=>e==null,createNode:()=>new mt(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new mt(null),stringify:({source:e},t)=>typeof e=="string"&&kp.test.test(e)?e:t.options.nullStr},Bb={identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new mt(e[0]==="t"||e[0]==="T"),stringify({source:e,value:t},n){if(e&&Bb.test.test(e)){const i=e[0]==="t"||e[0]==="T";if(t===i)return e}return t?n.options.trueStr:n.options.falseStr}};function ri({format:e,minFractionDigits:t,tag:n,value:i}){if(typeof i=="bigint")return String(i);const r=typeof i=="number"?i:Number(i);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let s=JSON.stringify(i);if(!e&&t&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(s)){let o=s.indexOf(".");o<0&&(o=s.length,s+=".");let a=t-(s.length-o-1);for(;a-- >0;)s+="0"}return s}const jN={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ri},qN={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():ri(e)}},YN={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new mt(parseFloat(e)),n=e.indexOf(".");return n!==-1&&e[e.length-1]==="0"&&(t.minFractionDigits=e.length-n-1),t},stringify:ri},Op=e=>typeof e=="bigint"||Number.isInteger(e),Pb=(e,t,n,{intAsBigInt:i})=>i?BigInt(e):parseInt(e.substring(t),n);function VN(e,t,n){const{value:i}=e;return Op(i)&&i>=0?n+i.toString(t):ri(e)}const WN={identify:e=>Op(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>Pb(e,2,8,n),stringify:e=>VN(e,8,"0o")},GN={identify:Op,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>Pb(e,0,10,n),stringify:ri},HN={identify:e=>Op(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>Pb(e,2,16,n),stringify:e=>VN(e,16,"0x")},xtt=[rc,sc,$p,kp,Bb,WN,GN,HN,jN,qN,YN];function xv(e){return typeof e=="bigint"||Number.isInteger(e)}const Gu=({value:e})=>JSON.stringify(e),Stt=[{identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:Gu},{identify:e=>e==null,createNode:()=>new mt(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Gu},{identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:e=>e==="true",stringify:Gu},{identify:xv,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>xv(e)?e.toString():JSON.stringify(e)},{identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:Gu}],Ett={default:!0,tag:"",test:/^/,resolve(e,t){return t(`Unresolved plain scalar ${JSON.stringify(e)}`),e}},Att=[rc,sc].concat(Stt,Ett),Ub={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if(typeof Buffer=="function")return Buffer.from(e,"base64");if(typeof atob=="function"){const n=atob(e.replace(/[\n\r]/g,"")),i=new Uint8Array(n.length);for(let r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},i,r,s){const o=n;let a;if(typeof Buffer=="function")a=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let c="";for(let l=0;l<o.length;++l)c+=String.fromCharCode(o[l]);a=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t||(t=mt.BLOCK_LITERAL),t!==mt.QUOTE_DOUBLE){const c=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),l=Math.ceil(a.length/c),u=new Array(l);for(let h=0,f=0;h<l;++h,f+=c)u[h]=a.substr(f,c);a=u.join(t===mt.BLOCK_LITERAL?`
`:" ")}return au({comment:e,type:t,value:a},i,r,s)}};function XN(e,t){if(ic(e))for(let n=0;n<e.items.length;++n){let i=e.items[n];if(!Jt(i)){if(nc(i)){i.items.length>1&&t("Each pair must have its own sequence indicator");const r=i.items[0]||new Le(new mt(null));if(i.commentBefore&&(r.key.commentBefore=r.key.commentBefore?`${i.commentBefore}
${r.key.commentBefore}`:i.commentBefore),i.comment){const s=r.value??r.key;s.comment=s.comment?`${i.comment}
${s.comment}`:i.comment}i=r}e.items[n]=Jt(i)?i:new Le(i)}}else t("Expected a sequence for this tag");return e}function KN(e,t,n){const{replacer:i}=n,r=new is(e);r.tag="tag:yaml.org,2002:pairs";let s=0;if(t&&Symbol.iterator in Object(t))for(let o of t){typeof i=="function"&&(o=i.call(t,String(s++),o));let a,c;if(Array.isArray(o))if(o.length===2)a=o[0],c=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const l=Object.keys(o);if(l.length===1)a=l[0],c=o[a];else throw new TypeError(`Expected { key: value } tuple: ${o}`)}else a=o;r.items.push(Cb(a,c,n))}return r}const zb={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:XN,createNode:KN};class sa extends is{constructor(){super(),this.add=hn.prototype.add.bind(this),this.delete=hn.prototype.delete.bind(this),this.get=hn.prototype.get.bind(this),this.has=hn.prototype.has.bind(this),this.set=hn.prototype.set.bind(this),this.tag=sa.tag}toJSON(t,n){if(!n)return super.toJSON(t);const i=new Map;n!=null&&n.onCreate&&n.onCreate(i);for(const r of this.items){let s,o;if(Jt(r)?(s=Rn(r.key,"",n),o=Rn(r.value,s,n)):s=Rn(r,"",n),i.has(s))throw new Error("Ordered maps must not include duplicate keys");i.set(s,o)}return i}static from(t,n,i){const r=KN(t,n,i),s=new this;return s.items=r.items,s}}sa.tag="tag:yaml.org,2002:omap";const jb={collection:"seq",identify:e=>e instanceof Map,nodeClass:sa,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const n=XN(e,t),i=[];for(const{key:r}of n.items)Xt(r)&&(i.includes(r.value)?t(`Ordered maps must not include duplicate keys: ${r.value}`):i.push(r.value));return Object.assign(new sa,n)},createNode:(e,t,n)=>sa.from(e,t,n)};function QN({value:e,source:t},n){return t&&(e?JN:ZN).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}const JN={identify:e=>e===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new mt(!0),stringify:QN},ZN={identify:e=>e===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new mt(!1),stringify:QN},Ttt={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ri},Itt={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():ri(e)}},Mtt={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new mt(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(n!==-1){const i=e.substring(n+1).replace(/_/g,"");i[i.length-1]==="0"&&(t.minFractionDigits=i.length)}return t},stringify:ri},cu=e=>typeof e=="bigint"||Number.isInteger(e);function Lp(e,t,n,{intAsBigInt:i}){const r=e[0];if((r==="-"||r==="+")&&(t+=1),e=e.substring(t).replace(/_/g,""),i){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`;break}const o=BigInt(e);return r==="-"?BigInt(-1)*o:o}const s=parseInt(e,n);return r==="-"?-1*s:s}function qb(e,t,n){const{value:i}=e;if(cu(i)){const r=i.toString(t);return i<0?"-"+n+r.substr(1):n+r}return ri(e)}const Ntt={identify:cu,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>Lp(e,2,2,n),stringify:e=>qb(e,2,"0b")},$tt={identify:cu,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>Lp(e,1,8,n),stringify:e=>qb(e,8,"0")},ktt={identify:cu,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>Lp(e,0,10,n),stringify:ri},Ott={identify:cu,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>Lp(e,2,16,n),stringify:e=>qb(e,16,"0x")};class oa extends hn{constructor(t){super(t),this.tag=oa.tag}add(t){let n;Jt(t)?n=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?n=new Le(t.key,null):n=new Le(t,null),Bs(this.items,n.key)||this.items.push(n)}get(t,n){const i=Bs(this.items,t);return!n&&Jt(i)?Xt(i.key)?i.key.value:i.key:i}set(t,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const i=Bs(this.items,t);i&&!n?this.items.splice(this.items.indexOf(i),1):!i&&n&&this.items.push(new Le(t))}toJSON(t,n){return super.toJSON(t,n,Set)}toString(t,n,i){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),n,i);throw new Error("Set items must all have null values")}static from(t,n,i){const{replacer:r}=i,s=new this(t);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof r=="function"&&(o=r.call(n,o,o)),s.items.push(Cb(o,null,i));return s}}oa.tag="tag:yaml.org,2002:set";const Yb={collection:"map",identify:e=>e instanceof Set,nodeClass:oa,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,n)=>oa.from(e,t,n),resolve(e,t){if(nc(e)){if(e.hasAllNullValues(!0))return Object.assign(new oa,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function Vb(e,t){const n=e[0],i=n==="-"||n==="+"?e.substring(1):e,r=o=>t?BigInt(o):Number(o),s=i.replace(/_/g,"").split(":").reduce((o,a)=>o*r(60)+r(a),r(0));return n==="-"?r(-1)*s:s}function t$(e){let{value:t}=e,n=o=>o;if(typeof t=="bigint")n=o=>BigInt(o);else if(isNaN(t)||!isFinite(t))return ri(e);let i="";t<0&&(i="-",t*=n(-1));const r=n(60),s=[t%r];return t<60?s.unshift(0):(t=(t-s[0])/r,s.unshift(t%r),t>=60&&(t=(t-s[0])/r,s.unshift(t))),i+s.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const e$={identify:e=>typeof e=="bigint"||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>Vb(e,n),stringify:t$},n$={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>Vb(e,!1),stringify:t$},Rp={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(Rp.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,i,r,s,o,a]=t.map(Number),c=t[7]?Number((t[7]+"00").substr(1,3)):0;let l=Date.UTC(n,i-1,r,s||0,o||0,a||0,c);const u=t[8];if(u&&u!=="Z"){let h=Vb(u,!1);Math.abs(h)<30&&(h*=60),l-=6e4*h}return new Date(l)},stringify:({value:e})=>e.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},Sv=[rc,sc,$p,kp,JN,ZN,Ntt,$tt,ktt,Ott,Ttt,Itt,Mtt,Ub,jb,zb,Yb,e$,n$,Rp],Ev=new Map([["core",xtt],["failsafe",[rc,sc,$p]],["json",Att],["yaml11",Sv],["yaml-1.1",Sv]]),Av={binary:Ub,bool:Bb,float:YN,floatExp:qN,floatNaN:jN,floatTime:n$,int:GN,intHex:HN,intOct:WN,intTime:e$,map:rc,null:kp,omap:jb,pairs:zb,seq:sc,set:Yb,timestamp:Rp},Ltt={"tag:yaml.org,2002:binary":Ub,"tag:yaml.org,2002:omap":jb,"tag:yaml.org,2002:pairs":zb,"tag:yaml.org,2002:set":Yb,"tag:yaml.org,2002:timestamp":Rp};function Jy(e,t){let n=Ev.get(t);if(!n)if(Array.isArray(e))n=[];else{const i=Array.from(Ev.keys()).filter(r=>r!=="yaml11").map(r=>JSON.stringify(r)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${i} or define customTags array`)}if(Array.isArray(e))for(const i of e)n=n.concat(i);else typeof e=="function"&&(n=e(n.slice()));return n.map(i=>{if(typeof i!="string")return i;const r=Av[i];if(r)return r;const s=Object.keys(Av).map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown custom tag "${i}"; use one of ${s}`)})}const Rtt=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0;class Fp{constructor({compat:t,customTags:n,merge:i,resolveKnownTags:r,schema:s,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(t)?Jy(t,"compat"):t?Jy(null,t):null,this.merge=!!i,this.name=typeof s=="string"&&s||"core",this.knownTags=r?Ltt:{},this.tags=Jy(n,this.name),this.toStringOptions=a??null,Object.defineProperty(this,Ur,{value:rc}),Object.defineProperty(this,yr,{value:$p}),Object.defineProperty(this,tc,{value:sc}),this.sortMapEntries=typeof o=="function"?o:o===!0?Rtt:null}clone(){const t=Object.create(Fp.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}}function Ftt(e,t){var c;const n=[];let i=t.directives===!0;if(t.directives!==!1&&e.directives){const l=e.directives.toString(e);l?(n.push(l),i=!0):e.directives.docStart&&(i=!0)}i&&n.push("---");const r=BN(e,t),{commentString:s}=r.options;if(e.commentBefore){n.length!==1&&n.unshift("");const l=s(e.commentBefore);n.unshift(rr(l,""))}let o=!1,a=null;if(e.contents){if(fe(e.contents)){if(e.contents.spaceBefore&&i&&n.push(""),e.contents.commentBefore){const h=s(e.contents.commentBefore);n.push(rr(h,""))}r.forceBlockIndent=!!e.comment,a=e.contents.comment}const l=a?void 0:()=>o=!0;let u=Fa(e.contents,r,()=>a=null,l);a&&(u+=Dr(u,"",s(a))),(u[0]==="|"||u[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${u}`:n.push(u)}else n.push(Fa(e.contents,r));if((c=e.directives)!=null&&c.docEnd)if(e.comment){const l=s(e.comment);l.includes(`
`)?(n.push("..."),n.push(rr(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=e.comment;l&&o&&(l=l.replace(/^\n+/,"")),l&&((!o||a)&&n[n.length-1]!==""&&n.push(""),n.push(rr(s(l),"")))}return n.join(`
`)+`
`}class oc{constructor(t,n,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Un,{value:Cm});let r=null;typeof n=="function"||Array.isArray(n)?r=n:i===void 0&&n&&(i=n,n=void 0);const s=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},i);this.options=s;let{version:o}=s;i!=null&&i._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new Ce({version:o}),this.setSchema(o,i),this.contents=t===void 0?null:this.createNode(t,r,i)}clone(){const t=Object.create(oc.prototype,{[Un]:{value:Cm}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=fe(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){Mo(this.contents)&&this.contents.add(t)}addIn(t,n){Mo(this.contents)&&this.contents.addIn(t,n)}createAlias(t,n){if(!t.anchor){const i=RN(this);t.anchor=!n||i.has(n)?FN(n||"a",i):n}return new Ap(t.anchor)}createNode(t,n,i){let r;if(typeof n=="function")t=n.call({"":t},"",t),r=n;else if(Array.isArray(n)){const m=b=>typeof b=="number"||b instanceof String||b instanceof Number,g=n.filter(m).map(String);g.length>0&&(n=n.concat(g)),r=n}else i===void 0&&n&&(i=n,n=void 0);const{aliasDuplicateObjects:s,anchorPrefix:o,flow:a,keepUndefined:c,onTagObj:l,tag:u}=i??{},{onAnchor:h,setAnchors:f,sourceObjects:d}=ltt(this,o||"a"),p={aliasDuplicateObjects:s??!0,keepUndefined:c??!1,onAnchor:h,onTagObj:l,replacer:r,schema:this.schema,sourceObjects:d},y=vl(t,u,p);return a&&ne(y)&&(y.flow=!0),f(),y}createPair(t,n,i={}){const r=this.createNode(t,null,i),s=this.createNode(n,null,i);return new Le(r,s)}delete(t){return Mo(this.contents)?this.contents.delete(t):!1}deleteIn(t){return Rc(t)?this.contents==null?!1:(this.contents=null,!0):Mo(this.contents)?this.contents.deleteIn(t):!1}get(t,n){return ne(this.contents)?this.contents.get(t,n):void 0}getIn(t,n){return Rc(t)?!n&&Xt(this.contents)?this.contents.value:this.contents:ne(this.contents)?this.contents.getIn(t,n):void 0}has(t){return ne(this.contents)?this.contents.has(t):!1}hasIn(t){return Rc(t)?this.contents!==void 0:ne(this.contents)?this.contents.hasIn(t):!1}set(t,n){this.contents==null?this.contents=rd(this.schema,[t],n):Mo(this.contents)&&this.contents.set(t,n)}setIn(t,n){Rc(t)?this.contents=n:this.contents==null?this.contents=rd(this.schema,Array.from(t),n):Mo(this.contents)&&this.contents.setIn(t,n)}setSchema(t,n={}){typeof t=="number"&&(t=String(t));let i;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ce({version:"1.1"}),i={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new Ce({version:t}),i={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const r=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${r}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(i)this.schema=new Fp(Object.assign(i,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:n,mapAsMap:i,maxAliasCount:r,onAnchor:s,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!t,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=Rn(this.contents,n??"",a);if(typeof s=="function")for(const{count:l,res:u}of a.anchors.values())s(u,l);return typeof o=="function"?zo(o,{"":c},"",c):c}toJSON(t,n){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:n})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){const n=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return Ftt(this,t)}}function Mo(e){if(ne(e))return!0;throw new Error("Expected a YAML collection as document contents")}class Wb extends Error{constructor(t,n,i,r){super(),this.name=t,this.code=i,this.message=r,this.pos=n}}class Ps extends Wb{constructor(t,n,i){super("YAMLParseError",t,n,i)}}class i$ extends Wb{constructor(t,n,i){super("YAMLWarning",t,n,i)}}const od=(e,t)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(a=>t.linePos(a));const{line:i,col:r}=n.linePos[0];n.message+=` at line ${i}, column ${r}`;let s=r-1,o=e.substring(t.lineStarts[i-1],t.lineStarts[i]).replace(/[\n\r]+$/,"");if(s>=60&&o.length>80){const a=Math.min(s-39,o.length-79);o="…"+o.substring(a),s-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,s))){let a=e.substring(t.lineStarts[i-2],t.lineStarts[i-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const c=n.linePos[1];c&&c.line===i&&c.col>r&&(a=Math.max(1,Math.min(c.col-r,80-s)));const l=" ".repeat(s)+"^".repeat(a);n.message+=`:

${o}
${l}
`}};function Da(e,{flow:t,indicator:n,next:i,offset:r,onError:s,startOnNewline:o}){let a=!1,c=o,l=o,u="",h="",f=!1,d=!1,p=!1,y=null,m=null,g=null,b=null,w=null;for(const v of e)switch(p&&(v.type!=="space"&&v.type!=="newline"&&v.type!=="comma"&&s(v.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p=!1),v.type){case"space":!t&&c&&n!=="doc-start"&&v.source[0]==="	"&&s(v,"TAB_AS_INDENT","Tabs are not allowed as indentation"),l=!0;break;case"comment":{l||s(v,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const E=v.source.substring(1)||" ";u?u+=h+E:u=E,h="",c=!1;break}case"newline":c?u?u+=v.source:a=!0:h+=v.source,c=!0,f=!0,(y||m)&&(d=!0),l=!0;break;case"anchor":y&&s(v,"MULTIPLE_ANCHORS","A node can have at most one anchor"),v.source.endsWith(":")&&s(v.offset+v.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=v,w===null&&(w=v.offset),c=!1,l=!1,p=!0;break;case"tag":{m&&s(v,"MULTIPLE_TAGS","A node can have at most one tag"),m=v,w===null&&(w=v.offset),c=!1,l=!1,p=!0;break}case n:(y||m)&&s(v,"BAD_PROP_ORDER",`Anchors and tags must be after the ${v.source} indicator`),b&&s(v,"UNEXPECTED_TOKEN",`Unexpected ${v.source} in ${t??"collection"}`),b=v,c=!1,l=!1;break;case"comma":if(t){g&&s(v,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),g=v,c=!1,l=!1;break}default:s(v,"UNEXPECTED_TOKEN",`Unexpected ${v.type} token`),c=!1,l=!1}const _=e[e.length-1],x=_?_.offset+_.source.length:r;return p&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&s(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:g,found:b,spaceBefore:a,comment:u,hasNewline:f,hasNewlineAfterProp:d,anchor:y,tag:m,end:x,start:w??x}}function xl(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(const t of e.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(const t of e.items){for(const n of t.start)if(n.type==="newline")return!0;if(t.sep){for(const n of t.sep)if(n.type==="newline")return!0}if(xl(t.key)||xl(t.value))return!0}return!1;default:return!0}}function zm(e,t,n){if((t==null?void 0:t.type)==="flow-collection"){const i=t.end[0];i.indent===e&&(i.source==="]"||i.source==="}")&&xl(t)&&n(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function r$(e,t,n){const{uniqueKeys:i}=e.options;if(i===!1)return!1;const r=typeof i=="function"?i:(s,o)=>s===o||Xt(s)&&Xt(o)&&s.value===o.value&&!(s.value==="<<"&&e.schema.merge);return t.some(s=>r(s.key,n))}const Tv="All mapping items must start at the same column";function Dtt({composeNode:e,composeEmptyNode:t},n,i,r,s){var u;const o=(s==null?void 0:s.nodeClass)??hn,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=i.offset,l=null;for(const h of i.items){const{start:f,key:d,sep:p,value:y}=h,m=Da(f,{indicator:"explicit-key-ind",next:d??(p==null?void 0:p[0]),offset:c,onError:r,startOnNewline:!0}),g=!m.found;if(g){if(d&&(d.type==="block-seq"?r(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in d&&d.indent!==i.indent&&r(c,"BAD_INDENT",Tv)),!m.anchor&&!m.tag&&!p){l=m.end,m.comment&&(a.comment?a.comment+=`
`+m.comment:a.comment=m.comment);continue}(m.hasNewlineAfterProp||xl(d))&&r(d??f[f.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((u=m.found)==null?void 0:u.indent)!==i.indent&&r(c,"BAD_INDENT",Tv);const b=m.end,w=d?e(n,d,m,r):t(n,b,f,null,m,r);n.schema.compat&&zm(i.indent,d,r),r$(n,a.items,w)&&r(b,"DUPLICATE_KEY","Map keys must be unique");const _=Da(p??[],{indicator:"map-value-ind",next:y,offset:w.range[2],onError:r,startOnNewline:!d||d.type==="block-scalar"});if(c=_.end,_.found){g&&((y==null?void 0:y.type)==="block-map"&&!_.hasNewline&&r(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&m.start<_.found.offset-1024&&r(w.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const x=y?e(n,y,_,r):t(n,c,p,null,_,r);n.schema.compat&&zm(i.indent,y,r),c=x.range[2];const v=new Le(w,x);n.options.keepSourceTokens&&(v.srcToken=h),a.items.push(v)}else{g&&r(w.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),_.comment&&(w.comment?w.comment+=`
`+_.comment:w.comment=_.comment);const x=new Le(w);n.options.keepSourceTokens&&(x.srcToken=h),a.items.push(x)}}return l&&l<c&&r(l,"IMPOSSIBLE","Map comment with trailing content"),a.range=[i.offset,c,l??c],a}function Ctt({composeNode:e,composeEmptyNode:t},n,i,r,s){const o=(s==null?void 0:s.nodeClass)??is,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=i.offset,l=null;for(const{start:u,value:h}of i.items){const f=Da(u,{indicator:"seq-item-ind",next:h,offset:c,onError:r,startOnNewline:!0});if(!f.found)if(f.anchor||f.tag||h)h&&h.type==="block-seq"?r(f.end,"BAD_INDENT","All sequence items must start at the same column"):r(c,"MISSING_CHAR","Sequence item without - indicator");else{l=f.end,f.comment&&(a.comment=f.comment);continue}const d=h?e(n,h,f,r):t(n,f.end,u,null,f,r);n.schema.compat&&zm(i.indent,h,r),c=d.range[2],a.items.push(d)}return a.range=[i.offset,c,l??c],a}function lu(e,t,n,i){let r="";if(e){let s=!1,o="";for(const a of e){const{source:c,type:l}=a;switch(l){case"space":s=!0;break;case"comment":{n&&!s&&i(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const u=c.substring(1)||" ";r?r+=o+u:r=u,o="";break}case"newline":r&&(o+=c),s=!0;break;default:i(a,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}t+=c.length}}return{comment:r,offset:t}}const Zy="Block collections are not allowed within flow collections",t0=e=>e&&(e.type==="block-map"||e.type==="block-seq");function Btt({composeNode:e,composeEmptyNode:t},n,i,r,s){const o=i.start.source==="{",a=o?"flow map":"flow sequence",c=(s==null?void 0:s.nodeClass)??(o?hn:is),l=new c(n.schema);l.flow=!0;const u=n.atRoot;u&&(n.atRoot=!1);let h=i.offset+i.start.source.length;for(let m=0;m<i.items.length;++m){const g=i.items[m],{start:b,key:w,sep:_,value:x}=g,v=Da(b,{flow:a,indicator:"explicit-key-ind",next:w??(_==null?void 0:_[0]),offset:h,onError:r,startOnNewline:!1});if(!v.found){if(!v.anchor&&!v.tag&&!_&&!x){m===0&&v.comma?r(v.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):m<i.items.length-1&&r(v.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),v.comment&&(l.comment?l.comment+=`
`+v.comment:l.comment=v.comment),h=v.end;continue}!o&&n.options.strict&&xl(w)&&r(w,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(m===0)v.comma&&r(v.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(v.comma||r(v.start,"MISSING_CHAR",`Missing , between ${a} items`),v.comment){let E="";t:for(const T of b)switch(T.type){case"comma":case"space":break;case"comment":E=T.source.substring(1);break t;default:break t}if(E){let T=l.items[l.items.length-1];Jt(T)&&(T=T.value??T.key),T.comment?T.comment+=`
`+E:T.comment=E,v.comment=v.comment.substring(E.length+1)}}if(!o&&!_&&!v.found){const E=x?e(n,x,v,r):t(n,v.end,_,null,v,r);l.items.push(E),h=E.range[2],t0(x)&&r(E.range,"BLOCK_IN_FLOW",Zy)}else{const E=v.end,T=w?e(n,w,v,r):t(n,E,b,null,v,r);t0(w)&&r(T.range,"BLOCK_IN_FLOW",Zy);const k=Da(_??[],{flow:a,indicator:"map-value-ind",next:x,offset:T.range[2],onError:r,startOnNewline:!1});if(k.found){if(!o&&!v.found&&n.options.strict){if(_)for(const O of _){if(O===k.found)break;if(O.type==="newline"){r(O,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}v.start<k.found.offset-1024&&r(k.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else x&&("source"in x&&x.source&&x.source[0]===":"?r(x,"MISSING_CHAR",`Missing space after : in ${a}`):r(k.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const A=x?e(n,x,k,r):k.found?t(n,k.end,_,null,k,r):null;A?t0(x)&&r(A.range,"BLOCK_IN_FLOW",Zy):k.comment&&(T.comment?T.comment+=`
`+k.comment:T.comment=k.comment);const I=new Le(T,A);if(n.options.keepSourceTokens&&(I.srcToken=g),o){const O=l;r$(n,O.items,T)&&r(E,"DUPLICATE_KEY","Map keys must be unique"),O.items.push(I)}else{const O=new hn(n.schema);O.flow=!0,O.items.push(I),l.items.push(O)}h=A?A.range[2]:k.end}}const f=o?"}":"]",[d,...p]=i.end;let y=h;if(d&&d.source===f)y=d.offset+d.source.length;else{const m=a[0].toUpperCase()+a.substring(1),g=u?`${m} must end with a ${f}`:`${m} in block collection must be sufficiently indented and end with a ${f}`;r(h,u?"MISSING_CHAR":"BAD_INDENT",g),d&&d.source.length!==1&&p.unshift(d)}if(p.length>0){const m=lu(p,y,n.options.strict,r);m.comment&&(l.comment?l.comment+=`
`+m.comment:l.comment=m.comment),l.range=[i.offset,y,m.offset]}else l.range=[i.offset,y,y];return l}function e0(e,t,n,i,r,s){const o=n.type==="block-map"?Dtt(e,t,n,i,s):n.type==="block-seq"?Ctt(e,t,n,i,s):Btt(e,t,n,i,s),a=o.constructor;return r==="!"||r===a.tagName?(o.tag=a.tagName,o):(r&&(o.tag=r),o)}function Ptt(e,t,n,i,r){var h;const s=i?t.directives.tagName(i.source,f=>r(i,"TAG_RESOLVE_FAILED",f)):null,o=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!i||!s||s==="!"||s===hn.tagName&&o==="map"||s===is.tagName&&o==="seq"||!o)return e0(e,t,n,r,s);let a=t.schema.tags.find(f=>f.tag===s&&f.collection===o);if(!a){const f=t.schema.knownTags[s];if(f&&f.collection===o)t.schema.tags.push(Object.assign({},f,{default:!1})),a=f;else return f!=null&&f.collection?r(i,"BAD_COLLECTION_TYPE",`${f.tag} used for ${o} collection, but expects ${f.collection}`,!0):r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${s}`,!0),e0(e,t,n,r,s)}const c=e0(e,t,n,r,s,a),l=((h=a.resolve)==null?void 0:h.call(a,c,f=>r(i,"TAG_RESOLVE_FAILED",f),t.options))??c,u=fe(l)?l:new mt(l);return u.range=c.range,u.tag=s,a!=null&&a.format&&(u.format=a.format),u}function s$(e,t,n){const i=e.offset,r=Utt(e,t,n);if(!r)return{value:"",type:null,comment:"",range:[i,i,i]};const s=r.mode===">"?mt.BLOCK_FOLDED:mt.BLOCK_LITERAL,o=e.source?ztt(e.source):[];let a=o.length;for(let y=o.length-1;y>=0;--y){const m=o[y][1];if(m===""||m==="\r")a=y;else break}if(a===0){const y=r.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let m=i+r.length;return e.source&&(m+=e.source.length),{value:y,type:s,comment:r.comment,range:[i,m,m]}}let c=e.indent+r.indent,l=e.offset+r.length,u=0;for(let y=0;y<a;++y){const[m,g]=o[y];if(g===""||g==="\r")r.indent===0&&m.length>c&&(c=m.length);else{if(m.length<c){const b="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";n(l+m.length,"MISSING_CHAR",b)}r.indent===0&&(c=m.length),u=y;break}l+=m.length+g.length+1}for(let y=o.length-1;y>=a;--y)o[y][0].length>c&&(a=y+1);let h="",f="",d=!1;for(let y=0;y<u;++y)h+=o[y][0].slice(c)+`
`;for(let y=u;y<a;++y){let[m,g]=o[y];l+=m.length+g.length+1;const b=g[g.length-1]==="\r";if(b&&(g=g.slice(0,-1)),g&&m.length<c){const _=`Block scalar lines must not be less indented than their ${r.indent?"explicit indentation indicator":"first line"}`;n(l-g.length-(b?2:1),"BAD_INDENT",_),m=""}s===mt.BLOCK_LITERAL?(h+=f+m.slice(c)+g,f=`
`):m.length>c||g[0]==="	"?(f===" "?f=`
`:!d&&f===`
`&&(f=`

`),h+=f+m.slice(c)+g,f=`
`,d=!0):g===""?f===`
`?h+=`
`:f=`
`:(h+=f+g,f=" ",d=!1)}switch(r.chomp){case"-":break;case"+":for(let y=a;y<o.length;++y)h+=`
`+o[y][0].slice(c);h[h.length-1]!==`
`&&(h+=`
`);break;default:h+=`
`}const p=i+r.length+e.source.length;return{value:h,type:s,comment:r.comment,range:[i,p,p]}}function Utt({offset:e,props:t},n,i){if(t[0].type!=="block-scalar-header")return i(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=t[0],s=r[0];let o=0,a="",c=-1;for(let f=1;f<r.length;++f){const d=r[f];if(!a&&(d==="-"||d==="+"))a=d;else{const p=Number(d);!o&&p?o=p:c===-1&&(c=e+f)}}c!==-1&&i(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let l=!1,u="",h=r.length;for(let f=1;f<t.length;++f){const d=t[f];switch(d.type){case"space":l=!0;case"newline":h+=d.source.length;break;case"comment":n&&!l&&i(d,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),h+=d.source.length,u=d.source.substring(1);break;case"error":i(d,"UNEXPECTED_TOKEN",d.message),h+=d.source.length;break;default:{const p=`Unexpected token in block scalar header: ${d.type}`;i(d,"UNEXPECTED_TOKEN",p);const y=d.source;y&&typeof y=="string"&&(h+=y.length)}}}return{mode:s,indent:o,chomp:a,comment:u,length:h}}function ztt(e){const t=e.split(/\n( *)/),n=t[0],i=n.match(/^( *)/),s=[i!=null&&i[1]?[i[1],n.slice(i[1].length)]:["",n]];for(let o=1;o<t.length;o+=2)s.push([t[o],t[o+1]]);return s}function o$(e,t,n){const{offset:i,type:r,source:s,end:o}=e;let a,c;const l=(f,d,p)=>n(i+f,d,p);switch(r){case"scalar":a=mt.PLAIN,c=jtt(s,l);break;case"single-quoted-scalar":a=mt.QUOTE_SINGLE,c=qtt(s,l);break;case"double-quoted-scalar":a=mt.QUOTE_DOUBLE,c=Ytt(s,l);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${r}`),{value:"",type:null,comment:"",range:[i,i+s.length,i+s.length]}}const u=i+s.length,h=lu(o,u,t,n);return{value:c,type:a,comment:h.comment,range:[i,u,h.offset]}}function jtt(e,t){let n="";switch(e[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${e[0]}`;break}case"@":case"`":{n=`reserved character ${e[0]}`;break}}return n&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),a$(e)}function qtt(e,t){return(e[e.length-1]!=="'"||e.length===1)&&t(e.length,"MISSING_CHAR","Missing closing 'quote"),a$(e.slice(1,-1)).replace(/''/g,"'")}function a$(e){let t,n;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=t.exec(e);if(!i)return e;let r=i[1],s=" ",o=t.lastIndex;for(n.lastIndex=o;i=n.exec(e);)i[1]===""?s===`
`?r+=s:s=`
`:(r+=s+i[1],s=" "),o=n.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,i=a.exec(e),r+s+((i==null?void 0:i[1])??"")}function Ytt(e,t){let n="";for(let i=1;i<e.length-1;++i){const r=e[i];if(!(r==="\r"&&e[i+1]===`
`))if(r===`
`){const{fold:s,offset:o}=Vtt(e,i);n+=s,i=o}else if(r==="\\"){let s=e[++i];const o=Wtt[s];if(o)n+=o;else if(s===`
`)for(s=e[i+1];s===" "||s==="	";)s=e[++i+1];else if(s==="\r"&&e[i+1]===`
`)for(s=e[++i+1];s===" "||s==="	";)s=e[++i+1];else if(s==="x"||s==="u"||s==="U"){const a={x:2,u:4,U:8}[s];n+=Gtt(e,i+1,a,t),i+=a}else{const a=e.substr(i-1,2);t(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),n+=a}}else if(r===" "||r==="	"){const s=i;let o=e[i+1];for(;o===" "||o==="	";)o=e[++i+1];o!==`
`&&!(o==="\r"&&e[i+2]===`
`)&&(n+=i>s?e.slice(s,i+1):r)}else n+=r}return(e[e.length-1]!=='"'||e.length===1)&&t(e.length,"MISSING_CHAR",'Missing closing "quote'),n}function Vtt(e,t){let n="",i=e[t+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&e[t+2]!==`
`);)i===`
`&&(n+=`
`),t+=1,i=e[t+1];return n||(n=" "),{fold:n,offset:t}}const Wtt={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Gtt(e,t,n,i){const r=e.substr(t,n),o=r.length===n&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(o)){const a=e.substr(t-2,n+2);return i(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function c$(e,t,n,i){const{value:r,type:s,comment:o,range:a}=t.type==="block-scalar"?s$(t,e.options.strict,i):o$(t,e.options.strict,i),c=n?e.directives.tagName(n.source,h=>i(n,"TAG_RESOLVE_FAILED",h)):null,l=n&&c?Htt(e.schema,r,c,n,i):t.type==="scalar"?Xtt(e,r,t,i):e.schema[yr];let u;try{const h=l.resolve(r,f=>i(n??t,"TAG_RESOLVE_FAILED",f),e.options);u=Xt(h)?h:new mt(h)}catch(h){const f=h instanceof Error?h.message:String(h);i(n??t,"TAG_RESOLVE_FAILED",f),u=new mt(r)}return u.range=a,u.source=r,s&&(u.type=s),c&&(u.tag=c),l.format&&(u.format=l.format),o&&(u.comment=o),u}function Htt(e,t,n,i,r){var a;if(n==="!")return e[yr];const s=[];for(const c of e.tags)if(!c.collection&&c.tag===n)if(c.default&&c.test)s.push(c);else return c;for(const c of s)if((a=c.test)!=null&&a.test(t))return c;const o=e.knownTags[n];return o&&!o.collection?(e.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),e[yr])}function Xtt({directives:e,schema:t},n,i,r){const s=t.tags.find(o=>{var a;return o.default&&((a=o.test)==null?void 0:a.test(n))})||t[yr];if(t.compat){const o=t.compat.find(a=>{var c;return a.default&&((c=a.test)==null?void 0:c.test(n))})??t[yr];if(s.tag!==o.tag){const a=e.tagString(s.tag),c=e.tagString(o.tag),l=`Value may be parsed as either ${a} or ${c}`;r(i,"TAG_RESOLVE_FAILED",l,!0)}}return s}function Ktt(e,t,n){if(t){n===null&&(n=t.length);for(let i=n-1;i>=0;--i){let r=t[i];switch(r.type){case"space":case"comment":case"newline":e-=r.source.length;continue}for(r=t[++i];(r==null?void 0:r.type)==="space";)e+=r.source.length,r=t[++i];break}}return e}const Qtt={composeNode:l$,composeEmptyNode:Gb};function l$(e,t,n,i){const{spaceBefore:r,comment:s,anchor:o,tag:a}=n;let c,l=!0;switch(t.type){case"alias":c=Jtt(e,t,i),(o||a)&&i(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=c$(e,t,a,i),o&&(c.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Ptt(Qtt,e,t,a,i),o&&(c.anchor=o.source.substring(1));break;default:{const u=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;i(t,"UNEXPECTED_TOKEN",u),c=Gb(e,t.offset,void 0,null,n,i),l=!1}}return o&&c.anchor===""&&i(o,"BAD_ALIAS","Anchor cannot be an empty string"),r&&(c.spaceBefore=!0),s&&(t.type==="scalar"&&t.source===""?c.comment=s:c.commentBefore=s),e.options.keepSourceTokens&&l&&(c.srcToken=t),c}function Gb(e,t,n,i,{spaceBefore:r,comment:s,anchor:o,tag:a,end:c},l){const u={type:"scalar",offset:Ktt(t,n,i),indent:-1,source:""},h=c$(e,u,a,l);return o&&(h.anchor=o.source.substring(1),h.anchor===""&&l(o,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(h.spaceBefore=!0),s&&(h.comment=s,h.range[2]=c),h}function Jtt({options:e},{offset:t,source:n,end:i},r){const s=new Ap(n.substring(1));s.source===""&&r(t,"BAD_ALIAS","Alias cannot be an empty string"),s.source.endsWith(":")&&r(t+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=t+n.length,a=lu(i,o,e.strict,r);return s.range=[t,o,a.offset],a.comment&&(s.comment=a.comment),s}function Ztt(e,t,{offset:n,start:i,value:r,end:s},o){const a=Object.assign({_directives:t},e),c=new oc(void 0,a),l={atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},u=Da(i,{indicator:"doc-start",next:r??(s==null?void 0:s[0]),offset:n,onError:o,startOnNewline:!0});u.found&&(c.directives.docStart=!0,r&&(r.type==="block-map"||r.type==="block-seq")&&!u.hasNewline&&o(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=r?l$(l,r,u,o):Gb(l,u.end,i,null,u,o);const h=c.contents.range[2],f=lu(s,h,!1,o);return f.comment&&(c.comment=f.comment),c.range=[n,h,f.offset],c}function Sc(e){if(typeof e=="number")return[e,e+1];if(Array.isArray(e))return e.length===2?e:[e[0],e[1]];const{offset:t,source:n}=e;return[t,t+(typeof n=="string"?n.length:1)]}function Iv(e){var r;let t="",n=!1,i=!1;for(let s=0;s<e.length;++s){const o=e[s];switch(o[0]){case"#":t+=(t===""?"":i?`

`:`
`)+(o.substring(1)||" "),n=!0,i=!1;break;case"%":((r=e[s+1])==null?void 0:r[0])!=="#"&&(s+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:t,afterEmptyLine:i}}class Hb{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,i,r,s)=>{const o=Sc(n);s?this.warnings.push(new i$(o,i,r)):this.errors.push(new Ps(o,i,r))},this.directives=new Ce({version:t.version||"1.2"}),this.options=t}decorate(t,n){const{comment:i,afterEmptyLine:r}=Iv(this.prelude);if(i){const s=t.contents;if(n)t.comment=t.comment?`${t.comment}
${i}`:i;else if(r||t.directives.docStart||!s)t.commentBefore=i;else if(ne(s)&&!s.flow&&s.items.length>0){let o=s.items[0];Jt(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${i}
${a}`:i}else{const o=s.commentBefore;s.commentBefore=o?`${i}
${o}`:i}}n?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Iv(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,n=!1,i=-1){for(const r of t)yield*this.next(r);yield*this.end(n,i)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(n,i,r)=>{const s=Sc(t);s[0]+=n,this.onError(s,"BAD_DIRECTIVE",i,r)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{const n=Ztt(this.options,this.directives,t,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{const n=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,i=new Ps(Sc(t),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new Ps(Sc(t),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const n=lu(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Ps(Sc(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){const i=Object.assign({_directives:this.directives},this.options),r=new oc(void 0,i);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,n,n],this.decorate(r,!1),yield r}}}function tet(e,t=!0,n){if(e){const i=(r,s,o)=>{const a=typeof r=="number"?r:Array.isArray(r)?r[0]:r.offset;if(n)n(a,s,o);else throw new Ps([a,a+1],s,o)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return o$(e,t,i);case"block-scalar":return s$(e,t,i)}}return null}function eet(e,t){const{implicitKey:n=!1,indent:i,inFlow:r=!1,offset:s=-1,type:o="PLAIN"}=t,a=au({type:o,value:e},{implicitKey:n,indent:i>0?" ".repeat(i):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}}),c=t.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(a[0]){case"|":case">":{const l=a.indexOf(`
`),u=a.substring(0,l),h=a.substring(l+1)+`
`,f=[{type:"block-scalar-header",offset:s,indent:i,source:u}];return u$(f,c)||f.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:s,indent:i,props:f,source:h}}case'"':return{type:"double-quoted-scalar",offset:s,indent:i,source:a,end:c};case"'":return{type:"single-quoted-scalar",offset:s,indent:i,source:a,end:c};default:return{type:"scalar",offset:s,indent:i,source:a,end:c}}}function net(e,t,n={}){let{afterKey:i=!1,implicitKey:r=!1,inFlow:s=!1,type:o}=n,a="indent"in e?e.indent:null;if(i&&typeof a=="number"&&(a+=2),!o)switch(e.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const l=e.props[0];if(l.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=l.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const c=au({type:o,value:t},{implicitKey:r||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":iet(e,c);break;case'"':n0(e,c,"double-quoted-scalar");break;case"'":n0(e,c,"single-quoted-scalar");break;default:n0(e,c,"scalar")}}function iet(e,t){const n=t.indexOf(`
`),i=t.substring(0,n),r=t.substring(n+1)+`
`;if(e.type==="block-scalar"){const s=e.props[0];if(s.type!=="block-scalar-header")throw new Error("Invalid block scalar header");s.source=i,e.source=r}else{const{offset:s}=e,o="indent"in e?e.indent:-1,a=[{type:"block-scalar-header",offset:s,indent:o,source:i}];u$(a,"end"in e?e.end:void 0)||a.push({type:"newline",offset:-1,indent:o,source:`
`});for(const c of Object.keys(e))c!=="type"&&c!=="offset"&&delete e[c];Object.assign(e,{type:"block-scalar",indent:o,props:a,source:r})}}function u$(e,t){if(t)for(const n of t)switch(n.type){case"space":case"comment":e.push(n);break;case"newline":return e.push(n),!0}return!1}function n0(e,t,n){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=n,e.source=t;break;case"block-scalar":{const i=e.props.slice(1);let r=t.length;e.props[0].type==="block-scalar-header"&&(r-=e.props[0].source.length);for(const s of i)s.offset+=r;delete e.props,Object.assign(e,{type:n,source:t,end:i});break}case"block-map":case"block-seq":{const r={type:"newline",offset:e.offset+t.length,indent:e.indent,source:`
`};delete e.items,Object.assign(e,{type:n,source:t,end:[r]});break}default:{const i="indent"in e?e.indent:-1,r="end"in e&&Array.isArray(e.end)?e.end.filter(s=>s.type==="space"||s.type==="comment"||s.type==="newline"):[];for(const s of Object.keys(e))s!=="type"&&s!=="offset"&&delete e[s];Object.assign(e,{type:n,indent:i,source:t,end:r})}}}const ret=e=>"type"in e?ad(e):gf(e);function ad(e){switch(e.type){case"block-scalar":{let t="";for(const n of e.props)t+=ad(n);return t+e.source}case"block-map":case"block-seq":{let t="";for(const n of e.items)t+=gf(n);return t}case"flow-collection":{let t=e.start.source;for(const n of e.items)t+=gf(n);for(const n of e.end)t+=n.source;return t}case"document":{let t=gf(e);if(e.end)for(const n of e.end)t+=n.source;return t}default:{let t=e.source;if("end"in e&&e.end)for(const n of e.end)t+=n.source;return t}}}function gf({start:e,key:t,sep:n,value:i}){let r="";for(const s of e)r+=s.source;if(t&&(r+=ad(t)),n)for(const s of n)r+=s.source;return i&&(r+=ad(i)),r}const jm=Symbol("break visit"),set=Symbol("skip children"),f$=Symbol("remove item");function oo(e,t){"type"in e&&e.type==="document"&&(e={start:e.start,value:e.value}),h$(Object.freeze([]),e,t)}oo.BREAK=jm;oo.SKIP=set;oo.REMOVE=f$;oo.itemAtPath=(e,t)=>{let n=e;for(const[i,r]of t){const s=n==null?void 0:n[i];if(s&&"items"in s)n=s.items[r];else return}return n};oo.parentCollection=(e,t)=>{const n=oo.itemAtPath(e,t.slice(0,-1)),i=t[t.length-1][0],r=n==null?void 0:n[i];if(r&&"items"in r)return r;throw new Error("Parent collection not found")};function h$(e,t,n){let i=n(t,e);if(typeof i=="symbol")return i;for(const r of["key","value"]){const s=t[r];if(s&&"items"in s){for(let o=0;o<s.items.length;++o){const a=h$(Object.freeze(e.concat([[r,o]])),s.items[o],n);if(typeof a=="number")o=a-1;else{if(a===jm)return jm;a===f$&&(s.items.splice(o,1),o-=1)}}typeof i=="function"&&r==="key"&&(i=i(t,e))}}return typeof i=="function"?i(t,e):i}const Dp="\uFEFF",Cp="",Bp="",Sl="",oet=e=>!!e&&"items"in e,aet=e=>!!e&&(e.type==="scalar"||e.type==="single-quoted-scalar"||e.type==="double-quoted-scalar"||e.type==="block-scalar");function cet(e){switch(e){case Dp:return"<BOM>";case Cp:return"<DOC>";case Bp:return"<FLOW_END>";case Sl:return"<SCALAR>";default:return JSON.stringify(e)}}function d$(e){switch(e){case Dp:return"byte-order-mark";case Cp:return"doc-mode";case Bp:return"flow-error-end";case Sl:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const uet=Object.freeze(Object.defineProperty({__proto__:null,BOM:Dp,DOCUMENT:Cp,FLOW_END:Bp,SCALAR:Sl,createScalarToken:eet,isCollection:oet,isScalar:aet,prettyToken:cet,resolveAsScalar:tet,setScalarValue:net,stringify:ret,tokenType:d$,visit:oo},Symbol.toStringTag,{value:"Module"}));function En(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const Mv="0123456789ABCDEFabcdef".split(""),fet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),i0=",[]{}".split(""),het=` ,[]{}
\r	`.split(""),r0=e=>!e||het.includes(e);class p${constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,n=!1){t&&(this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null),this.atEnd=!n;let i=this.next??"stream";for(;i&&(n||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let t=this.pos,n=this.buffer[t];for(;n===" "||n==="	";)n=this.buffer[++t];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[t+1]===`
`:!1}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let n=this.buffer[t];if(this.indentNext>0){let i=0;for(;n===" ";)n=this.buffer[++i+t];if(n==="\r"){const r=this.buffer[i+t+1];if(r===`
`||!r&&!this.atEnd)return t+i+1}return n===`
`||i>=this.indentNext||!n&&!this.atEnd?t+i:-1}if(n==="-"||n==="."){const i=this.buffer.substr(t,3);if((i==="---"||i==="...")&&En(this.buffer[t+3]))return-1}return t}getLine(){let t=this.lineEndPos;return(typeof t!="number"||t!==-1&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),t===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[t-1]==="\r"&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(t===null)return this.setNext("stream");if(t[0]===Dp&&(yield*this.pushCount(1),t=t.substring(1)),t[0]==="%"){let n=t.length;const i=t.indexOf("#");if(i!==-1){const s=t[i-1];(s===" "||s==="	")&&(n=i-1)}for(;;){const s=t[n-1];if(s===" "||s==="	")n-=1;else break}const r=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-n),yield*this.pushNewline(),"stream"}return yield Cp,yield*this.parseLineStart()}*parseLineStart(){const t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if(t==="-"||t==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if(n==="---"&&En(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(n==="..."&&En(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!En(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[t,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((t==="-"||t==="?"||t===":")&&En(n)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const t=this.getLine();if(t===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(t[n]){case"#":yield*this.pushCount(t.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(r0),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(t.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,n,i=-1;do t=yield*this.pushNewline(),t>0?(n=yield*this.pushSpaces(!1),this.indentValue=i=n):n=0,n+=yield*this.pushSpaces(!0);while(t+n>0);const r=this.getLine();if(r===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&r[0]!=="#"||i===0&&(r.startsWith("---")||r.startsWith("..."))&&En(r[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(r[0]==="]"||r[0]==="}")))return this.flowLevel=0,yield Bp,yield*this.parseLineStart();let s=0;for(;r[s]===",";)s+=yield*this.pushCount(1),s+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(s+=yield*this.pushIndicators(),r[s]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-s),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(r0),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||En(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const t=this.charAt(0);let n=this.buffer.indexOf(t,this.pos+1);if(t==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let s=0;for(;this.buffer[n-1-s]==="\\";)s+=1;if(s%2===0)break;n=this.buffer.indexOf('"',n+1)}const i=this.buffer.substring(0,n);let r=i.indexOf(`
`,this.pos);if(r!==-1){for(;r!==-1;){const s=this.continueScalar(r+1);if(s===-1)break;r=i.indexOf(`
`,s)}r!==-1&&(n=r-(i[r-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){const n=this.buffer[++t];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>En(n)||n==="#")}*parseBlockScalar(){let t=this.pos-1,n=0,i;t:for(let r=this.pos;i=this.buffer[r];++r)switch(i){case" ":n+=1;break;case`
`:t=r,n=0;break;case"\r":{const s=this.buffer[r+1];if(!s&&!this.atEnd)return this.setNext("block-scalar");if(s===`
`)break}default:break t}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{const r=this.continueScalar(t+1);if(r===-1)break;t=this.buffer.indexOf(`
`,r)}while(t!==-1);if(t===-1){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}if(!this.blockScalarKeep)do{let r=t-1,s=this.buffer[r];s==="\r"&&(s=this.buffer[--r]);const o=r;for(;s===" "||s==="	";)s=this.buffer[--r];if(s===`
`&&r>=this.pos&&r+1+n>o)t=r;else break}while(!0);return yield Sl,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const t=this.flowLevel>0;let n=this.pos-1,i=this.pos-1,r;for(;r=this.buffer[++i];)if(r===":"){const s=this.buffer[i+1];if(En(s)||t&&s===",")break;n=i}else if(En(r)){let s=this.buffer[i+1];if(r==="\r"&&(s===`
`?(i+=1,r=`
`,s=this.buffer[i+1]):n=i),s==="#"||t&&i0.includes(s))break;if(r===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(t&&i0.includes(r))break;n=i}return!r&&!this.atEnd?this.setNext("plain-scalar"):(yield Sl,yield*this.pushToIndex(n+1,!0),t?"flow":"doc")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,n){const i=this.buffer.slice(this.pos,t);return i?(yield i,this.pos+=i.length,i.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(r0))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const t=this.flowLevel>0,n=this.charAt(1);if(En(n)||t&&i0.includes(n))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let t=this.pos+2,n=this.buffer[t];for(;!En(n)&&n!==">";)n=this.buffer[++t];return yield*this.pushToIndex(n===">"?t+1:t,!1)}else{let t=this.pos+1,n=this.buffer[t];for(;n;)if(fet.includes(n))n=this.buffer[++t];else if(n==="%"&&Mv.includes(this.buffer[t+1])&&Mv.includes(this.buffer[t+2]))n=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){const t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):t==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let n=this.pos-1,i;do i=this.buffer[++n];while(i===" "||t&&i==="	");const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(t){let n=this.pos,i=this.buffer[n];for(;!t(i);)i=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class y${constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let n=0,i=this.lineStarts.length;for(;n<i;){const s=n+i>>1;this.lineStarts[s]<t?n=s+1:i=s}if(this.lineStarts[n]===t)return{line:n+1,col:1};if(n===0)return{line:0,col:t};const r=this.lineStarts[n-1];return{line:n,col:t-r+1}}}}function jn(e,t){for(let n=0;n<e.length;++n)if(e[n].type===t)return!0;return!1}function Nv(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function m$(e){switch(e==null?void 0:e.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Hu(e){switch(e.type){case"document":return e.start;case"block-map":{const t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function No(e){var n;if(e.length===0)return[];let t=e.length;t:for(;--t>=0;)switch(e[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break t}for(;((n=e[++t])==null?void 0:n.type)==="space";);return e.splice(t,e.length)}function $v(e){if(e.start.type==="flow-seq-start")for(const t of e.items)t.sep&&!t.value&&!jn(t.start,"explicit-key-ind")&&!jn(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,m$(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class Xb{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new p$,this.onNewLine=t}*parse(t,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(t,n))yield*this.next(i);n||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}const n=d$(t);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{const i=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const t=this.peek(1);if(this.type==="doc-end"&&(!t||t.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){const n=t??this.stack.pop();if(n)if(this.stack.length===0)yield n;else{const i=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in i?i.indent:0:n.type==="flow-collection"&&i.type==="document"&&(n.indent=0),n.type==="flow-collection"&&$v(n),i.type){case"document":i.value=n;break;case"block-scalar":i.props.push(n);break;case"block-map":{const r=i.items[i.items.length-1];if(r.value){i.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(r.sep)r.value=n;else{Object.assign(r,{key:n,sep:[]}),this.onKeyLine=!jn(r.start,"explicit-key-ind");return}break}case"block-seq":{const r=i.items[i.items.length-1];r.value?i.items.push({start:[],value:n}):r.value=n;break}case"flow-collection":{const r=i.items[i.items.length-1];!r||r.value?i.items.push({start:[],key:n,sep:[]}):r.sep?r.value=n:Object.assign(r,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const r=n.items[n.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&Nv(r.start)===-1&&(n.indent===0||r.start.every(s=>s.type!=="comment"||s.indent<n.indent))&&(i.type==="document"?i.end=r.start:i.items.push({start:r.start}),n.items.splice(-1,1))}}else{const i="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:i}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{Nv(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}const n=this.startBlockValue(t);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){const n=Hu(this.peek(2)),i=No(n);let r;t.end?(r=t.end,r.push(this.sourceToken),delete t.end):r=[this.sourceToken];const s={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:i,key:t,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=s}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var i;const n=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const r="end"in n.value?n.value.end:void 0,s=Array.isArray(r)?r[r.length-1]:void 0;(s==null?void 0:s.type)==="comment"?r==null||r.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,t.indent)){const r=t.items[t.items.length-2],s=(i=r==null?void 0:r.value)==null?void 0:i.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=t.indent){const r=!this.onKeyLine&&this.indent===t.indent&&n.sep;let s=[];if(r&&n.sep&&!n.value){const o=[];for(let a=0;a<n.sep.length;++a){const c=n.sep[a];switch(c.type){case"newline":o.push(a);break;case"space":break;case"comment":c.indent>t.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(s=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":r||n.value?(s.push(this.sourceToken),t.items.push({start:s}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!jn(n.start,"explicit-key-ind")?n.start.push(this.sourceToken):r||n.value?(s.push(this.sourceToken),t.items.push({start:s})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(jn(n.start,"explicit-key-ind"))if(n.sep)if(n.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(jn(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(m$(n.key)&&!jn(n.sep,"newline")){const o=No(n.start),a=n.key,c=n.sep;c.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:a,sep:c}]})}else s.length>0?n.sep=n.sep.concat(s,this.sourceToken):n.sep.push(this.sourceToken);else if(jn(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=No(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||r?t.items.push({start:s,key:null,sep:[this.sourceToken]}):jn(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);r||n.value?(t.items.push({start:s,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(t);if(o){r&&o.type!=="block-seq"&&jn(n.start,"explicit-key-ind")&&t.items.push({start:s}),this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var i;const n=t.items[t.items.length-1];switch(this.type){case"newline":if(n.value){const r="end"in n.value?n.value.end:void 0,s=Array.isArray(r)?r[r.length-1]:void 0;(s==null?void 0:s.type)==="comment"?r==null||r.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,t.indent)){const r=t.items[t.items.length-2],s=(i=r==null?void 0:r.value)==null?void 0:i.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=t.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;n.value||jn(n.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>t.indent){const r=this.startBlockValue(t);if(r){this.stack.push(r);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){const n=t.items[t.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?t.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);!n||n.value?t.items.push({start:[],key:r,sep:[]}):n.sep?this.stack.push(r):Object.assign(n,{key:r,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}const i=this.startBlockValue(t);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===t.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const r=Hu(i),s=No(r);$v(t);const o=t.end.splice(1,t.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:s,key:t,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=Hu(t),i=No(n);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i}]}}case"map-value-ind":{this.onKeyLine=!0;const n=Hu(t),i=No(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,n){return this.type!=="comment"||this.indent<=n?!1:t.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function g$(e){const t=e.prettyErrors!==!1;return{lineCounter:e.lineCounter||t&&new y$||null,prettyErrors:t}}function det(e,t={}){const{lineCounter:n,prettyErrors:i}=g$(t),r=new Xb(n==null?void 0:n.addNewLine),s=new Hb(t),o=Array.from(s.compose(r.parse(e)));if(i&&n)for(const a of o)a.errors.forEach(od(e,n)),a.warnings.forEach(od(e,n));return o.length>0?o:Object.assign([],{empty:!0},s.streamInfo())}function b$(e,t={}){const{lineCounter:n,prettyErrors:i}=g$(t),r=new Xb(n==null?void 0:n.addNewLine),s=new Hb(t);let o=null;for(const a of s.compose(r.parse(e),!0,e.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new Ps(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&n&&(o.errors.forEach(od(e,n)),o.warnings.forEach(od(e,n))),o}function pet(e,t,n){let i;typeof t=="function"?i=t:n===void 0&&t&&typeof t=="object"&&(n=t);const r=b$(e,n);if(!r)return null;if(r.warnings.forEach(s=>PN(r.options.logLevel,s)),r.errors.length>0){if(r.options.logLevel!=="silent")throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:i},n))}function yet(e,t,n){let i=null;if(typeof t=="function"||Array.isArray(t)?i=t:n===void 0&&t&&(n=t),typeof n=="string"&&(n=n.length),typeof n=="number"){const r=Math.round(n);n=r<1?void 0:r>8?{indent:8}:{indent:r}}if(e===void 0){const{keepUndefined:r}=n??t??{};if(!r)return}return new oc(e,i,n).toString(n)}const met=Object.freeze(Object.defineProperty({__proto__:null,Alias:Ap,CST:uet,Composer:Hb,Document:oc,Lexer:p$,LineCounter:y$,Pair:Le,Parser:Xb,Scalar:mt,Schema:Fp,YAMLError:Wb,YAMLMap:hn,YAMLParseError:Ps,YAMLSeq:is,YAMLWarning:i$,isAlias:po,isCollection:ne,isDocument:ec,isMap:nc,isNode:fe,isPair:Jt,isScalar:Xt,isSeq:ic,parse:pet,parseAllDocuments:det,parseDocument:b$,stringify:yet,visit:ns,visitAsync:Ep},Symbol.toStringTag,{value:"Module"}));async function get(e){const t=await vL();as().databaseConnector(t);const n=met.parse(await fetch("campaign-finance.yaml").then(r=>r.text())),i=await jZ(n,{baseURL:location.origin+"/"});e.replaceChildren(i)}const bet=document.querySelector("#app");get(bet);
